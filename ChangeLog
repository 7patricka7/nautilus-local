2000-09-06  Robey Pointer  <robey@eazel.com>

	* components/services/install/lib/eazel-install-md5.c:
	(_byte_reverse), (md5_update), (md5_final), (md5_get_digest),
	(md5_get_digest_from_file), (main):
	* components/services/install/lib/eazel-install-md5.h:

	Fix evil gint/gchar types in MD5 to use native types according to
	the style guide.
	
2000-09-06  John Sullivan  <sullivan@eazel.com>

	Fixed bug 1794 (New directory view background context menu design)

	Any complaints or revisions of the context menus in directory
	views should be written up as new bugs.

	* libnautilus-extensions/nautilus-gtk-extensions.h,
	* libnautilus-extensions/nautilus-gtk-extensions.c:
	(nautilus_gtk_menu_insert_separator): New function, slight
	generalization of _append_separator that takes a position.
	(nautilus_gtk_menu_append_separator): Now calls _insert_separator.
	
	* src/file-manager/fm-icon-view.h: Added supports_auto_layout 
	function pointer for subclasses to optionally override.
	
	* src/file-manager/fm-icon-view.c: 
	renamed details->updating_bonobo_marked_menu_item to
	updating_toggle_menu_item since I realized that it's not
	a Bonobo-specific problem.
	(tighter_layout_callback): updated for API changes.
	(fm_icon_view_using_auto_layout),
	(fm_icon_view_using_tighter_layout): New convenience function
	to share a little code.
	(compute_menu_item_info): Changed toggle_item boolean parameter
	to menu_item_type that returns an enum for normal, check,
	radio, and subtree items; moved some layout-related items in
	here so the context menu can avoid duplicating code.
	(context_menu_layout_radio_item_callback),
	(append_one_context_menu_layout_item): New functions, used by
	layout items in context menu. 
	(insert_one_context_menu_item): Now handles the various menu item 
	types returned by compute_menu_item_info, and returns the new item.
	(append_one_context_menu_item): Now returns the new item.
	(fm_icon_view_create_background_context_menu_items): Add the
	layout items to the context menu per bug 1794.
	(fm_icon_view_supports_auto_layout): New function, calls
	virtual function.
	(real_supports_auto_layout): Returns TRUE.
	(fm_icon_view_initialize_class): Wire up supports_auto_layout.
	(update_layout_menus): Now skips some work if supports_auto_layout
	is false; also updates reversed_order item in a way that works
	even the reversed_order field was changed elsewise.
	(fm_icon_view_get_directory_sort_by),
	(fm_icon_view_set_directory_sort_by),
	(fm_icon_view_get_directory_sort_reversed),
	(fm_icon_view_set_directory_sort_reversed),
	(fm_icon_view_get_directory_auto_layout),
	(fm_icon_view_set_directory_auto_layout): Bail out early if
	supports_auto_layout is false.
	(fm_icon_view_begin_loading): Refactor a little.
	(insert_bonobo_menu_item): Handle the different menu item types
	returned by compute_menu_item_info.
	(set_sort_criterion_by_path): New function, extracted from
	sort_callback so it could be used elsewhere.
	(sort_callback): Now calls set_sort_criterion_by_path.
	(sort_direction_callback): Changed signature so it can be used
	for both Bonobo and Gtk menus; changed implementation not to
	rely on Bonobo menu state.
	(manual_layout_callback): Changed signature so it can be used
	for both Bonobo and Gtk menus
	(layout_changed_callback),  (icon_position_changed_callback): 
	Use new convenience functions.
	(fm_icon_view_merge_menus): Use insert_bonobo_menu_item for
	more items to avoid duplicating code with context menus.
	(update_one_menu_item): Updated for compute_menu_item_info API change.

	* src/file-manager/fm-desktop-icon-view.c:
	(fm_desktop_icon_view_get_directory_sort_by),
	(fm_desktop_icon_view_set_directory_sort_by),
	(fm_desktop_icon_view_get_directory_sort_reversed),
	(fm_desktop_icon_view_set_directory_sort_reversed),
	(fm_desktop_icon_view_get_directory_sort_auto_layout),
	(fm_desktop_icon_view_set_directory_sort_auto_layout): Removed
	these overridden function pointers, obviated by new
	supports_auto_layout.
	(fm_desktop_icon_view_initialize_class): removed function
	pointer wiring for the above set; added function pointer
	wiring for supports_auto_layout.
	(real_supports_auto_layout): New function, returns FALSE.

2000-09-06  Darin Adler  <darin@eazel.com>

	* libnautilus-extensions/nautilus-search-uri.c: Got rid of a FIXME
	for a bug that was already fixed.
	* libnautilus-extensions/nautilus-volume-monitor.c: (eject_cdrom):
	Got rid of a FIXME for a bug that was already fixed.

2000-09-06  Andy Hertzfeld  <andy@eazel.com>

	* src/nautilus-location-bar.c: (try_to_expand_path):
	fixed bug 2828, append a slash when auto-completing
	directory names.
	
2000-09-06  Eli Goldberg  <eli@eazel.com>

	Checked in Nautilus Smoke Tests to doc tree.

	* docs/smoketests.html

2000-09-06  Darin Adler  <darin@eazel.com>

	Fixed bug 1960 (nautilus_strdup_strftime relies on glibc strftime
	behavior) and bug 2820 (date/time formatting uses non-standard
	glibc extension).

	* libnautilus-extensions/nautilus-glib-extensions.h:
	* libnautilus-extensions/nautilus-glib-extensions.c:
	(nautilus_strdup_strftime): Rewrote nautilus_strdup_strftime so
	that it provides the features we need, but no longer requires the
	GNU glibc version of strftime.
	(nautilus_g_string_append_len): Added a half-assed version of the
	GLib 2.0 function g_string_append_len, since I needed it for
	nautilus_strdup_strftime.
	(test_strftime), (nautilus_self_check_glib_extensions): Added
	light self-checks for the nautilus_strdup_strftime function to
	confirm that my rewrite didn't break it.

	* libnautilus-extensions/nautilus-file.c:
	(nautilus_file_get_date_as_string): Refined the comments for
	localizers to make it clear that the GNU "%-" and "%_" extensions
	are allowed, but other GNU extensions are not.

	* components/services/trilobite/libtrilobite/.cvsignore:
	Ignore some generated files that weren't in the list.
	
2000-09-06  Arlo Rose  <arlo@eazel.com>

	* icons/arlo/left-bumper-active-prelight.png:
	Lopped off a pixel.

2000-09-06  Mathieu Lacage  <mathieu@eazel.com>

	* components/tree/nautilus-tree-view.c: implement autoscroll
	by stealing code from nautilus-icon-dnd.c fixes task 2418
	* libnautilus-extensions/nautilus-icon-container.c:
	(nautilus_icon_container_scroll), (reveal_icon),
	(nautilus_icon_container_update_scroll_region): do not access
	the GtkLayout internal structures but use the gtk accessors.
	ie: gtk_layout_get_[vh]adjustment

2000-09-06  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 2644, Enter and Return should invoke file renaming.
	
	* libnautilus-extensions/nautilus-icon-container.c:
	(key_press_event):

2000-09-06  Darin Adler  <darin@eazel.com>

	Added checks in Nautilus to guarantee we will notice leaks
	of UI handlers in the future.

	The check will fire unless you get new Bonobo, since I just fixed
	a UI handler leak bug in Bonobo.

	* src/nautilus-window.c: (nautilus_window_real_set_content_view):
	Added code to check for a still-merged Open menu item in the file
	menu. This will catch leaks of UI handlers fairly quickly, instead
	of the traditional way we discover them, after long debugging
	sessions.

	* components/history/nautilus-history-view.c:
	(history_view_frame_call_end):
	* libnautilus-extensions/nautilus-undo-manager.c:
	(release_transaction), (nautilus_undo_manager_undo):
	* libnautilus/nautilus-clipboard.c: (add_menu_items_callback):
	* libnautilus/nautilus-undo.c: (undo_manager_unref_cover),
	(nautilus_undo_attach_undo_manager):
	* libnautilus/nautilus-view.c: (view_frame_call_end):
	* src/file-manager/fm-directory-view.c:
	(bonobo_control_activate_callback):
	* src/nautilus-application.c: (nautilus_application_startup):
	* src/nautilus-view-frame-bonobo-embeddable.c:
	(bonobo_subdoc_load_location):
	* src/nautilus-view-frame-nautilus-view.c:
	(nautilus_view_try_load_client):
	* src/nautilus-view-frame.c: (nautilus_view_frame_destroy_client),
	(nautilus_view_frame_load_client):
	Use bonobo_object_dup_ref and bonobo_object_release_unref to
	simplify some code.
	
	* components/loser/content/nautilus-content-loser.c:
	(loser_merge_bonobo_items_callback):
	* components/loser/sidebar/nautilus-sidebar-loser.c:
	(loser_merge_bonobo_items_callback):
	* components/mozilla/nautilus-mozilla-content-view.c:
	(mozilla_merge_bonobo_items_callback):
	* components/sample/nautilus-sample-content-view.c:
	(sample_merge_bonobo_items_callback):
	Add missing unref to avoid leaking a UI handler.
	
	* components/services/time/nautilus-view/trilobite-eazel-time-view.c:
	Remove a bunch of code inside #if 0, which had out of date copies
	of the sample code. I decided this was better than trying to fix
	it.
	
2000-09-06  John Sullivan  <sullivan@eazel.com>

	Fixed bug 2377 (Menu separators in search date criterion
	look wrong and are selectable)

	* src/nautilus-search-bar-criterion.c:
	(get_date_modified_location_for): Replaced "--" with
	"" when defining menu item text.
	(nautilus_search_bar_criterion_new_from_values): When
	constructing option menu items, treat empty string specially
	by not translating it and making an insensitive separator.

2000-09-06  Eskil Heyn Olsen  <eskil@eazel.com>

	* components/services/install/lib/eazel-install-metadata.c:
	(create_default_metadata), (create_default_configuration_metafile),
	(xml_doc_sanity_checks):
	Removed \n's for g_print/warnings/messages
	
	* components/services/install/lib/eazel-install-object.c:
	(eazel_install_finalize), 
	Changed to call parents finalize
	(eazel_install_alter_mode_on_temp),
	(eazel_install_lock_tmp_dir), (eazel_install_unlock_tmp_dir),
	Calls to chmod all the downloaded files and the tmpdir.
	(eazel_install_delete_downloads),
	(eazel_install_install_packages):
	Moved the deletion of downloads to a seperate call, so revert can
	also reap it's benefits.
	
	* components/services/install/lib/eazel-install-protocols.c:
	(gnome_vfs_xfer_callback), (eazel_install_fetch_file),
	Fixed download progress emission to only emit with amount==0 once
	for gnome-vfs downloads.
	Also checks for existence of package prior to download. This
	should be safe once md5 checking is done, and prevents
	fetch_dependencies from fetching the same file over and over
	(which maybe should be solver in another way).
	(eazel_install_fetch_package),
	Moved the md5 checking code into eazel_install_start_transaction.
	(eazel_install_fetch_package_which_provides),
	Fixed evil bug I found now that i modified rpmsearch.cgi to
	support ?provides= searches.
	(get_url_for_package):
	Fixed a packagedata_destroy_foreach call.
	
	* components/services/install/lib/eazel-install-public.h:
	Prototypes for the calls to chmod unchmod tmpdir + downloads.
	
	* components/services/install/lib/eazel-install-rpm-glue.c:
	(eazel_install_flatten_categories), 
	Reversed the order of list concatenation.
	(install_new_packages),
	Creates tmpdir, needed for reverttransaction.
	(eazel_install_download_packages),
	Removed the EAZEL_INSTALL_DOWNLOADS status flag, check the
	downloaded_files list in private instead.
	(eazel_install_monitor_rpm_propcess_pipe),
	Moved a comment reg. parsing rpm --percent here.
	(eazel_install_monitor_subcommand_pipe),
	(eazel_install_do_transaction_md5_check),	
	(eazel_install_start_transaction),
	Moved the md5 checking to be near the installtion routine.
	(eazel_install_check_existing_packages),
	Modified some strings to be more i18n friendly
	(eazel_install_fetch_rpm_dependencies),
	Do a check so the some packages isn't added several times.
	(eazel_install_ensure_deps):
	list append rather then prepend. Seems rpm isn't as nonchalant
	about the order of rpm's as we were led to believe.
	
	* components/services/install/lib/eazel-install-rpm-glue.h:
	Removed the EAZEL_INSTALL_DOWNLOADS status flag, check the
	downloaded_files list in private instead.

	* components/services/install/lib/eazel-install-types.h:
	* components/services/install/lib/eazel-install-types.c:
	(packagedata_new), (packagedata_destroy):
	Made the md5 a pointer rather then char[16];
	
	* components/services/install/lib/makefile.staticlib.in:
	* components/services/trilobite/libtrilobite/makefile.staticlib.in:
	* components/services/trilobite/libtrilobite/trilobite-core-utils.c:
	I needed some cpp loving to keep the gnome-vfs stuff out of
	nautilus-installer.
	
	* components/services/trilobite/sample/service/sample-service-impl.
	c: (sample_service_finalize), (sample_service_unref),
	(sample_service_class_initialize):
	* components/services/trilobite/sample/command-line/main.c: (main):
	* components/services/trilobite/sample/lib/sample-service-public.h:
	* components/services/trilobite/sample/service/main.c:
	(trilobite_service_factory_destroy):
	Fixed the destroy mechanism's of sample-service (bug 967)
	
	* configure.in:
	Added the mystic libtrilobite/makefile/staticlib.in
	
	* nautilus-installer/src/Makefile:
	* nautilus-installer/src/callbacks.c: (begin_install),
	(prep_install), (prep_finish):
	* nautilus-installer/src/callbacks.h:
	* nautilus-installer/src/installer.c: (create_finish_page_good),
	(create_finish_page_evil), (create_window),
	(eazel_installer_initialize):
	* nautilus-installer/src/link.sh:
	More installer loving. Now it enables/disables the next/back
	buttons in a more sane manner, plus handles lack of
	package-list.xml better.

2000-09-05  Robey Pointer  <robey@eazel.com>

	* components/services/install/lib/eazel-install-object.c:
	(eazel_install_install_packages):
	* components/services/trilobite/libtrilobite/trilobite-core-utils.c
	: (trilobite_init):
	* components/services/trilobite/libtrilobite/trilobite-root-helper.
	c: (trilobite_root_helper_start):

	Fix bug 2684 that would cause an occasional crash if running as
	root (freeing a password that had never been collected).

2000-09-05  Ramiro Estrugo  <ramiro@eazel.com>

	* libnautilus-extensions/nautilus-icon-canvas-item.c:
	(nautilus_icon_canvas_item_initialize_class),
	(nautilus_icon_canvas_item_initialize),
	(nautilus_icon_canvas_item_destroy),
	(nautilus_icon_canvas_item_set_arg),
	(nautilus_icon_canvas_item_get_arg), (icon_canvas_item_is_smooth),
	(nautilus_icon_canvas_item_get_max_text_width),
	(nautilus_icon_canvas_item_set_smooth_font),
	(nautilus_icon_canvas_item_set_smooth_font_size):
	* libnautilus-extensions/nautilus-icon-canvas-item.h:
	Add arguments and setter functions to set the font and font size
	in smooth mode.  Also added a function to determine whether we are
	in smooth mode or not.
	
2000-09-05  Pavel Cisler  <pavel@eazel.com>

	* libnautilus-extensions/nautilus-directory-notify.h:
	* libnautilus-extensions/nautilus-directory.c:
	(nautilus_direcotry_copy_move_metadata_key),
	(nautilus_directory_move_metadata),
	(nautilus_directory_copy_metadata),
	(nautilus_directory_schedule_metadata_copy),
	(nautilus_directory_schedule_metadata_move),
	(nautilus_directory_schedule_metadata_remove):
	* libnautilus-extensions/nautilus-file-changes-queue.c:
	(nautilus_file_changes_queue_schedule_metadata_remove),
	(nautilus_file_changes_consume_changes):
	* libnautilus-extensions/nautilus-file-changes-queue.h:
	* libnautilus-extensions/nautilus-file-operations.c:
	(sync_xfer_callback):
	Add hooks for metadata removal.

2000-09-05  Ramiro Estrugo  <ramiro@eazel.com>

	* libnautilus-extensions/nautilus-lib-self-check-functions.h:
	Add hook for scalable fonts test which im going to add soon.

	* libnautilus-extensions/nautilus-scalable-font.h:
	* libnautilus-extensions/nautilus-scalable-font.c:
	(nautilus_scalable_font_text_width), New convenience function to
	measure just the text width.
	(nautilus_self_check_scalable_font): Add hook for scalable fonts
	test which im going to add soon.

2000-09-05  Ramiro Estrugo  <ramiro@eazel.com>

	* libnautilus-extensions/nautilus-scalable-font.c:
	(nautilus_scalable_font_draw_text),
	(nautilus_scalable_font_draw_text_lines_with_dimensions),
	(nautilus_scalable_font_draw_text_lines),
	(initialize_global_stuff_if_needed):
	Add support for rendering text on pixbufs without alpha channels.
	
	* libnautilus-extensions/nautilus-icon-factory.c: (embed_text):
	No longer need to create a pixbuf with alpha channel duplicate.
	
	* test/test-nautilus-font.c: (main):
	Paint the pixbuf white before drawing stuff to it.		
	
2000-09-05  Andy Hertzfeld  <andy@eazel.com>

	* icons/arlo/sidebar_tab_pieces/Makefile.am:
	* icons/arlo/sidebar_tab_pieces/fill-active-prelight.png:
	* icons/arlo/sidebar_tab_pieces/left-bumper-active-prelight.png:
	* icons/arlo/sidebar_tab_pieces/right-top-active-prelight.png:
	added new tab pieces for active prelight state
	
	* src/nautilus-sidebar-tabs.c:
	(nautilus_sidebar_tabs_load_tab_pieces), (draw_one_tab_themed),
	(nautilus_sidebar_tabs_expose):
	fixed bug 2504, active tabs don't prelight, by adding, loading
	and drawing the appropriate tab pieces.  Also, moved the text
	down one pixel at Arlo's request.
	
2000-09-05  Arlo Rose  <arlo@eazel.com>
	
	* icons/arlo/sidebar_tab_pieces/left-bumper.png        
	* icons/arlo/sidebar_tab_pieces/left-bumper-active.png
        * icons/arlo/sidebar_tab_pieces/left-bumper-prelight.png
	Took off left side pixel in order to get rid of the double
	black line that was there.

2000-09-05  Ramiro Estrugo  <ramiro@eazel.com>

	* test/Makefile.am:
	* test/font-test.sh:
	Add a dumb script to make it easy to run the font test.
	
	* test/test-nautilus-font.c: (main):
	Make the clipping test better; clip both vertically and
	horizontally.

2000-09-05  John Sullivan  <sullivan@eazel.com>

	Much context-menu-related cleanup and some bug fixes.

	2734: comment fm_directory_view_add_context_menu_item

	* libnautilus-extensions/nautilus-gtk-extensions.h,
	* libnautilus-extensions/nautilus-gtk-extensions.c:
	(nautilus_gtk_menu_append_separator): New convenience function
	for appending a separator to a GtkMenu.
	(nautilus_gtk_menu_set_item_visibility): New convenience function
	for hiding/showing a menu item in a GtkMenu.
	
	* src/file-manager/fm-directory-view.h:
	Removed overridable function pointers for 
	create_background_context_menu_zoom_items and
	create_background_context_menu_background_items; I made sure the
	API supports what these were used for in a more general way.
	Added overridable function pointer for supports_zooming. Now the
	base class handles disabling/removing things for subclasses that
	don't support zooming.
	Changed fm_directory_view_add_context_menu_item to
	_insert_context_menu_item and gave it a position parameter.
	* src/file-manager/fm-directory-view.c:
	(fm_directory_view_initialize_class): removed function pointer
	assignment for deleted calls; added function pointer assignment
	for new supports_zooming call.
	(select_all_callback): Removed this function because I removed
	the item from the context menu (as per bug 1794).
	(fm_directory_view_bump_zoom_level),
	(fm_directory_view_zoom_to_level),
	(fm_directory_view_set_zoom_level),
	(fm_directory_view_restore_default_zoom_level),
	(fm_directory_view_can_zoom_in), (fm_directory_view_can_zoom_out):
	Bail out without calling overridable function pointer for these
	calls if supports_zooming is FALSE.
	(finish_inserting_menu_item): New function, generalization of
	finish_appending_menu_item that takes a position.
	(finish_appending_menu_item): Now calls finish_inserting_menu_item.
	Also, renamed this from finish_adding_menu_item.
	(compute_menu_item_info): Removed ellipsis from "Show Properties"
	and added comment explaining why it needs no ellipsis.
	(append_gtk_menu_item_with_view),
	(append_selection_menu_subtree): Update for adding -> appending rename.
	(fm_directory_view_insert_context_menu_item): Generalization of
	_append_context_menu_item that takes a position parameter.
	(fm_directory_view_append_context_menu_item): Renamed from
	_add_context_menu_item, and now calls _insert_context_menu_item.
	(real_create_background_context_menu_zoom_items),
	(real_create_background_context_menu_background_items):
	Removed these functions. These menu items are no longer treated as
	special cases.
	(fm_directory_view_real_create_background_context_menu_items):
	Now inserts zooming items only if supports_zooming is TRUE;
	resurrected the accidentally-obliterated "Reset Background" item.
	(add_separator): Removed this function in favor of 
	nautilus_gtk_menu_append_separator.
	(add_application_to_gtk_menu), (add_component_to_gtk_menu),
	(create_open_with_gtk_menu),
	Update for API renames.
	(fm_directory_view_real_create_selection_context_menu_items):
	Use nautilus_gtk_menu_append_separator.
	(fm_directory_view_supports_zooming): New function, calls 
	virtual function.
	(fm_directory_view_real_supports_zooming): New function,
	returns TRUE.

	* src/file-manager/fm-icon-view.c:
	(fm_icon_view_create_background_context_menu_items):
	Remove "Icon Captions..." item per bug 1794

	* src/file-manager/fm-desktop-icon-view.c:
	(fm_desktop_icon_view_create_background_context_menu_zoom_items),
	(fm_desktop_icon_view_create_background_context_menu_background_items),
	(bump_zoom_level), (zoom_to_level), (restore_default_zoom_level),
	(can_zoom_in), (can_zoom_out): Removed these functions due to
	reworking the responsibilities of super- and subclass.
	(real_supports_zooming): New function, returns FALSE.	
	(fm_desktop_icon_view_initialize_class): Remove overrides of various
	functions; add override for supports_zooming.
	(new_folder_menu_item_callback): Removed this now that it inherits
	New Folder from parent.
	(fm_desktop_icon_view_create_background_context_menu_items):
	Cleaned this up to start with inherited and make modifications
	as necessary rather than reimplementing the whole thing.

2000-09-05  Robey Pointer  <robey@eazel.com>

	* components/services/install/lib/eazel-install-protocols.c:
	(eazel_install_fetch_package):
	* components/services/install/lib/eazel-install-rpm-glue.c:
	(eazel_install_download_packages):
	* components/services/install/nautilus-view/nautilus-service-instal
	l-view.c: (nautilus_service_install_downloading):
	* components/services/install/server/main.c:
	(trilobite_service_factory_destroy), (main):

	Fix small bug in eazel-install (don't set the downloaded flag if
	the rpm didn't get downloaded); correct FIXME comment; clean up
	install main to have the right log domain and remove unused code.

2000-09-05  Michael Engber  <engber@eazel.com>
	
	We now update the gnome_config settings that store the list
	of background images that populate the background capplet's
	popup menu. bug 2343.

	* libnautilus-extensions/nautilus-directory-background.c:
	(nautilus_directory_background_write_desktop_settings):

2000-09-05  Mathieu Lacage  <mathieu@eazel.com>

	* components/tree/nautilus-tree-view.c: implement task bugzilla.eazel.com
	2416

2000-09-05  Andy Hertzfeld  <andy@eazel.com>

	fixed bug 2610, can't delete duplicate colors from property browser.
	Also, made property browser use anti-aliased item labels
		
	* src/nautilus-property-browser.c: (remove_color),
	(add_new_button_callback), (remove_button_callback),
	(element_clicked_callback), (make_properties_from_directories):
	fixed bug by checking for delete property when finding item to delete;
	also, set up nautilus_buffered_widget properities for labels
	* src/nautilus-search-bar-criterion.c: (make_emblem_value_menu):
	made it use nautilus_label routines to access returned label text	
	* libnautilus-extensions/nautilus-customization-data.h:
	changed type of label returned from GtkLabel to GtkWidget
	* libnautilus-extensions/nautilus-customization-data.c:
	(nautilus_customization_data_get_next_element_for_display):
	return a nautilus_label instead of a gtk_label
	
2000-09-05  Mathieu Lacage  <mathieu@eazel.com>

	* components/tree/nautilus-tree-view.c:
	(nautilus_tree_view_insert_model_node): add some dnd UI nicety.
	GtkCTreeNode now hold a pointer to their NautilusTreeNode instead 
	of their char *uri.
	
	* libnautilus-extensions/nautilus-search-uri.c:
	(nautilus_self_check_search_uri): fix tests after rebecka 
	second break of them :)

2000-09-05  Darin Adler  <darin@eazel.com>

	* check-FIXME.pl: Removed some special-case file names
	that aren't needed any more.
	
	* libnautilus-extensions/nautilus-file-operations.c:
	(get_link_name): Added comments to help localizers.
	* libnautilus-extensions/nautilus-file.c:
	(nautilus_file_get_date_as_string): Added comments to help
	localizers. Deals with bug 2720 (Please add a comment to help
	localizers do date translations)
	* libnautilus-extensions/nautilus-icon-canvas-item.c:
	(draw_or_measure_label_text): Added a comment to help localizers.
	* src/file-manager/fm-directory-view.c:
	(fm_directory_view_display_selection_info): Unmarked one string
	that doesn't make sense to translate and adding a comment to
	another to explain why it is marked for translation.
	(add_separator): Changed add_open_with_gtk_menu_item into this
	function, which deals with bug 2735 (add_open_with_gtk_menu_item
	only called to create separator?).
	(create_open_with_gtk_menu): Call the new add_separator function.
	* src/nautilus-zoom-control.c: (create_zoom_menu_item): Added a
	comment to help localizers.
	
	* libnautilus-extensions/nautilus-link.c: (make_local_path): Fixed
	logic here that was doing strange things with URIs.  This deals
	with bugs 2492 (Incorrect unescaping when dealing with link
	files), 2493 (Mysterious and probably incorrect "+7" when escaping
	URI for link file), and 2737 (link code must make path into URI).
	
	* libnautilus-extensions/nautilus-search-bar-criterion.c:
	* libnautilus-extensions/nautilus-search-bar-criterion.h:
	* po/POTFILES.in:
	Removed these duplicate files. Rebecca moved them to src, but she
	didn't remove the old ones. I didn't have to remove them from the
	makefile, since they were already removed, but I had to remove
	them from the list of files to translate.
	
	* src/nautilus-search-bar-criterion.h:
	* libnautilus-extensions/nautilus-search-uri.h:
	Moved some of the stuff from nautilus-search-bar-criterion.h to
	here, since it's really about search URIs, not specific to the
	search bar. Over time we will move more.
	
	* src/nautilus-search-bar-criterion.c: Added include of the
	nautilus-search-uri.h header now that stuff was moved there.
	
	* src/file-manager/fm-search-list-view.c:
	Fixed includes to get the nautilus-search-bar-criterion.h from its
	new location. This is not a real solution to the problem that was
	exposed by moving the search bar code. The bug 2815 covers this.
	* src/nautilus-complex-search-bar.c: Fix search bar so it gets
	the real location of the header. It was including the old one.
	* src/nautilus-simple-search-bar.c: Fix search bar so it gets
	the real location of the header. It was including the old one.

	* src/nautilus-main.c: (main): Some small cleanups including some
	additional parameter checking and returning a failure code to
	the invoking shell in the case where the parameters are not
	consistent.
	
2000-09-05  Pavel Cisler  <pavel@eazel.com>

	* configure.in:
	Remove the -Wuninitialized to unbreak the build.
	(It should be part of -Wall so it's probably not needed anyhow).

2000-09-05  Pavel Cisler  <pavel@eazel.com>

	* components/help/converters/gnome-db2html2/gdb3html.c:
	(xml_parse_document):
	* components/help/hyperbola-nav-index.c: (end_element):
	* components/services/summary/nautilus-view/nautilus-summary-view.c
	: (logout_button_cb):
	* components/services/time/service/trilobite-eazel-time-service.c:
	(trilobite_eazel_time_service_do_http_request):
	* components/tree/nautilus-tree-view.c:
	* configure.in:
	* libnautilus-extensions/bonobo-stream-vfs.c:
	(bonobo_stream_vfs_open):
	* libnautilus-extensions/nautilus-background.c:
	(nautilus_background_draw), (nautilus_background_draw_aa):
	* libnautilus-extensions/nautilus-customization-data.c:
	(nautilus_customization_data_new):
	* libnautilus-extensions/nautilus-directory-background.c:
	(nautilus_directory_background_write_desktop_settings):
	* libnautilus-extensions/nautilus-file-operations.c:
	(nautilus_file_operations_move_to_trash), (do_empty_trash):
	* libnautilus-extensions/nautilus-file.c: (nautilus_file_dump):
	* libnautilus-extensions/nautilus-icon-canvas-item.c:
	(draw_or_measure_label_text), (emblem_layout_next):
	* libnautilus-extensions/nautilus-icon-factory.c:
	(get_image_from_cache):
	* libnautilus-extensions/nautilus-icon-text-item.c:
	(iti_paint_text):
	* libnautilus-extensions/nautilus-list.c: (draw_cell), (draw_row):
	* libnautilus-extensions/nautilus-mime-actions.c:
	(nautilus_mime_add_application_to_short_list_for_uri):
	* libnautilus-extensions/nautilus-program-chooser.c:
	(program_file_pair_get_short_status_text),
	(program_file_pair_get_long_status_text):
	* libnautilus-extensions/nautilus-program-choosing.c:
	(nautilus_choose_component_for_file),
	(nautilus_choose_application_for_file):
	* libnautilus-extensions/nautilus-scalable-font.c:
	(nautilus_scalable_font_draw_text_lines_with_dimensions):
	* libnautilus-extensions/nautilus-theme.c:
	(nautilus_theme_make_selector):
	* librsvg/rsvg-ft.c: (rsvg_ft_get_glyph):
	* librsvg/test-ft-gtk.c: (set_text):
	* librsvg/test-ft.c: (save_pixbuf_to_file_internal),
	(save_pixbuf_to_file):
	* librsvg/test-rsvg.c: (save_pixbuf_to_file_internal),
	(save_pixbuf_to_file):
	* src/file-manager/fm-directory-view.c: (display_pending_files),
	(compute_menu_item_info):
	* src/file-manager/fm-icon-view.c: (compute_menu_item_info):
	* src/file-manager/fm-list-view.c: (get_column_from_attribute):
	* src/nautilus-application.c: (nautilus_application_startup):
	* src/nautilus-search-bar-criterion.c:
	(nautilus_search_bar_criterion_next_new),
	(nautilus_search_bar_criterion_get_location),
	(get_date_modified_location_for):
	* src/nautilus-sidebar-tabs.c: (draw_one_tab_themed),
	(draw_or_layout_all_tabs):
	* src/nautilus-toolbar.c: (nautilus_toolbar_size_allocate):
	* src/nautilus-window-manage-views.c:
	(nautilus_window_get_current_location_title):
	* test/test-nautilus-label.c: (justification_changed_callback):

	Fix all the warnings -Wuninitialized found.
	Quite a number of them were actual bugs.
	Turn on -Wuninitialized in configure.in now that ORBit generates 
	warning-free code.
	
2000-09-05  John Sullivan  <sullivan@eazel.com>

	Fixed bug 1247 ("Edit Novice Settings" menu item
	needs to be handled better)

	Now this menu item is enabled, and choosing it explains
	that you can't edited the Novice settings but offers
	to switch to Intermediate and let you edit those
	settings.

	* libnautilus-extensions/nautilus-user-level-manager.c,
	* libnautilus-extensions/nautilus-user-level-manager.h:
	Made the #defines for the user level ints public, so
	code elsewhere could use them rather than hardwiring
	a bunch of 0s, 1s, and 2s.

	* libnautilus-extensions/nautilus-caption-table.h:
	* libnautilus-extensions/nautilus-caption.h:
	* libnautilus-extensions/nautilus-font-picker.h:
	* libnautilus-extensions/nautilus-global-preferences.h:
	* libnautilus-extensions/nautilus-password-dialog.h:
	* libnautilus-extensions/nautilus-preference.h:
	* libnautilus-extensions/nautilus-preferences-box.h:
	* libnautilus-extensions/nautilus-preferences-dialog.h:
	* libnautilus-extensions/nautilus-preferences-group.h:
	* libnautilus-extensions/nautilus-preferences-item.h:
	* libnautilus-extensions/nautilus-preferences-pane.h:
	* libnautilus-extensions/nautilus-preferences-private.h:
	* libnautilus-extensions/nautilus-preferences.h:
	* libnautilus-extensions/nautilus-radio-button-group.h:
	* libnautilus-extensions/nautilus-string-picker.h:
	* libnautilus-extensions/nautilus-text-caption.h:
	Changed the closing BEGIN_GNOME_DECLS in these header files
	to END_GNOME_DECLS.
	
	* src/nautilus-window-menus.c:
	(get_user_level_string_for_display): New function, extracted
	from get_customize_user_level_string. Returns the user level
	string to be put into user messages or menu item names.
	(get_customize_user_level_string): Now calls 
	get_user_level_string_for_display
	(switch_and_show_intermediate_settings_callback): New function,
	switches to intermediate level and displays the user level
	settings dialog.
	(user_level_customize_callback): If the current user level is
	NAUTILUS_USER_LEVEL_NOVICE, puts up a dialog telling the user
	that the Novice settings can't be changed, and asking them if
	they want to switch to Intermediate and edit those settings.
	(get_user_level_image), (user_level_changed_callback),
	(nautilus_window_initialize_menus), 
	(convert_menu_path_to_user_level),
	(convert_user_level_to_menu_path): 
	Use #defines for user levels instead of hardwiring integers.
	(switch_to_user_level): New function, extracted from
	user_level_menu_item_callback. Switches to a specified user
	level and updates menu items & title image appropriately.
	(user_level_menu_item_callback): Now calls switch_to_user_level.
	(update_user_level_menu_items): Don't desensitize the Edit 
	Settings item at Novice user level anymore.

2000-09-05  Andy Hertzfeld  <andy@eazel.com>

	* src/nautilus-shell.c: (display_caveat):
	Now that Ramiro fixed the problems in NautilusLabel,
	made the caveat dialog use anti-aliased text

2000-09-05  Gene Z. Ragan  <gzr@eazel.com>

	* libnautilus-extensions/nautilus-link.c:
	(nautilus_link_get_image_uri):
	Added a check for a NULL image tag returned
	by am XML property retrieval.

2000-09-05  Pavel Cisler  <pavel@eazel.com>

	* libnautilus-extensions/nautilus-directory.c:
	(nautilus_direcotry_copy_move_metadata_key),
	(nautilus_directory_copy_metadata_key),
	(nautilus_directory_move_metadata_key),
	(nautilus_directory_move_metadata),
	(nautilus_directory_copy_metadata),
	(nautilus_directory_schedule_metadata_copy),
	(nautilus_directory_schedule_metadata_move):
	Work on metadata copying.
	For now hardcode the metadata keys that get copied.
	Metadata move does not remove old metadata in source location yet.

2000-09-05  Ramiro Estrugo  <ramiro@eazel.com>

	* libnautilus-extensions/nautilus-icon-factory.c: (embed_text):
	Fix a bug I just introduced drawing embedded text in the non
	smooth case.  We need to make sure the pixbuf we feed to the text
	rendering code has an alpha channel.
	
2000-09-05  Ramiro Estrugo  <ramiro@eazel.com>

	More work on task 1588.

	* libnautilus-extensions/nautilus-icon-factory.c: (embed_text):
	Use NautilusScalableFont to render embedded text.
	
2000-09-05  Ramiro Estrugo  <ramiro@eazel.com>

	* libnautilus-extensions/nautilus-scalable-font.c:
	(nautilus_scalable_font_draw_text_lines):
	Add a FIXME for a performance issue.
	
2000-09-05  Ramiro Estrugo  <ramiro@eazel.com>

	* libnautilus-extensions/nautilus-label.c: (render_buffer_pixbuf):
	* libnautilus-extensions/nautilus-scalable-font.c:
	(nautilus_scalable_font_draw_text_lines_with_dimensions),
	(nautilus_scalable_font_draw_text_lines):
	* libnautilus-extensions/nautilus-scalable-font.h:
	Simpify the text line drawing function to not reuqire passing in
	the number of lines or their dimensions.  Compute these when
	needed.  An alternate function that accepts the dimensions is
	available as well.

	* test/test-nautilus-font.c: (main):
	Draw both text lines and single line clipped text to test more
	stuff.
	
2000-09-05  Ramiro Estrugo  <ramiro@eazel.com>

	Complete task 1733 - need mozilla component support for grokking
	eazel: uris.

	* components/mozilla/nautilus-mozilla-content-view.c:
	(nautilus_mozilla_content_view_initialize),
	(nautilus_mozilla_content_view_destroy), (bonobo_mozilla_callback),
	(mozilla_net_state_callback), (mozilla_open_uri_callback),
	(mozilla_dom_mouse_click_callback):
	For mozilla M17, add support for registering the eazel protocol
	handler.  For mozilla M18, add support for peeking dom events -
	this is the preffered way to deal with these special uris, however
	we cant turn this on until mozilla M18 is released.

2000-09-05  Ramiro Estrugo  <ramiro@eazel.com>

	* components/mozilla/eazel-protocol-handler/eazel-protocol-channel.cpp:
	Damn, some of this code only builds with mozilla M18.  Updating
	for that.
	
2000-09-05  Ramiro Estrugo  <ramiro@eazel.com>

	More work on task 1733.

	* components/mozilla/eazel-protocol-handler/.cvsignore:
	* components/mozilla/eazel-protocol-handler/Makefile.am:
	* components/mozilla/eazel-protocol-handler/eazel-protocol-channel.cpp:
	* components/mozilla/eazel-protocol-handler/eazel-protocol-channel.h:
	* components/mozilla/eazel-protocol-handler/eazel-protocol-handler.cpp:
	* components/mozilla/eazel-protocol-handler/eazel-protocol-handler.h:
	* components/mozilla/eazel-protocol-handler/eazel-protocol-module.cpp:
	New files.  A mozilla XPCOM component to grok eazel: protocol uris.
	
	* components/mozilla/Makefile.am:
	Build the eazel-protocol-handler
	
	* configure.in:
	Build the eazel-protocol-handler

2000-09-05  Ramiro Estrugo  <ramiro@eazel.com>

	* components/tree/.cvsignore:
	Ignore generated files.
	
2000-09-05  Ramiro Estrugo  <ramiro@eazel.com>

	More work on task 1588.

	* libnautilus-extensions/nautilus-scalable-font.c:
	(nautilus_scalable_font_draw_text),
	(nautilus_scalable_font_measure_text_lines),
	(nautilus_scalable_font_draw_text_lines):
	* libnautilus-extensions/nautilus-scalable-font.h:
	Change text rendering api to take in x,y coordinates along with a
	clip_area.  

	Remove some #if 0 code i left in before.

	Also change the text lines rendering api to optionally do its own
	line measuring - for the convenience of the caller.
	
	* libnautilus-extensions/nautilus-label.c: (render_buffer_pixbuf):
	Update for text rendering changes.
	Fix the justification bug.
	Fix the multiple newlines bug.
	
	* src/nautilus-about.c: (draw_aa_string):
	Update for text rendering changes.
	
	* src/nautilus-sidebar-tabs.c: (draw_one_tab_plain),
	(draw_one_tab_themed):
	Update for text rendering changes.

	* test/test-nautilus-font.c: (main):
	Update for text rendering changes.
	Also add multiple new lines test and clipping test.
	
	* test/test-nautilus-label.c: (main):
	Update for text rendering changes.

2000-09-05  Ramiro Estrugo  <ramiro@eazel.com>

	* librsvg/rsvg-ft.c: (rsvg_ft_render_string):
	Add a band aid fix for the unknown character problem when trying
	to index glyphs from a font face.  I filed a bug for this issue:
	2775.
	
2000-09-04  Maciej Stachowiak  <mjs@eazel.com>

	* src/nautilus-window-manage-views.c
	(nautilus_window_update_view): Fix bug 2462 by causing a NULL
	selection to be interpreted as no selection, rather than an empty
	selection.

2000-09-05  Andy Hertzfeld  <andy@eazel.com>

	* src/nautilus-theme-selector.c:
	(nautilus_theme_selector_initialize), (add_theme_to_icons),
	(dialog_destroy), (add_new_theme_button_callback):
	implement the "add new theme" command by invoking a file dialog;
	this still isn't finished yet.
	
2000-09-04  Ramiro Estrugo  <ramiro@eazel.com>

	Work on task 1588.

	* configure.in:
	* data/Makefile.am:
	* data/fonts/.cvsignore:
	* data/fonts/Makefile.am:
	* data/fonts/urw/.cvsignore:
	* data/fonts/urw/Makefile.am:
	* data/fonts/urw/README:
	* data/fonts/urw/fonts.dir:
	Add a fallback font in case no Type1 fonts are found in the
	system.  This font was plucked from the ghostscript-fonts-5.10a
	package. See data/fonts/urw/README for more info.
	
2000-09-04  Andy Hertzfeld  <andy@eazel.com>

	* icons/Makefile.am:
	* icons/i-web-72.png:
	added a new icon for generic http documents, which is just a
	placeholder.
	* libnautilus-extensions/nautilus-icon-factory.c:
	(nautilus_icon_factory_get_icon_name_for_regular_file):
	made it use a distinct icon for generic documents if the protocol
	associated with the file is "http", so the sidebar can have a decent
	icon when displaying websites.  The current icon is just a placeholder.
	
2000-09-04  Ramiro Estrugo  <ramiro@eazel.com>

	Work on task 1733.

	* configure.in:
	Add macros for only xpcom and nspr libs (for components)
	Add check for mozilla M18 - evil in its purest form.
	
2000-09-04  Ramiro Estrugo  <ramiro@eazel.com>

	Work on task 1733.

	* components/mozilla/mozilla-components.cpp:
	Quiet down the debug noise.

	* components/mozilla/mozilla-events.cpp:
	* components/mozilla/mozilla-events.h:
	A new wrapper for grokking mozilla dom events.

	* components/mozilla/Makefile.am:
	Build the events code.
	
2000-09-04  Ramiro Estrugo  <ramiro@eazel.com>

	* libnautilus-extensions/nautilus-buffered-widget.c:
	(create_background_pixbuf_from_ancestor):
	Remove an assertion that is not needed.
	
2000-09-04  Ramiro Estrugo  <ramiro@eazel.com>

	Work on task 1588.
	
	* libnautilus-extensions/nautilus-scalable-font.c:
	(nautilus_scalable_font_measure_text),
	(nautilus_scalable_font_draw_text),
	(nautilus_scalable_font_measure_text_lines),
	(nautilus_scalable_font_draw_text_lines),
	(nautilus_scalable_font_measure_text_lines),
	(nautilus_scalable_font_draw_text_lines),
	(nautilus_scalable_font_largest_fitting_font_size):
	* libnautilus-extensions/nautilus-scalable-font.h:
	Change api to accept a string with embedded new lines instead of
	an array of strings.  This simplifies many things.
	
	* libnautilus-extensions/nautilus-label.c:
	(nautilus_label_initialize), (nautilus_label_destroy),
	(render_buffer_pixbuf), (label_recompute_line_geometries):
	Update for NautilusScalalbleFont api changes.  No longer need to
	tokenize the text string.  we can feed the string to the rendering
	api as is.
	
	* librsvg/rsvg-ft.c: (rsvg_ft_render_string):
	* librsvg/rsvg-ft.h:
	Change the string to glyph rendering api to accept the string
	length rather than computing it.  This makes it possible to feed
	it arbitrary lengths.
	
	* librsvg/rsvg.c: (rsvg_text_handler_characters):
	* librsvg/test-ft-gtk.c: (draw_line):
	* librsvg/test-ft.c: (main):
	Update for api changes.
	
	* src/nautilus-about.c: (draw_aa_string):
	* src/nautilus-sidebar-tabs.c: (draw_one_tab_plain),
	(draw_one_tab_themed), (get_tab_width):
	* test/test-nautilus-font.c: (main):
	Update test to use text lines drawing api.
	
	* test/test-nautilus-label.c:
	(alpha_background_color_value_changed_callback), (main):
	Update test for 2 new lines in a row.

2000-09-04  Ramiro Estrugo  <ramiro@eazel.com>

	* libnautilus-extensions/nautilus-string-list.c:
	(nautilus_self_check_string_list):
	Make the tokens test a little better.

2000-09-04  Maciej Stachowiak  <mjs@eazel.com>

	* configure.in: Set shared library tree view as default,
	completing task 1647.

2000-09-04  Maciej Stachowiak  <mjs@eazel.com>

	* components/tree/nautilus-tree-model.c:
	(nautilus_tree_model_initialize), (nautilus_tree_model_destroy),
	(nautilus_tree_model_for_each_postorder),
	(nautilus_tree_model_monitor_remove),
	(nautilus_tree_model_get_node), (report_node_added),
	(report_node_changed), (report_node_removed_internal),
	(nautilus_tree_model_directory_files_changed_callback):
	* components/tree/nautilus-tree-node-private.h:
	* components/tree/nautilus-tree-node.c:
	(nautilus_tree_node_destroy), (nautilus_tree_node_new),
	(nautilus_tree_node_get_uri):
	* components/tree/nautilus-tree-node.h:
	* components/tree/nautilus-tree-view.c:
	(nautilus_tree_view_insert_model_node):

	Architecture changes to properly handle the case where a
	NautilusFile object changes name or location. In brief, the tree
	model keeps a hash keyed on NautilusFiles instead of on uris, and
	tries to remember the URI of a node to detect when the URI
	changes. When the URI changes, it gives a remove notification
	followed by an add notification.
	
2000-09-03  Andy Hertzfeld  <andy@eazel.com>

	made the arlo sidebar tabs use the official anti-aliased text machinery,
	instead of the scaling hack it was using.  Also, made the non-themed
	tabs use anti-aliased text.
	
	* src/nautilus-sidebar-tabs.c:
	(nautilus_sidebar_tabs_load_theme_data),
	(nautilus_sidebar_tabs_destroy), (make_colored_pixbuf),
	(draw_one_tab_plain), (draw_one_tab_themed), (get_tab_width):
	use NautilusScalableFont to render and measure the labels, for both
	types of tabs
	
Sun Sep 03 19:09:49 2000  George Lebl <jirka@5z.com>

	* src/nautilus-first-time-druid.c (nautilus_first_time_druid_show):
	  mark druid_welcome.png for translation (it contains english text)
	  and put in a comment explaining why which should appear in the
	  .po file.

2000-09-03  Maciej Stachowiak  <mjs@eazel.com>

	* components/tree/nautilus-tree-model.c
	(nautilus_tree_model_for_each_postorder): Some optional debugging
	statements.
	(nautilus_tree_model_monitor_remove): Also unmonitor any nodes
	that might be monitored by this client.

	* components/tree/nautilus-tree-view.c
	(nautilus_tree_view_destroy): Stop monitoring the model

2000-09-03  Ali Abdin  <aliabdin@aucegypt.edu>

        I now consider navigation links to be 'done' (Fixes bug #2201)

        * components/help/converters/gnome-db2html2/gdb3html.c:
        (parse_file): Renamed a variable. Updated the call to sect_footer.
        Cleaned up in a couple misc. spots
        (sect_footer): Renamed the variables to be more descriptive. Modified
        calls to print_footer (function changed + we now pass the full URI).
        Fixed memory leaks by actually freeing the variables.
        (print_footer): Change the function arguments to make it a 'sane'
        function. Also - just print what we recieve.

        * components/help/converters/gnome-db2html2/toc-elements.c:
        (toc_title_start_element),
        (toc_title_end_element):
        Disable the links to sect2/sect3/sect4/sect5 tags as they already get
        'included' with the sect1 tags.

        Ideally we should create anchor tags in the sect1 'pages' and use that
        instead, but this will not work due to mozilla issues

2000-09-03  Maciej Stachowiak  <mjs@eazel.com>

	* components/services/install/lib/eazel-install-protocols.c:
	(eazel_install_fetch_package):
	* components/services/login/nautilus-view/nautilus-login-view.c:
	(nautilus_login_view_initialize):
	* components/services/summary/nautilus-view/nautilus-summary-view.c
	: (authn_cb_succeeded), (authn_cb_failed), (login_button_cb),
	(nautilus_summary_view_initialize):
	* components/tree/libmain.c: (tree_shlib_object_destroyed):
	* components/tree/nautilus-tree-view.c:
	* libnautilus-extensions/nautilus-link.c: (make_local_path):
	* libnautilus-extensions/nautilus-search-bar-criterion.c:
	(make_emblem_value_menu):
	* src/file-manager/fm-directory-view.c:
	(add_open_with_gtk_menu_item):
	* src/nautilus-search-bar-criterion.c: (make_emblem_value_menu),
	(emblems_changed_callback):

	Added bug numbers for FIXMEs
	
2000-09-03  Pavel Cisler  <pavel@eazel.com>

	* libnautilus-extensions/nautilus-directory-notify.h:
	* libnautilus-extensions/nautilus-directory.c:
	(nautilus_directory_schedule_metadata_copy),
	(nautilus_directory_schedule_metadata_move):
	* libnautilus-extensions/nautilus-file-changes-queue.c:
	(nautilus_file_changes_queue_schedule_metadata_copy),
	(nautilus_file_changes_queue_schedule_metadata_move),
	(nautilus_file_changes_consume_changes):
	* libnautilus-extensions/nautilus-file-changes-queue.h:
	* libnautilus-extensions/nautilus-file-operations.c:
	(progress_dialog_set_files_remaining_text),
	(handle_xfer_vfs_error), (handle_xfer_duplicate),
	(sync_xfer_callback):
	Work on task bugzilla task 330.
	Add notification hooks for metadata copying to NautilusFileChangesQueue.
	Using the new top_level_item, call the hooks from the copy engine 
	synchronous callback. 

2000-09-03  Maciej Stachowiak  <mjs@eazel.com>

	* components/tree/nautilus-tree-view.c: (insert_hack_node,
	remove_hack_node, freeze_if_have_hack_node): Remove gratuitous
	debugging messages.

2000-09-03  Andy Hertzfeld  <andy@eazel.com>

	* components/rpmview/nautilus-rpm-verify-window.h:
	added "continue" signal
	* components/rpmview/nautilus-rpm-verify-window.c:
	(nautilus_rpm_verify_window_initialize_class),
	(continue_button_callback), (cancel_button_callback),
	(nautilus_rpm_verify_window_initialize),
	(nautilus_rpm_verify_window_set_error_mode):
	implemented verify error presentation, by adding a continue and cancel button,
	with a method to show them, and a signal to resume verification after errors
	
	* components/rpmview/nautilus-rpm-view.c:
	(nautilus_rpm_view_verify_files),
	(nautilus_rpm_view_verify_package_callback),
	(rpm_view_continue_verify):
	connect to the "continue" signal and resume verification; remember where we
	left off in an instance variable.  We still need more descriptive messages.
	
2000-09-02  Andy Hertzfeld  <andy@eazel.com>

	* components/rpmview/Makefile.am:
	* components/rpmview/nautilus-rpm-verify-window.c,h:
	(nautilus_rpm_verify_window_initialize_class),
	(nautilus_rpm_verify_window_destroy),
	(nautilus_rpm_verify_window_initialize),
	(nautilus_rpm_verify_window_new),
	(nautilus_rpm_verify_window_set_message):
	added verify window class to give feedback during the verify operation
	* components/rpmview/nautilus-rpm-view.c:
	(nautilus_rpm_view_destroy), (nautilus_rpm_view_update_from_uri),
	(nautilus_rpm_view_verify_package_callback):
	made the verify command work, but it's still needs to handle verification errors
	made the file list work correctly with rpmlib version >= 3.0
	
	* src/nautilus-about.c: (nautilus_about_draw_info):
	at Arlo's request, made the comment text in the about window have a white shadow
	
2000-09-02  Eskil Heyn Olsen  <eskil@eazel.com>

	* components/hardware/nautilus-hardware-view.c:
	(get_RAM_description), (get_IDE_description),
	(setup_overview_form), (setup_IDE_form),
	(nautilus_hardware_view_load_uri):
	Added Shane Butlers <sbutle@deakin.edu.au> patch for showing IDE
	devices in the hardware overview. Also fixed the size display
	problem (unsigned long overflow).
	
Sat Sep 02 02:56:48 2000  George Lebl <jirka@5z.com>

	* libnautilus-extensions/nautilus-icon-canvas-item.c (map_pixbuf),
	  libnautilus-extensions/nautilus-theme.c (load_theme_document):
	  Deal with the fact that nautilus_pixmap_file can return a NULL
	  if the file doesn't exist.

	* src/nautilus-first-time-druid.c (create_named_pixbuf),
	  (make_hbox_user_level_radio_button):
	  Deal with nautilus_pixmnap_file_returning NULL.  Also do
	  not assert out when no icon can be loaded.  Things need to
	  work/fail gracefully if icons are not installer properly instead of
	  just asserting.
	  (set_page_sidebar) (nautilus_first_time_druid_show):
	  Use the create_named_pixbuf function for loading the pixbufs

	* src/nautilus-shell.c (display_caveat):  Again deal with
	  non-existant image.  If it doesn't exist don't even create the
	  frame for the image.

2000-09-01  Eskil Heyn Olsen  <eskil@eazel.com>

	* components/services/install/lib/eazel-install-types.h:
	* components/services/install/lib/eazel-install-rpm-glue.h:
	* components/services/install/lib/eazel-install-types.c:
	(categorydata_destroy_foreach), (packagedata_new),
	(packagedata_destroy), (packagedata_remove_soft_dep):
	The packagedata_destroy_foreach has been removed,
	packagedata_destroy now takes a boolean that controls the deep
	destroy.
	
	* components/rpmview/nautilus-rpm-view.c:
	(nautilus_rpm_view_destroy), (nautilus_rpm_view_update_from_uri):
	* components/services/install/command-line/eazel-alt-install-corba.
	c: (main):
	Use the categorydata_new call
	
	* components/services/install/lib/eazel-install-corba-callback.c:
	(impl_dep_check), (impl_install_progress),
	(impl_uninstall_progress):
	Fixed to use the changed packagedata_destroy
	
	* components/services/install/lib/eazel-install-corba.c:
	(impl_Eazel_Install_simple_query):
	Call the correct query call
	
	* components/services/install/lib/eazel-install-private.h:
	Added a glist to hold downloaded packages
	
	* components/services/install/lib/eazel-install-object.c:
	(eazel_install_initialize), (eazel_install_install_packages),
	(eazel_install_uninstall_packages),
	(eazel_install_revert_transaction_from_xmlstring),
	(eazel_install_query_package_system),
	(eazel_install_emit_install_progress_default):
	Modified the deletion, so it now deletes all downloaded files (and
	only downloaded files). Also this file is now responsible for
	calling prepare_package_system.
	
	* components/services/install/lib/eazel-install-protocols.c:
	(eazel_install_fetch_file):
	Added downloaded packages to the glist in eazel_install.
	
	* components/services/install/lib/eazel-install-query.c:
	(eazel_install_simple_rpm_query), (eazel_install_simple_query):
	Removed the prepare/free_package_system calls
	
	* components/services/install/lib/eazel-install-rpm-glue.c:
	(eazel_install_flatten_categories),
	(eazel_install_download_packages),
	(eazel_install_pre_install_packages),
	(eazel_install_do_install_packages), (uninstall_all_packages),
	(ei_get_packages_with_mod_flag), (ei_check_uninst_vs_downgrade),
	(revert_transaction), (eazel_install_do_transaction_fill_hash),
	(eazel_install_do_transaction_get_total_size),
	(eazel_install_start_transaction_make_argument_list),
	(eazel_install_do_transaction_save_report_helper),
	(eazel_install_display_arguments),
	(eazel_install_start_transaction),
	(eazel_install_prune_packages_helper),
	(eazel_install_prune_packages), (eazel_install_load_rpm_headers),
	(eazel_install_free_rpm_system),
	(eazel_install_prepare_rpm_system), (eazel_install_add_to_rpm_set),
	(eazel_install_add_to_extras_foreach),
	(eazel_install_check_existing_packages),
	(eazel_install_fetch_rpm_dependencies), (print_package_list),
	(eazel_install_ensure_deps), (eazel_uninstall_upward_traverse),
	(eazel_uninstall_downward_traverse),
	(eazel_uninstall_check_for_install), (eazel_uninstall_globber):
	changed all the iterations to use g_list_next.
	Changed the packagedata_destroy calls
	Fixed the reversion
	Modified the prepare package system scheme
	
	* components/services/install/nautilus-view/nautilus-service-instal
	l-view.c: (nautilus_install_parse_uri),
	(nautilus_service_install_view_update_from_uri):
	Changed the packagedata_destroy calls.
	Used categorydata_new instead of g_new
	
	* components/services/install/nautilus-view/nautilus-service-instal
	l.c: (nautilus_service_install_view_install_package_callback),
	(nautilus_service_install_view_uninstall_package_callback):
	Used categorydata_new instead of g_new

	* nautilus-installer/src/druid-sidebar.xpm:
	Nicer ui
	
	* nautilus-installer/src/installer.c: (check_system):
	Comment to the danish dialog box...

2000-09-01  J Shane Culpepper  <pepper@eazel.com>

	* components/services/summary/nautilus-view/nautilus-summary-view.c
	: (generate_summary_form), (maintenance_button_cb),
	(community_button_cb), (register_button_cb):

	Adding missing buttons to the summary view.

2000-09-01  Robey Pointer  <robey@eazel.com>

	* components/services/login/nautilus-view/Makefile.am:
	* components/services/login/nautilus-view/nautilus-login-view.c:
	(generate_login_form), (entry_changed_cb), (authn_succeeded),
	(authn_failed), (start_login), (login_button_cb),
	(nautilus_login_view_initialize), (nautilus_login_view_destroy):

	Fix the "login view" so that it's really the change-password
	view.  Another bug (2710) has been filed on cleaning this up and
	possibly renaming it.

2000-09-01  Darin Adler  <darin@eazel.com>

	* libnautilus-extensions/nautilus-directory-private.h:
	* libnautilus-extensions/nautilus-directory-async.c:
	(nautilus_directory_is_anyone_monitoring_file_list):
	Made this function public because it's needed to get the
	assert right.
	(start_or_stop_io): Use it by the new public name.
	* libnautilus-extensions/nautilus-vfs-directory.c:
	(vfs_is_not_empty): Use the new function to get the assert
	right, which fixes bug 2706 (crash at startup with
	bookmark for nonexistent trash file).
	
	* libnautilus-extensions/nautilus-trash-directory.c:
	(remove_trash_volume): Fix a NautilusDirectory leak.

	* libnautilus-extensions/nautilus-glib-extensions.c:
	(print_key_string), (free_hash_tables_at_exit):
	Print keys before complaining about hash table so you
	see them first if you have things set to drop into
	the debugger on warnings.

2000-09-01  John Sullivan  <sullivan@eazel.com>

	Changed all nautilus dialog calls to take a window title
	(or NULL to get "Nautilus: Error" and the like). Updated 
	all callers to pass a window title.

	* libnautilus-extensions/nautilus-stock-dialogs.h,
	* libnautilus-extensions/nautilus-stock-dialogs.c:
	(show_message_box), (show_ok_box), (nautilus_info_dialog),
	(nautilus_warning_dialog), (nautilus_error_dialog),
	(nautilus_error_dialog_with_details), (nautilus_yes_no_dialog):
	Updated all public & private dialog-creating calls to take
	a dialog_title parameter.

	* components/rpmview/nautilus-rpm-view-install.c:
	(nautilus_rpm_view_install_done):
	* libnautilus-extensions/nautilus-file-operations.c:
	(confirm_empty_trash):
	* libnautilus-extensions/nautilus-program-chooser.c:
	(nautilus_program_chooser_show_no_choices_message):
	* libnautilus-extensions/nautilus-program-choosing.c:
	(nautilus_launch_application_parented):
	* src/file-manager/fm-error-reporting.c:
	(fm_report_error_renaming_file), (fm_report_error_setting_group),
	(fm_report_error_setting_owner),
	(fm_report_error_setting_permissions):
	* src/nautilus-application.c:
	(nautilus_application_check_user_directories),
	(nautilus_application_startup):
	* src/nautilus-first-time-druid.c:
	(nautilus_first_time_druid_show):
	* src/nautilus-property-browser.c: (emblem_image_file_changed),
	(add_background_to_browser):
	* src/nautilus-sidebar.c: (receive_dropped_uri_list):
	* src/nautilus-window-manage-views.c: (handle_unreadable_location),
	(report_content_view_failure_to_user),
	(report_sidebar_panel_failure_to_user),
	(nautilus_window_end_location_change_callback):
	* src/nautilus-window-menus.c: (forget_history_if_confirmed),
	(show_bogus_bookmark_window): Made up dialog titles for all
	title-less dialogs. A few were already setting titles after
	the fact, so I removed the now-extraneous set_title calls.

2000-09-01  J Shane Culpepper  <pepper@eazel.com>

	* components/services/nautilus-dependent-shared/shared-service-widg
	ets.c: (create_summary_service_title_top_widget),
	(create_summary_service_title_bottom_widget),
	(create_services_header_widget),
	(create_summary_service_large_grey_header_widget),
	(create_summary_service_small_grey_header_widget):
	* components/services/nautilus-dependent-shared/shared-service-widg
	ets.h:
	* components/services/summary/nautilus-view/nautilus-summary-view.c
	: (generate_summary_form):

	Finishing Bug #2631.  Arlo titles to all sections of the summary view.

2000-09-01  Michael Engber  <engber@eazel.com>
	
	Removed our quitting logic from nautilus-application
	(where it was tied to nautilus-window closing) and added
	a more general mechanism in main.c - by which you can
	register any gtk object to keep the main event loop
	alive while the object is around. This, in turn, fixed 
	a problem with the first-time-druid not causing nautilus
	to quit when it was cancel via the close box (bug 2211)
	and also a problem with nautilus quitting before you had
	a chance to see an error dialog (bug 1871). Also, added
	nautilus_main_event_loop_quit as the preferred way to
	cause nautilus to quit (as opposed to gtk_main_quit)

	* src/nautilus-application.c: (nautilus_application_startup),
	(nautilus_application_close_desktop),
	(nautilus_application_destroyed_window):
	* src/nautilus-application.h:
	* src/nautilus-first-time-druid.c: (druid_finished),
	(nautilus_first_time_druid_show):
	* src/nautilus-main.c: (nautilus_main_is_event_loop_needed),
	(nautilus_main_event_loop_unregister),
	(nautilus_main_event_loop_register),
	(nautilus_main_is_event_loop_mainstay),
	(nautilus_main_event_loop_quit), (main):
	* src/nautilus-main.h:
	* src/nautilus-shell.c: (corba_quit), (corba_restart):
	* src/nautilus-window-manage-views.c:
	(nautilus_window_end_location_change_callback):
	* src/nautilus-window.c: (nautilus_window_initialize):

2000-09-01  J Shane Culpepper  <pepper@eazel.com>

	* components/services/nautilus-dependent-shared/icons/Makefile.am:
	* components/services/nautilus-dependent-shared/shared-service-widg
	ets.c: (create_summary_service_title_top_widget),
	(create_summary_service_title_bottom_widget):
	* components/services/nautilus-dependent-shared/shared-service-widg
	ets.h:
	* components/services/summary/nautilus-view/nautilus-summary-view.c
	: (generate_summary_form):

	First part of the arlo titles for the summary view.

2000-09-01  Darin Adler  <darin@eazel.com>

	* libnautilus-extensions/nautilus-glib-extensions.c:
	(print_key_string), (free_hash_tables_at_exit),
	(nautilus_g_hash_table_new_free_at_exit): Added code to print out
	the keys for the hash table at exit time if it's a hash table with
	string keys. I can tell the keys are strings because the hash
	function is g_str_hash.
	
	* src/file-manager/nautilus-trash-monitor.c:
	(nautilus_trash_monitor_initialize): Used connect_while_alive
	instead of connect to get rid of some nasty problems with
	lingering signal handlers.

2000-09-01  Maciej Stachowiak  <mjs@eazel.com>

	* components/tree/libmain.c (tree_shlib_object_destroyed): Don't
	call oaf_plugin_unuse for now, it kills stuff.

	* components/tree/nautilus-tree-model.c:
	(nautilus_tree_model_destroy,
	nautilus_tree_model_for_each_postorder): Bug fixes to avoid crashing.
	
	* components/tree/nautilus-tree-view.c: (insert_hack_node,
	remove_hack_node, freeze_if_have_hack_node): Assorted fixes to
	avoid crashing or locking up when in-process.

	* configure.in: Fix configure text for in-proc tree view.

2000-09-01  John Sullivan  <sullivan@eazel.com>

	Fixed bug 1476 (Using bogus local bookmark should update
	its icon). The specific bug led me to changing some of
	the internals of NautilusBookmark in a way that has nice
	UI consequences. Now if you use Nautilus to move a bookmarked
	file, the bookmark will continue to find the moved file, and
	if you delete a file, the bookmark's icon will change to the
	"missing location" icon.

	* libnautilus-extensions/nautilus-bookmark.c:
	(nautilus_bookmark_disconnect_file),
	(nautilus_bookmark_connect_file): New helper functions that
	handle wiring or unwiring the connection between a bookmark
	and its NautilusFile.
	(nautilus_bookmark_destroy): Use nautilus_bookmark_disconnect_file.
	(nautilus_bookmark_new_with_icon): Use nautilus_bookmark_connect_file.
	(bookmark_file_changed_callback): Notice changes in the file's URI
	and update the bookmark to use the new URI; notice when the file
	is gone and disconnect/reconnect to file.

	Miscellaneous tweaks:
	
	* src/file-manager/fm-search-list-view.c:
	(compute_reveal_item_name_and_sensitivity): At the suggestion of
	a localizer (menthos), added explanatory comments before the use
	of "Reveal in New Window" and "Reveal in <n> New Windows". It turns
	out that a comment just before a translatable text string will
	appear in the .pot files that localizers use.
	* src/nautilus-first-time-druid.c: (set_up_user_level_page):
	Fixed two misspellings of "technical" and one missing period. Thanks
	to menthos for pointing these out.
	* src/nautilus-window-menus.c: 
	(show_bogus_bookmark_window): Use nautilus_format_uri_for_display
	for bookmark uris shown in user messages. Simplify the message you
	get if you choose a known-bogus URI from the Go menu.

2000-09-01  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 2491, remove GtkHtml web browser from build.
	
	* components/Makefile.am:
	Removed the http component
	
2000-09-01  Ali Abdin  <aliabdin@aucegypt.edu>

        * components/help/converters/gnome-db2html2/sect-elements.c:
        Ooops - Make the QUOTE tag actually print the characters out

2000-09-01  Maciej Stachowiak  <mjs@eazel.com>

	* components/tree/nautilus-tree-model.c:
	(nautilus_tree_model_destroy, nautilus_tree_model_unref_callback,
	nautilus_tree_model_for_each_postorder, remove_all_nodes,
	report_node_removed_internal, report_node_removed): Clean up all
	the nodes when destroying the model.
	
	* components/tree/nautilus-tree-view.c: Unref the model when
	destroying the view.

	* components/tree/nautilus-tree-node-private.h,
	components/tree/nautilus-tree-node.c:
	(nautilus_tree_node_remove_from_parent): Renamed from
	`nautilus_tree_remove_from_parent'

2000-09-01  Pavel Cisler  <pavel@eazel.com>

	Fix bugzilla 2186 - Move/Copy/Make-Link for times from multiple directories
	fails. Still needs more testing.
	Reworked file operations to match new gnome_vfs_xfer... APIs that now take
	lists of URIs for copy source and destination.

	* components/services/install/lib/eazel-install-protocols.c:
	(gnome_vfs_fetch_remote_file):
	Update to use new API. 
	
	* libnautilus-extensions/nautilus-file-operations.c:
	(check_target_directory_is_or_in_trash),
	(new_uri_from_escaped_string), (append_basename_unescaped),
	(nautilus_file_operations_copy_move),
	(nautilus_file_operations_new_folder),
	(nautilus_file_operations_move_to_trash),
	(nautilus_file_operations_delete), (do_empty_trash):
	Reworked to use new APIs.
	Eliminated FIXME 1107.
	Updated find_directory calls to use proper "create if needed" flags.
	
	* libnautilus-extensions/nautilus-file-utilities.c:
	(nautilus_get_user_main_directory):
	* libnautilus-extensions/nautilus-file.c: (nautilus_file_rename):
	Updated to use new APIs.

2000-09-01  Eskil Heyn Olsen  <eskil@eazel.com>

	* components/rpmview/nautilus-rpm-view-install.c:
	(nautilus_rpm_view_download_progress_signal),
	(nautilus_rpm_view_install_progress_signal),
	(nautilus_rpm_view_download_failed), 
	Emits load_underway signals, although they do not seem to start
	the spinner.
	(get_detailed_errors_foreach),
	(get_detailed_errors), 
	(nautilus_rpm_view_install_failed),
	Generates contents for the dialog box showed when the operation
	failed.
	(nautilus_rpm_view_dependency_check),
	(nautilus_rpm_view_install_done), 
	If failed, show a box to the user
	(nautilus_service_need_password),
	(nautilus_service_try_again), 
	(set_root_client), 
	Added Robeys password dialog stuff
	(delete_files),
	emits a FALSE when asked to delete files.	
	(nautilus_rpm_view_install_package_callback),
	(nautilus_rpm_view_uninstall_package_callback):
	Still defaults to testmachine.eazel.com (bad, but landa.eazel.com
	seems to be down). Sets up the password query thing.
	
	* components/rpmview/nautilus-rpm-view.c:
	(nautilus_rpm_view_initialize), 
	(nautilus_rpm_view_destroy),
	(check_installed):
	Fixed the nautilus_label problem by ifdeffing it to use gtk_label
	for the strings that will most likely contain \n\n
	
	* components/rpmview/nautilus-rpm-view.h:
	Added some calls to get div fields from details.
	
	* components/services/install/command-line/eazel-alt-install-corba.
	c: (set_parameters_from_command_line):
	Fixed the --root handling of dirs.
	
	* components/services/install/lib/eazel-install-protocols.c:
	Now set to use the old CGI stuff while landa doesn't serve me my
	rpm's..
	
	* components/services/install/lib/eazel-install-rpm-glue.c:
	(eazel_install_prune_packages_helper),
	Added some debug output
	(eazel_install_package_name_compare):
	Removed some debug output
	
	* components/services/install/lib/eazel-install-types.c:
	(packagedata_destroy_foreach), (packagedata_destroy),
	free the pack structure itself
	(packagedata_remove_soft_dep):
	paranoia check
	
	* components/services/trilobite/libtrilobite/trilobite-root-client-
	public.h:
	Changed the include to use "'s instead of <'s. 
	
	* nautilus-installer/src/Makefile:
	* nautilus-installer/src/installer.c: (create_pixmap),
	(create_what_to_do_page), (create_install_page),
	(create_finish_page_good), (create_finish_page_evil),
	(create_window), (create_info_druid_page):
	Better image loading for the static installer.

2000-09-01  J Shane Culpepper  <pepper@eazel.com>

	* components/services/nautilus-dependent-shared/icons/Makefile.am:
	Forgot to update the Makefile.am for the new icons.

2000-09-01  J Shane Culpepper  <pepper@eazel.com>

	* components/services/summary/nautilus-view/nautilus-summary-view.c
	: (generate_summary_form):

	Minor ui fixes to prepare adding the arlo title widgets.  Adding
	several images as well.

2000-09-01  Andy Hertzfeld  <andy@eazel.com>

	* components/rpmview/nautilus-rpm-view.c:
	(nautilus_rpm_view_initialize), (check_installed),
	(nautilus_rpm_view_update_from_uri):
	removed anti-aliased text from rpm_view, since it was causing
	too many problems; displayed icon contained in package header, or
	a generic package icon if there isn't one; gather and display
	package install time correctly.
	
2000-08-31  Maciej Stachowiak  <mjs@eazel.com>

	* ChangeLog: rolled over to ChangeLog-20000831.

