2001-02-12  Mike Fleming  <mfleming@eazel.com>

	reviewed by: <ramiro@eazel.com>

	* components/mozilla/nautilus-mozilla-content-view.c:
	(view_load_location_callback), (mozilla_net_stop_callback),
	(mozilla_link_message_callback), (mozilla_progress_callback),
	(mozilla_dom_mouse_click_callback), (vfs_read_callback),
	(update_nautilus_uri), (dispatch_report_location_change),
	(dispatch_report_load_complete):

	Bug 6436: Throbber wasn't thobbing on mozilla-to-mozilla navigation.

	Confirmed with Darin: call report_load_underway and report_load_complete
	in case where report_location_changed is used.

2001-02-12  John Harper  <jsh@eazel.com>

	* src/nautilus-application.c (set_session_restart): set the
	restart command to be `nautilus --no-default-window'

2001-02-12  Ian McKellar  <ian@eazel.com>

	* configure.in:
	Updated the check to check for RPM 3.0.5 not 3.0.4.

2001-02-12  Gene Z. Ragan  <gzr@eazel.com>

	Turn off repawn behavior in debug mode at request of Andy.
	
	* src/nautilus-application.c: (set_session_restart):
	Check for debug environment variable.
	
2001-02-12  Robin * Slomkowski  <rslomkow@eazel.com>

	* nautilus.spec.in: merged changes from branch into
	head BUG 6067

2001-02-11  Michael K. Fleming  <mfleming@eazel.com>

	reviewed by: <sullivan@eazel.com>

	Bug 5961: Starting nautilus with path to local HTML file
	causes images not to load.

	The problem here was that any argument specified on the commandline
	was being passed directly into Nautilus and its components as a
	valid URI.  Added pre-processing to commandline arguments, including
	ability to handle relative file pathnames. (so you can do "nautilus ."
	to open a window on the current directory)

	* libnautilus-extensions/nautilus-file-utilities.c:
	(file_uri_from_local_relative_path),
	(nautilus_make_uri_from_shell_arg), (is_uri_partial),
	(remove_internal_relative_components),
	(nautilus_uri_make_full_from_relative),
	(nautilus_self_check_file_utilities):
	* libnautilus-extensions/nautilus-file-utilities.h:
	* src/nautilus-application.c:
	(nautilus_make_uri_list_from_shell_strv),
	(nautilus_application_startup):


2001-02-12  Rebecca Schulman  <rebecka@eazel.com>
	Fix bugzilla.eazel.com bug 4962 that open with
	mpg123 fails.  The problem was a check for 
	a file uri that had its logic backwards

	reviewed by: Mike Engber <engber@eazel.com>

	* libnautilus-extensions/nautilus-program-choosing.c:
	(nautilus_launch_application):
	Change if (file_uri) to if (!file_uri)

2001-02-12  Michael Engber  <engber@eazel.com>

	reviewed by: John Sullivan

	* libnautilus-extensions/nautilus-directory-async.c:
	(metafile_read_mark_done), (metafile_read_done_callback):
	* libnautilus-extensions/nautilus-directory-metafile.c:
	(free_factory), (get_metafile),
	(nautilus_directory_get_file_metadata),
	(nautilus_directory_get_file_metadata_list),
	(nautilus_directory_set_file_metadata),
	(nautilus_directory_set_file_metadata_list),
	(nautilus_directory_copy_file_metadata),
	(nautilus_directory_remove_file_metadata),
	(nautilus_directory_rename_file_metadata):
	* libnautilus-extensions/nautilus-directory-metafile.h:
	* libnautilus-extensions/nautilus-directory.c:
	(nautilus_directory_destroy):
	* libnautilus-extensions/nautilus-metafile-factory.c:
	(free_factory_instance):
	* libnautilus-extensions/nautilus-metafile-factory.h:
	* libnautilus-extensions/nautilus-metafile-server.idl:
	* libnautilus-extensions/nautilus-metafile.c: (destroy),
	(corba_get), (corba_get_list), (corba_set), (corba_set_list),
	(corba_copy), (corba_remove), (corba_rename),
	(get_or_add_directory_monitor_list_entry),
	(remove_directory_monitor_list_entry), (find_monitor_link),
	(corba_register_monitor), (corba_unregister_monitor),
	(get_metadata_from_node), (get_metadata_list_from_node),
	(create_metafile_root), (get_file_node),
	(get_metadata_string_from_metafile),
	(get_metadata_list_from_metafile),
	(set_metadata_string_in_metafile), (set_metadata_list_in_metafile),
	(metadata_value_new), (metadata_value_new_list),
	(metadata_value_destroy), (metadata_value_equal),
	(set_metadata_in_metafile), (get_metadata_string_from_table),
	(get_metadata_list_from_table), (str_or_null_hash),
	(str_or_null_equal), (set_metadata_eat_value),
	(free_file_table_entry), (free_directory_table_entry),
	(destroy_metadata_changes_hash_table), (destroy_xml_string_key),
	(nautilus_metafile_destroy), (get_file_metadata),
	(get_file_metadata_list), (set_file_metadata),
	(set_file_metadata_list), (rename_file_metadata),
	(apply_one_change), (apply_file_changes), (apply_one_file_changes),
	(nautilus_metafile_apply_pending_changes), (copy_file_metadata),
	(remove_file_metadata), (nautilus_metafile_set_metafile_contents):
	* libnautilus-extensions/nautilus-metafile.h:
	* src/nautilus-application.h:

	Metadata setting/getting is now done via CORBA so that
	out of process components stay in sync. bug 5958

2001-02-12  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: John Sullivan <sullivan@eazel.com>

	* src/nautilus-property-browser.c:
	(make_properties_from_directories):
	Dont free the object name so soon.  Its needed to determine where
	to put the reset and erase objects.
	
2001-02-12  Rebecca Schulman  <rebecka@eazel.com>
	Fix bug 6333, that a warning about not finding
	unindexed files should not be displayed if the
	backup search is turned on.

	reviewed by: John Sullivan <sullivan@eazel.com>

	* libnautilus-extensions/nautilus-global-preferences.h:
	Leave a note that we should change the SEARCH_METHOD
	name to be more clear about what the preference is for
	(whether or not we  do a slow background search)
	* src/file-manager/fm-search-list-view.c: (load_location_callback):
	Check the SEARCH_METHOD preference 

	
2001-02-12  John Sullivan  <sullivan@eazel.com>

	reviewed by: Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 6500 (tighter layout option not saved).

	It actually was being saved, it was just being clobbered back to
	off every time a directory was loaded.

	* src/file-manager/fm-icon-view.c: (fm_icon_view_begin_loading):
	Moved the tighter-layout setting code up one line and refined
	comments to explain why.

2001-02-12  Robey Pointer  <robey@eazel.com>

	* components/services/install/lib/eazel-install-logic2.c:
	(do_dep_check_internal), (install_packages_helper):

	Make the dep-check logic bail out early if the user has cancelled
	the install.  (It's possible to get the async "stop" callback
	during a package info fetch, I found out the hard way...)
	
	* components/services/install/lib/eazel-install-protocols.c:
	(http_fetch_remote_file):

	Make get_failed into an official bool, since it acts like one
	already.
	
	* components/services/install/nautilus-view/nautilus-service-instal
	l-view.c: (nautilus_service_install_dependency_check),
	(nautilus_service_need_password),
	(service_install_stop_loading_callback):

	Treat aborted password dialog as a cancel, not a failure.  Fix
	abort callback so it doesn't loop endlessly in a GTK event
	handling cycle on fast downloads.

2001-02-11  Ramiro Estrugo  <ramiro@eazel.com>

	* test/.cvsignore:
	* test/Makefile.am:
	* test/test-nautilus-wrap-table.c: (main):
	New NautilusWrapTable test.
	
2001-02-11  Ramiro Estrugo  <ramiro@eazel.com>

	* test/test-nautilus-clickable-image.c: (main):
	* test/test-nautilus-labeled-image.c: (button_callback),
	(labeled_image_button_window_new):
	A tiny bit more debug code.
	
2001-02-11  Ramiro Estrugo  <ramiro@eazel.com>

	* applets/preferences-applet/nautilus-preferences-applet.c:
	(user_level_changed_callback), (main):
	Make toggle buttons insensitive on novice user level.

2001-02-11  Ramiro Estrugo  <ramiro@eazel.com>

	* libnautilus-extensions/nautilus-viewport.h:
	* libnautilus-extensions/nautilus-viewport.c:
	(nautilus_viewport_draw), (nautilus_viewport_expose_event),
	(nautilus_viewport_realize), (nautilus_viewport_set_is_smooth),
	(nautilus_viewport_get_is_smooth): Add public is_smooth getter.
	(nautilus_viewport_set_never_smooth): Add a 'never_smooth'
	attribute.

2001-02-11  Ramiro Estrugo  <ramiro@eazel.com>

	* libnautilus-extensions/nautilus-customization-data.h:
	Add comment clarifying API changes I made in my last checkin.
	* src/file-manager/fm-properties-window.c: (create_emblems_page):
	Remove some left over code from when the emblems table was hard
	coded to 2 columns.
	* src/nautilus-property-browser.c:
	(make_properties_from_directories):
	Fix a small memory leak.

2001-02-11 John Fleck <jfleck@inkstain.net>

	reviewed by: Ali Abdin <aliabdin@aucegypt.edu>

	* components/help/converters/gnome-db2html2/gdb3html.h
	* /components/help/converters/gnome-db2html2/sect-elements.c
	* /components/help/converters/gnome-db2html2/sect-elements.h
	* /components/help/converters/gnome-db2html2/sect-preparse.c
	* /components/help/converters/gnome-db2html2/toc-elements.c
	add support for <bridgehead> tag in DocBook, fix bug #6492

2001-02-11  Rebecca Schulman  <rebecka@eazel.com>

	reviewed by: Mathieu Lacage <mathieu@gnome.org>

	* cut-n-paste-code/widgets/nautilusclist/nautilusclist.c: Use
	binary instead of linear search to find the right insert new row
	into a sorted clist. This is part of addressing bug 6290

2001-02-10  Andy Hertzfeld  <andy@eazel.com>

	* src/nautilus-sidebar.c: (add_command_buttons),
	(empty_trash_callback),
	(nautilus_sidebar_trash_state_changed_callback),
	(nautilus_sidebar_update_buttons):
	fixed bug 6052, sidebar needs empty trash button when showing
	trash: directory
	
2001-02-09  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Maciej Stachowiak <mjs@eazel.com>

	* libnautilus-extensions/nautilus-image-table.c:
	(image_table_handle_motion), (ancestor_button_press_event),
	(ancestor_button_release_event):
	Ignore insensitive widgets when doing the event thing.
	
	* src/nautilus-property-browser.c:
	(make_properties_from_directories):
	Add an extra empty space between the erase emblem and the next to
	make it stand out more.  Cleanup property image creation a tiny bit.

2001-02-09  Robey Pointer  <robey@eazel.com>

	* po/POTFILES.in:

	Fix build bustage by removing the two missing install-lib files
	from POTFILES.in.

2001-02-09  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Robey Pointer  <robey@eazel.com>

	* libnautilus-extensions/Makefile.am:
	* libnautilus-extensions/nautilus-region.c:
	* libnautilus-extensions/nautilus-region.h:
	New class for super easy region management using rectangle.

	* libnautilus-extensions/nautilus-art-gtk-extensions.h:
	* libnautilus-extensions/nautilus-art-gtk-extensions.c:
	(nautilus_gdk_rectangle_assign_irect):
	New function to convert ArtIRect to GdkRectangles.

	* libnautilus-extensions/nautilus-customization-data.h:
	* libnautilus-extensions/nautilus-customization-data.c:
	(nautilus_customization_data_get_next_element_for_display):
	Return pixbufs and labels for the object instead of widgets.  This
	is so that the caller can use the widget that best suits its
	display needs.

	* libnautilus-extensions/nautilus-image-table.h:
	* libnautilus-extensions/nautilus-image-table.c:
	(nautilus_image_table_initialize_class),
	(nautilus_image_table_initialize),
	(nautilus_image_table_expose_event),
	(nautilus_image_table_realize), (nautilus_image_table_unrealize),
	(nautilus_image_table_set_is_smooth_signal),
	(image_table_foreach_child_subtract_content),
	(image_table_clear_dirty_areas), (image_table_peek_clear_gc),
	(image_table_emit_signal), (image_table_handle_motion),
	(ancestor_button_press_event), (ancestor_button_release_event),
	(nautilus_image_table_new), (nautilus_image_table_set_is_smooth),
	(nautilus_image_table_set_smooth_background_color):
	Add support for smoothnes.  Register widget as a possible smooth
	widget.  When smoothness changes, we modify our background drawing
	behavior such that in smooth mode we dont flicker at all.

	Remove grab/ungrab pair that could screw up operations.  Turns out
	these are not needed.

	Change event signal emissions to include more data from the raw
	gdk events without exposing these.

	* libnautilus-extensions/nautilus-image.c:
	(nautilus_image_initialize_class):
	Update for new smooth widget class registration scheme.

	* libnautilus-extensions/nautilus-label.c:
	(nautilus_label_initialize_class):
	Update for new smooth widget class registration scheme.

	* libnautilus-extensions/nautilus-labeled-image.h:
	* libnautilus-extensions/nautilus-labeled-image.c:
	(nautilus_labeled_image_size_allocate),
	(nautilus_labeled_image_get_image_bounds),
	(nautilus_labeled_image_get_label_bounds):
	Make these two functions public.
	
	* libnautilus-extensions/nautilus-smooth-widget.h:
	* libnautilus-extensions/nautilus-smooth-widget.c:
	(smooth_widget_type_list_free), (smooth_widget_list_free),
	(widget_is_smooth), (nautilus_smooth_widget_register),
	(nautilus_smooth_widget_register_type):
	Add mechanism for registering types that are meant to be smooth.
	That way we dont need to hardcode the list of smooth widget
	classes.  Also made sure to free the static lists at exit time.
	
	* libnautilus-extensions/nautilus-viewport.h:
	* libnautilus-extensions/nautilus-viewport.c:
	(nautilus_viewport_initialize_class),
	(nautilus_viewport_initialize), (nautilus_viewport_destroy),
	(nautilus_viewport_draw), (nautilus_viewport_expose_event),
	(nautilus_viewport_realize), (nautilus_viewport_paint),
	(nautilus_viewport_set_is_smooth_signal), (nautilus_viewport_new),
	(nautilus_viewport_set_is_smooth),
	(nautilus_viewport_get_scroll_offset):
	Add support for smoothness.  When the is_smooth attribute changes,
	the viewport will not clear the background on resize - and so its
	content will not flicker.

	Add function for querying the scroll offset.
	
	* libnautilus-extensions/nautilus-wrap-table.h:
	* libnautilus-extensions/nautilus-wrap-table.c:
	(wrap_table_get_content_frame), (wrap_table_get_scroll_offset),
	(nautilus_wrap_table_get_homogeneous),
	(nautilus_wrap_table_reorder_child):
	Fix a mod by zero error.
	Add support for reordering children.
	
	* src/file-manager/fm-properties-window.c: (create_emblems_page):
	Simplify a bit by using NautilusWrapTable instead of a GtkTable
	with a hard coded number of columns.  The emblems now wrap to fit
	the available space.  Also use NautilusLabeledImages instead of
	boxes.  Update for changes in customization data api.
	Remove check box painting workaround.  Its taken care of in
	NautilusLabeledImage now.
	
	* src/nautilus-property-browser.c:
	(nautilus_property_browser_initialize_class),
	(nautilus_property_browser_initialize), (element_clicked_callback),
	(nautilus_property_browser_preferences_changed),
	(make_property_tile), (make_properties_from_directories),
	(add_reset_property), (make_properties_from_xml_node),
	(property_browser_category_button_new), (make_category_link),
	(nautilus_property_browser_update_contents),
	(emit_emblems_changed_signal):
	Use a NautilusImageTable instead of a GtkTable to make things wrap
	propertly and thus not have to recreate the whole property box
	each time its resized.  Remove a lot of hard coded dimensions.
	Simplified a bit by using NautilusLabeledImages.
	
	* src/nautilus-search-bar-criterion.c: (make_emblem_value_menu):
	Update for changes in customization data api.
	
	* test/test-nautilus-image-table.c: (labeled_image_new),
	(foo_timeout), (image_table_size_allocate),
	(image_table_new_scrolled):
	Update for new image table features.

2001-02-09  Andy Hertzfeld  <andy@eazel.com>

	* src/nautilus-sidebar.c:
	(nautilus_sidebar_active_panel_matches_id),
	(nautilus_sidebar_remove_panel):
	fixed bug 6005, help tab still left on sidebar after view is hidden,
	by decrementing the active tab index when an earlier one is deleted,
	and checking for NULL in active_panel_matches_id.

	* components/rpmview/nautilus-rpm-view.c:
	(nautilus_rpm_view_initialize),
	(nautilus_rpm_view_update_from_uri):
	made it us nautilus_image so the package image is anti-aliased

2001-02-09  John Sullivan  <sullivan@eazel.com>

	Fixed bug 5903 ("Tighter Layout" can't be changed in
	manual layout, but affects Clean Up by Name)

	* libnautilus-extensions/nautilus-icon-container.c:
	(nautilus_icon_container_set_tighter_layout): When in
	manual layout mode, invalidate label sizes and update
	all items so the smaller caption width used for
	tighter layout can take effect immediately.
	
	* src/file-manager/fm-icon-view.c: 
	(update_layout_menus): Remove the code that was making
	this item insensitive in manual layout.

2001-02-09  Robey Pointer  <robey@eazel.com>

	reviewed by: Eskil Heyn Olsen  <eskil@eazel.com>

	* components/services/install/idl/trilobite-eazel-install.idl:
	* components/services/install/lib/eazel-install-corba-callback.c:
	(eazel_install_callback_get_epv):
	* components/services/install/lib/eazel-install-corba-types.c:
	(corba_packagedatastruct_fill_from_packagedata),
	(packagedata_from_corba_packagedatastruct):

	Remove some cruft from the IDL that's not implemented anymore or
	isn't being used by any of the clients.
	
	* components/services/install/lib/eazel-install-metadata.c:
	(eazel_install_configure_use_local_db):
	* components/services/install/lib/eazel-install-metadata.h:
	* components/services/install/lib/eazel-install-object.c:
	(eazel_install_initialize):
	* components/services/trilobite/doc/gconf.txt:

	Make an opt-out for people who don't want the "can't get shared
	lock" spam message scrolling endlessly on every install just
	because RPM can't deal with NFS directories well.
	
	* components/services/install/lib/makefile.staticlib.in:

	Remove dead files from the bootstrap installer's makefile, and
	make the package-system object be a var to be filled in later.
	
	* components/services/install/nautilus-view/nautilus-service-instal
	l-view.c: (nautilus_service_install_conflict_check),
	(nautilus_service_install_downloading),
	(nautilus_service_install_view_update_from_uri_finish),
	(user_login_callback),
	(nautilus_service_install_view_update_from_uri),
	(nautilus_service_install_view_load_uri):

	General cleanup, and the addition of the conflict_check signal
	handler.

	* nautilus-installer/src/Makefile:
	* nautilus-installer/src/installer.c: (eazel_install_progress),
	(conflict_check), (eazel_install_preflight),
	(eazel_installer_initialize):

	Add conflict check handler; fix 50% bug prior to downloading.

2001-02-09  John Sullivan  <sullivan@eazel.com>

	Fixed problems I ran into while trying to fix bug 5903,
	which is about making "Tighter Layout" sensitive even
	in manual layout, since it affects "Clean Up by Name"

	* libnautilus-extensions/nautilus-icon-container.c:
	(nautilus_icon_container_set_tighter_layout): Don't
	re-sort when tighter layout setting changes if not
	in auto_layout mode.
	
	* src/file-manager/fm-icon-view.c: 
	(handle_radio_item): Don't assume that every id passed
	to this routine is a sort ID; it might be a toggle
	button's id. Use get_sort_criterion_by_id to distinguish.
	(update_layout_menus): Added FIXME comment explaining
	why "tighter layout" is insensitive in manual layout.
	(set_sort_criterion_by_id): Check whether passed id is
	a valid sort criterion; don't try to sort if not.

2001-02-09  Eskil Heyn Olsen  <eskil@eazel.com>

	reviewed by: Robey Pointer  <robey@eazel.com>

	Fix for 6190, reuse check_if_related. If a package being revived
	is related to the broken (related by name and version diff), don't
	ask softcat for an update, but ask for an exact version.
	
	* components/services/install/lib/eazel-install-rpm-glue.c:
	* components/services/install/lib/eazel-install-rpm-glue.h:
	* components/services/install/lib/eazel-install-logic.c:
	* components/services/install/lib/eazel-install-logic.h:
	* components/services/install/lib/Makefile.am:
	Removed rpm-glue and logic.
	
	* components/services/install/lib/eazel-install-logic2.c:
	(is_satisfied), (check_if_related_package), (check_tree_helper),
	(download_packages):
	is_satisfied checks name!=null before doing is_installed.
	check_tree_helper now uses check_if_related before doing the
	softcat_available_update. If the packages are related, use
	get_info to get an exacat version (sense=EQ).
	Moved check_if_related here
	Output tuning...
	* components/services/install/lib/eazel-install-object.c:
	(eazel_install_emit_download_progress):
	Woops, undid a comment about bug 6425
	
	* components/services/install/lib/eazel-softcat.c:
	(eazel_softcat_available_update):
	Indention...

2001-02-08  John Harper  <jsh@eazel.com>

	reviewed by: Maciej Stachowiak <mjs@eazel.com>

	Fix bug 4423 (when a folder that is expanded in the tree view
	is renamed, it collapses)

	* components/tree/nautilus-tree-model.h,
	components/tree/nautilus-tree-model.c: added a new signal
	`node_being_renamed'. Has two arguments, the old and new URIs

	(report_node_changed): when the node is being renamed, use
	report_node_removed_internal instead of report_node_removed so
	we can avoid emitting the `node_removed' signal. Before doing
	this, emit the new `node_being_renamed' signal

	* components/tree/nautilus-tree-view.c
	(nautilus_tree_view_insert_model_node): if the node is already
	inserted in the tree, call nautilus_tree_view_update_model_node

	(nautilus_tree_view_model_node_renamed_callback): connected to
	the `node_being_renamed' signal, propagates the expansion state
	from the old URI to the new one

	Fix bug 4421 (Delete file while folder collapsed -> not
	reflected in Tree View)

	* components/tree/nautilus-tree-model.c
	(nautilus_tree_model_monitor_node): if the node being monitored
	is a directory, check if any of the files we think it contains
	got moved away (e.g. while the node was collapsed)

2001-02-09  Andy Hertzfeld  <andy@eazel.com>

	* icons/i-directory-12.png:
	* icons/i-directory-accept-12.png:
	fixed bug 6338, folder moves to the right when highlighted,
	by tweaking the associated images
	
	* src/nautilus-sidebar-tabs.c: (nautilus_sidebar_tabs_hit_test):
	consider the tab for hit-testing even if invisible
	* src/nautilus-sidebar.c: (nautilus_sidebar_release_event):
	fixed 3538, easier way to minimize active sidebar view, by
	making it close the active view when you click on the space
	its tab formerly occupied.

2001-02-09  Arlo Rose  <arlo@eazel.com>

	* icons/Makefile.am:
	* icons/emblem-symbolic-link-12.png:
	* icons/emblem-symbolic-link-24.png:
	* icons/emblem-symbolic-link-36.png:
	Made more link icons that will work at smaller zoom levels.
	Fixes bug number 5988.

2001-02-09  John Sullivan  <sullivan@eazel.com>

	Fixed bug 6473 (counting deep contents of folder in Properties
	window takes tons of CPU)

	Fixed by deploying a timeout, so that the displayed numbers
	only update periodically, instead of with every item count
	increment. The interval is 200 milliseconds. This makes the
	count faster as well as greatly reducing CPU thrashage by
	not pounding on the poor widdle widgets so often.

	* src/file-manager/fm-properties-window.c:
	(directory_contents_value_field_update): Changed signature
	to just take an FMPropertiesWindow, and get the other
	relevant objects from the Details struct.
	(update_directory_contents_callback): New function, updates
	field and clears timeout ID.
	(schedule_directory_contents_update): Schedules update if
	not already pending.
	(attach_directory_contents_value_field): Removed old hack
	to store the title_field in the object data of the value
	field; store value_field after creation in Details struct.
	(append_directory_contents_fields): Store title_field after
	creation in Details struct.
	(real_destroy): Remove timeout if still pending.

2001-02-09  John Sullivan  <sullivan@eazel.com>

	Fixed part of bug 6462 (two error messages after doing search
	in Red Hat 7). Now you should only get one error message.
	Rebecca gets to figure out that one.

	* src/file-manager/fm-search-list-view.c: (real_load_error),
	(fm_search_list_view_initialize_class),
	(fm_search_list_view_initialize): Now replaces function
	pointer for load_error instead of attaching to signal, to
	avoid triggering fm-directory-view's error-handling code
	(which I recently added).

2001-02-09  John Sullivan  <sullivan@eazel.com>

	Fixed bug 6343 (timed-wait dialog is too narrow, often
	clipping dialog title)

	* libnautilus-extensions/nautilus-stock-dialogs.c:
	(timed_wait_callback): Enforced a minimum width for timed-wait
	windows. They look better now, and don't clip the titles
	except with extremely long titles, for which the title-writer
	should be flogged.

2001-02-09  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 6453, Gnome VFS_CRITICAL received when dragging
	nautilus link icons over each other.
	
	* libnautilus-extensions/nautilus-drag.c:
	(nautilus_drag_default_drop_action_for_icons):
	
	* libnautilus-extensions/nautilus-icon-dnd.c:
	(nautilus_icon_container_dropped_icon_feedback),
	(nautilus_icon_dnd_end_drag):

2001-02-08  Robey Pointer  <robey@eazel.com>

	* components/mozilla/nautilus-mozilla-content-view.c:
	(pre_widget_initialize):

	Fix build bustage in Mozilla content view: profile_name ->
	profile_directory_name.

2001-02-08  Eskil Heyn Olsen  <eskil@eazel.com>

	reviewed by: Robey Pointer  <robey@eazel.com>

	This commit fixed bugs:
	5723 ei2: check that install_failed_signal was not called 
	5752 ei2: port the uninstall stuff to the new ei2 
	5753 ei2: port the revert stuff to ei2 
	5757 fix leaks in EazelProblemHander 
	5957 eazel-install cli tool no longer uninstalls nicely
	6100 RPM4: don't handle dependencies called "rpmlib(.*)"
	6173 ei2: finish conflict and feature breakage  
	6191 make revert work (ei2: resurrect transaction stuff) 
	
	* components/rpmview/nautilus-rpm-view-install.c:
	(get_detailed_errors_foreach):
	Updated for the CANCELLED status.
	* components/services/install/command-line/eazel-alt-install-corba.
	c: (eazel_preflight_check_signal):
	Fixed an output string.
	
	* components/services/install/idl/trilobite-eazel-install.idl:
	Added the CANCELLED status.
	uninstall_progress now has same signature as install_progress.
	
	* components/services/install/lib/eazel-install-corba-callback.h:
	* components/services/install/lib/eazel-install-corba-callback.c:
	(impl_uninstall_progress),
	(eazel_install_callback_class_initialize):
	uninstall_progress now has same signature as install_progress.

	* components/services/install/lib/eazel-install-corba-types.c:
	(corba_packagedatastruct_fill_from_packagedata),
	(traverse_packagetree_md5), (corba_packagedatastruct_fill_deps),
	(packagedata_from_corba_packagedatastruct),
	(packagedata_tree_from_corba_packagedatastructlist),
	(categorydata_list_from_corba_categorystructlist):
	Added the CANCELLED status.
	Commented out sending ->provides in signals.
	Added some g_asserts to find a bug.
	categorydata_list_from_corba_categorystructlist uses
	packagedata_list_from_corba_packagedatastructlist.
	
	* components/services/install/lib/eazel-install-logic.h:
	* components/services/install/lib/eazel-install-logic.c:
	(eazel_install_start_transaction), (dump_one_package),
	(compare_break_to_package_by_name),
	(eazel_uninstall_upward_traverse),
	(eazel_uninstall_downward_traverse):
	Threw out most of the old code. Keeping logic.c untill 6190 is
	closed.
	
	* components/services/install/lib/eazel-install-logic2.c:
	(dump_tree_helper), (check_md5_on_files), (is_satisfied),
	(check_tree_helper), (execute), (set_toplevel),
	(get_packages_with_mod_flag), (check_uninst_vs_downgrade),
	(debug_revert), (compare_break_to_package_by_name),
	(eazel_uninstall_upward_traverse),
	(eazel_uninstall_check_for_install), (eazel_uninstall_globber),
	(install_packages), (uninstall_packages), (revert_transaction):
	Moved revert and uninstall into logic2.c and updated them
	appropriately.
	Added paranoia check in case bad xml dependency has a version but
	an senseless sense.
	When reviving, set parent->topleve to TRUE, not revived package.
	Revived the transaction stuff (for revert).
	Don't allow a package to depend on a package of the same name,
	this is often a problem during softcat updates.
	
	* components/services/install/lib/eazel-install-public.h:
	* components/services/install/lib/eazel-install-private.h:
	* components/services/install/lib/eazel-install-object.c:
	(eazel_install_finalize), (eazel_install_start_signal),
	(eazel_install_end_signal), (eazel_install_progress_signal),
	(eazel_install_failed_signal), (eazel_install_class_initialize),
	(eazel_install_initialize), (eazel_install_install_packages),
	(eazel_install_uninstall_packages),
	(eazel_install_revert_transaction_from_xmlstring),
	(eazel_install_do_transaction_save_report_helper),
	(eazel_install_save_transaction_report),
	(eazel_install_init_transaction),
	(eazel_install_emit_uninstall_progress),
	(eazel_install_emit_uninstall_progress_default),
	(eazel_install_emit_download_progress):
	uninstall_progress now has same signature as install_progress.
	Fixed some dumb bugs in install/uninstall progress emission.
	Added some lists to check on install status.
	Moved some of the transaction stuff from logic.c here.
	
	* components/services/install/lib/eazel-install-problem.c:
	(get_detailed_messages_foreach),
	(get_detailed_uninstall_messages_foreach),
	(get_detailed_cases_foreach),
	(get_detailed_uninstall_cases_foreach),
	(eazel_install_problem_tree_to_case),
	(eazel_install_problem_tree_to_string),
	(build_categories_from_problem_list):
	Updated again for the new PackageBreaks objects.
	Fixed so cli uninstall works nice again.
	Added the CANCELLED status.
	The problem handler is deteriorating, either we use it or we scrap
	it.
	
	* components/services/install/lib/eazel-package-system-rpm3.c:
	(rpmmonitorpiggybag_new),
	(eazel_package_system_rpm3_set_mod_status),
	(monitor_rpm_process_pipe_percent_output),
	(eazel_package_system_rpm3_packagedata_fill_from_header),
	(eazel_package_system_rpm3_set_state),
	(eazel_package_system_rpm3_execute), (check_if_all_packages_seen),
	(eazel_package_system_rpm3_install_uninstall):
	Don't spam about the locales decimal seperator.
	Set modification status after handling a package, so transaction
	logs make sense.
	Don't accept requirements of type "rpmlib(.*".
	Ability to set all packages to CANCELLED if root helper failed
	login.
	If TEST is set, fake success all the time.
	
	* components/services/install/lib/eazel-package-system-types.h:
	* components/services/install/lib/eazel-package-system-types.c:
	(categorydata_new), (categorydata_destroy_foreach),
	(packagedata_status_enum_to_str),
	(packagedata_status_str_to_enum):
	Added the CANCELLED status.
	Improved the debug strings for alloc/dealloc of category data
	structures.
	
	* components/services/install/lib/eazel-package-system.c:
	(eazel_package_system_install):
	If TEST, disable FORCE.

2001-02-08  John Harper  <jsh@eazel.com>

	Fixed bug 6044 (Druid should be clearer on what the right
	choice is for proxy users)

	* src/nautilus-first-time-druid.c (set_up_update_page): added
	the text `If you know your computer uses a proxy connection,
	click Yes and Nautilus will use it.' to the middle of the label

	Fixed bug 5656 (First time druid should bail out at startup if
	it cannot create .nautilus and Nautilus directories)

	* src/nautilus-application.c (nautilus_application_startup):
	moved the call to check_required_directories () before that to
	nautilus_first_time_druid_show ()

2001-02-08  Michael K. Fleming  <mfleming@eazel.com>

	reviewed by: Maciej Stachowiak <mjs@eazel.com>

	* components/mozilla/main.c: (mozilla_process_delayed_exit),
	(mozilla_object_destroyed), (mozilla_make_object), (main):

	Bug 6328 -- Mozilla processes are now kept around for 30
	minutes after last used, so that re-activation is much faster.
	Navigating to and from web pages in Nautilus is much less agonizing
	now.

2001-02-07  Maciej Stachowiak  <mjs@eazel.com>

	reviewed by: Rebecca Schulman  <rebecka@eazel.com>

	This change is needed to enable the bonobo-level fix to Nautilus
	bug 6023 (throbber and proxy processes still around after Nautilus
	is quit). The throbber was unreffing itself on destroy, which is
	wrong. However, Bonobo was leaking a reference to any toolbar
	control item, so the two bugs were masking each other.
	
	* components/throbber/nautilus-throbber.c
	(nautilus_throbber_destroy): Remove incorrect unref.
	(nautilus_throbber_initialize): Formatting tweaks

2001-02-08  Andy Hertzfeld  <andy@eazel.com>

	* libnautilus-extensions/nautilus-gnome-extensions.c:
	(widget_destroy_callback), (icon_selected_callback),
	(icon_cancel_pressed):
	fixed bug 6458, crash if you quickly press cancel after pressing
	OK in the icon picker; fixed by setting a boolean once the
	picker has been dismissed, and checking it so we don't do it twice.
	
2001-02-08  Andy Hertzfeld  <andy@eazel.com>
	
	* src/nautilus-location-bar.c,h: (get_file_info_list),
	(try_to_expand_path), (editable_key_press_callback),
	(real_activate), (destroy), (nautilus_location_bar_initialize),
	(nautilus_location_bar_new), (nautilus_location_bar_set_location),
	(nautilus_location_bar_get_location),
	(nautilus_location_bar_update_label):

	fixed bug 6369, sluggish keyboard response in location bar. I improved
	this in two different ways: the expansion code is deferred to idle
	time now, so it doesn't get in the way of fast typing.  Also, the
	file info list is cached in memory, so it doesn't have to load it
	again for every keystroke.  I also made the instance variables
	private, instead of being exposed in the .h file.
	
2001-02-08  Robey Pointer  <robey@eazel.com>

	* components/services/install/nautilus-view/nautilus-service-instal
	l-view.c: (nautilus_service_install_downloading),
	(nautilus_service_install_preflight_check),
	(previous_install_finished), (nautilus_service_install_installing),
	(nautilus_service_install_done),
	(nautilus_service_install_view_update_from_uri_finish):

	Change texts to match Vera's refinements.

2001-02-08  Robey Pointer  <robey@eazel.com>

	reviewed by: Ian McKellar  <ian@eazel.com>

	* components/services/login/nautilus-view/nautilus-change-password-
	view.c: (generate_change_password_form),
	(change_password_button_cb):

	Stick the password panels in a viewport so they'll have
	opportunistic scrollbars.

2001-02-08  John Sullivan  <sullivan@eazel.com>

	Fixed bug 5946 (minimum Nautilus window size is too large)

	* src/nautilus-window-private.h: Made the minimum window
	size much much smaller. This exposes layout problems in
	some of the bars & such at very small sizes, but none of
	these layout problems seem like 1.0 show-stoppers. Better to
	allow the user who wants to use a stripped-down window at
	minimum size do so than to prevent this because it looks bad
	with some bars showing. Note that other Linux apps don't stop
	you from reducing the window down to nothing at all (the
	Nautilus limit is somewhat larger than "nothing at all").

	* src/nautilus-switchable-search-bar.c:
	(nautilus_switchable_search_bar_new): With Rebecca's OK,
	changed "Search For:" to "Find:" in order to save precious
	horizontal screen real estate.

2001-02-08  Gene Z. Ragan  <gzr@eazel.com>

	reviewed by: Mike Engber <angber@eazel.com>

	Fixed bug 3087, gmc to Nautilus transition tool
	
	Added all features except removing gmc from session. Will
	need some additional help to add that feature.
	
	* libnautilus-extensions/nautilus-global-preferences.h:
	Add a preferences constant to indicate if Nautilus should
	respawn in the Gnome session.
	
	* src/nautilus-application.c: (nautilus_application_startup),
	(volume_unmounted_callback), (removed_from_session),
	(save_session), (set_session_restart), (init_session):
	Check preferences add add ourselves to session with a respawn
	setting if the user has specified that they wish such behavior.
	
	* src/nautilus-first-time-druid.c: (druid_finished),
	(set_up_gmc_transition_page):
	Save gmc to nautilus transition values in nautilus preferences.

2001-02-08  Michael K. Fleming  <mfleming@eazel.com>

	reviewed by: <ramiro@eazel.com>

	Significant rework of nautilus-mozilla-content-view to use
	report_location_change and to do general house-cleaning.

	Fixes following bugs:

	Bug 3547  POSTs in the mozilla component don't update the URI 
	Bug 4682, 6142  Frame sets have difficulty in Nautilus
	Bug 5461  "http://localhost:xxxx" instead of "eazel-services:" on location bar
	
	Will fix following bugs when I talk with Darin about problems
	with report_location_change:

	5592  nautilus / mozilla back button goes back 2 pages

	Also removes all module-global and static variables, making gnome-vfs
	and general state-tracking per-instance, thus eliminating latent
	bugs related to using two browsers simultainously

	Removes all special-casing for form POST's and for iframes

	Removes usage of the mozilla "open_uri" signal, which was no longer really
	being used for anything (interruption of eazel-specific schemes is done
	at the DOM event level, notification to Nautilus of navigation is done
	as a result of the "location" signal

	Introduces/aggrevates these bugs:

	6435	No history recorded when using report_location_change
	6436	Throbber doesn't throb when using report_location_change

	I'll wait until Darin returns to figure out solutions to this.

	* components/mozilla/Makefile.am:
	* components/mozilla/main.c: (main):
	* components/mozilla/mozilla-events.cpp:
	* components/mozilla/mozilla-events.h:
	* components/mozilla/nautilus-mozilla-content-view.c:
	* components/mozilla/nautilus-mozilla-content-view.h:

>>>>>>> 1.3690
2001-02-08  Andy Hertzfeld  <andy@eazel.com>

	* libnautilus-extensions/nautilus-gnome-extensions.c:
	(icon_selected_callback), (nautilus_gnome_icon_selector_new):
	fixed bugs 6437 and 6438 by testing for a directory selected
	instead of a file in the icon selector, and putting up an error
	dialog in that case instead of invoking the callback with the
	directory path.
	
2001-02-08  Pavel Cisler  <pavel@eazel.com>
	
	Fix 6401 (Create Link yields "You cannot link a file to itself"
		  error)
	* libnautilus-extensions/nautilus-file-operations.c:
	(nautilus_file_operations_copy_move):
	Remove a confused link to self check.
	Pass the GNOME_VFS_XFER_USE_UNIQUE_NAMES option to xfer.

2001-02-08  Fatih Demir	<kabalak@kabalak.net>

	* components/services/install/lib/eazel-package-system-rpm3.c:
		Include locale.h as you use localeconv() without including
		 it -- bad on debian...

2001-02-08  John Sullivan  <sullivan@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	* src/nautilus-sidebar-title.c:
	(nautilus_sidebar_title_size_allocate): Found useful
	optimization while investigating sidebar flashiness:
	now it only recomputes the sidebar font in
	size_allocate if the width actually changed.

2001-02-08  Robin * Slomkowski  <rslomkow@eazel.com>

	* nautilus.spec.in: updated to note that
	/usr/share/hyperbola/maps/*.map have moved to
	/usr/share/nautilus/components/hyperbola/maps/*.map

2001-02-08  John Sullivan  <sullivan@eazel.com>

	Fixed bug 6421 (Labels for permissions should look insensitive
	when permissions are not settable)

	* src/file-manager/fm-properties-window.c:
	(add_permissions_column_label), (create_permissions_page):
	Pass file parameter into add_permissions_column_label,
	set insensitive if can't set permissions.

	* libnautilus-extensions/nautilus-file.c:
	(nautilus_file_get_string_attribute_with_default):
	Use "--" as item count string instead of "..." when
	the preference is set to not display the item counts.
	("..." implied that it would show up eventually, not 
	true in this case.)
	
2001-02-08  Laszlo Kovacs  <laszlo.kovacs@sun.com>
	* components/help/Makefile.am:

	Man page map file moved to new hyperbola data
	directory.

        * components/help/hyperbola-filefmt.c:

	Compiler warnings fixed

2001-02-08  Laszlo Kovacs  <laszlo.kovacs@sun.com>
	* components/help/hyperbola-filefmt.c:

	Toplevel document support added. Docs specified in
	$(prefix)/share/nautilus/components/hyperbola/topleveldocs.xml
	will be added to the toplevel section of the help tree if
	Scrollkeeper is enabled
	
	* components/help/Makefile.am:

	topleveldocs.xml installed and hyperbola data directory
	changed to $(prefix)/share/nautilus/components/hyperbola

	* components/help/topleveldocs.xml:

	new xml file holding the docs that go into the toplevel
	section of the help tree

2001-02-07  Robey Pointer  <robey@eazel.com>

	* components/services/install/lib/eazel-install-logic2.c:
	(expand_package_suites), (install_packages):

	Do a softcat query for any suite ids in the initial package list,
	so they're expanded first and then all future queries will return
	single packages.
	
	* components/services/install/lib/eazel-install-object.c:
	(eazel_install_emit_preflight_check):

	Don't restrict the preflight signal to toplevel packages anymore:
	we send the whole package tree now so no editing is necessary.
	
	* components/services/install/lib/eazel-install-xml-package-list.c:
	(osd_parse_provides), (osd_parse_shared):

	Softcat server has started filling in the sense flag differently
	(without notice, I might grumpily add), so handle both types now
	and whine if we can't figure out how to decode it.  Log the
	softcat DB version now (eventually should store it somewhere).
	
	* components/services/install/lib/eazel-softcat.c:
	(eazel_softcat_error_string), (eazel_softcat_query),
	(eazel_softcat_get_info), (eazel_softcat_available_update):
	* components/services/install/lib/eazel-softcat.h:

	Split up the handling for single-package softcat queries and
	multi-package suite queries.
	
	* components/services/install/nautilus-view/main.c:
	(service_install_make_object), (main):

	Remove redundant 2nd ammonite_init call and a long-since useless
	printf from object creation.
	
	* components/services/install/nautilus-view/nautilus-service-instal
	l-view.c: (nautilus_service_install_downloading),
	(flatten_package_tree_foreach), (nautilus_service_install_done),
	(nautilus_service_install_failed):
	* components/services/install/nautilus-view/nautilus-service-instal
	l-view.h:

	Clean up final dialog text generation, and only ask about deleting
	RPMs if the user level is "advanced".  Also don't ask if no files
	were even downloaded.
	
2001-02-07  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Mike Fleming <mfleming@eazel.com>
	Minus the 2 new widgets.
		
	* libnautilus-extensions/Makefile.am:
	New files.

	* libnautilus-extensions/nautilus-labeled-image.h:
	* libnautilus-extensions/nautilus-labeled-image.c:
	(button_leave_callback), (button_focus_out_event_callback),
	(nautilus_labeled_image_check_button_new): Add workaround for
	rendering problems with GtkCheckButton.
	(nautilus_labeled_image_set_label_never_smooth): New function to
	make the label part possibly never smooth.

	* libnautilus-extensions/nautilus-clickable-image.h:
	* libnautilus-extensions/nautilus-clickable-image.c:
	(ancestor_button_press_event), (ancestor_button_release_event),
	(nautilus_clickable_image_new),
	(nautilus_clickable_image_new_from_file_name): New function to
	create clickable images from image files.  Add grab/ungrab calls
	to match the logic in GtkButton.

	* libnautilus-extensions/nautilus-wrap-table.h:
	* libnautilus-extensions/nautilus-wrap-table.c:
	New class.
	
	* libnautilus-extensions/nautilus-image-table.c:
	* libnautilus-extensions/nautilus-image-table.h:
	New class.

	* test/test-nautilus-image-table.c:
	* test/.cvsignore:
	* test/Makefile.am:
	Image table test.
	
2001-02-07  Robey Pointer  <robey@eazel.com>

	* components/services/install/lib/eazel-install-object.c:
	(eazel_install_start_signal):

	Remove break that caused 0% signals to never get sent on install.

	* components/services/install/lib/eazel-package-system-rpm3.c:
	(rpmmonitorpiggybag_new), (make_rpm_argument_list),
	(monitor_rpm_process_pipe_percent_output),
	(monitor_rpm_process_pipe), (monitor_subcommand_pipe),
	(manual_rpm_command), (eazel_package_system_rpm3_execute):

	Make percent a float for more accurate byte counts.  Give the IO
	channel a lower priority than normal, so that it doesn't outrank X
	refresh events (though this doesn't help much).  Reinsert the
	manual RPM execute from the old logic.c code.
	
	* nautilus-installer/src/installer.c: (insert_info_page),
	(eazel_install_progress), (eazel_download_progress),
	(get_detailed_errors_foreach_dep), (get_detailed_errors_foreach),
	(get_detailed_errors), (collect_failure_info),
	(eazel_install_preflight):
	* nautilus-installer/src/installer.h:

	Remove fixed "max assumed download" size and try to set it to the
	total bytes expected.  For some reason this still fails sometimes
	but at least it's on the right track.  Stop calling
	gtk_main_iteration from inside the install progress callback since
	that interacts horribly with the IO channel crap.  Getting
	detailed errors should avoid recursing, and should follow the
	depends struct instead of the old soft_depends one.
	
	* nautilus-installer/src/link.sh:

	Test for RPM4 build (should build now, but still not work due to
	lingering code that refuses to try under RPM4).
	
	* nautilus-installer/src/package-tree.c: (get_errant_children_int),
	(get_errant_children), (package_customizer_fill):

	Fix up tree tracing routines to avoid recursing and to use the new
	struct members instead of the old (now empty) ones.
	
2001-02-07  John Sullivan  <sullivan@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	Fixed bug 6405 (seg fault right-double-clicking when context
	menu is already showing)

	* libnautilus-extensions/nautilus-icon-container.c:
	(handle_icon_button_press): Don't create context-menu callback
	if one is already pending; don't let right-double-click activate.
	
	* src/file-manager/nautilus-directory-view-ui.xml: Added underscore
	accelerator for Show Trash, which didn't have one.

2001-02-07  Ian McKellar  <ian@eazel.com>

	reviewed by: Eskil Heyn Olsen  <eskil@eazel.com>

	* components/rpmview/nautilus-rpm-view.c:
	(nautilus_rpm_view_update_from_uri), (nautilus_rpm_view_load_uri),
	(rpm_view_load_location_callback):
	* components/rpmview/nautilus-rpm-view.h:
	If an RPM load fails then report it to Nautilus with:
	nautilus_view_report_load_failed,

	* components/services/install/lib/eazel-package-system-rpm3.c:
	(eazel_package_system_rpm3_packagedata_fill_from_header),
	(rpm_packagedata_fill_from_file):
	If an RPM load fails then report it to the caller.

	* components/services/trilobite/libtrilobite/trilobite-core-network
	.c: (trilobite_open_uri):
	Changed the unsafe `setenv' call to the safer `trilobite_setenv'.

2001-02-07  Ian McKellar  <ian@eazel.com>

	reviewed by: Maciej Stachowiak <mjs@eazel.com>

	* components/services/inventory/eazel-inventory-collect-hardware.c:
	(add_device_property), (eazel_inventory_collect_pci),
	(remove_trailing_whitespace), (ide_get_value),
	Separated whitespace removal into a separate function.

	(eazel_inventory_collect_usb), (eazel_inventory_collect_scsi),
	(eazel_inventory_collect_hardware):
	Added USB and SCSI bus scanning. Bugs: 5094, 6285.

2001-02-07  Pavel Cisler  <pavel@eazel.com>

	reviewed by: John Sullivan  <sullivan@eazel.com>

	Fix 6380 (** ERROR ** in trash_callback_destroy when
	          navigating to trash)
	* libnautilus-extensions/nautilus-trash-file.c:
	(trash_callback_destroy), (trash_file_call_when_ready):
	Add a missing ref and unref.

2001-02-07  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 5967, Music View slider is narrow in Eazel GTK theme
	
	Attempt to layout using Arlo's design.
	
	* components/music/nautilus-music-view.c:
	(music_view_set_selected_song_title), (add_play_controls),
	(nautilus_music_view_update),
	(music_view_background_appearance_changed_callback):

2001-02-07  Robin * Slomkowski  <rslomkow@eazel.com>

	* README: updated to note using the gnome-vfs-1 branch

2001-02-07  Andy Hertzfeld  <andy@eazel.com>

	fixed bug 6281, property browser should user gnome icon
	selection UI for adding patterns and emblems instead of
	generic file browsing
	
	* libnautilus-extensions/nautilus-gnome-extensions.c,h:
	(nautilus_gnome_open_terminal), (widget_destroy_callback),
	(icon_selected_callback), (icon_cancel_pressed),
	(list_icon_selected_callback), (entry_activated),
	(nautilus_gnome_icon_selector_new):
	moved code to integrate icon picking UI from the properties
	window into gnome-extensions, so other parts of nautilus can
	use it.
	
	* src/file-manager/fm-properties-window.c: (set_icon_callback),
	(select_image_button_callback):
	moved icon picking code out of properties window, but call it
	from here instead.
	
	* src/nautilus-property-browser.c: (nautilus_emblem_dialog_new),
	(add_pattern_to_browser), (add_new_pattern),
	(emblem_dialog_clicked):
	use icon picking code in property browser to pick patterns, and
	rework the emblem dialog to use gnome-icon-entry.
	
2001-02-07  Gene Z. Ragan  <gzr@eazel.com>

	reviewed by: Robin Slomkowski <robin@eazel.com>
	
	Fixed bug 6389, Extremely poor performance when
	autodir automounter is present
	
	Detect special NFS autofs directories and filter them out
	of the mount list.
	
	* libnautilus-extensions/nautilus-volume-monitor.c:
	(get_removable_volumes), (mount_volume_activate_nfs),
	(mount_volume_activate), (get_current_mount_list),
	(mount_volume_nfs_add), (mount_volume_add_filesystem):

	Worked on cleaning up placement of icons on the edges
	of the desktop based on input from Arlo.
	
	* libnautilus-extensions/nautilus-icon-container.c:
	(icon_set_position):
		
2001-02-07  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 6363, "Set Cover Image" button assumes
	fixed font height.
	
	* components/music/nautilus-music-view.c:
	(nautilus_music_view_initialize):
	Remove call to get_widget_set_usize
	
2001-02-07  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Pavel Cisler  <pavel@eazel.com>

	* libnautilus-extensions/nautilus-directory-async.c:
	(show_hidden_files_changed_callback),
	(show_backup_files_changed_callback),
	(get_filter_options_for_directory_count):
	* libnautilus-extensions/nautilus-file.c:
	(show_text_in_icons_changed_callback),
	(show_directory_item_count_changed_callback),
	(get_speed_tradeoff_preference_for_file),
	(nautilus_file_should_show_directory_item_count),
	(nautilus_file_should_get_top_left_text):
	* libnautilus-extensions/nautilus-theme.c:
	(theme_changed_callback), (nautilus_theme_get_theme),
	(nautilus_theme_get_theme_data), (nautilus_theme_get_image_path):
	* src/file-manager/fm-directory-view.c:
	(confirm_trash_changed_callback), (real_update_menus):
	* src/file-manager/fm-icon-text-window.c:
	(icon_captions_changed_callback),
	(fm_get_text_attribute_names_preference_or_default):
	Use calllbacks for some preferences values instead of peeking
	diectly.  The preferences in question here are peeked a lot during
	large directory loads, even though they hardly ever change.  This
	should get preferences stuff mostly out of Pavel's profiles.  Now,
	im still working on bug 6054 which is about making peeking
	preferences in general faster.

2001-02-06  Pavel Cisler  <pavel@eazel.com>

	reviewed by: Mike Fleming <mfleming@eazel.com>

	* libnautilus-extensions/nautilus-directory-async.c:
	(dequeue_pending_idle_callback), (mime_list_one):
	Handle the case where mime types don't get returned.

	* libnautilus-extensions/nautilus-file.c:
	Fix a comment.

2001-02-06  Andy Hertzfeld  <andy@eazel.com>

	* libnautilus-extensions/nautilus-mime-actions.c:
	(nautilus_do_component_query):
	fixed bug 5479, two "View as Text" items in "View as Other"
	dialog list, by special casing the sample text component so
	it doesn't get added to the list.
	
2001-02-06  Arik Devens  <arik@eazel.com>

	reviewed by: Eskil Heyn Olsen  <eskil@eazel.com>

	Fixed bug 5919, Preferences dialog jumps around the screen.
	
	* libnautilus-extensions/nautilus-preferences-dialog.c:
	(nautilus_preferences_dialog_construct): Removed the center
	positioning so that the dialog stays where the user put it.

2001-02-06  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 1736, if icons on desktop are offscreen, need to
	move them somewhre on screen.
	
	* libnautilus-extensions/nautilus-icon-container.c:
	(icon_set_position), (nautilus_icon_container_move_icon):
	icon_set_position may modify the x and y location of the
	icon.  nautilus_icon_container_move_icon should use the
	modified position instead of the original x and y postion
	when writing the position out into the metafile.

2001-02-06  Andy Hertzfeld  <andy@eazel.com>

	* src/file-manager/fm-properties-window.c:
	(widget_destroy_callback), (icon_selected_callback),
	(icon_cancel_pressed), (list_icon_selected_callback),
	(entry_activated), (select_image_button_callback):
	fixed bug 6280, custom icon selection should use gnome-icon-sel
	instead of the generic file browser, so now it does.
	 
2001-02-06  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Michael Engber  <engber@eazel.com>

	* src/nautilus-sidebar.c: (nautilus_sidebar_initialize_class),
	(nautilus_sidebar_size_allocate), (nautilus_sidebar_realize):
	Tell X not to clear the window contents when the sidebar is
	resized.  Since we double buffer its contents, this will reduce
	(but not eliminate) flicker in the sidebar.
	
2001-02-06  Maciej Stachowiak  <mjs@eazel.com>

	reviewed by: Laszlo Kovacs  <laszlo.kovacs@sun.com>

	Fixed bug 795 (help component installs files in nautilus prefix,
	but uses gnome-libs prefix to find them later) by expanding the
	set of places Nautilus looks for help files.

	* components/help/hyperbola-filefmt.c:
	(fmt_man_populate_tree_for_subdir): Changed to look in more places
	for help files: the help directory in the gnome prefix, the help
	directory in the nautilus prefix, and directories in GNOME_PATH.
	(fmt_help_populate_tree): New helper function.
	(append_help_dir_if_exists): New helper function.

	* components/help/Makefile.am: Define DATADIR in compile flags.

	* components/help/hyperbola-main.c: Add copyright notice.

	This part not reviewed:

	* .cvsignore, libnautilus-extensions/.cvsignore: gnore more
	things.

	* Makefile.am: distribute .in versions of xml-i18n-tools.
	
2001-02-06  John Sullivan  <sullivan@eazel.com>

	Fixed bug 5157 (Nautilus won't display directories for
	which it thinks it doesn't have permissions)

	I removed the code that prevented Nautilus from even
	trying to load a location for which the perceived
	permissions didn't allow reading (because the perceived
	permissions can be wrong with some file systems). Now
	it always tries, and puts up an error dialog only if
	it gets an error while actually loading the directory.

	* src/file-manager/fm-error-reporting.h:
	* src/file-manager/fm-error-reporting.c:
	(fm_report_error_loading_directory): New function, currently
	only handles GNOME_VFS_ERROR_ACCESS_DENIED and a fallback
	default case.
	(fm_report_error_renaming_file), (fm_report_error_setting_group),
	(fm_report_error_setting_owner),
	(fm_report_error_setting_permissions), (rename_callback):
	All the report_error functions now take a parent-window
	parameter (which is often NULL). Also, they now all use
	gnome_vfs_error_result_to_string when whining about
	unhandled cases.

	* src/file-manager/fm-directory-view.h: Changed comments
	and copyright notice only.
	* src/file-manager/fm-directory-view.c:
	(real_load_error): New function, calls 
	fm_report_error_loading_directory unless an error has already
	been reported for the current directory load operation.
	(fm_directory_view_initialize_class): Wire up real_load_error
	as default handler for LOAD_ERROR signal.
	(activate_callback): Pass parent window to error-reporting call.
	(load_directory): Reset the reported_load_error boolean since
	we're about to load anew.
	
	* src/file-manager/fm-properties-window.c: (rename_callback),
	(group_change_callback), (owner_change_callback),
	(permission_change_callback):
	Pass parent window to error-reporting-calls. I just passed NULL
	if it was not trivial to pass a good window.

	* src/nautilus-window-manage-views.c: 
	(handle_unreadable_location), (open_location): Remove code that
	was preventing "unreadable" locations from being loaded.

2001-02-06  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 6375, Certain menu shortcuts don't work when
	insertion point is in location bar.
	
	* libnautilus-extensions/nautilus-entry.c:
	(nautilus_entry_key_press):
	Filter out alt and control keyboard events and don't
	allow them to be passed to the parent GtkEntry.
	
2001-02-06  John Sullivan  <sullivan@eazel.com>

	reviewed by: Gene Ragan <gzr@eazel.com>

	Fixed bug 6365 (Crash at boot if invalid file name given)

	* src/nautilus-window-manage-views.c:
	(load_new_location_in_all_views): Added some parameter checking
	to make future bugs like this even easier to find.
	(cancel_location_change): Don't reset to old location when old
	location is NULL.

2001-02-05  Pavel Cisler  <pavel@eazel.com>

	reviewed by: Seth Nickel <seth@eazel.com>

	Fix 5930 (Copy dialog often shows "1" as total number of
		  fields in operation)

	* libnautilus-extensions/nautilus-file-operations-progress.c:
	(nautilus_file_operations_progress_update),
	(nautilus_file_operations_progress_new_file):
	* libnautilus-extensions/nautilus-file-operations.c:
	(create_transfer_dialog):
	Special case the preparing to copy/move phase -- when the
	bytes_total is 0, don't display the count.
	
	* libnautilus-extensions/nautilus-file-operations-progress.c:
	(nautilus_file_operations_progress_thaw):
	Formatting.

	* HACKING:
	Tiny tweak.

2001-02-05  Eskil Heyn Olsen  <eskil@eazel.com>

	* components/services/install/lib/eazel-install-public.h:
	* components/services/install/command-line/eazel-alt-install-corba.
	c: (eazel_file_conflict_check_signal),
	(eazel_file_uniqueness_check_signal),
	(eazel_feature_consistency_check_signal), (main):
	* components/services/install/idl/trilobite-eazel-install.idl:
	* components/services/install/lib/eazel-install-corba-callback.c:
	(impl_file_conflict_check), (impl_file_uniqueness_check),
	(impl_feature_consistency_check), (eazel_install_callback_get_epv),
	(eazel_install_callback_class_initialize):
	* components/services/install/lib/eazel-install-corba-callback.h:
	* components/services/install/lib/eazel-install-logic2.c:
	(check_no_two_packages_has_same_file),
	(check_conflicts_against_already_installed_packages),
	(check_feature_consistency):
	* components/services/install/lib/eazel-install-object.c:
	(eazel_install_class_initialize),
	(eazel_install_emit_file_conflict_check),
	(eazel_install_emit_file_conflict_check_default),
	(eazel_install_emit_file_uniqueness_check),
	(eazel_install_emit_file_uniqueness_check_default),
	(eazel_install_emit_feature_consistency_check),
	(eazel_install_emit_feature_consistency_check_default):
	Fixed bug 3459 (emit signals when doing file-conflict,
	feature-consistency and file-uniqueness checks).
	
	* components/services/install/lib/eazel-package-system-types.c:
	(packagedata_get_readable_name):
	Nyll poynter checking.

2001-02-05  John Sullivan  <sullivan@eazel.com>

	Fixed bug 6359 (Choosing current view from "View as" menu crashes)

	* src/nautilus-window-manage-views.c:
	(nautilus_window_content_view_matches_iid): New function, extracted
	from load_content_view, checks whether passed iid is the one in
	use by this window.
	(load_content_view): Now calls extracted function.
	(nautilus_window_set_content_view): Bail out early if the
	new content view is the old one. This avoids unpleasant crashing
	later on.

2001-02-05  Gene Z. Ragan  <gzr@eazel.com>

	Add code to send the mime type of the file being examined to the
	mime type capplet so that the capplet can scroll to the mime type
	being examined.
	
	* libnautilus-extensions/nautilus-program-chooser.c:
	(repopulate_program_list), (launch_mime_capplet),
	(launch_mime_capplet_and_close_dialog),
	(nautilus_program_chooser_show_no_choices_message):

2001-02-05  John Sullivan  <sullivan@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	Fixed part of bug 6329 (entering "gconf://" as location
	crashes Nautilus). After this fix, it still crashes Nautilus,
	but in a gconf-specific way.

	* src/nautilus-window-manage-views.c:
	(load_new_location_in_all_views): Don't try to load
	a location in new_content_view if it's NULL.

2001-02-05  John Sullivan  <sullivan@eazel.com>

	reviewed by: Mike Fleming <mfleming@eazel.com>

	Fixed bug 6324 (Switching views crashes every time)
	
	* src/nautilus-window-manage-views.c:
	(set_to_pending_location_and_selection): Added assert
	to make future similar bugs even easier to catch.
	(view_loaded_callback): Don't call set_to_pending_location_and_selection
	when the content view is changing without the location & selection 
	changing; just update the one view instead.

	* libnautilus-extensions/nautilus-stock-dialogs.c:
	Reduced the timed-wait timeout from 3 seconds to 2 after
	more investigation of timed-wait-related bugs. 3 seconds
	just felt a little too long.

2001-02-05  Michael Engber  <engber@eazel.com>

	* libnautilus-extensions/nautilus-metafile-factory.c:
	(nautilus_metafile_factory_new), (free_factory_instance),
	(nautilus_metafile_factory_get_instance):
	* libnautilus-extensions/nautilus-metafile-factory.h:
	* src/Nautilus_shell.oaf.in:
	* src/nautilus-application.c: (manufactures), (create_object),
	(nautilus_application_startup):
	* src/nautilus-application.h:
	Add the MetafileFactory to the main object factory.

2001-02-05  Rebecca Schulman  <rebecka@eazel.com>

	reviewed by: Maciej Stachowiak <mjs@eazel.com>

	* libnautilus-extensions/nautilus-mime-actions.c:
	(nautilus_mime_get_default_component_sort_conditions),
	(nautilus_mime_get_default_component_for_file_internal),
	(nautilus_mime_get_short_list_components_for_file):
	Changes to make sure the short list is sorted 
	correctly, so the correct default application is chosen.

2001-02-05  Andy Hertzfeld  <andy@eazel.com>

	* librsvg/rsvg.c: (rsvg_render_svp):
	fixed bug 6301, bad svg crashes Nautilus, by adding a check
	in rsvg_render_svp to make sure a pixbuf has been allocated; if
	not, don't try to render.
	
2001-02-05  John Sullivan  <sullivan@eazel.com>

	Fixed bug 6321 (Apparently arbitrary item initially selected
	in "Open with Other" dialog)

	* libnautilus-extensions/nautilus-program-chooser.c:
	(repopulate_program_list): Select first item in list after sorting.

2001-02-04  Ian McKellar,,,  <ian@eazel.com>

	reviewed by: Maciej Stachowiak <mjs@eazel.com>	

	* components/services/install/lib/Makefile.am:
	* components/services/install/lib/eazel-package-system-dpkg.c:
	(debpackage_free), (debpackage_fill_packagedata),
	(strip_trailing_whitespace), (parse_packages),
	(load_package_callback), (eazel_package_system_dpkg_load_package),
	(query_callback), (eazel_package_system_dpkg_query),
	(eazel_package_system_dpkg_install),
	(eazel_package_system_dpkg_uninstall),
	(eazel_package_system_dpkg_verify),
	(eazel_package_system_dpkg_compare_version),
	(eazel_package_system_dpkg_finalize),
	(eazel_package_system_dpkg_class_initialize),
	(eazel_package_system_dpkg_initialize),
	(eazel_package_system_dpkg_get_type),
	(eazel_package_system_dpkg_new),
	(eazel_package_system_implementation):
	* components/services/install/lib/eazel-package-system-dpkg.h:
	* components/services/install/lib/eazel-package-system.c:
	(eazel_package_system_suggest_id),
	(eazel_package_system_load_implementation):
	Created a minimal, sub-functional Debian package backend for 
	libeazelinstall - essentially only enough to allow me to test my
	software inventory work on my Debian machines.

	* components/services/inventory/Makefile.am:
	* components/services/inventory/eazel-inventory-collect-hardware.c:
	(add_device_property), (eazel_inventory_collect_pci),
	(ide_get_value), (eazel_inventory_collect_ide), (str_has_prefix),
	(add_info), (read_proc_info), (eazel_inventory_collect_memory),
	(eazel_inventory_collect_cpu), (eazel_inventory_collect_hardware):
	* components/services/inventory/eazel-inventory-collect-hardware.h:
	* components/services/inventory/eazel-inventory-collect-software.c:
	(str_has_prefix), (get_package_list),
	(eazel_inventory_collect_packages),
	(eazel_inventory_collect_software):
	* components/services/inventory/eazel-inventory-collect-software.h:
	* components/services/inventory/eazel-inventory-utils.c:
	(eazel_create_configuration_metafile):
	Moved software inventory code into eazel-inventory-collect-software.c
	and hardware inventory code into eazel-inventory-collect-hardware.c.
	Added coded to collect PCI and IDE bus information.

	* components/services/trilobite/libtrilobite/trilobite-core-distrib
	ution.c: (determine_suse_version), (determine_debian_version):
	Added version check code for SuSE and Debian.

2001-02-04  Jason Leach  <jasonleach@usa.net>

	reviewed by: Maciej Stachowiak <mjs@eazel.com>	
	
	* nautilus-clean.sh: Update to work with Solaris.

2001-02-04  Maciej Stachowiak  <mjs@eazel.com>

	* indent.sh: Script that calls indent with the right parameters to
	get a GNOME coding style (Nautilus subvariant).

	* components/help/hyperbola-filefmt.c,
	components/help/hyperbola-filefmt.h,
	components/help/hyperbola-main.c,
	components/help/hyperbola-nav-index.c,
	components/help/hyperbola-nav-search.c,
	components/help/hyperbola-nav-tree.c,
	components/help/hyperbola-nav.h,
	components/help/hyperbola-types.h: Run indent.sh on these.

2001-02-03  John Sullivan  <sullivan@eazel.com>

	Fixed bug 6254 ("Display" name for grouping in "Folder Views"
	category is poor)

	* libnautilus-extensions/nautilus-global-preferences.c:
	(global_preferences_install_descriptions),
	(global_preferences_create_dialog): Verafied a little text.

2001-02-03  Eskil Heyn Olsen  <eskil@eazel.com>

	* components/throbber/Makefile.am:
	Added the oaf.in files to EXTRA_DIST (tinderbox fix)

2001-02-03  Gene Z. Ragan  <gzr@eazel.com>

	Do a simple check for NULL instead of using
	g_return_if_fail.  We don't need the error
	reported to the terminal.
	
	* libnautilus-extensions/nautilus-volume-monitor.c:
	(get_removable_volumes), (volume_is_removable),
	(volume_is_read_only):

2001-02-02  Eskil Heyn Olsen  <eskil@eazel.com>

	* components/services/install/command-line/eazel-alt-install-corba.
	c: (tree_helper_helper), (tree_helper):
	Added check for PackageBreaks iterators.
	
	* components/services/install/lib/eazel-install-corba-callback.c:
	(impl_install_failed):
	Leakfix, freeing the list given to the signal handler after
	handling.
	
	* components/services/install/lib/eazel-install-corba-types.c:
	(empty_hash_table),
	(packagedata_tree_from_corba_packagedatastructlist):
	Leakfix, now correctly frees the contents of the md5_hashtable and
	unrefs the proper objects.

	* components/services/install/lib/eazel-install-logic2.c:
	(eazel_install_check_existing_packages), (get_softcat_info),
	(is_satisfied), (is_satisfied_features),	
	(check_dependencies_foreach), (check_tree_helper),
	(add_file_conflict),
	(check_conflicts_against_already_installed_packages),
	(check_feature_consistency):
	Proper fillflags for some EazelPackageSystem calls.
	Nicer log-output when debug is off.
	Leak fix, the PackageBreaks "objects".
	
	* components/services/install/lib/eazel-install-problem.c:
	(get_detailed_messages_breaks_foreach),
	(get_detailed_messages_foreach),
	(get_detailed_cases_breaks_foreach), (get_detailed_cases_foreach):
	Updated for the new PackageBreaks "objects".
	
	* components/services/install/lib/eazel-package-system-rpm4.c:
	(eazel_package_system_rpm4_query_impl):
	s/packagedata_destroy/gtk_object_unref/
	
	* components/services/install/lib/eazel-package-system-types.c:
	(at_exit_package_data_info), (categorydata_new),
	(categorydata_destroy_foreach), (packagedata_finalize),
	(packagedata_class_initialize), (packagedata_initialize),
	(packagedata_get_readable_name), (packagebreaks_finalize),
	(packagebreaks_class_initialize), (packagebreaks_initialize),
	(packagefileconflict_finalize),
	(packagefileconflict_class_initialize),
	(packagefeaturemissing_finalize),
	(packagefeaturemissing_class_initialize):
	Finally got the destroy crap working for the PackageBreak
	"objects".
	More leakcheck stuff for various structures.
	Again, fixed get_reabable_name.
	
	* components/services/install/lib/eazel-package-system-types.h:
	Added finalizes to the "objects".
	Removed packagedata_destroy prototype.
	
	* components/services/trilobite/libtrilobite/Makefile.am:
	Cleanup and possible tinderbox fix.
	
2001-02-02  Robey Pointer  <robey@eazel.com>

	* components/services/install/lib/eazel-install-corba-types.c:
	(packagedata_tree_from_corba_packagedatastructlist):

	Fix small bug in the package tree inflater that caused break
	structs to be messed up.
	
	* components/services/install/lib/eazel-softcat.c:
	(get_search_url_for_package):
	* components/services/install/nautilus-view/nautilus-service-instal
	l-view.c: (create_package),
	(nautilus_service_install_view_update_from_uri_finish):

	Encode and decode suite_id/suite_name/product_id/product_name from
	eazel-install: urls and pass through to softcat queries.  They are
	all treated like variant flavors of suite_id internally (group of
	packages with a single id).
	
	* nautilus-installer/src/Makefile:
	* nautilus-installer/src/installer.c:
	(get_detailed_errors_foreach), (get_detailed_errors),
	(eazel_install_preflight), (eazel_installer_set_default_texts),
	(eazel_installer_initialize):

	Remove eazel-hacking uninstall, since experts claim we no longer
	need it.  Some changes to sync up with the new world order where
	PackageData is now a GTK object.
	
	* nautilus-installer/src/package-tree.c:
	(find_package_parents_int), (find_package_parents),
	(get_errant_children_int), (get_errant_children),
	(package_customizer_fill_dep), (package_customizer_fill),
	(jump_to_package_tree_page):

	Fix the package customizer to cope with the new world order, where
	the package tree is sent across as a directed graph (instead of
	tree) and the deps are in 'depends' not 'soft_depends'.
	
	* nautilus-installer/src/prescript:

	Up version to 1.0.

2001-02-02  Darin Adler  <darin@eazel.com>

	reviewed by: John Sullivan <sullivan@eazel.com>

	Fixed bug 6163 (Need NautilusViewFrame ::
	report_location_changed). This is re-adding a feature we also had
	long ago, where a view reports a location change, but does not
	want the location change to come back to it in the form of a
	load_location call.

	* src/nautilus-applicable-views.h:
	* src/nautilus-applicable-views.c:
	(get_view_result_from_gnome_vfs_result), (got_file_info_callback),
	(got_minimum_file_info_callback),
	(nautilus_determine_initial_view),
	(nautilus_determine_initial_view_cancel): Changed this entire file
	to have a much easier-to-understand API.
	
	* src/nautilus-view-frame-private.h:
	* src/nautilus-view-frame-corba.c: (free_location_plus_callback):
	Change existing structure so it can be used for the location-change
	case, which includes a title too.
	(open_force_new_window): Use new structure.
	(report_location_change): Implement new call.
	(impl_Nautilus_ViewFrame_open_location_force_new_window): Use new
	structure.
	(impl_Nautilus_ViewFrame_report_location_change): Implement new
	call.
	
	* libnautilus/nautilus-view-component.idl: Add the new call.
	* libnautilus/nautilus-view.h:
	* libnautilus/nautilus-view.c:
	(nautilus_view_report_location_change): Add the new call.

	* src/nautilus-view-frame.h:
	* src/nautilus-view-frame.c:
	(nautilus_view_frame_initialize_class): Add new signal.
	(nautilus_view_frame_report_location_change): Implement new call.
	
	* src/nautilus-window-private.h:
	* src/nautilus-window-manage-views.h:
	* src/nautilus-window-manage-views.c: (update_for_new_location):
	Got rid of obsolete assert. Also, no longer clear the selection.
	The selection is set properly earlier, and clearing it at this
	point serves no purpose.
	(location_has_really_changed): Call free_location_change to share
	more code. Also no reason to free "pending_ni" any more, because
	we don't keep it around in the success case.
	(load_new_location_in_one_view): New name.
	(load_new_location_in_sidebar_panels): New name. Also take a
	parameter of a view to skip.
	(load_new_location_in_all_views): New function.
	(set_to_pending_location_and_selection): New name, and removed
	code to handle the case where there is no pending location, since
	that doesn't happen. Also take a parameter of a view to skip. Also
	broke out the guts into load_new_location_in_all_views.
	(free_location_change): Free things by their new names. There's
	also less to free now.
	(cancel_location_change): Key off pending_location instead of
	pending_ni. Also save code by using new function that skips a
	view.
	(determined_initial_view_callback): Changed name, and use new
	interface. No longer need "end_reached" trick, because the new
	interface handles that.
	(begin_location_change): Made a static after moving all the
	functions that use it in here. Also moved some of the reload
	code out into nautilus_window_reload.
	(report_location_change_callback): New function. Does all the
	steps neede for a location change in place.
	(nautilus_window_back_or_forward), (nautilus_window_reload): Moved
	these two functions in here from nautilus-window.c so we could
	make begin_location_change more private.
	
	* src/nautilus-window.h:
	* src/nautilus-window.c: (nautilus_window_go_to): Changed the name.
	(nautilus_window_get_location): New function for callers that used
	to get the location field directly.
	(go_to_callback): Changed name.

	* src/nautilus-desktop-window.c: (nautilus_desktop_window_new):
	* src/nautilus-location-bar.c: (drag_data_received_callback):
	* src/nautilus-shell.c: (open_window), (save_window_states),
	(restore_window_states):
	* src/nautilus-window-menus.c: (services_button_callback),
	(help_menu_nautilus_manual_callback),
	(help_menu_nautilus_license_callback),
	(help_menu_nautilus_feedback_callback),
	(activate_bookmark_in_menu_item):
	* src/nautilus-window-service-ui.c: (goto_services_summary),
	(goto_online_storage), (goto_software_catalog),
	(goto_services_support):
	* src/nautilus-window.c: (location_change_at_idle_callback),
	(nautilus_window_constructed), (view_as_menu_vfs_method_callback),
	(nautilus_window_go_web_search), (nautilus_window_go_home):
	Use nautilus_go_to under its new name.
	
	* src/nautilus-shell.c: (restore_window_states): Use
	nautilus_istr_has_prefix instead of g_strncasecmp. Also did other
	code cleanup.
	
	* libnautilus-extensions/nautilus-gtk-extensions.h: Added a new
	marshal function that I needed.
	
	* libnautilus-extensions/nautilus-thumbnails.c: Added a FIXME.
	
	* libnautilus-extensions/nautilus-view-identifier.h:
	* libnautilus-extensions/nautilus-view-identifier.c:
	(nautilus_view_identifier_copy),
	(nautilus_view_identifier_compare): Use const.
	
	* src/nautilus-application.c: (nautilus_application_startup): Only
	check for root if we are actually running nautilus, not if we are
	just killing off an existing copy.
	(confirm_ok_to_run_as_root): Changed name of the function and
	improved the wording of the message and button. Also added an
	environment variable you can set to get rid of this. (Probably
	should have been a preference instead, but I am officially being
	lazy about this.)

	Fixed bug that was revealed by the change in the loading sequence
	I made. John didn't review this part:
	
	* libnautilus-extensions/nautilus-directory-private.h:
	* libnautilus-extensions/nautilus-directory-async.c:
	(load_directory_state_destroy), (load_directory_done):
	Separate out code to free the partly-done state so it can
	be used in the cancel case.
	(dequeue_pending_idle_callback): Ref the directory object
	so that we won't get messed up if the callback destroys it.
	(directory_load_cancel): Separated out the old part of
	file_list_cancel so that we can cancel the idle part too
	when we want to.
	(file_list_cancel): Use the new calls to cancel the idle
	part of directory loading.
	(directory_load_done): Use directory_load_cancel instead of
	file_list_cancel.
	(nautilus_directory_stop_monitoring_file_list): Use
	directory_load_cancel instead of file_list_cancel.
	(nautilus_directory_async_state_changed): Added state variables to
	protect cases where we re-enter this function.

2001-02-02  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Michael Engber  <engber@eazel.com>

	* applets/preferences-applet/nautilus-preferences-applet.c:
	(restart_button_clicked_callback), (main):
	Add a restart button.
	
2001-02-02  Gene Z. Ragan  <gzr@eazel.com>

	Fixed a small bug where I was assuming a value would be valid
	when it could be NULL. Now I check for NULL.
	
	* src/nautilus-application.c: (volume_unmounted_callback):

2001-02-02  Brett Neely  <brett@eazel.com>

	reviewed by: Eric Fischer  <eric@eazel.com>

	* nautilus-clean.sh:
	Kill oafd last so nautilus-clean.sh -x only needs to be run once.

2001-02-02  Gene Z. Ragan  <gzr@eazel.com>

	reviewed by: Maciej Stachowiak  <mjs@eazel.com>
	
	Fixed bug 5222,
	Nautilus allows users to rename .Trash (but not copy or link)
	
	* libnautilus-extensions/nautilus-file-utilities.c:
	* libnautilus-extensions/nautilus-file-utilities.h:
	(nautilus_uri_is_trash_folder):
	Utility function to indentify if the folder is trash based
	on a text uri.
	
	* libnautilus-extensions/nautilus-file.c:
	(nautilus_file_can_rename):
	Call nautilus_uri_is_trash_folder to identify a trash
	folder and disallow renaming.
	
2001-02-02  John Sullivan  <sullivan@eazel.com>

	reviewed by: Darin Adler <darin@eazel.com>

	Fixed bug 5749 (bookmarks are untranslated)

	* data/static_bookmarks.xml:
	An earlier checkin to update the bookmarks stripped off
	all the underscores from "_name=" strings, which was what
	was causing them to be translated. Fixed by returning the
	underscores.

2001-02-02  Ramiro Estrugo  <ramiro@eazel.com>

	* applets/preferences-applet/nautilus-preferences-applet.c:
	(boolean_toggle_button_new), (start_button_clicked_callback),
	(main):
	Add a Nautilus start button.  Also make the fonts smaller to
	conserver panel space.
	
2001-02-02  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Maciej Stachowiak  <mjs@eazel.com>

	Fix bug 6131 - NautilusLabel does not support proper line wrap.
	Its fixed for smooth mode.  Theres a bug (6243) for the more
	complicated issue of wrapping in non smooth mode.

	* libnautilus-extensions/nautilus-label.h:
	* libnautilus-extensions/nautilus-label.c:
	(nautilus_label_initialize_class), (nautilus_label_set_arg),
	(nautilus_label_get_arg), (nautilus_label_size_allocate),
	(nautilus_label_set_never_smooth),
	(nautilus_label_set_adjust_wrap_on_resize),
	(nautilus_label_get_adjust_wrap_on_resize):
	Add a boolean attribute 'adjust_wrap_on_resize' that controls
	whether the label will automatically update its line wrap width
	when its resized.

	* components/services/summary/nautilus-view/nautilus-summary-view.c
	: (summary_view_item_label_new), (summary_load_location_callback):
	No longer need size_allocate hack.  Use NautilusLabel's
	'adjust_wrap_on_resize' attribute instead.
	
	* test/test-nautilus-label-wrapped.c: (create_nautilus_label),
	(create_gtk_label_window), (create_nautilus_label_window), (main):
	Update for 'adjust_wrap_on_resize'.
	
2001-02-01  Maciej Stachowiak  <mjs@eazel.com>

	reviewed by: Pavel Cisler  <pavel@eazel.com>

	Fix bug 4678 (Clicking on a Nautilus link file in tree view causes
	Nautilus cannot handle item type error box).
	
	* components/tree/nautilus-tree-view.c:
	(nautilus_tree_view_destroy), (got_activation_uri_callback),
	(cancel_possible_activation), (tree_select_row_callback): Activate
	activation URI instead of file URI to support Nautilus links
	properly. If the link resolves to a "command:" URI, however,
	silently ignore it to avoid giving an ugly error message because
	per John Sullivan, selecting things in the tree view should not
	launch apps.

	* components/tree/nautilus-tree-view-private.h: Added
	activation_uri_wait_file field to details struct.

	* data/top/Computer, data/top/Services: Updated to new nautilus
	link format.

2001-02-02  Robey Pointer  <robey@eazel.com>

	* components/services/install/nautilus-view/nautilus-service-instal
	l-view.c: (flatten_package_tree_foreach):

	Fix build breakage caused by my previous checkin.

2001-02-02  Robey Pointer  <robey@eazel.com>

	reviewed by: Eskil Heyn Olsen  <eskil@eazel.com>

	* components/services/install/lib/eazel-install-logic2.c:
	(is_satisfied), (download_packages):
	* components/services/install/lib/eazel-install-protocols.c:
	(gnome_vfs_fetch_remote_file):

	Fix thinko (caused by myself in October) that caused the stop
	button to only cancel one download and then aggravatingly continue
	with the remaining downloads.

	* components/services/install/idl/trilobite-eazel-install.idl:
	* components/services/install/lib/eazel-install-corba-callback.c:
	(impl_download_progress), (impl_preflight_check),
	(impl_download_failed), (impl_dep_check), (impl_install_progress),
	(impl_uninstall_progress), (impl_md5_check_failed),
	(impl_install_failed), (impl_uninstall_failed),
	(eazel_install_callback_simple_query):
	* components/services/install/lib/eazel-install-corba-types.c:
	(corba_string_sequence_to_glist),
	(g_list_to_corba_string_sequence),
	(corba_packagedatastruct_fill_from_packagedata),
	(corba_packagedatastruct_from_packagedata),
	(corba_packagedatastructlist_fill_from_packagedata_list),
	(corba_packagedatastructlist_from_packagedata_list),
	(new_fake_md5), (traverse_packagetree_md5),
	(corba_packagedatastruct_fill_deps),
	(corba_packagedatastructlist_foreach),
	(corba_packagedatastructlist_from_packagedata_tree),
	(packagedata_from_corba_packagedatastruct),
	(packagedata_list_from_corba_packagedatastructlist),
	(packagedata_tree_from_corba_packagedatastructlist),
	(corba_category_list_from_categorydata_list),
	(categorydata_list_from_corba_categorystructlist):
	* components/services/install/lib/eazel-install-corba-types.h:
	* components/services/install/lib/eazel-install-corba.c:
	(impl_Eazel_Install_install_packages),
	(impl_Eazel_Install_uninstall_packages),
	(impl_Eazel_Install_simple_query):
	* components/services/install/lib/eazel-install-object.c:
	(eazel_install_emit_preflight_check_default),
	(eazel_install_emit_install_failed_default),
	(eazel_install_emit_uninstall_failed_default):
	* components/services/install/lib/eazel-install-xml-package-list.c:
	(parse_package), (eazel_install_packagedata_to_xml_int),
	(eazel_install_packagedata_to_xml),
	(eazel_install_packagelist_to_xml):
	* components/services/install/lib/eazel-install-xml-package-list.h:

	Add proper "breaks", "modifies", and "depends" structures to the
	corba interface, by using package MD5 strings to serve as "soft
	pointers" between packages in a package tree.  Convert the
	preflight, install_failed, and uninstall_failed signals to use the
	new package-tree type instead of munging into and out of XML.
	Also fixed up the API's to the corba conversion routines so they
	would make a valiant attempt not to leak memory.

	* components/services/install/lib/eazel-package-system-types.c:
	(packagedata_copy):

	Don't forget to copy that pesky MD5!
	
	* components/services/install/lib/eazel-package-system-types.h:

	Satisfy Robey's desire to avoid Carpal Tunnel Syndrome.
	
	* components/services/install/lib/eazel-softcat.c:
	(eazel_softcat_string_to_sense_flags),
	(get_search_url_for_package):
	* components/services/install/lib/eazel-softcat.h:

	Add function to convert a sense string back into flags.
	
	* components/services/install/nautilus-view/nautilus-service-instal
	l-view.c: (flatten_package_tree_depends_foreach),
	(flatten_package_tree_foreach):

	Fix up the install view to use the new "depends" chain instead of
	the old "soft_depends" which is now empty.

2001-02-02  Ramiro Estrugo  <ramiro@eazel.com>

	* libnautilus-extensions/nautilus-metafile-factory.c: (corba_open):
	Add new line at end of file to make redhat7 build happy. 
	
2001-02-01  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Maciej Stachowiak  <mjs@eazel.com>

	* libnautilus-extensions/nautilus-global-preferences.c:
	(global_preferences_install_defaults),
	(global_preferences_install_visibility),
	(global_preferences_install_sidebar_panel_defaults):
	* libnautilus-extensions/nautilus-preferences.c:
	(nautilus_preferences_get_user_level):
	* libnautilus-extensions/nautilus-preferences.h:
	* src/nautilus-first-time-druid.c: (set_up_user_level_page):
	* src/nautilus-window-menus.c: (get_user_level_icon_name),
	(nautilus_window_initialize_menus), (convert_verb_to_user_level),
	(convert_user_level_to_path):
	* test/test-nautilus-preferences-change.c: (main):
	Change 'hacker' to 'advanced' for the advanced user level so that
	the names used for storage match those used for display.

2001-02-01  Maciej Stachowiak  <mjs@eazel.com>

	reviewed by: Darin Adler  <darin@eazel.com> and 
	             Robey Pointer  <robey@eazel.com>

	Fix bugs 5528 (oaf command-line options show up in main program
	section, not a separate section) and 5510 (descriptions of
	OAF-specific options in --help are not translated). To do this I
	had to change the way the oaf popt options are processed in all
	the places that do so.

	* components/adapter/main.c: (main):
	* components/hardware/main.c: (main):
	* components/help/hyperbola-main.c: (main):
	* components/image-viewer/Nautilus_View_image.oaf.in:
	* components/image-viewer/nautilus-image-view.c:
	(init_server_factory):
	* components/loser/content/main.c: (main):
	* components/loser/sidebar/main.c: (main):
	* components/mozilla/main.c: (main):
	* components/music/main.c: (main):
	* components/notes/nautilus-notes.c: (main):
	* components/rpmview/main.c: (main):
	* components/services/install/command-line/eazel-alt-install-corba.
	c: (main):
	* components/services/install/nautilus-view/main.c: (main):
	* components/services/login/nautilus-view/main.c: (main):
	* components/services/summary/nautilus-view/main.c: (main):
	* components/services/time/command-line/main.c: (main):
	* components/services/time/nautilus-view/main.c: (main):
	* components/services/trilobite/libtrilobite/trilobite-core-utils.c
	: (trilobite_init):
	* components/shell/shell.c:
	* components/text/Nautilus_View_text.oaf.in:
	* components/text/main.c: (main):
	* components/throbber/main.c: (main):
	* components/tree/main.c: (main):
	* libnautilus/nautilus-view-standard-main.c:
	(nautilus_view_standard_main_multi):
	* src/Nautilus_shell.oaf.in:
	* src/nautilus-main.c: (main):
	* test/test-nautilus-mime-actions-set.c: (main):
	* test/test-nautilus-mime-actions.c: (main): Register oaf options
	with gnomelib_register_popt_options and move oaf_init call to
	before gnome_init to fix the aforementioned bugs.

2001-02-01  Rebecca Schulman  <rebecka@eazel.com>
	Fixed bug 5648, bad ui in the indexing info
	dialog.

	reviewed by: Maciej Stachowiak <mjs@eazel.com>

	* src/file-manager/nautilus-indexing-info.c:
	(get_index_percentage_complete), (initialize_dialog),
	(get_text_for_progress_label), (update_progress_display),
	(show_index_progress_dialog), (show_reindex_request_dialog),
	(recreate_and_show_reindex_request_dialog),
	(update_file_index_callback),
	(last_index_time_and_reindex_button_dialog_new),
	(index_progress_dialog_new),
	(destroy_indexing_info_dialogs_on_exit),
	(show_indexing_info_dialog): Rework this file.  Use two separate
	index dialogs for the case where the index is going, and not
	going.  When "update now" is pressed, switch to the index progress
	dialog.  Report errors reported by and unavailibility of the
	indexing service.

	* libnautilus-extensions/nautilus-stock-dialogs.c:
	(nautilus_create_info_dialog):
	* libnautilus-extensions/nautilus-stock-dialogs.h:
	Add this for use in creating the indexing info dialog.
	

2001-02-01  Michael K. Fleming  <mfleming@eazel.com>

	reviewed by: <robey@eazel.com>

	Bug 6103 a user can install any package from softcat without login 
	Bug 4514 error msg when register during softcat install 

	Login dialog for the install view, with working registration, cancel,
	etc.


	* components/services/install/nautilus-view/Makefile.am:
	* components/services/install/nautilus-view/main.c: (main):
	* components/services/install/nautilus-view/nautilus-service-instal
	l-view.c: (nautilus_service_install_view_destroy),
	(nautilus_install_parse_uri), (nautilus_service_install_done),
	(user_login_callback),
	(nautilus_service_install_view_update_from_uri),
	(nautilus_service_install_view_update_from_uri_finish),
	(nautilus_service_install_view_load_uri):
	* components/services/summary/nautilus-view/nautilus-summary-menu-i
	tems.c: (merge_bonobo_menu_items):
	* components/services/summary/nautilus-view/nautilus-summary-view.c
	: (update_header), (nautilus_summary_view_load_uri):
	* src/nautilus-window-service-ui.c: (goto_online_storage),
	(goto_software_catalog):

2001-02-01  Michael Engber  <engber@eazel.com>

	* libnautilus-extensions/Makefile.am:
	* libnautilus-extensions/nautilus-metafile-factory.c:
	(nautilus_metafile_factory_initialize_class),
	(nautilus_metafile_factory_get_epv),
	(nautilus_metafile_factory_get_vepv),
	(nautilus_metafile_factory_create_servant),
	(nautilus_metafile_factory_initialize), (destroy),
	(nautilus_meta_file_factory_new), (corba_open):
	* libnautilus-extensions/nautilus-metafile-factory.h:
	* libnautilus-extensions/nautilus-metafile-server.idl:
	* libnautilus-extensions/nautilus-metafile.c:
	(nautilus_metafile_initialize_class), (nautilus_metafile_get_epv),
	(nautilus_metafile_get_vepv), (nautilus_metafile_create_servant),
	(nautilus_metafile_initialize), (destroy), (nautilus_metafile_new),
	(corba_get), (corba_get_list), (corba_set), (corba_set_list),
	(corba_copy), (corba_remove), (corba_rename),
	(corba_register_monitor), (corba_unregister_monitor):
	* libnautilus-extensions/nautilus-metafile.h:
	Initiall check-in of new metadata APIs (corba) - not hooked
	up yet.

2001-02-01  Gene Z. Ragan  <gzr@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>
	
	Fixed bug 6941, 'Clean Up By Name' feature on the desktop keep
	switching file locations after being 'cleaned up'
	
	* src/file-manager/fm-desktop-icon-view.c:
	(desktop_icons_compare_callback):
	In the case of identical links tpyes, compare by name.	
		
	More work on gmc transition tool
	
	* src/nautilus-first-time-druid.c:
	(druid_finished):
	Hide druid widget before performing startup tasks.
	
	(next_proxy_configuration_page_callback),
	(add_nautilus_to_session):

2001-02-01  Pavel Cisler  <pavel@eazel.com>

	reviewed by: Gene Ragan <gzr@eazel.com>

	Fix 6152 (Dragging a file to the trash will bring up a replace
		  dialog)
	Fix 5387 (Dragging a file within Trash gives "already exists"
		 error)

	* libnautilus-extensions/nautilus-drag.c:
	* libnautilus-extensions/nautilus-drag.h:
	(nautilus_drag_items_local), (nautilus_drag_items_in_trash):
	Add more convenience calls for Trash handling.
	
	* libnautilus-extensions/nautilus-file-utilities.h:
	* libnautilus-extensions/nautilus-file-utilities.c:
	(nautilus_uri_is_in_trash):
	New convenience call for Trash handling.

	* libnautilus-extensions/nautilus-file.c:
	(nautilus_file_is_in_trash):
	Use the new nautilus_uri_is_in_trash call.

	* libnautilus-extensions/nautilus-file-operations.c:
	(nautilus_file_operations_copy_move):
	Handle the case where a file is dragged into a Trash window or
	onto a Trash icon as if the "Move to Trash" command was issued -
	if there is a name conflict with a pre-existing file in the Trash,
	use a new unique name for the new file.
	
	* libnautilus-extensions/nautilus-icon-dnd.c:
	(nautilus_icon_container_selection_items_local):
	Handle files in the Trash properly - doing a parent match with
	the container URI fails for these, special case Trash handling.

2001-02-01  John Sullivan  <sullivan@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	Fixed bug 143 (zooming in list view doesn't affect font size)

	Maybe I get the award for "oldest reported bug fixed recently"?

	* src/file-manager/fm-list-view.c: 
	(fm_list_view_update_font): New function, started with guts of
	fm_list_view_font_family_changed but also takes zoom level into
	account when choosing font size.
	(set_up_list): Call _update_font instead of _font_family_changed,
	just 'cuz it makes more sense.
	(fm_list_view_set_zoom_level): Call _update_font.
	(fm_list_view_font_family_changed): Extracted guts to
	_update_font.

2001-02-01  John Sullivan  <sullivan@eazel.com>

	reviewed by: Darin Adler <darin@eazel.com>

	Fixed bug 6181 (funny mouse clicking freezes Nautilus)

	* libnautilus-extensions/nautilus-icon-container.c:
	(button_press_event): Ignore middle & right button
	presses when we're dragging a selection rectangle.

2001-02-01  John Sullivan  <sullivan@eazel.com>

	reviewed by: Darin Adler <darin@eazel.com>

	* libnautilus-extensions/nautilus-global-preferences.c:
	(global_preferences_install_descriptions):
	Parenthesize parenthetical part of "slow but complete
	search" checkbox label.
	(global_preferences_create_dialog): Use SHORT_ENUM
	instead of ENUM type for executable text file
	activation options so they all go on one line, taking
	less precious vertical screen real estate.

2001-02-01  Darin Adler  <darin@eazel.com>

	* components/services/install/lib/eazel-package-system-types.h:
	Add missing packagedata_destroy prototype to make it compile
	on systems with RPM 4 (like mine).

2001-02-01  Maciej Stachowiak  <mjs@eazel.com>

	* ChangeLog: rolled over to ChangeLog-20010201.

