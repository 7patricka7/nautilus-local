2000-09-23  Andy Hertzfeld  <andy@eazel.com>

	optimized the new selection highlighting by fetching the
	highlight frame once for the icon canvas instead of for each
	selected item

	* libnautilus-extensions/nautilus-icon-private.h:
	added field for highlight frame
	
	* libnautilus-extensions/nautilus-icon-container.c: (destroy),
	(nautilus_icon_container_initialize):
	load and destroy the highlight frame as necessary
	
	* libnautilus-extensions/nautilus-icon-canvas-item.c:
	(draw_label_text_aa):
	use the highlight frame from the canvas
	
2000-09-22  Maciej Stachowiak  <mjs@eazel.com>

	Register all the below components per display. I didn't make
	nautilus per-display yet (to avoid dealing with the locking
	issues, etc). I also did not change the services components that
	appear to be non-gui to operate per-display.

	I believe this fixes bugs 3033 and 2237.

	* components/adapter/main.c: (main):
	* components/hardware/main.c: (main):
	* components/help/hyperbola-main.c: (main):
	* components/history/nautilus-history-view.c: (main):
	* components/html/ntl-web-browser.c: (main):
	* components/image-viewer/nautilus-image-view.c:
	(init_bonobo_image_generic_factory):
	* components/loser/content/main.c: (main):
	* components/loser/sidebar/main.c: (main):
	* components/mozilla/main.c: (main):
	* components/music/main.c: (main):
	* components/notes/nautilus-notes.c: (main):
	* components/rpmview/main.c: (main):
	* components/sample/main.c: (main):
	* components/services/install/nautilus-view/main.c: (main):
	* components/services/inventory/nautilus-view/main.c: (main):
	* components/services/login/nautilus-view/main.c: (main):
	* components/services/summary/nautilus-view/main.c: (main):
	* components/services/time/nautilus-view/main.c: (main):
	* components/services/trilobite/sample/service/main.c: (main):
	* components/shell/shell.c: (shell_factory_init):
	* components/tree/main.c: (main):
	* components/websearch/ntl-web-search.c: (main): Register each of 
	these per-display.

2000-09-22  Andy Hertzfeld  <andy@eazel.com>

	* libnautilus-extensions/nautilus-gdk-extensions.c:
	(nautilus_gradient_parse_one_color_spec):
	fixed glitch in Michael's gradient parsing logic that was
	mishandling three-point gradients and making Arlo's sidebar
	draw wrong.
	
2000-09-22  Andy Hertzfeld  <andy@eazel.com>

	implemented Arlo's new design for icon selection highlighting.
	It's still not finished; it needs to be optimized and refined in
	various ways.
	
	* icons/Makefile.am:
	* icons/text-selection-frame.png
	added semi-transparent text selection frame image
	
	* libnautilus-extensions/nautilus-graphic-effects.c,h:
	(nautilus_stretch_frame_image), (nautilus_embed_image_in_frame):
	exposed the stretch frame image routine
	
	* libnautilus-extensions/nautilus-icon-canvas-item.c:
	(draw_or_measure_label_text_aa), (draw_label_text_aa):
	implemented the new, transparent highlighting.
	
2000-09-22  Darin Adler  <darin@eazel.com>

	Storage leak fixes. Today I concentrated on leaks that happen
	when you change views from Icon to List View and back.

	* components/tree/nautilus-tree-view.c:
	(nautilus_tree_view_insert_model_node): Unref a pixmap and bitmap,
	free a string.
	(nautilus_tree_view_update_model_node): Unref a pixmap and bitmap,
	free a string.
	(notify_node_seen): Free a string.
	(nautilus_tree_view_uri_to_name): Removed extra g_strdup.
	* libnautilus-extensions/nautilus-glib-extensions.c:
	(free_hash_tables_at_exit): Free a list.
	* libnautilus-extensions/nautilus-list.c: (draw_cell): Skip the
	excess work of re-getting the pixmap and bitmap, not using them,
	and leaking them.
	* libnautilus-extensions/nautilus-preferences.c:
	(preferences_hash_node_remove_callback): Free a list.
	* src/file-manager/fm-directory-view.c: (queue_pending_files):
	Free a list.
	* src/file-manager/fm-icon-view.c: (get_icon_text_callback):
	Free a string in all code paths (was freed in some before).
	* src/file-manager/fm-list-view.c: (add_to_list): Free the column
	text in a way that works even though some columns have NULL.
	(install_row_images): Unref a pixmap and bitmap.
	
	* libnautilus-extensions/nautilus-scalable-font.c:
	(destroy_global_rsvg_ft_context),
	(initialize_global_stuff_if_needed): Free the rsvg_ft font cache
	at exit.
	* libnautilus-extensions/nautilus-theme.c: (free_last_theme),
	(nautilus_theme_get_theme_data): Free the cached theme XML
	document at exit.
	
	* components/help/converters/gnome-db2html2/gdb3html.c:
	(remove_head), (start_element), (end_element), (cdata_block):
	* components/tree/nautilus-tree-model.c:
	(nautilus_tree_model_for_each_postorder),
	(nautilus_tree_model_monitor_add):
	* libnautilus-extensions/nautilus-directory-async.c:
	(remove_monitor_link), (dequeue_pending_idle_callback),
	(remove_callback_link_keep_data), (remove_callback_link):
	* libnautilus-extensions/nautilus-drag.c:
	(nautilus_drag_file_receive_dropped_keyword):
	* libnautilus-extensions/nautilus-file-changes-queue.c:
	(nautilus_file_changes_queue_get_change):
	* libnautilus-extensions/nautilus-thumbnails.c:
	(check_for_thumbnails):
	* src/file-manager/fm-properties-window.c:
	(property_button_toggled):
	* src/nautilus-window-manage-views.c: (handle_go_back),
	(handle_go_forward):
	* src/nautilus-window.c: (nautilus_add_to_history_list):
	Fixed a bunch of callers of g_list_remove_link to also free the
	removed link. This seems to be an error-prone API from glib.
	About half of the callers had it wrong.
	
	* src/nautilus-bookmark-list.c:
	(nautilus_bookmark_list_delete_item_at),
	(nautilus_bookmark_list_delete_items_with_uri):
	* src/nautilus-sidebar.c: (receive_dropped_keyword):
	Changed to use g_list_free_1 for clarity.
	
	* src/nautilus-location-bar.c: Coding style tweaks.
	
	* src/nautilus-main.c: (main): Run the self-checks a second time
	if they succeed the first time. More thorough check this way (make
	sure the test works even after it's been run once), and better to
	notice one-time vs. per-test leaks.
	
	* tools/leak-checker/nautilus-leak-checker.c: (g_slist_alloc),
	(g_slist_free), (g_slist_free_1), (g_mem_chunk_new),
	(g_mem_chunk_destroy), (g_mem_chunk_alloc), (g_mem_chunk_alloc0),
	(g_mem_chunk_free), (g_mem_chunk_clean), (g_mem_chunk_reset),
	(g_mem_chunk_print): Made the GSList and GMemChunk code dumb down
	when using the leak checker.

	* tools/leak-checker/nautilus-leak-checker.c: Added more symbols
	of "known to leak" functions so we can see the real leakers.

2000-09-22  Michael Engber  <engber@eazel.com>

	horizontal & vertical desktop gradient settings were
	being written out bassackwards: bug 3247.
	* libnautilus-extensions/nautilus-directory-background.c:
	(nautilus_directory_background_write_desktop_settings):

2000-09-22  Michael Engber  <engber@eazel.com>

	Sped up gradient drawing. Also changed the n-point
	gradient syntax to use a '%' to indicate percentage
	instead of a '|'.
	* icons/arlo/arlo.xml:
	* libnautilus-extensions/nautilus-background.c:
	(nautilus_background_destroy), (reset_cached_color_info),
	(ensure_gradient_buffered), (gradient_helper_v),
	(gradient_helper_h), (fill_canvas_from_gradient_buffer),
	(nautilus_background_draw), (draw_pixbuf_tiled_aa),
	(nautilus_background_draw_aa),
	(nautilus_background_set_color_no_emit):
	* libnautilus-extensions/nautilus-gdk-extensions.c:
	(nautilus_gradient_parse_one_color_spec),
	(nautilus_gradient_get_start_color_spec),
	(nautilus_gradient_get_end_color_spec):
	* libnautilus-extensions/nautilus-gdk-extensions.h:
	* libnautilus-extensions/nautilus-gnome-extensions.c:
	(nautilus_gnome_canvas_fill_rgb):
	* libnautilus-extensions/nautilus-gnome-extensions.h:

2000-09-22  Robey Pointer  <robey@eazel.com>

	* components/services/install/lib/eazel-install-object.c:
	(eazel_install_delete_downloads):
	* components/services/install/lib/eazel-install-protocols.c:
	(eazel_install_fetch_file), (real_arch_name),
	(get_search_url_for_package):
	* components/services/install/lib/eazel-install-rpm-glue.c:
	(eazel_install_start_transaction),
	(eazel_install_package_provides_compare),
	(eazel_install_package_modifies_provides_compare):

	Hack the installer lib to munge "i?86" => "i386" so as not to
	confuse the RPM queries.  (This can be removed later: the java
	team says they will do this munging themselves.)  Don't add
	duplicate entries to the downloaded_files GList.
	
	* components/services/install/lib/eazel-install-types.c:
	(categorydata_destroy_foreach):
	* components/services/install/lib/eazel-install-types.h:
	* components/services/install/lib/eazel-install-xml-package-list.c:
	(parse_category):
	* nautilus-installer/src/installer.c: (category_compare_func),
	(toggle_button_toggled), (eazel_install_get_depends),
	(eazel_installer_initialize):
	* nautilus-installer/src/installer.h:
	
	Add "depends" GList to CategoryData, so that the info about
	buttons in the bootstrap installer can be pulled out of the
	package-list.xml and not require a bogus 2nd XML file.  Add that
	extra parsing to the install lib XML parser and make it more
	robust.  Convert bootstrap installer to use the info in its new
	place and junk the redundant XML parser.

2000-09-22  Andy Hertzfeld  <andy@eazel.com>

	* src/nautilus-location-bar.c: (nautilus_location_bar_initialize),
	(nautilus_location_bar_update_label):
	at Arlo's request, right justified the location bar label, now
	that it switches between "location" and "go to".
	
2000-09-22  J Shane Culpepper  <pepper@eazel.com>

	* src/nautilus-first-time-druid.c: (druid_finished):

	Fixing urls for the first time druid so that they do
	not point to the eazel: redirect nonsense.

2000-09-22  Andy Hertzfeld  <andy@eazel.com>

	* src/file-manager/fm-icon-view.c: (fm_icon_view_destroy),
	(fm_icon_view_begin_loading):
	fixed bug 1038, sound file being previewed doesn't stop playing
	when the view switches, by explicitly terminating the sound process
	when the icon view is destroyed or a new directory is loaded.
	
2000-09-22  J Shane Culpepper  <pepper@eazel.com>

	* components/services/login/nautilus-view/nautilus-login-view.oafin
	fo:
	point eazel-pw to the change password dialog.  Will finish the full
	renaming a little later but needed to go ahead and use the correct uri.

2000-09-22  John Sullivan  <sullivan@eazel.com>

	Fixed bug 168 (Save and restore window position/size per
	directory)

	Note that this is only done when in "use separate windows
	for everything" mode. My brain broke trying to figure out
	how it could be used coherently in single-window mode.

	* libnautilus-extensions/nautilus-gtk-extensions.h:
	* libnautilus-extensions/nautilus-gtk-extensions.c:
	(sanity_check_window_geometry): New helper function, takes
	four coordinates and munges them if necessary to keep the
	window at least partially on screen and not ridiculously
	huge.
	(nautilus_gtk_window_set_initial_geometry): New function,
	sets the position/location of a window before it is shown
	after calling sanity_check_window_geometry on 
	top/left/width/height parameters.
	(nautilus_gtk_window_set_initial_geometry_from_string):
	New function, calls _set_initial_geometry after parsing
	geometry-as-string parameter and adjusting it for
	minimum-width and minimum-height parameters.
	
	* libnautilus-extensions/nautilus-metadata.h:
	#define new per-directory key for window geometry
	
	* src/nautilus-application.c:
	(nautilus_window_delete_event_callback): New function,
	calls nautilus_window_close.
	(nautilus_application_create_window): Hook up this new
	callback as signal handler for window's delete_event;
	this causes closing the window from the close box go
	through the same nautilus_window_close path that closing
	the window from the menu did.
	
	* src/nautilus-bookmarks-window.c:
	(nautilus_bookmarks_window_restore_geometry):
	Now calls nautilus_gtk_window_set_geometry_from_string,
	which was extracted from here.
	
	* src/nautilus-window-manage-views.c:
	(position_and_show_window_callback): New function, reads
	geometry string for this location from metadata & applies
	it (if in use-new-window mode), then shows window.
	(nautilus_window_end_location_change_callback):
	Use nautilus_directory_call_when_ready to show the window
	only after the metadata has been read, so it doesn't appear
	in one position and then bounce elsewhere.
	
	* src/nautilus-window-menus.c: (file_menu_new_window_callback):
	Removed gtk_widget_show from here. It wasn't necessary since
	the window is shown later after the URI is determined to be good,
	and doing it here prevented the window positioning code from
	working correctly.
	
	* src/nautilus-window-private.h: Moved some window geometry
	#defines in here.
	
	* src/nautilus-window.c: 
	(nautilus_window_save_geometry): New private function, reads
	the window geometry and stores it in the directory's metadata.
	(nautilus_window_close): Calls nautilus_window_save_geometry
	if we're in use-new-windows mode.

2000-09-22  Robin * Slomkowski  <rslomkow@eazel.com>

	* nautilus.spec.in: added --enable-more-warnings

2000-09-22  Pavel Cisler  <pavel@eazel.com>

	* tools/profiler/symbol-table.h:
	Tweak the profiler output adding a code address.

2000-09-22  Andy Hertzfeld  <andy@eazel.com>

	in response to user testing, made the location bar label switch to
	"Go to:" during input when the text doesn't match the uri.
	
	* src/nautilus-location-bar.h:
	added "last_location" field
	* src/nautilus-location-bar.c: (editable_key_press_callback),
	(destroy), (nautilus_location_bar_initialize),
	(nautilus_location_bar_set_location),
	(nautilus_location_bar_update_label):
	maintained last_location field; when anything changes, set the label
	to "location" if the contents match last_location and "goto"
	otherwise.
	
2000-09-21  Pavel Cisler  <pavel@eazel.com>

	* tools/profiler/nautilus-leak-symbol-lookup.C:
	Enable bfd symbol lookup.

2000-09-21  John Sullivan  <sullivan@eazel.com>

	Fixed bug 2598 ("Select All Files" should be insensitive in
	views that have 0 files)

	* src/file-manager/fm-directory-view.c: 
	(no_items_showing): New function, checks directory item
	count. I can trust this now that the directory item count
	filters the same way the directory view does, thanks to
	rebecka's recent change.
	(compute_menu_item_info): Use no_items_showing to set the
	sensitivity of "Select All Files".

2000-09-21  John Sullivan  <sullivan@eazel.com>

	Fixed bug 3236 (Window titles are indistinguishable in taskbar)

	Removed "Nautilus: " from the main Nautilus window and all
	the dialogs. Took this opportunity to standardize on book title
	capitalization for all dialog titles. Also softened the caveat
	text just a bit.

	* components/music/nautilus-music-view.c: (play_current_file):
	* components/rpmview/nautilus-rpm-view-install.c:
	(nautilus_rpm_view_install_done):
	* libnautilus-extensions/nautilus-file-operations.c:
	(handle_xfer_vfs_error), (handle_xfer_overwrite),
	(nautilus_file_operations_copy_move),
	(nautilus_file_operations_move_to_trash), (confirm_empty_trash):
	* libnautilus-extensions/nautilus-program-chooser.c:
	(nautilus_program_chooser_new),
	(nautilus_program_chooser_show_no_choices_message):
	* libnautilus-extensions/nautilus-stock-dialogs.c:
	(nautilus_info_dialog), (nautilus_warning_dialog),
	(nautilus_error_dialog), (nautilus_error_dialog_with_details),
	(nautilus_yes_no_dialog):
	* src/file-manager/fm-directory-view.c:
	(fm_directory_view_confirm_multiple_windows),
	(fm_directory_view_confirm_deletion), (confirm_delete_from_trash),
	(report_broken_symbolic_link):
	* src/file-manager/fm-error-reporting.c:
	(fm_report_error_renaming_file), (fm_report_error_setting_group),
	(fm_report_error_setting_owner),
	(fm_report_error_setting_permissions):
	* src/file-manager/fm-icon-text-window.c:
	(create_icon_text_window):
	* src/file-manager/fm-properties-window.c:
	(update_properties_window_title):
	* src/nautilus-application.c:
	(nautilus_application_check_user_directories):
	* src/nautilus-bookmarks-window.c: (create_bookmarks_window):
	* src/nautilus-first-time-druid.c:
	(nautilus_first_time_druid_show):
	* src/nautilus-property-browser.c: (emblem_image_file_changed),
	(add_background_to_browser):
	* src/nautilus-shell.c: (display_caveat):
	* src/nautilus-sidebar.c: (receive_dropped_uri_list):
	* src/nautilus-window-manage-views.c:
	(nautilus_window_update_title), (handle_unreadable_location),
	(report_content_view_failure_to_user),
	(report_sidebar_panel_failure_to_user),
	(nautilus_window_end_location_change_callback):
	* src/nautilus-window-menus.c: (forget_history_if_confirmed),
	(user_level_customize_callback), (show_bogus_bookmark_window):

2000-09-21  Pavel Cisler  <pavel@eazel.com>

	* tools/profiler/funcsummary.C:
	* tools/profiler/funcsummary.h:
	* tools/profiler/profile.C:
	* tools/profiler/profiledata.C:
	* tools/profiler/test.cpp:

	Profiler tweaks.
	Add volatile to make things thread safe.

2000-09-21  Darin Adler  <darin@eazel.com>

	Fixes to leaks and the leak checker.
	
	* libnautilus-extensions/nautilus-preference.c:
	(nautilus_self_check_preference): Unref an object that was
	leaking.
	* libnautilus-extensions/nautilus-string-list.c:
	(nautilus_self_check_string_list): Unref an object that was
	leaking.
	* libnautilus-extensions/nautilus-user-level-manager.c:
	(user_level_manager_destroy): Allow destroying.
	(unref_user_level_manager): Unref the user level manager.
	(user_level_manager_ensure_global_manager): Unref the user level
	manager at exit time.
	* src/nautilus-main.c: (main): Free the context even in the
	self-check case.
	* tools/leak-checker/nautilus-leak-checker.c:
	(nautilus_leak_record_malloc), (nautilus_leak_record_realloc),
	(nautilus_leak_record_free) : Don't gather stats on the blocks as
	the leaks are recorded. Instead build them at print time.
	(total_one_leak): Compute totals for printing.
	(create_bad_names_hash_table): Make a hash table to use to check
	if a name is one of the "allowed to leak" functions.
	(is_stack_crawl_good): Reject stack crawls from things that are
	allowed to leak. "good" here means "worth keeping".
	(print_one_leak): Don't print any "?" if there's only a single
	leak, since all levels of the stack crawl are valid then.
	(nautilus_leak_print_leaks): Filter out expected leaks.
	(g_list_alloc), (g_list_free), (g_list_free_1), (g_node_new),
	(g_nodes_free), (g_node_destroy): Versions of these functions that
	use malloc/free instead of mem. chunks so we can accurately gauge
	leaks of these data types.
	* tools/leak-checker/nautilus-leak-hash-table.h:
	* tools/leak-checker/nautilus-leak-hash-table.c:
	(nautilus_leak_hash_table_filter): Function for use by new
	filtering code.
	* tools/leak-checker/nautilus-leak-symbol-lookup.h:
	* tools/leak-checker/nautilus-leak-symbol-lookup.c:
	(nautilus_leak_get_function_name): Function for use by new
	filtering code.

2000-09-21  Arlo Rose  <arlo@eazel.com>

	* data/browser.xml:
	Added names to our colors, but will replace the colors later.

2000-09-21  Andy Hertzfeld  <andy@eazel.com>

	* icons/Makefile.am:
	* icons/gnome/Makefile.am:
	* icons/gnome/i-music.png:
	* icons/i-music.png:
	* icons/i-music-aa.png:
	* icons/i-spreadsheet.png:
	* icons/i-spreadsheet-aa.png:
	added Susan's new icons for spreadsheets and music, but moved the
	classic gnome ones into the gnome theme.
	
2000-09-21  Mathieu Lacage  <mathieu@eazel.com>

	* libnautilus-extensions/nautilus-bookmark.c:
	(bookmark_file_changed_callback): replace strcmp by
	nautilus_uri_matchs: this took me a lot of time to find 
	out.
	* libnautilus-extensions/nautilus-directory.c:
	(nautilus_directory_get_internal): remove is_canonical_uri
	* libnautilus-extensions/nautilus-file-utilities.c:
	(nautilus_uri_is_local_scheme), (nautilus_handle_trailing_slashes),
	(nautilus_make_uri_canonical), (nautilus_uri_is_canonical_uri),
	(nautilus_self_check_file_utilities): make nautilus know the difference
	between foo and foo/ so that we do not cache too aggressively.
	* libnautilus-extensions/nautilus-file-utilities.h: add prototype for
	nautilus_uri_is_canonical.

2000-09-21  Rebecca Schulman  <rebecka@eazel.com>
	Cut and pasted the gtkclist widget into
	nautilus.  Fixed bugzilla.eazel.com 481,
	to reflect user file filtering preferences
	in directory counts, and in the process,
	fixed bug 480.

	* configure.in:
	* cut-n-paste-code/widgets/.cvsignore:
	* cut-n-paste-code/widgets/Makefile.am:
	* cut-n-paste-code/widgets/gtkclist/.cvsignore:
	* cut-n-paste-code/widgets/gtkclist/Makefile.am:
	* cut-n-paste-code/widgets/gtkclist/gtkclist.c:
	* cut-n-paste-code/widgets/gtkclist/gtkclist.h:
	(COLUMN_FROM_XPIXEL), (LIST_WIDTH), (gtk_clist_get_type),
	(gtk_clist_class_init), (gtk_clist_set_arg), (gtk_clist_get_arg),
	(gtk_clist_init), (gtk_clist_construct), (gtk_clist_new),
	(gtk_clist_new_with_titles), (gtk_clist_set_hadjustment),
	(gtk_clist_get_hadjustment), (gtk_clist_set_vadjustment),
	(gtk_clist_get_vadjustment), (gtk_clist_set_scroll_adjustments),
	(gtk_clist_set_shadow_type), (gtk_clist_set_selection_mode),
	(gtk_clist_freeze), (gtk_clist_thaw),
	(gtk_clist_column_titles_show), (gtk_clist_column_titles_hide),
	(gtk_clist_column_title_active), (gtk_clist_column_title_passive),
	(gtk_clist_column_titles_active),
	(gtk_clist_column_titles_passive), (gtk_clist_set_column_title),
	(gtk_clist_get_column_title), (gtk_clist_set_column_widget),
	(gtk_clist_get_column_widget),
	(gtk_clist_set_column_justification),
	(gtk_clist_set_column_visibility),
	(gtk_clist_set_column_resizeable),
	(gtk_clist_set_column_auto_resize), (gtk_clist_columns_autosize),
	(gtk_clist_optimal_column_width):
	* src/file-manager/Makefile.am:
	Add include of the cut-n-paste-code directory,
	so we can access the clist.
	* libnautilus-extensions/Makefile.am:
	include the new static gtkclist library
	* libnautilus-extensions/nautilus-list.h:
	include the cut and pasted widget instead
	of the gtk one.
	
	* libnautilus-extensions/nautilus-directory-async.c:
	(get_filter_options_for_directory_count),
	(start_getting_directory_counts):
	Add command to get filtering options for gnome-vfs 
	based on user preferences.  This works niftily
	when preferences change thanks to the callbacks
	in fm_directory_view



2000-09-21  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 2090, Sidebar panel shrinks when back from text
	or image view to directory view.
		
	* src/nautilus-sidebar.c: (make_button_box),
	(nautilus_sidebar_update_buttons):
	Fixed logic where button centering was being shown
	at the wrong time, messing up spacing of sidebar panels.
	
	* components/image-viewer/nautilus-image-view.c: (redraw_view),
	(configure_size), (view_factory_common):
	Fixed cases where image data might be NULL.

2000-09-21  Robey Pointer  <robey@eazel.com>

	* components/services/install/lib/eazel-install-rpm-glue.c:
	* nautilus-installer/src/Makefile.am:
	* nautilus-installer/src/installer.c: (eazel_install_get_depends),
	(eazel_installer_initialize):
	* nautilus-installer/src/link.sh:
	* nautilus-installer/src/prescript:
	* nautilus-installer/src/proxy.c:
	* nautilus-installer/src/proxy.h:
	
	Add proxy autodetect from the nautilus first-time druid, and
	support for the install lib to use proxies.  Clean up some of the
	temp dir stuff for security reasons.
	
2000-09-21  Andy Hertzfeld  <andy@eazel.com>

	* libnautilus-extensions/nautilus-icon-canvas-item.c:
	(draw_stretch_handles_aa):
	
	fixed bugs 3084, 3119, 3134, icon stretch handles are not drawn
	in the right place or hit-tested properly, by removing some
	bogus offsets.
		
	fixed bugs 764 and 2626, icon stretching is way too slow, by only
	doing the relayout and update position when the stretching is
	finished, instead of doing it every time the mouse moves during
	the stretch.  Also, made it relayout if necessary after stretching
	is finished, like it was intending to do.
	
	* libnautilus-extensions/nautilus-icon-container.c:
	(icon_set_size), (nautilus_icon_container_move_icon),
	(continue_stretching), (end_stretching), (motion_notify_event),
	(nautilus_icon_container_unstretch):
	passed an "update_position" parameter through the various levels
	to control if it should issue the icon_position_changed signal and
	attempt the relayout
	
	* libnautilus-extensions/nautilus-icon-dnd.c: (handle_local_move):
	passed TRUE for the new update_position parameter to the move_icon call.
	* libnautilus-extensions/nautilus-icon-private.h:
	added an update position parameter to the move_icon call.
	
2000-09-21  Josh Barrow  <linuxfan@ionet.net>

	* icons/gnome/gnome.xml:
	Changed Gnome to GNOME.  GNOME is an acronym.

2000-09-21  Michael Engber  <engber@eazel.com>

	Move nautilus_gnome_canvas_draw_pixmap to nautilus-gnome-extensions 
	* libnautilus-extensions/nautilus-background.c:
	(draw_pixbuf_centered_aa), (draw_pixbuf_tiled_aa):
	* libnautilus-extensions/nautilus-gnome-extensions.c:
	(nautilus_gnome_canvas_draw_pixmap_helper),
	(nautilus_gnome_canvas_draw_pixmap_helper_alpha),
	(nautilus_gnome_canvas_draw_pixmap),
	(nautilus_gnome_canvas_fill_rgb):
	* libnautilus-extensions/nautilus-gnome-extensions.h:

2000-09-21  Pavel Cisler  <pavel@eazel.com>

	* libnautilus-extensions/nautilus-gdk-pixbuf-extensions.c:
	(nautilus_gdk_pixbuf_load):
	Handle GNOME_VFS_ERROR_EOF properly, now that we get this result
	instead of just relying on getting 0 bytes read.

2000-09-21  Darin Adler  <darin@eazel.com>

	* components/tree/nautilus-tree-model.c: (report_node_changed):
	Add ref/unref to fix problem with renaming.
	
	* src/check-nautilus: Add "--g-fatal-warnings" so tests fail if
	there are warning messages.

2000-09-21  Josh Barrow  <linuxfan@ionet.net>

	* icons/theme_preview.png:
	Goofed up the last icon and put the document icon to
	far to the right.  This made it where the icon was 
	being cut off when viewed.

2000-09-21  Josh Barrow  <linuxfan@ionet.net>

	* icons/theme_preview.png:
	Updated theme preview icon to better reflect what the
	actual theme looks like.

2000-09-21  Josh Barrow  <linuxfan@ionet.net>

	* components/music/mpg123_handler.c:
	Removed include of gdk_imlib.h

2000-09-21  Pavel Cisler  <pavel@eazel.com>

	* tools/profiler/Makefile:
	* tools/profiler/funcsummary.C:
	* tools/profiler/funcsummary.h:
	* tools/profiler/machine-profile.S:
	* tools/profiler/machine-profile.h:
	* tools/profiler/machine-profileP.h:
	* tools/profiler/nautilus-leak-symbol-lookup.C:
	* tools/profiler/nautilus-leak-symbol-lookup.h:
	* tools/profiler/profile.C:
	* tools/profiler/profile.h:
	* tools/profiler/profileP.h:
	* tools/profiler/profiledata.C:
	* tools/profiler/profiledata.h:
	* tools/profiler/symbol-table.h:
	* tools/profiler/test.cpp:
	* tools/profiler/totaltime.C:
	* tools/profiler/totaltime.h:
	
	First pass at a profiler that handles threading and shared libraries.
	Adapted from Corel's cprof.
	It works on my machine but there are still a quite a few hardcoded 
	things.

2000-09-20  Pavel Cisler  <pavel@eazel.com>

	* libnautilus-extensions/nautilus-file-operations.c:
	(parse_previous_duplicate_name), (make_next_duplicate_name):
	Fix a duplicate name generator bug that caused make check to fail.
	Remove some string pasting that would make localization impossible.
	Add better comments to duplicate name string fragments to make it clearer
	to localizers.

2000-09-21  Andy Hertzfeld  <andy@eazel.com>

	* data/browser.xml:
	fixed bug 3169, emblems should come last in property browser,
	by changing the order in the xml definition file.
	
2000-09-20  Andy Hertzfeld  <andy@eazel.com>

	* libnautilus-extensions/nautilus-gdk-pixbuf-extensions.c:
	(file_read_callback):
	
	fixed problem where background images were not being displayed. 
	Maciej recently fixed gnome-vfs to return EOF errors when appropriate;
	unfortunately, that broke nautilus_gdk_pixbuf_load_async, which was
	reading until it got an EOF but not returning the pixbuf if it got
	an error of any kind.  Fixed by checking for EOF and allowing it; a
	better fix might be to read the file size and only read the
	proper amount, which we might consider doing later.
	
2000-09-20  Robey Pointer  <robey@eazel.com>

	* components/services/trilobite/libtrilobite/trilobite-core-distrib
	ution.c: (determine_turbolinux_version):

	Add code to detect turbolinux version.
	
	* components/rpmview/nautilus-rpm-view-install.c:
	(nautilus_rpm_view_install_package_callback):
	* components/services/install/lib/eazel-install-protocols.c:
	(get_url_for_package), (get_search_url_for_package):

	Don't set an RPM server in the RPM view.  Detect no-server in the
	install lib and don't try to connect.
	
	* components/services/install/lib/eazel-install-rpm-glue.c:
	(uninstall_all_packages), (eazel_install_start_transaction):
	* components/services/trilobite/libtrilobite/trilobite-root-helper.
	c: (trilobite_root_helper_destroy), (trilobite_root_helper_start),
	(trilobite_root_helper_get_exit_code):
	* components/services/trilobite/libtrilobite/trilobite-root-helper.
	h:

	Fix result code of uninstall.  Try to check rpm child exitcode
	(though this won't work under userhelper, thanks userhelper).
	
2000-09-20  Maciej Stachowiak  <mjs@eazel.com>

	The following two NautilusDirectory fixes fix bugzilla.eazel.com
	bug 2894:
	
	* libnautilus-extensions/nautilus-directory-async.c
	(request_is_satisfied): Check for
	directory_loaded_set_notification as well as directory_loaded.

	(nautilus_directory_stop_monitoring_file_list): When we dump the
	file list, we also need to indicate that the directory is no
	longer loaded.

2000-09-20  Darin Adler  <darin@eazel.com>

	* src/Makefile.am:
	* src/nautilus-view-frame-nautilus-view.c:
	* src/nautilus-view-frame-private.h:
	* src/nautilus-view-frame.h:
	* src/nautilus-view-frame.c: (nautilus_view_frame_destroy_client),
	(nautilus_view_frame_load_client),
	(nautilus_view_frame_load_location),
	(nautilus_view_frame_stop_loading),
	(nautilus_view_frame_selection_changed),
	(nautilus_view_frame_title_changed):
	Removed some of the remains of the component_class machinery.
	NautilusViewFrame now is the frame for a NautilusView only.
	
	* src/file-manager/nautilus-indexing-info.c:
	(nautilus_indexing_info_show_dialog): Fixed a misplaced statement
	that results in bad code and an uninitialized variable warning.
	
	* tools/leak-checker/nautilus-leak-symbol-lookup.c:
	(nautilus_leak_find_symbol_in_map): Fixed handling of symbols for
	libraries where the bfd library doesn't find the information.

2000-09-20  Andy Hertzfeld  <andy@eazel.com>

	* icons/i-bookmark.png:
	* icons/i-bookmark-20.png:
	* icons/i-bookmark-missing.png:
	* icons/i-bookmark-missing-20.png:
	* icons/eazel/SearchWeb.png:
	
	updated icons from Susan
	
2000-09-20  Andy Hertzfeld  <andy@eazel.com>

	* icons/i-bookmark-20.png:
	* icons/i-bookmark-missing.png:
	fixed bug 1471, need real icons for bookmark and missing bookmark,
	by adding these new ones from Susan.
	
	* configure.in:
	* icons/Makefile.am:
	* icons/ardmore/.cvsignore:
	* icons/ardmore/Makefile.am:
	* icons/ardmore/ardmore.xml:
	* icons/ardmore/blueridge.png 
	* icons/ardmore/bluewall.png
	* icons/ardmore/i-directory-12.png 
	* icons/ardmore/i-directory-24.png 
	* icons/ardmore/i-directory-36.png 
	* icons/ardmore/i-directory-72.png 
	* icons/ardmore/i-directory-96.png 
	* icons/ardmore/i-directory-accept-12.png 
	* icons/ardmore/i-directory-accept-24.png 
	* icons/ardmore/i-directory-accept-36.png 
	* icons/ardmore/i-directory-accept-72.png 
	* icons/ardmore/i-directory-accept-96.png 
	* icons/ardmore/i-directory-accept.png 
	* icons/ardmore/i-directory.png
	* icons/ardmore/number_strip.png 
	
	added a new theme from Susan with realistic folders
	
2000-09-20  Rebecca Schulman  <rebecka@eazel.com>

	* src/nautilus-window-manage-views.c:
	(nautilus_window_end_location_change_callback):
	Added new "advice" for bug 1874, to provide advice.
	I am not sure what sort of advice we should be
	giving, so I welcome recommendations on this matter.

2000-09-20  Darin Adler  <darin@eazel.com>

	First step fixing storage leaks: Fixed some ref. count leaks of
	NautilusFile, NautilusDirectory, and NautilusScalableIcon.
	
	* components/tree/nautilus-tree-model.c: (remove_all_nodes):
	Unref the root node when we are done with it.
	(report_root_node_if_possible): Use report_node_changed for
	new nodes as well.
	(report_node_changed): Since a new node and a changed node are
	really the same, just use this instead of using a different call
	for added vs. changed.
	(nautilus_tree_model_directory_files_changed_callback): Ref
	the node when it's being added to the hash table. Get rid of
	the misguided code that would ref "because remove will unref"
	and instead use a more normal model.
	(nautilus_tree_model_directory_files_added_callback): Fix a
	storage leak in the case where we generate a warning. Changed it
	from a printf to a g_warning. Use report_node_changed for new
	nodes as well. Unref the node after adding it to use a more normal
	ref model; handles cases where it's already in there properly, for
	one thing.
	* components/tree/nautilus-tree-node.c:
	(nautilus_tree_node_set_parent): Changed an assert to a
	return_if_fail.
	
	* libnautilus-extensions/nautilus-bookmark.c:
	(nautilus_bookmark_update_icon): Change the code to take the fact
	that nautilus_icon_factory_get_icon_for_file yields a new ref into
	account to plug a NautilusScalableIcon leak.
	
	* src/nautilus-bookmark-parsing.c:
	(nautilus_bookmark_new_from_node): Unref the icon after creating a
	new bookmark. If the bookmark needs to keep it, it will ref it.
	
	* src/file-manager/fm-icon-view.c: (get_icon_images_callback):
	Extra space in here.

2000-09-20  Darin Adler  <darin@eazel.com>

	* components/adapter/Makefile.am:
	* cut-n-paste-code/freetype/Makefile.am: Make the tinderbox a bit
	happier by mentioning some files that were missing from these
	makefiles.

2000-09-20  Darin Adler  <darin@eazel.com>

	* cut-n-paste-code/freetype/ftdebug.h: Fixed compiling with newer
	gcc. Freetype was trying to use token pasting to attach the name
	of a function (FTMessage) onto the parameters to that
	function. There's no need to attempt this, and it's incorrect. I
	removed the token pasting attempt. Perhaps Raph should get this
	rolled back into the main freetype soruces.
	
	* libnautilus-extensions/bonobo-stream-vfs.c: Cleaned up the code
	a bit to match Nautilus coding style and remove some redundant
	stuff.
	
	* libnautilus-extensions/nautilus-bookmark.c:
	(nautilus_bookmark_update_icon): Fixed a place where we unref the
	old value before ref'ing the new one. It's not really a bug, but
	it's a good habit to ref the new value first. Ran into this when
	I started looking for NautilusScalableIcon leaks.

2000-09-20  John Sullivan  <sullivan@eazel.com>

	* src/nautilus-complex-search-bar.c: (fewer_options_callback):
	Reinstated a less vile form of the queue_resize hack that had
	been here now that Rebecca and I discovered that without it the
	toolbar doesn't shrink correctly when the window is very wide.

2000-09-20  Rebecca Schulman  <rebecka@eazel.com>

	* po/POTFILES.in:
	Fixed a build problem that was caused by a removed
	file not being removed from here.
	* src/file-manager/nautilus-indexing-info.c:
	(nautilus_indexing_info_show_dialog):
	Add place-holder index progress indicator in the indexing
	info menu.  This will go when Arlo give

2000-09-20  John Sullivan  <sullivan@eazel.com>

	* src/nautilus-location-bar.c: (real_activate),
	(nautilus_location_bar_initialize_class): Wired
	up the location bar such that when it is swapped in
	its text field gets keyboard focus, just like the
	search fields.

2000-09-20  J Shane Culpepper  <pepper@eazel.com>

	* components/services/summary/nautilus-view/nautilus-summary-view.c
	: (generate_summary_form):

	Fixed several annoying gtk bugs while drawing boxes in the tables.

2000-09-20  Maciej Stachowiak  <mjs@eazel.com>

	Finally fixed bug 1994; in the process I think I also ended up
	fixing 2576, 2577, 2578, 2579 and 2580.

	* components/adapter/nautilus-adapter-embed-strategy.h,
	components/adapter/nautilus-adapter-embed-strategy.c: Abstract
	interface for embedding various kinds of Bonobo components.
	* components/adapter/nautilus-adapter-embed-strategy-private.h:
	Header inclusing a `protected' call to emit a signal.
	* components/adapter/nautilus-adapter-control-embed-strategy.h,
	components/adapter/nautilus-adapter-control-embed-strategy.c:
	Concrete subclass for embedding a Control.
	* components/adapter/nautilus-adapter-embeddable-embed-strategy.h,
	components/adapter/nautilus-adapter-embeddable-embed-strategy.c:
	Concrete subclass for embedding an Embeddable.
	* components/adapter/Makefile.am: Add new files.

	* components/adapter/nautilus-adapter-progressive-load-strategy.c
	(nautilus_adapter_progressive_load_strategy_load_location): Fixed
	incorrect GnomeVFSFIleInfo handling and removed a printf.

	* components/adapter/nautilus-adapter-stream-load-strategy.c:
	(nautilus_adapter_stream_load_strategy_load_location,
	nautilus_adapter_stream_load_strategy_stop_loading): Removed print
	statements.

	* components/adapter/nautilus-adapter.c:
	(nautilus_adapter_destroy): Free stuff.

	(nautilus_adapter_new): Use the new embed strategy stuff.
	
	(nautilus_adapter_open_location_callback): callback for signal
	handler attached to embed strategy.

	* src/nautilus-view-frame-bonobo-control.c,
	src/nautilus-view-frame-bonobo-embeddable.c: Removed.
	* src/nautilus-view-frame-private.h, src/Makefile.am: Remove
	mentions of the two preceding files.

	* src/nautilus-view-frame.c (nautilus_view_frame_load_client): Use
	the adapter to host non-nautilus-native components.

	* nautilus-clean.sh: Added image view.

2000-09-20  Michael Engber  <engber@eazel.com>

	Refactor/clean-up background blitting code
	* libnautilus-extensions/nautilus-background.c:
	(nautilus_copy_pixbuf_to_canvasbuf_helper),
	(nautilus_copy_pixbuf_to_canvasbuf_helper_alpha),
	(nautilus_copy_pixbuf_to_canvasbuf), (draw_pixbuf_centered_aa),
	(draw_pixbuf_tiled_aa):

2000-09-20  Darin Adler  <darin@eazel.com>

	* src/nautilus-location-bar.c: (drag_data_received_callback),
	(drag_data_get_callback): Fixed bug that happens when you drag the
	"Location:" part of the location bar. I still think the feature is
	of questionable value, but it was easy to fix it to keep it
	working. The bug resulted from making assumptions about the widget
	hierarchy.

2000-09-20  Darin Adler  <darin@eazel.com>

	Fixed bug that was preventing Show Properties from working.

	* libnautilus-extensions/nautilus-icon-factory.c: (cache_icon_new):
	Allow NULL for details to mean default details; keeps the fallback
	icon code simpler.
	(set_theme): A little more simplification.
	(load_icon_for_scaling): Fix the fallback icon to create the cache
	icon with cache_icon_new instead of rolling its own.

2000-09-20  Maciej Stachowiak  <mjs@eazel.com>

	* libnautilus-extensions/bonobo-stream-vfs.c (vfs_read): Handle
	GNOME_VFS_ERROR_EOF correctly.

2000-09-20  Darin Adler  <darin@eazel.com>

	* components/help/help-method.c: (shell_quote),
	(help_uri_to_string): Moved the shell quote function in here
	instead of trying to share the one in libnautilus-extensions. This
	fixes bug 3163 (Nautilus crashes any time a help item in the
	sidebar pane is double-clicked).

2000-09-20  Maciej Stachowiak  <mjs@eazel.com>

	* components/adapter/nautilus-adapter-file-load-strategy.c
	(nautilus_adapter_file_load_strategy_destroy): Another
	uninitialized variable.
	* components/adapter/nautilus-adapter-stream-load-strategy.c
	(nautilus_adapter_stream_load_strategy_destroy): Another
	uninitialized variable. Thanks to Will LaShell for pointing these
	out.

2000-09-20  Maciej Stachowiak  <mjs@eazel.com>

	* components/adapter/nautilus-adapter-progressive-load-strategy.c
	(nautilus_adapter_progressive_load_strategy_destroy): Fix
	unuinitialized variable use (thanks to Will LaShell).

2000-09-20  Maciej Stachowiak  <mjs@eazel.com>

	More work towards fixing bug 1994; in the process I think I might
	also end up fixing 2576, 2577, 2578 and 2579 (might also end up
	fixing 2580 later).
	
	* components/adapter/Makefile.am:

	* components/adapter/nautilus-adapter-load-strategy.h,
	components/adapter/nautilus-adapter-load-strategy.c: Abstract
	class that gives the interface for loading up a component that
	presents some particular interface.

	* components/adapter/nautilus-adapter-file-load-strategy.h,
	components/adapter/nautilus-adapter-file-load-strategy.c:
	Concrete subclass for loading a component that has the
	Bonobo::PersistFile interface.

	* components/adapter/nautilus-adapter-progressive-load-strategy.h,
	components/adapter/nautilus-adapter-progressive-load-strategy.c:
	Concrete subclass for loading a component that has the
	Bonobo::ProgressiveDataSink interface.

	* components/adapter/nautilus-adapter-stream-load-strategy.c,
	components/adapter/nautilus-adapter-stream-load-strategy.h:
	Concrete subclass for loading a component that has the
	Bonobo::PersistStream interface.

	* components/adapter/nautilus-adapter.h,
	components/adapter/nautilus-adapter.c:
	(nautilus_adapter_destroy, nautilus_adapter_new,
	nautilus_adapter_load_location_callback,
	nautilus_adapter_stop_loading_callback): Use load strategies.

	* libnautilus-extensions/bonobo-stream-vfs.c (vfs_read): Minor
	formatting correction.

2000-09-20  Andy Hertzfeld  <andy@eazel.com>

	* components/music/nautilus-music-view.c: (play_current_file):
	fixed bug 2374, music view crashes when attempting to play non-local
	files, by checking for non-local files and putting up a dialog instead.
	
	* src/nautilus-property-browser.c: (ensure_uri_is_image),
	(emblem_image_file_changed), (add_background_to_browser):
	fixed bug 3173, adding an svg background fails, by checking for it
	and not permitting it. Also made a few clean-ups.  We still need to
	be more robust when non-images get places in ~/.nautilus/backgrounds,
	which I'll work on soon.
	
2000-09-19  Maciej Stachowiak  <mjs@eazel.com>

	* libnautilus-extensions/nautilus-icon-factory.c (set_theme):
	Fixed an uninitialized variable use and cleaned up some nearby
	logic while I was at it.

	* src/nautilus-main.c (main): Removed a gratuitous puts call.

2000-09-19  Robey Pointer  <robey@eazel.com>

	* components/services/install/lib/eazel-install-object.c:
	(eazel_install_emit_delete_files_default):

	Since the default delete_files signal is the last called in the
	bootstrap installer (which kinda sucks), it should always return
	TRUE.
	
	* components/services/install/lib/eazel-install-rpm-glue.c:
	(eazel_install_download_packages),
	(eazel_install_start_transaction_make_rpm_argument_list):

	Don't always assume we're downgrading.  Make sure "--oldpackage"
	flag is passed to RPM when we are.
	
	* components/services/trilobite/libtrilobite/trilobite-core-utils.c
	: (trilobite_setenv):
	* libnautilus-extensions/nautilus-glib-extensions.c:
	(nautilus_setenv):

	Fix "=" bug in setenv.
	
	* nautilus-installer/src/installer.c: (eazel_installer_do_install),
	(eazel_installer_initialize):
	* nautilus-installer/src/main.c:
	* nautilus-installer/src/prescript:

	Set default CGI path for remote services (in the bootstrap
	installer) and make a command-line option for setting it.  Remove
	outdated /var stuff from the prescript.
	
2000-09-19  Mathieu Lacage  <mathieu@eazel.com>

	* src/file-manager/fm-list-view.c: (fm_list_receive_dropped_icons):
	doh, forgot to commit. This fixes a uninitialized variable.

2000-09-19  Andy Hertzfeld  <andy@eazel.com>

	* libnautilus-extensions/nautilus-icon-factory.c: (set_theme):
	fixed recently introduced bug where it would only use icons
	from the default theme.  Fixed by flipping the sense of a
	comparison in set_theme.
	
2000-09-19  John Sullivan  <sullivan@eazel.com>

	Fixed bug 1860 (Switching to complex search bar leaves
	navigation bar too tall forever)

	I never did fully figure out what was wrong, but I found
	a workaround, and added a FIXME (bug 3171) about the fact 
	that the need for the workaround isn't well-understood.

	* src/nautilus-switchable-navigation-bar.c:
	(nautilus_switchable_navigation_bar_set_mode):
	* src/nautilus-switchable-search-bar.c:
	(nautilus_switchable_search_bar_set_mode):
	Added gtk_widget_queue_resize calls on the GNOME_DOCK
	ancestor of the navigation bar and search bar when the
	contents are swapped.

2000-09-19  Andy Hertzfeld  <andy@eazel.com>

	added a new theme for the classic GNOME icons, and changed the
	default document icons to the ones from the eazel theme that can
	display embedded text.  This is a step on the way toward finishing
	the default theme.  I think Darin's recent check-in broke the
	icon factory so it only displays icons from the default theme; I'll
	try to fix that soon.
	
	* configure.in:
	added new gnome theme folder
	* icons/Makefile.am:
	added the document icons from the eazel theme to the default theme
	* icons/eazel/Makefile.am:
	removed the document icons from the eazel theme since it now
	inherits theme from the default theme
	* icons/eazel/i-regular.xml:
	removed the document xml file from the eazel theme 
	* icons/i-regular.xml:
	added the document xml file to the default theme
	
	* icons/gnome/.cvsignore:
	* icons/gnome/Makefile.am:
	* icons/gnome/gnome.xml:
	added new gnome theme for the classic gnome look, for people who
	prefer it.
	
2000-09-19  Darin Adler  <darin@eazel.com>

	Fixed bug 3157 (Going to a bogus URI crashes nautilus).
	
	* libnautilus-extensions/nautilus-directory-async.c:
	(nautilus_directory_async_state_changed): Add a ref/unref to keep
	the directory around even if call_when_ready results in the last
	ref to the directory going away.

2000-09-19  Darin Adler  <darin@eazel.com>

	Fixed bug 640 (icon cache never frees images (awaiting GdkPixbuf
	fix)). Also took care of bug 3146 (zillions of 'main_loops !=
	NULL' assertion failures when quitting) and bug 3138 (Some code in
	the icon factory is cut and pasted from elsewhere). And a few
	unrelated things that came up while I was busy working on these.

	* configure.in: Applied patch from Dan Winship to fix handling of
	CFLAGS and LDFLAGS. Fixes some missing quoting and other mistakes.
	
	* libnautilus-extensions/Makefile.am:
	* libnautilus-extensions/nautilus-icon-factory-private.h:
	* libnautilus-extensions/nautilus-thumbnails.c:
	* libnautilus-extensions/nautilus-thumbnails.h:
	Broke out the thumbnailing code into its own source file for
	clarity.
	
	* libnautilus-extensions/nautilus-directory.c:
	* libnautilus-extensions/nautilus-file-utilities.h:
	* libnautilus-extensions/nautilus-file-utilities.c:
	(nautilus_make_directory_and_parents):
	Moved nautilus_make_directory_and_parents into a place where the
	thumbnail code can share it instead of requiring its own copy.
	
	* libnautilus-extensions/nautilus-global-preferences.h:
	* libnautilus-extensions/nautilus-global-preferences.c:
	(destroy_global_prefs_dialog), (global_preferences_get_dialog),
	(nautilus_global_preferences_dialog_update),
	(nautilus_global_preferences_initialize):
	* libnautilus-extensions/nautilus-preferences.h:
	* libnautilus-extensions/nautilus-preferences.c:
	(preferences_initialize_if_needed), (preferences_shutdown):
	* src/nautilus-application.c: (nautilus_application_destroy):
	Changed code so that it cleans up with g_atexit instead of with an
	explicit shutdown call. This makes it sequence correctly with
	other atexit code.
	
	* libnautilus-extensions/nautilus-icon-canvas-item.h:
	* libnautilus-extensions/nautilus-icon-canvas-item.c:
	(nautilus_icon_canvas_item_destroy),
	(nautilus_icon_canvas_item_set_attach_points),
	(emblem_layout_next):
	* libnautilus-extensions/nautilus-icon-container.c:
	(nautilus_icon_container_update_icon):
	Added a Nautilus prefix to the EmblemAttachPoints typedef, since
	it's public.
	
	* libnautilus-extensions/nautilus-icon-factory.h:
	* libnautilus-extensions/nautilus-icon-factory.c:
	Changed the icon factory structure so that it will actually free
	pixbufs when done with them. Made some other small fixes to the
	icon factory in passing, including removing some redundant code
	and fixing the logic for getting custom icons and deleting the
	icon factory and g_atexit time.
	
	* src/file-manager/fm-icon-view.c: (play_file), (preview_sound):
	Restructured the logic for playing sound previews a little to get
	rid of compiler warnings and close some loopholes in the old code.
	
	* src/nautilus-main.c: (is_event_loop_needed),
	(quit_if_in_main_loop), (nautilus_gtk_main_quit_all),
	(event_loop_unregister), (nautilus_main_event_loop_register),
	(nautilus_main_is_event_loop_mainstay),
	(nautilus_main_event_loop_quit), (main): Fixed the main loop
	quitting logic so that it is a bit simpler and works with the
	gnome-vfs code that runs event handling after the last main loop
	is gone.

2000-09-19  John Sullivan  <sullivan@eazel.com>

	Fixed bug 2519 (fix hideous queue_size_request hack)
	
	* src/nautilus-complex-search-bar.c: (fewer_options_callback):
	It turns out that this most vile of lines was totally
	unnecessary, so I deleted it.

2000-09-19  J Shane Culpepper  <pepper@eazel.com>

	* components/services/summary/nautilus-view/nautilus-summary-view.c
	: (authn_cb_succeeded), (login_button_cb), (logout_button_cb),
	(logged_in_callback), (logged_out_callback):

	Removed the evil gtk_main_iteration crap so that the logged in state
	is much more reliable.  Hooked up the logout button to do the right thing.

2000-09-19  Michael Engber  <engber@eazel.com>

	First cut at speeding up background drawing. Images now scaled
	with interpolation and image drawing is faster.
	* libnautilus-extensions/nautilus-background.c:
	(ensure_image_scaled), (nautilus_background_image_fully_obscures),
	(nautilus_background_draw), (nautilus_art_rgb),
	(nautilus_art_rgb_rgba), (nautilus_draw_pixbuf_to_canvasbuf),
	(draw_pixbuf_centered_aa), (draw_pixbuf_tiled_aa),
	(nautilus_background_draw_aa), (load_image_callback):

2000-09-19  J Shane Culpepper  <pepper@eazel.com>

	* components/services/summary/nautilus-view/nautilus-summary-view.c
	: (generate_startup_form), (generate_summary_form),
	(authn_cb_succeeded), (authn_cb_failed), (am_i_logged_in),
	(preferences_button_cb):

	Fixed view so that it queries ammonite for its current login state
	and the login table is not drawn in a user is already logged in.

2000-09-19  Darin Adler  <darin@eazel.com>

	* components/image-viewer/io-png.c: (image_save): Use volatile to
	fix setjmp/longjmp vulnerability that was indicated by a GCC
	warning. For some reason this showed up only with new versions of
	lbpng.

2000-09-19  John Sullivan  <sullivan@eazel.com>

	Fixed bug 1244 (Nautilus window size is hardwired)
	Fixed bug 2870 (Windows are too tall for 1024x480 screen of
	Vaio C1XD picturebook)
	Fixed bug 3025 (Can't shrink window smaller than large initial size)

	* src/nautilus-window.c: 
	Added #defines for window minimum and default width & height.

	(get_max_forced_height), (get_max_forced_width): New helper
	functions, broken out of nautilus_window_size_request, that
	return the maximum dimensions a window should be programatically
	forced to. They return 90% of the screen width/height.
	
	(set_initial_window_geometry): New function, broken out of
	nautilus_window_constructed. Uses #defines and 
	get_max_forced_width/height to determine initial and minimum
	window sizes. Set policy so that user can stretch window smaller,
	but only down to sensible minimum size.
	(nautilus_window_constructed): call set_initial_window_geometry.
	(nautilus_window_size_request): call get_max_forced_width/height.

2000-09-19  Andy Hertzfeld  <andy@eazel.com>

	* libnautilus-extensions/nautilus-lib-self-check-functions.h:
	fixed build problem where someone apparently deleted nautilus-queue
	without deleting its self check function.  Fixed by deleting the check.
	
	* components/music/mpg123_handler.c: (start_playing_file):
	fixed bug 2262, nautilus doesn't play variable bit rate mp3s properly, by
	adding the "-y" parameter to the mpg123 invocation, as suggested to me
	by Jamie Manley in email.  This might also have fixed bug 2227, but I
	don't have vbr files to test with.
	
	* src/file-manager/fm-icon-view.c: (play_file):
	added the "-y" parameter to mpg123 invocations to play variable bit
	rate files better.  Also, fixed bug 2529 by checking for non-local
	files and not trying to play them.
	
2000-09-19  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 3019, renaming special icons should be
	impossible or harmless.

	You can't rename any NautilusLinks now.  This makes
	sense given the way we use them.
	
	* libnautilus-extensions/nautilus-file.c:
	(nautilus_file_can_rename):
	Add a check to see if file is NautilusLink.
	
	* src/file-manager/fm-icon-view.c: 
	(special_link_in_selection):
	Check and see if selection contains link files.
	
	(fm_icon_view_create_selection_context_menu_items):
	Call above funcion and disable rename if it returns TRUE.
	
2000-09-18  Maciej Stachowiak  <mjs@eazel.com>

	Fix bugzilla.eazelc.om 674 2052
	
	* components/loser/content/nautilus-content-loser.oafinfo,
	components/loser/sidebar/nautilus-sidebar-loser.oafinfo,
	components/sample/nautilus-sample-content-view.oafinfo: Set
	test_only attribute to TRUE.

	* src/nautilus-main.c (main): Enable test components if
	NAUTILUS_ENABLE_TEST_COMPONENTS evnironment variable is set.

2000-09-19  Yukihiro Nakai <nakai@gnome.gr.jp>

	* nautilus.desktop: Add Japanese entry

2000-09-18  J Shane Culpepper  <pepper@eazel.com>

	* components/services/summary/nautilus-view/nautilus-summary-view.c
	: (authn_cb_succeeded), (login_button_cb):

	Added a gtk_main_iteration to block for the corba callback so that
	login will wait until it gets a return value.  The summary view
	actually works now but is still pretty unreliable and throws lots
	of warnings.

2000-09-18  J Shane Culpepper  <pepper@eazel.com>

	* components/services/summary/lib/eazel-summary-shared.c:
	(parse_a_service), (parse_a_eazel_news_item),
	(parse_a_update_news_item):
	* components/services/summary/nautilus-view/nautilus-summary-view.c
	: (generate_startup_form), (authn_cb_succeeded), (authn_cb_failed),
	(login_button_cb), (nautilus_summary_view_load_uri):

	Removing some debugging code and checking state fixes for a logged in
	user.

2000-09-18  Mathieu Lacage  <mathieu@eazel.com>

	* components/tree/nautilus-tree-view.c: cleanup.
	* libnautilus-extensions/Makefile.am: remove nautilus-queue.c/h
	from build process.

2000-09-18  Robey Pointer  <robey@eazel.com>

	* components/services/install/lib/eazel-install-metadata.c:
	(init_default_transfer_configuration):
	* components/services/install/lib/eazel-install-object.c:
	(eazel_install_set_arg), (eazel_install_class_initialize),
	(eazel_install_new_with_config):
	* components/services/install/lib/eazel-install-protocols.c:
	(http_fetch_remote_file), (eazel_install_fetch_file),
	(eazel_install_fetch_package), (get_url_for_package),
	(get_search_url_for_package):
	* components/services/install/lib/eazel-install-public.h:
	* components/services/install/lib/eazel-install-types.h:
	* components/services/trilobite/doc/gconf.txt:
	* components/services/trilobite/libtrilobite/trilobite-core-utils.c
	: (trilobite_setenv):
	* components/services/trilobite/libtrilobite/trilobite-core-utils.h
	:

	Un-hardcoded the CGI path (for the RPM database server) and made
	it a gconf setting.  Use trilobite_setenv to set the user agent
	string.
	
2000-09-18  John Sullivan  <sullivan@eazel.com>

	Fixed bug 558 (Rubber-band selection of files in icon
	view gradually degrades)

	Now the menu-updating code does not run while rubberband
	selecting (but does run immediately thereafter).

	* libnautilus-extensions/nautilus-icon-container.h:
	* libnautilus-extensions/nautilus-icon-container.c:
	(start_rubberbanding), (stop_rubberbanding),
	(nautilus_icon_container_initialize_class): New signals
	"band_select_started" and "band_select_ended" emitted
	just when you'd expect.
	
	* src/file-manager/fm-directory-view.h:
	Prototypes for new functions (intended to be called only
	by subclasses) fm_directory_view_start_batching_selection_changes
	and fm_directory_view_stop_batching_selection_changes.
	
	* src/file-manager/fm-directory-view.c:
	Added details fields: guint batching_selection_level,
	gboolean selection_changed_while_batched, gboolean
	menu_states_untrustworthy
	(selection_contains_one_item_in_menu_callback),
	(selection_not_empty_in_menu_callback): New helper functions
	that report if the selection matches expectations and complain
	via g_warning if they don't match and we trust the menu state.
	(open_callback), (trash_callback), (duplicate_callback), 
	(create_link_callback),	(open_properties_window_callback):
	Use these new helper functions to verify that the menu state
	matches expectations but not crash if it doesn't.
	
	(schedule_update_menus): Change timeout back to idle now that
	it isn't affecting the band-select case; mark menu states as
	untrustworthy.
	(fm_directory_view_update_menus): mark menu states as
	trustworthy.

	(fm_directory_view_notify_selection_changed): If we're batching
	selection changes, remember that the selection changed; otherwise,
	do the work that you only do when not batching (update menus).
	
	(fm_directory_view_start_batching_selection_changes): Increment
	the batching level counter.
	(fm_directory_view_stop_batching_selection_changes): Decrement
	the batching level counter. If it reaches zero, and the selection
	changed while batched, call notify_selection_changed.
	
	* src/file-manager/fm-icon-view.c: 
	(band_select_started_callback): start batching selection changes.
	(band_select_ended_callback): stop batching selection changes.
	(create_icon_container): connect to band_select_started and
	band_select_ended signals of icon container.

2000-09-18  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 3018, should not be able to remove special icons
	from desktop.
	
	* libnautilus-extensions/nautilus-file-operations.c:
	(is_special_link):
	New function that checks if link is volume, home or trash.

	(nautilus_file_operations_copy_move):
	Call is_special_link() and prune special items from
	operation list.

2000-09-18  Arlo Rose  <arlo@eazel.com>

	* icons/throbber/008.png:
	Fixed a glitch in the image.

2000-09-18  Robey Pointer  <robey@eazel.com>

	* components/services/install/lib/eazel-install-xml-package-list.c:
	(parse_osd_xml_from_memory):

	Fix bugs 2862 & 2975 by fixing an off-by-one in the memory
	allocation and trimming whitespace from before and after the XML
	file (which makes libxml puke).
	
2000-09-18  J Shane Culpepper  <pepper@eazel.com>

	* components/services/summary/lib/eazel-summary-shared.c:
	(services_data_new), (parse_a_service), (parse_summary_xml_file):
	* components/services/summary/lib/eazel-summary-shared.h:
	* components/services/summary/nautilus-view/nautilus-summary-view.c
	: (generate_startup_form), (generate_summary_form),
	(authn_cb_succeeded), (login_button_cb), (register_button_cb):

	Pointing summary view to the real servers.  Lots of little state fixes
	to help generate real content.

2000-09-18  John Sullivan  <sullivan@eazel.com>

	Fixed bug 2243 (trash window name should be "Trash"
	with a capital T, localized)

	* libnautilus-extensions/nautilus-directory-private.h:
	Added prototype for nautilus_directory_get_
	name_for_self_as_new_file
	* libnautilus-extensions/nautilus-directory.h,
	* libnautilus-extensions/nautilus-directory.c:
	(nautilus_directory_initialize_class),
	(nautilus_directory_get_name_for_self_as_new_file),
	(real_get_name_for_self_as_new_file): wired up new
	overridable function pointer "get_name_for_self_as_new_file"
	that's used to get the name from directories that aren't
	vfs directories. Default implementation returns the scheme.
	
	* libnautilus-extensions/nautilus-file.c:
	(nautilus_file_get_internal): Use nautilus_directory_
	get_name_for_self_as_new_file instead of hardwiring
	scheme-getting logic here.
	* libnautilus-extensions/nautilus-trash-directory.c:
	(trash_get_name_for_self_as_new_file),
	(nautilus_trash_directory_initialize_class):
	Override get_name_for_self_as_new_file to return _("Trash").

	* src/nautilus-window-manage-views.c: 
	(compute_default_title): Use NautilusFile to get the
	default window title. Formerly it was using some similar
	but slightly different logic to what nautilus_file uses
	to get a name to display.

	* src/nautilus-window-menus.c: (help_menu_about_nautilus_callback):
	* AUTHORS: Gave credit where credit was due.

2000-09-18  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 3017, should not be able to copy desktop items

	Check for special desktop link types when specifying
	drag and drop actions.

	Disable Duplicate menu item.
	
	* libnautilus-extensions/nautilus-icon-dnd.c:
	(selection_includes_special_link),
	(nautilus_icon_container_receive_dropped_icons):
	* src/file-manager/fm-directory-view.c:
	(fm_directory_link_type_in_selection), (special_link_in_selection),
	(fm_directory_view_real_create_selection_context_menu_items):
	* src/file-manager/fm-directory-view.h:
	* src/file-manager/fm-icon-view.c:
	(fm_icon_view_create_selection_context_menu_items):

2000-09-18  Josh Barrow  <linuxfan@ionet.net>

	* README:
	* configure.in:
	* nautilus.spec.in:
	Remove instances of libwww, as it's no longer required.

2000-09-18  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 3029, Metafile shows up on desktop when
	"show invisible files" is on.

	Special files are now never shown on the desktop.
		
	* src/file-manager/fm-directory-view.c: 
	(queue_pending_files):
	Reset hidden file flags to false for the desktop case.
	
	(filtering_changed_callback):
	Reset hidden file flags to false for the desktop case
	and don't reload contents.

2000-09-18  John Sullivan  <sullivan@eazel.com>

	Fixed bug 2213 (Shouldn't be able to drop files into
	search results view)

	* libnautilus-extensions/nautilus-list.h:
	Added prototypes for nautilus_list_rejects_dropped_icons
	and nautilus_list_set_rejects_dropped_icons.
	* libnautilus-extensions/nautilus-list.c:
	New rejects_dropped_icons field in details.
	(nautilus_list_rejects_dropped_icons): new function,
	read from field.
	(nautilus_list_set_rejects_dropped_icons): new function,
	sets field.
	(nautilus_list_find_icon_list_drop_target): check field
	for early out. Also, renamed from find_drop_target for
	clarity.
	(nautilus_list_get_drop_action): Update for name change.

	* src/file-manager/fm-directory-view.h: New overridable
	function pointer accepts_dragged_files and function
	fm_directory_view_accepts_dragged_files.
	* src/file-manager/fm-directory-view.c:
	(fm_directory_view_initialize_class),
	(fm_directory_view_accepts_dragged_files),
	(fm_directory_view_real_accepts_dragged_files): Wire up
	fm_directory_view_accepts_dragged_files as a virtual
	function with default implementation that always returns
	TRUE.

	* src/file-manager/fm-list-view.c: (set_up_list):
	Call nautilus_list_set_rejects_dropped_icons with (opposite
	of) result of fm_directory_view_accepts_dragged_files.
	
	* src/file-manager/fm-search-list-view.c:
	(fm_search_list_view_initialize_class),
	(real_supports_creating_files), (real_accepts_dragged_files):
	Wire up override of accepts_dragged_files that returns FALSE.

2000-09-18  Pavel Cisler  <pavel@eazel.com>

	* src/file-manager/fm-directory-view.c:
	(fm_directory_view_destroy), (update_menus_idle_callback),
	(update_one_menu_item), (schedule_update_menus):
	Partial fix to bug 558- draging to select files gradually degrades.
	Turns out to be a bonobo bug. For now tweaked the way the menu updating
	code gets called to make it get called less to make the bug less visible.
	
2000-09-18  Mathieu Lacage  <mathieu@eazel.com>

	* libnautilus-extensions/nautilus-search-uri.c:
	(nautilus_self_check_search_uri): fix bug 2378.
	This was waaaay tougher than I expected: the translation 
	strings were actually good. The code did an evil cast between 
	2 slightly different structures which ended in strange 
	behaviour. Added a test for this. Thanks a lot Rebecca.

2000-09-18  Josh Barrow  <linuxfan@ionet.net>

	* README:
	Remove instances of gtkhtml as it isn't required any longer.

2000-09-17  Robey Pointer  <robey@eazel.com>

	* components/services/trilobite/libtrilobite/trilobite-core-utils.c
	: (trilobite_open_uri):
	* components/services/trilobite/libtrilobite/trilobite-redirect.c:
	(trilobite_redirect_parse_xml):

	Clean up whitespace on XML files for the pathetic libxml library,
	so it won't puke.  Add the hacky gnome-vfs env variable to set the
	user-agent string for fetching the XML file.

2000-09-17  Mathieu Lacage  <mathieu@eazel.com>

	* src/file-manager/fm-list-view.c: (fm_list_receive_dropped_icons):
	make it check if a target is begin copied into itself before doing 
	the actual file operation. ie: bug 3085
	* test/Makefile.am: add brand new test I used in my quest for bug
	1963
	* test/test-nautilus-background.c: (main): the actual test :)
	run and you will see beautiful background.

2000-09-17  Maciej Stachowiak  <mjs@eazel.com>

	More work towards bug 1994. I'm not yet checking in the code to
	actually use the adapter yet, but it sort of works on my system.
	
	* nautilus-clean.sh: Added nautilus-adapter

	* components/adapter/main.c (main): Do the stop in debugger
	trick. Also, initialize gnome-vfs (and threads). Duh!
	
	* components/adapter/nautilus-adapter-factory-server.c
	(impl_Nautilus_ComponentAdapterFactory_create_adapter):
	CORBA_Object_duplicate the object reference we return, because
	CORBA's just cool like that.
	
	* components/adapter/nautilus-adapter.c
	(nautilus_adapter_new): Show me the widgets, Lebowski. That's
	right, a few missing gtk_widget_show calls were the only bugs in
	this hairy mess of CORBA/Bonobo code (well, other than the obvious
	resource leaks).
	
	* components/adapter/nautilus-adapter.oafinfo: Updated to match
	reality.

	* libnautilus-extensions/nautilus-icon-factory.c
	(vfs_file_exists, nautilus_make_directory_and_parents,
	make_thumbnail_path, nautilus_icon_factory_get_thumbnail_uri,
	check_for_thumbnails): Put FIXMEs for a bunch of synchronous I/O
	that is making it a pain in the ass to test 1994.

	* src/nautilus-component-adapter-factory.c:
	Fill in the right IID.
	(nautilus_component_adapter_factory_initialize): Allocate the details.
	(nautilus_component_adapter_factory_create_adapter): Return the
	actual adapted view, not CORBA_OOBJECT_BIL (hello?).

	* src/nautilus-main.c (main): Add "ORBit" log domain to ones that
	stop in the debugger.
	
2000-09-17  Andy Hertzfeld  <andy@eazel.com>

	fixed bug 2319, "Find" and "Web Search" shouldn't have the same icon.  Fixed by
	adding a search web icon in the default and eazel themes, and changing the
	toolbar code to properly fetch them using the theme routines.
	
	* icons/Makefile.am:
	* icons/SearchWeb.png:
	added web search icon done by Susan in the standard style
	
	* icons/eazel/Makefile.am:
	* icons/eazel/SearchWeb.png:
	added web search icon done by Susan in the eazel theme style
	
	* libnautilus-extensions/nautilus-theme.c:
	(nautilus_theme_get_image_path):
	made nautilus_theme_get_image_path optinally supply a ".png" suffix if the
	passed in target doesn't have one.
	* src/nautilus-window-toolbars.c: (set_up_button),
	(set_up_toolbar_images):
	use theme-based image fetching when setting up the toolbar images
	
2000-09-17  Mathieu Lacage  <mathieu@eazel.com>

	* components/tree/nautilus-tree-view.c: remove auto-collapsing
	claenup the code. make it more readable (hopefully although
	I am less than hopeful).

2000-09-16  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 2450, We don't detect zip drives, etc.

	I added all filesystem types listed in man fstab and
	others that I found by reading various linux articles.
	There may be even more!  We can test these for now.
	
	* libnautilus-extensions/nautilus-volume-monitor.c:
	(nautilus_volume_monitor_volume_is_removable),
	(mount_volume_generic_set_state), (mount_volume_set_state),
	(mount_volume_activate_generic), (mount_volume_activate),
	(mount_volume_udf_add), (mount_volume_vfat_add),
	(mount_volume_msdos_add), (mount_volume_iso9660_add),
	(mount_volume_affs_add), (mount_volume_fat_add),
	(mount_volume_hpfs_add), (mount_volume_minix_add),
	(mount_volume_nfs_add), (mount_volume_proc_add),
	(mount_volume_smb_add), (mount_volume_unsdos_add),
	(mount_volume_xenix_add), (mount_volume_xiafs_add),
	(mnttab_add_mount_volume), (mntent_add_mount_volume):
	* libnautilus-extensions/nautilus-volume-monitor.h:

2000-09-16  Andy Hertzfeld  <andy@eazel.com>

	* libnautilus-extensions/nautilus-icon-factory.c:
	(nautilus_icon_factory_get_icon_name_for_regular_file):
	fixed problem that yakk told me about, where all the webdav files
	were getting the "www" icon; fixed by explicitly checking for the
	mime-type.
	
2000-09-16  Ali Abdin  <aliabdin@aucegypt.edu>

        * components/help/converters/gnome-db2html2/toc-elements.c:
        * components/help/converters/gnome-db2html2/sect-preparse.c:
        * components/help/converters/gnome-db2html2/sect-elements.c:
        * components/help/converters/gnome-db2html2/gdb3html.h:
        Apply patch submitted by John Fleck (jfleck@inkstain.net) for preface
        tag support

        * components/help/converters/gnome-db2html2/sect-elements.c:
        * components/help/converters/gnome-db2html2/toc-elements.c:
        (toc_title_start_element),
        (toc_title_end_element),
        (toc_title_characters),
        (sect_title_characters),
        (sect_title_start_element),
        (sect_title_end_element): Make these functions ignore the <important>
        tag. Fixes bug #2907

        * components/help/converters/gnome-db2html2/toc-elements.c:
        * components/help/converters/gnome-db2html2/gdb3html.c:
        * components/help/converters/gnome-db2html2/sect-elements.c:
        Change 'help:' URI's to 'gnome-help:' URIs (for better compliance to
        the RFC)

2000-09-16  Maciej Stachowiak  <mjs@eazel.com>

	More work towards 1994:

	* components/adapter/nautilus-adapter-factory-server.h,
	components/adapter/nautilus-adapter-factory-server.c:
	(nautilus_adapter_factory_server_initialize,
	nautilus_adapter_factory_server_destroy): minor cleanups
	(impl_Nautilus_ComponentAdapterFactory_create_adapter): Actually
	create some objects.
	(adapter_object_destroyed): Watch for object destruction, for
	factory lifecycle management purposes.

	* components/adapter/nautilus-adapter.h,
	components/adapter/nautilus-adapter.c: Initial implementation of
	class that does the actual adapting. For now, it only handles
	Embeddables that take input via PersistStream. Later I will apply
	the Strategy pattern to virtualize visual embedding (Control
	vs. Embeddable) and loading (PersistStream vs. PersistFile
	vs. ProgressiveDataSink) (and fix some missing bits in the
	embedding virtualization).

	* components/adapter/Makefile.am: Build the new files.
	
2000-09-16  Ramiro Estrugo  <ramiro@eazel.com>

	* components/mozilla/eazel-protocol-handler/eazel-protocol-module.cpp:
	* components/mozilla/mozilla-components.cpp:
	* components/mozilla/mozilla-preferences.cpp:
	Ok dumbass, you need to make this thing work with the old stuff too.
	
2000-09-16  Ramiro Estrugo  <ramiro@eazel.com>

	* components/mozilla/eazel-protocol-handler/eazel-protocol-module.cpp:
	* components/mozilla/mozilla-components.cpp:
	* components/mozilla/mozilla-preferences.cpp:
	Update for latest round of mozilla M18 changes.  Also removed an
	extra module registration entry I "accidentally" left in before.
	
2000-09-15  Andy Hertzfeld  <andy@eazel.com>

	* libnautilus-extensions/nautilus-file-utilities.c:
	(nautilus_make_uri_from_input):
	fixed bug 2204, ~ shortcut for home directory doesn't work
	in location bar, by expanding '~' and '~user' in make_uri_from_input
	* src/nautilus-location-bar.c: (try_to_expand_path):
	made the expand code handle '~' properly
	
2000-09-15  Robey Pointer  <robey@eazel.com>

	* components/services/trilobite/libtrilobite/trilobite-redirect.c:
	(trilobite_redirect_parse_xml), (trilobite_redirect_fetch_table):
	* components/services/trilobite/libtrilobite/trilobite-redirect.h:

	Make redirection XML parser in line with what services will
	provide.  Add extra API hook for Shane to cover the case where
	you've already downloaded the XML file and just want it to be
	parsed.
	
2000-09-15  Robey Pointer  <robey@eazel.com>

	* components/services/install/lib/eazel-install-rpm-glue.c:
	(eazel_install_download_packages),
	(eazel_install_do_install_packages):

	Fix bug in RPM glue that would case a failed download to get
	glossed over instead of aborting right then.  (Very annoying to
	download 500M of stuff and then find out that one of the first
	downloads silently failed.)
	
	* nautilus-installer/src/installer.c: (eazel_install_progress),
	(eazel_download_progress), (get_detailed_errors_foreach),
	(get_detailed_errors), (install_failed), (download_failed),
	(eazel_install_preflight), (eazel_install_dep_check),
	(check_system), (eazel_installer_do_install),
	(eazel_installer_finalize):
	* nautilus-installer/src/installer.h:

	Clean up installer: Fix a few crashes and make error-reporting
	more robust.  Add annoying calls to gtk_main_iteration() to make
	it update the screen.

2000-09-15  Arlo Rose  <arlo@eazel.com>

	* icons/eazel/Up.png:
	Fixed to not spew the whit epoint warning on startup.


2000-09-15  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 2194, no scrollbars in image view
	Fixed bug 2215, image viewer needs to erase background
	when loading image.

	I fixed these bugs by writing a new image component.  Is this bad?
	I don't know.  What is bad is the current state of the EOG bonobo
	component.  I don't think it is worth our time to fix it right now.
	This component will also support the zoomable interface when
	Maciej finishes the work there. It is doubtful the EOG bonobo
	component would have a Nautilus specific dependency.
	
	* components/Makefile.am:
	* components/image-viewer/.cvsignore:
	* components/image-viewer/Makefile.am:
	* components/image-viewer/io-png.c: (png_write_data_fn),
	(png_flush_fn), (image_save):
	* components/image-viewer/io-png.h:
	* components/image-viewer/nautilus-image-view.c:
	(release_pixbuf_cb), (release_pixbuf), (bod_destroy_cb),
	(get_pixbuf), (render_pixbuf), (redraw_view), (configure_size),
	(resize_all_cb), (view_update), (save_image_to_stream),
	(load_image_from_stream), (destroy_view),
	(zoomable_zoom_in_callback), (zoomable_zoom_out_callback),
	(zoomable_set_zoom_level_callback),
	(zoomable_zoom_to_fit_callback), (drawing_area_exposed),
	(view_size_allocate_cb), (scrolled_view_size_allocate_cb),
	(view_factory_common), (scaled_view_factory),
	(scrollable_view_factory), (bonobo_object_factory),
	(init_bonobo_image_generic_factory), (init_server_factory), (main):
	* components/image-viewer/nautilus-image-view.oafinfo:
	* configure.in:

	New files and functions.

2000-09-15  Mathieu Lacage  <mathieu@eazel.com>

	fix bug 2874
	* components/tree/nautilus-tree-view.c: remove color/background/emblem 
	dnd from the tree view.
	* libnautilus-extensions/nautilus-gtk-extensions.c:
	(nautilus_gtk_marshal_NONE__INT_POINTER_INT_INT_UINT): add function
	* libnautilus-extensions/nautilus-gtk-extensions.h: add prototype.
	* libnautilus-extensions/nautilus-list.c:
	(nautilus_list_initialize_class), (nautilus_list_get_drop_action),
	(nautilus_list_receive_dropped_icons),
	(nautilus_list_receive_dropped_keyword),
	(nautilus_list_drag_data_received): add support for keywords by
	changing the handle_dropped_icons event to handle_dropped_items
	* libnautilus-extensions/nautilus-list.h: change signal prototype.
	* src/file-manager/fm-list-view.c: (fm_list_receive_dropped_icons),
	(fm_list_receive_dropped_keyword), (fm_list_handle_dropped_items),
	(set_up_list): make it use the right signal and suppport both icon and 
	keyword drops.

2000-09-15  Arlo Rose  <arlo@eazel.com>

	* icons/knob.png:
	Put in a different knob.

2000-09-15  John Sullivan  <sullivan@eazel.com>

	Fixed bug 1563 (Optionally hide ~-suffix files created by emacs)
	Fixed bug 2274 (Implement Empty Trash confirmation preference)

	* libnautilus-extensions/nautilus-global-preferences.h:
	define NAUTILUS_PREFERENCES_CONFIRM_TRASH and 
	NAUTILUS_PREFERENCES_SHOW_BACKUP_FILES.
	* libnautilus-extensions/nautilus-global-preferences.c:
	(global_preferences_create_dialog): Put these two new preferences
	on the Directory Views page; rename it Folder Views.
	(global_preferences_register): Register default values for new
	preferences.
	* libnautilus-extensions/nautilus-preferences-dialog.c:
	Increase initial height of window to account for new preferences.
	There's an open bug about reorganizing the whole window for later.

	* libnautilus-extensions/nautilus-file-operations.c:
	(confirm_empty_trash): Don't confirm if preference says not to.
	* src/file-manager/fm-directory-view.c:
	(fm_directory_view_initialize), (fm_directory_view_destroy):
	Add & remove callbacks to monitor these two new preferences. 
	(queue_pending_files): Take SHOW_BACKUP_FILES preference into
	account.
	(file_name_from_uri): New helper routine to save a little code
	duplication.
	(fm_directory_view_confirm_deletion): Use yes_no dialog instead
	of simple dialog to match other usage; improve dialog title.
	(confirm_delete_from_trash): New function, confirms deleting
	items from trash unless preference says not to bother.
	(fm_directory_view_trash_or_delete_files): Call 
	confirm_delete_from_trash before deleting items from trash.
	(compute_menu_item_info): Do or don't add ellipses to "Empty Trash"
	and "Delete From Trash" depending on preference setting.
	(schedule_update_menus_callback): New function, simple wrapper for
	schedule_update_menus (called when CONFIRM_TRASH preference changes).
	(filtering_changed_callback): Renamed and slightly generalized from
	show_hidden_files_changed_callback, called when either the
	SHOW_HIDDEN_FILES or SHOW_BACKUP_FILES preference changes.

2000-09-15  Eli Goldberg  <eli@eazel.com>

	* docs/smoketests.html: Added a few steps to include breakages last week.

2000-09-15  Robin * Slomkowski  <rslomkow@eazel.com>

	* nautilus.spec.in: removed dependencie on eog because
	nautilus doesn't actually depend on it, but this will
	make the install not install eog onto someones system.

2000-09-15  J Shane Culpepper  <pepper@eazel.com>

	* components/services/install/nautilus-view/nautilus-service-instal
	l-view.c:
	* components/services/login/nautilus-view/nautilus-login-view.c:
	* components/services/summary/lib/eazel-summary-shared.c:
	(services_data_new), (update_news_data_new), (parse_a_service),
	(parse_a_update_news_item):
	* components/services/summary/lib/eazel-summary-shared.h:
	* components/services/summary/nautilus-view/nautilus-summary-view.c
	: (generate_startup_form), (generate_summary_form),
	(generate_service_entry_row), (generate_update_news_entry_row),
	(goto_service_cb), (goto_update_cb):

	Fixed Bug # 2630, 3054, and most of 2632 and 3051.  You probably
	will get a blank summary view now since the xml file lives on my
	local apache.  I will point it to the server generated one on
	Monday.

2000-09-15  John Sullivan  <sullivan@eazel.com>

	Fixed bug 2362 (Selecting "Add Bookmark" while loading a web
	page can crash)

	* src/nautilus-window-menus.c:
	(nautilus_window_add_bookmark_for_current_location): Removed
	incorrect assert comparing window->location and 
	window->current_location_bookmark. These can be out of synch
	here due to the evils of the state machine, but this function
	will be OK. Also, removed logic preventing adding multiple
	bookmarks for the same location, since it (A) doesn't match the
	behavior of other browsers; (B) might be annoying if you want
	to add several identical bookmarks and then hand-tweak them in
	the Edit Bookmarks window; (C) might be confusing if you don't
	notice the existing bookmark in the menu; and (D) won't make 
	sense when we fully support hierarchical bookmarks.

	* src/nautilus-window-manage-views.c:
	(check_last_bookmark_location_matches_window):
	Updated the comments on this debugging function, and changed
	its behavior from g_warning to g_error since the only known
	reasons for it complaining have recently been fixed.

2000-09-15  Darin Adler  <darin@eazel.com>

	Robin helped me fix up the spec. file. Take that, Tinderbox!
	
	* nautilus.spec.in: Removed nautilus-tree-view, top/*.xml, and
	icons/vector/*.png from the spec file.

2000-09-15  Andy Hertzfeld  <andy@eazel.com>

	* src/nautilus-first-time-druid.c:
	(nautilus_first_time_druid_show):
	fixed bug 2782, druid_welcome.png needs to be redone for each locale,
	by removing the image and using our nice, shadowed aa text instead.
	
	* icons/Makefile.am:
	removed icons/druid_welcome.png image, since it's no longer used

2000-09-15  Darin Adler  <darin@eazel.com>

	Another try at fixing the Tinderbox.

	* po/POTFILES.in: Removed files that are not in Makefile.am,
	since they won't be in the tarball/RPM.
	
	* check-POTFILES.pl: Added a new script to check for files that
	are mentioned in POTFILES.in, but not in the Makefile.am files.
	* check-headers-in-Makefile.pl: Fixed to use SUBDIRS instead of
	looking for all Makefile.am files.
	
	* components/adapter/.cvsignore: Listed generated files.

2000-09-15  John Sullivan  <sullivan@eazel.com>

	Fixed bug 1779 ("Customize Hacker Settings" doesn't match
	user level name)
	Fixed bug 2806 (User level names need to be localizable)
	Fixed bug 2838 (Settings message badly suited for translation)

	* libnautilus-extensions/nautilus-user-level-manager.h:
	* libnautilus-extensions/nautilus-user-level-manager.c:
	(user_level_manager_new), (user_level_manager_destroy),
	(user_level_set_default_if_needed),
	(nautilus_user_level_manager_set_user_level),
	(nautilus_user_level_manager_get_user_level),
	(nautilus_user_level_manager_get_user_level_name_for_display),
	(nautilus_user_level_manager_make_gconf_key),
	(user_level_manager_get_user_level_as_string): Split array of
	user level names & list that's made from it into two; one for
	gconf setting strings and one for user display. The user display
	one is marked for translation. Made "get_user_level_string"
	private since it had no callers and it's used only for the gconf
	manipulation (and it would have a confusing name if public).
	Changed _get_user_level_names to _get_user_level_name_for_display
	and made it return a single name rather than the whole set;
	that's how callers were using it anyway.
	
	* src/nautilus-first-time-druid.c:
	(make_hbox_user_level_radio_button), (set_up_user_level_page):
	Reworked to get user level names from user level manager rather
	than hardwiring them here.
	
	* src/nautilus-window-menus.c: (user_level_customize_callback),
	(add_user_level_menu_item), (nautilus_window_initialize_menus),
	(get_customize_user_level_string): Reworked to get user level
	names from user level manager rather than hardwiring them here.
	Also added some comments and tweaked the wording of the
	"Edit Beginner Settings" dialog at the suggestion of a localizer.

2000-09-15  John Sullivan  <sullivan@eazel.com>

	* libnautilus-extensions/nautilus-file-operations.c:
	(handle_xfer_vfs_error), (handle_xfer_overwrite),
	(nautilus_file_operations_copy_move),
	(nautilus_file_operations_move_to_trash): Tweaked a bunch
	of error message and dialog title wording.

2000-09-15  Maciej Stachowiak  <mjs@eazel.com>

	Some work towards 1994.
	
	* libnautilus-adapter/nautilus-adapter-factory.idl: Changed
	`object' argument to `component'.
	* configure.in: Generate Makefile for components/adapter
	directory.
	* components/Makefile.am: Add adapter subdir to build.

	* components/adapter/Makefile.am, components/adapter/main.c,
	components/adapter/nautilus-adapter-factory-server.c,
	components/adapter/nautilus-adapter-factory-server.h,
	components/adapter/nautilus-adapter.oafinfo: Skeleton for the
	adapter component.
	
2000-09-14  Pavel Cisler  <pavel@eazel.com>

	* libnautilus-extensions/nautilus-file-operations.c:
	(extract_string_until), (parse_previous_duplicate_name),
	(test_next_duplicate_name), (nautilus_self_check_file_operations):
	Make duplicate name generator tests localizable.
	Add tests for "foo (10000000000000000th copy)".
	Add more comments, tweak some names.

2000-09-14  J Shane Culpepper  <pepper@eazel.com>

	* components/services/summary/lib/eazel-summary-shared.c:
	(services_data_new), (update_news_data_new), (parse_a_service),
	(parse_a_eazel_news_item), (parse_a_update_news_item),
	(parse_summary_xml_file):
	* components/services/summary/lib/eazel-summary-shared.h:
	* components/services/summary/nautilus-view/Makefile.am:
	* components/services/summary/nautilus-view/nautilus-summary-view.c
	: (generate_startup_form):

	xml parser now works right and downloads the file into memory. spews
	lots of debugging code right now but very close to being done.

2000-09-14  Mathieu Lacage  <mathieu@eazel.com>

	* libnautilus-extensions/nautilus-file.c: add necessary header to
	make nautilus compile with new gnome-vfs

2000-09-14  Robey Pointer  <robey@eazel.com>

	* components/services/install/lib/eazel-install-protocols.c:
	(eazel_install_fetch_package_by_id), (get_url_for_package),
	(get_search_url_for_package):
	* components/services/install/lib/eazel-install-protocols.h:
	* components/services/install/lib/eazel-install-rpm-glue.c:
	(eazel_install_download_packages):
	* components/services/install/nautilus-view/nautilus-service-instal
	l-view.c: (nautilus_service_install_view_update_from_uri):

	Add support for package names of the type "id=NNN" where the id
	will refer to a specific RPM on the remote server.  Services wants
	this for the case when the user has clicked on a specific package.
	
	* components/services/trilobite/libtrilobite/trilobite-core-utils.c
	: (trilobite_fetch_uri):

	Fix bug in ghttp code that forgot to add a trailing null.
	
2000-09-14  Darin Adler  <darin@eazel.com>

	Fixed bug 3079 (Cannot copy or link files or folders with current
	build). This was just an || where there should be a &&.

	Also took another crack at making the tinderbox succeed.
	
	* libnautilus-extensions/nautilus-icon-dnd.c:
	(selection_includes_trash): Change || to &&. Oops.
	
	* nautilus.spec.in: Removed unused directories.
	* po/POTFILES.in: Removed unused files.

	* libnautilus-extensions/nautilus-drag.c:
	(nautilus_drag_drop_action_ask): Formatting tweak.

2000-09-14  Andy Hertzfeld  <andy@eazel.com>

	changed the default click policy from single click to double click as
	a result of our first wave of user testing
	
	* libnautilus-extensions/nautilus-global-preferences.c:
	(global_preferences_register):
	* libnautilus-extensions/nautilus-icon-canvas-item.c:
	(in_single_click_mode):
	* libnautilus-extensions/nautilus-icon-container.c:
	(button_press_event):
	* src/file-manager/fm-icon-view.c:
	(fm_icon_view_update_click_mode):
	* src/file-manager/fm-list-view.c:
	(fm_list_view_update_click_mode):

2000-09-14  Darin Adler  <darin@eazel.com>

	* libnautilus-extensions/nautilus-file-operations.c:
	(handle_xfer_vfs_error), (handle_xfer_overwrite),
	(nautilus_file_operations_copy_move),
	(nautilus_file_operations_move_to_trash): Fix wording and make it
	a little easier to translate some of these dialogs.  John said he
	will make a pass to make them even better, but I got rid of some
	of the egregious problems and added Nautilus: to all the titles.
	* libnautilus/nautilus-undo-transaction.c:
	(nautilus_undo_transaction_add_to_undo_manager): Tiny format
	tweak.
	* src/file-manager/fm-directory-view.c: Improved comment for
	localizers.

2000-09-14  John Sullivan  <sullivan@eazel.com>

	Fixed bug 2373 (Select All Files scrolls to bottom)
	Fixed bug 2624 (clicking to select a partly-obscured icon
	auto-scrolls, but shouldn't)
	Fixed bug 2612 (Part of icon view drawn in black when
	right-clicking on icon causes scroll)

	The key was separating reveal_selection from set_selection,
	and only calling reveal_selection when switching/loading
	views.

	* src/file-manager/fm-directory-view.h:
	* src/file-manager/fm-directory-view.c:
	(fm_directory_view_reveal_selection): New function, calls
	virtual function
	(fm_directory_view_initialize_class): initialize reveal_selection
	function to NULL, since it would be OK if a subclass did nothing.
	(display_pending_files): reveal selection after setting it in
	this case.
	* src/file-manager/fm-icon-view.c: 
	(fm_icon_view_reveal_selection): New function, extracted from 
	set_selection.
	(fm_icon_view_set_selection): Took out the reveal code.
	(fm_icon_view_initialize_class): Wire up reveal_selection.
	* src/file-manager/fm-list-view.c: 
	(fm_list_view_reveal_selection): New function, extracted from
	set_selection.
	(fm_list_view_set_selection): Took out the reveal code.
	(fm_list_view_initialize_class): Wire up reveal_selection.

2000-09-14  Mathieu Lacage  <mathieu@eazel.com>

	* components/tree/nautilus-tree-view.c: fix bug 2937.
	Tree view now autocollapses when you drag. Not a small 
	task...

2000-09-14  J Shane Culpepper  <pepper@eazel.com>

	* components/services/summary/nautilus-view/nautilus-summary-view.c
	: (generate_service_entry_row), (generate_eazel_news_entry_row),
	(generate_update_news_entry_row),
	(nautilus_summary_view_initialize):

	Fixing the background color on the startup form.

2000-09-14  Michael Engber  <engber@eazel.com>

	Cleaned up fixme's (bugs 2549, 2550, 2548) while
	working on a related background drawing bug.
	* libnautilus-extensions/nautilus-background-canvas-group.c:
	(nautilus_background_canvas_group_render):
	* libnautilus-extensions/nautilus-background.c:
	(nautilus_background_draw), (nautilus_background_draw_aa):

2000-09-14  Robey Pointer  <robey@eazel.com>

	* components/services/trilobite/doc/gconf.txt:
	* components/services/trilobite/libtrilobite/trilobite-redirect.c:
	(trilobite_redirect_fetch_table), (trilobite_redirect_lookup),
	(trilobite_get_services_address):
	* components/services/trilobite/libtrilobite/trilobite-redirect.h:

	Add documentation on gconf settings and add services-host setting
	so we can later change the default servier:port for Eazel
	services.  Fix API for downloading the redirection table.

2000-09-14  Ramiro Estrugo  <ramiro@eazel.com>

	* libnautilus-extensions/nautilus-scalable-font.c:
	(nautilus_text_layout_new):
	Remove a brain fart of mine that was causing a serious memory leak
	everytime the icon layout was computed.

2000-09-14  Gene Z. Ragan  <gzr@eazel.com>

	Fixed a crashing bug in the preligting code.
	
	* libnautilus-extensions/nautilus-ctree.c: (nautilus_ctree_event):
	Check for 0 when getting selected row.
	
2000-09-14  John Sullivan  <sullivan@eazel.com>

	Fixed unreported bug where the built-in bookmarks never
	displayed the first time after visiting any directory, 
	and reversed sense of the preference to avoid problems
	with defaults not working for global preferences.

	* libnautilus-extensions/nautilus-global-preferences.h:
	Changed preference from NAUTILUS_PREFERENCES_SHOW_BUILT_IN_BOOKMARKS
	to NAUTILUS_PREFERENCES_HIDE_BUILT_IN_BOOKMARKS
	* src/nautilus-bookmarks-window.c: (create_bookmarks_window),
	(synch_built_in_bookmarks_preference_and_checkbox): Updated
	for reversed preference.
	* src/nautilus-window-private.h:
	* src/nautilus-window-menus.c: (append_bookmark_to_menu),
	(refresh_bookmarks_menu),
	(nautilus_window_initialize_bookmarks_menu),
	(nautilus_window_remove_bookmarks_menu_callback),
	(refresh_bookmarks_menu_idle_callback),
	(schedule_refresh_bookmarks_menu): Updated for reversed
	preference. Also, deleted refresh_dynamic_bookmarks, which
	was broken (removed but didn't replace built-in bookmarks),
	and renamed *dynamic_bookmarks* -> *bookmarks_menu* to parallel
	names for go_menu calls.

2000-09-14  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 1984, Crash when closing a window after undo operation
	Fixed bug 2151, Segfault in undo manager during quit

	* libnautilus/nautilus-undo-transaction.c:
	(remove_transaction_from_atom_targets)
	New function that removes transaction list from target
	object and frees contents.
	
	(nautilus_undo_transaction_destroy),
	(nautilus_undo_transaction_undo):
	Call new function in these places.
	
2000-09-14  Darin Adler  <darin@eazel.com>

	Another cut at getting the tinderbox to be happy.
	
	* configure.in: Remove websearch directory.
	* nautilus.spec.in: Remove ntl-web-browser, ntl-web-search, and
	websearch directory pattern.
	* components/services/trilobite/sample/nautilus-view/Makefile.am:
	Fix typo (SUBDIR instead of SUBDIRS).
	
	* src/file-manager/fm-directory-view.c: (schedule_update_menus):
	Only schedule an update if the menus are already merged.
	Also made cosmetic changes.

2000-09-14  Josh Barrow  <linuxfan@ionet.net>

	* icons/Makefile.am:
	Oops!  Forgot to remove the Makefile.am reference to the
	tab files.

2000-09-14  Josh Barrow <linuxfan@ionet..net>

	* icons/tableft.png:
	* icons/tabright.png:

	Removed both of these files.  These files were from back
	in the day when Nautilus used those horrid white tabs.

2000-09-14  John Sullivan  <sullivan@eazel.com>

	Fixed bug 3043 (clicking on broken symbolic link tries
	to execute it).

	Now clicking on it brings up a dialog telling the user
	about the missing target file and asking whether they
	want to throw the link away. Also, I changed the type
	string for link files to be "link to <whatever>" instead
	of just "<whatever>", and "link (broken)" for broken ones.

	* libnautilus-extensions/nautilus-file-attributes.h:
	define NAUTILUS_FILE_ATTRIBUTE_FILE_TYPE for callers
	interested in GnomeVFS's concept of file type.
	* libnautilus-extensions/nautilus-directory-async.c:
	(set_up_request_by_file_attributes): Get file_info if
	NAUTILUS_FILE_ATTRIBUTE_FILE_TYPE is requested.
	* libnautilus-extensions/nautilus-file.h,
	* libnautilus-extensions/nautilus-file.c:
	(type_as_string_considering_link): New function,
	converts target-type to link-type string if necessary.
	(nautilus_file_get_type_as_string): Deploy
	type_as_string_considering_link at each return location.
	(nautilus_file_is_broken_symbolic_link): New public function.
	* libnautilus-extensions/nautilus-icon-factory.c:
	(nautilus_icon_factory_get_icon_name_for_file): Added comment.
	* src/file-manager/fm-directory-view.c: 
	(fm_directory_view_trash_or_delete_files): Renamed from
	..._selection since it is passed the list of files.
	(trash_callback): Updated for name change.
	(report_broken_symbolic_link): New function, puts up dialog.
	(activate_callback): Calls report_broken_symbolic_link if
	appropriate.
	(fm_directory_view_activate_file): include 
	NAUTILUS_FILE_ATTRIBUTE_FILE_TYPE in list to pass to call_when_ready.

2000-09-14  Darin Adler  <darin@eazel.com>

	Some fixes to "make dist" to make the tinderbox happy.

	* components/rpmview/Makefile.am:
	* components/tree/Makefile.am:
	* libnautilus-extensions/Makefile.am:
	* src/Makefile.am:
	Added missing .h files.
	
	* src/file-manager/.cvsignore:
	Ignore some ancient generated files.
	
	* libnautilus-extensions/nautilus-gtk-extensions.c:
	(nautilus_gtk_label_make_bold): Formatting tweak.
	(nautilus_gtk_widget_set_foreground_color): Don't set the base
	color when you set the foreground. The base is more like the
	background color.
	* libnautilus-extensions/nautilus-volume-monitor.c:
	(mnttab_add_mount_volume): Formatting tweak.

2000-09-14  Darin Adler  <darin@eazel.com>

	To get started on a bug, I dismantled part of the state machine,
	which we can replace with something much simpler. Just doing this
	change seems to have fixed the bug I was going to tackle.

	Fixes bug 2170 (hitting the "up" button a lot of times in a row
	causes crash).

	* libnautilus-extensions/nautilus-file-utilities.c:
	(nautilus_self_check_file_utilities): Quick tweak to these tests.
	We need more thorough tests of nautilus_make_uri_from_input.
	
	* libnautilus-extensions/nautilus-search-bar-criterion-private.h:
	Removed this long-obsolete file. There's another copy in the src
	directory that's the "real" one.
	
	* src/file-manager/fm-directory-view.c:
	(fm_directory_view_destroy): Fixed a problem I was seeing
	switching out of the list view by emptying the "pending" lists so
	doing the stop as part of destroy will not add items to the view
	before destroying it.
	
	* src/nautilus-window-manage-views.c:
	(nautilus_window_free_load_info): Got rid of "action_tag",
	"made_changes", and "state".
	(nautilus_window_update_state): Turned "made_changes" into a local
	variable. Got rid of code setting "state" since nothing looked at
	it. Got rid of code that sets up an idle.
	(nautilus_window_set_state_info): Eliminated "do_sync" and made
	the function always keep running update_state until it's done
	instead of using an idle.
	(nautilus_window_end_location_change_callback): Got rid of FIXME
	since I now understand why gtk_object_destroy is OK for windows.
	
	* src/nautilus-window.h: Eliminated "action_tag", "made_changes",
	and "state".
	
	* src/nautilus-window.c: (nautilus_window_destroy): No need to
	deal with "action_tag" any more.
	(window_update_sidebar_panels_from_preferences): Remove excess
	unref that's not needed now that we have more careful handling of
	sidebar references.

2000-09-14  John Sullivan  <sullivan@eazel.com>

	Fixed bug 3072 (crash right-clicking in icon view background)

	* src/file-manager/fm-icon-view.c: (compute_menu_item_info):
	Fixed mistake in assert. *return_name != NULL should have
	been return_name != NULL. This caused an intermittent assertion
	failure (reproducible for some people).

2000-09-14  John Sullivan  <sullivan@eazel.com>

	Fixed bug 3071 (zoom control right-click menu doesn't work)

	The recent change from doubles to floats broke this, because
	some function pointers had been cast to gpointer so that the
	compiler didn't notice that they were casting CORBA_float to 
	CORBA_double.

	* libnautilus/nautilus-zoomable.c:
	(impl_Nautilus_Zoomable__get_zoom_level),
	(impl_Nautilus_Zoomable__set_zoom_level),
	(impl_Nautilus_Zoomable__get_min_zoom_level),
	(impl_Nautilus_Zoomable__get_max_zoom_level),
	(impl_Nautilus_Zoomable__get_is_continuous),
	(impl_Nautilus_Zoomable__get_preferred_zoom_level_list),
	(impl_Nautilus_Zoomable_zoom_in),
	(impl_Nautilus_Zoomable_zoom_out),
	(impl_Nautilus_Zoomable_zoom_to_fit),
	(impl_Nautilus_Zoomable__destroy):
	Removed (gpointer) function casts by passing parameters
	of the required type and casting them inside each function.
	Then changed CORBA_double to CORBA_float wherever it was
	used.
	
	* src/nautilus-zoom-control.c: (create_zoom_menu_item):
	Changed menu items in zoom control popup to use the
	"always show toggle" style like all of our other
	toggleable menu items.

2000-09-14  Pavel Cisler  <pavel@eazel.com>

	* libnautilus-extensions/nautilus-file-operations.c:
	(extract_string_until), (parse_previous_duplicate_name),
	(make_next_duplicate_name), (get_duplicate_name),
	(get_next_duplicate_name), (handle_xfer_duplicate),
	Add new smart duplicate name generator.
	Fixes bugzilla 2592, 2363, 2701.

	* libnautilus-extensions/nautilus-file-operations.c:
	(nautilus_self_check_file_operations),
	(test_next_duplicate_name):
	* libnautilus-extensions/nautilus-lib-self-check-functions.h:
	Add a test rig for the new code.

2000-09-14 Seth Nickell  <seth@eazel.com>
	
	* libnautilus-extensions/nautilus-volume-monitor.c:
	(mnttab_add_mount_volume):
	Fixed minor compile problem on Solaris dealing with
	mount table structure names.

2000-09-14  J Shane Culpepper  <pepper@eazel.com>

	* components/services/Makefile.am:
	* components/services/inventory/nautilus-view/nautilus-inventory-vi
	ew.c: (generate_inventory_form), (make_http_post_request),
	(go_to_uri):
	* components/services/startup/.cvsignore:
	* components/services/startup/Makefile.am:
	* components/services/startup/command-line/.cvsignore:
	* components/services/startup/command-line/Makefile.am:
	* components/services/startup/nautilus-view/.cvsignore:
	* components/services/startup/nautilus-view/Makefile.am:
	* components/services/startup/nautilus-view/main.c:
	* components/services/startup/nautilus-view/nautilus-service-startu
	p-view.c:
	* components/services/startup/nautilus-view/nautilus-service-startu
	p-view.h:
	* components/services/startup/nautilus-view/nautilus-service-startu
	p-view.oafinfo:
	* components/services/summary/nautilus-view/nautilus-summary-view.c
	: (generate_startup_form), (generate_startup_form_logo),
	(generate_summary_form), (nautilus_summary_view_load_uri):
	* components/services/summary/nautilus-view/nautilus-summary-view.o
	afinfo:
	* configure.in:

	Merging startup and summary into a single view. Deleted the original
	startup view.  Removed inventory view from daily builds since it is
	going to be moved out of the nautilus module.
	Removed some invalid FIXMEs from inventory since it will be completely
	rewritten.

2000-09-13  J Shane Culpepper  <pepper@eazel.com>

	* components/services/summary/nautilus-view/nautilus-summary-view.c
	: (generate_summary_form), (generate_service_entry_row),
	(generate_update_news_entry_row):

	More ui tweaks before the big startup / summary merge.

2000-09-13  Robey Pointer  <robey@eazel.com>

	* components/rpmview/nautilus-rpm-view-install.c:
	(nautilus_rpm_view_download_progress_signal),
	(nautilus_rpm_view_install_progress_signal),
	(nautilus_rpm_view_download_failed), (get_detailed_errors_foreach),
	(get_detailed_errors), (nautilus_rpm_view_install_failed),
	(nautilus_rpm_view_uninstall_failed), (preflight_check),
	(nautilus_rpm_view_install_package_callback),
	(nautilus_rpm_view_uninstall_package_callback):
	* components/rpmview/nautilus-rpm-view.c:
	(nautilus_rpm_view_update_from_uri):
	* components/services/install/nautilus-view/nautilus-service-instal
	l-view.c: (dig_up_errors):

	Fix annoying fprintf's to debug messages.  Fix error message
	assembly on failed install/uninstall.  Catch new signals from the
	install library.  Turn on the verify button after an install.
	Sync up install error messages between RPM view and the install
	service a little bit.
	
2000-09-14  Josh Barrow  <linuxfan@ionet.net>

	* configure.in:
	Remove the check for gtkhtml, as it isn't build any more.

2000-09-13  Robey Pointer  <robey@eazel.com>

	* components/services/install/lib/eazel-install-corba-callback.c:
	(impl_uninstall_failed):
	* components/services/install/lib/eazel-install-object.c:
	(eazel_install_uninstall_packages),
	(eazel_install_revert_transaction_from_xmlstring):
	* components/services/install/lib/eazel-install-rpm-glue.c:
	(eazel_install_monitor_rpm_propcess_pipe):

	Fix copy-and-paste error where the uninstall_failed callback was
	actually triggering the install_failed signal.  Make sure a failed
	uninstall or revert actually return a fail condition.  Clean up
	possible warning debug messages (read from rpm pipe).
	
Wed Sep 13 22:06:55 2000  George Lebl <jirka@5z.com>

	* libnautilus-extensions/nautilus-druid.c
	  (nautilus_druid_size_request):  After some investigation found that
	  fixme (#2553) was complete bollocks, so I removed it.

	* libnautilus-extensions/nautilus-file.c (nautilus_file_get_uri):
	  Apparently my current alpha compiler (egcs 1.1.2) is now more
	  sensitive to uninitialized vars.  This one is harmless, since there
	  was a g_assert_not_reached for the case where it's uninited.

	* libnautilus-extensions/nautilus-scalable-font.c (invert_glyph),
	  librsvg/test-ft-gtk.c (invert_glyph):
	  YAIKES! casting to to (int) to get artithmetic.  Changed to (long)
	  but that's still Wrong(tm)

	* src/file-manager/fm-desktop-icon-view.c (get_sort_category):
	  remove the "char *link_type", as it wasn't ever used, it was
	  only freed thus causing havoc

2000-09-13  Josh Barrow  <linuxfan@ionet.net>

	* icons/Makefile.am:
	* icons/theme_preview.png:

	Added a theme_preview.png for the default theme.  Thanks
	to Kenneth Christiansen <kenneth@gnu.org> for this.  

2000-09-13  Rebecca Schulman  <rebecka@eazel.com>
	Fixed bug 2977, to remove anti-aliased text from the
	emblem menu

	* libnautilus-extensions/nautilus-customization-data.c:
	(nautilus_customization_data_new),
	(nautilus_customization_data_get_next_element_for_display):
	* libnautilus-extensions/nautilus-customization-data.h:
	Added additional value to customization data to return the
	correct label type depending on whether or not antialiased
	text and truncation were appropriate
	* src/nautilus-complex-search-bar.c:
	(load_find_them_pixmap_widget):
	indenting fix
	* src/nautilus-property-browser.c:
	(make_properties_from_directories):
	add parameter to customization data call
	
	* src/nautilus-search-bar-criterion.c: (get_emblem_location_for),
	(make_emblem_value_menu):
	Removed a bug that double freed an emblem value menu name

2000-09-13  Andy Hertzfeld  <andy@eazel.com>

	* libnautilus-extensions/nautilus-theme.c:
	(nautilus_theme_make_selector):
	fixed bug 2962, default theme doesn't use custom preview icon, by
	special-casing the default theme, which doesn't have it's own
	directory.
	
2000-09-13  Gene Z. Ragan  <gzr@eazel.com>

	Fixed a glitch with prelighting and mousedown.
		
	* libnautilus-extensions/nautilus-ctree.c: (nautilus_ctree_event),
	(nautilus_ctree_button_press), (nautilus_ctree_draw_expander),
	(row_new):

	* components/tree/nautilus-tree-view.c:
	Set the state of the in_hotspot flag on 
	button press and release.

2000-09-13  Darin Adler  <darin@eazel.com>

	* libnautilus-extensions/nautilus-program-choosing.c:
	(nautilus_launch_application_from_command):
	Add one last missing change for my previous bug fix.

2000-09-13  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 1595, Tree view collapsing triangle does not
	track mouse.

	* libnautilus-extensions/nautilus-ctree.c: (nautilus_ctree_event),
	(nautilus_ctree_draw_expander):

2000-09-13  John Sullivan  <sullivan@eazel.com>

	Fixed bug 3039 (Clicking in edited file name exits rename mode)

	* libnautilus-extensions/nautilus-icon-container.c:
	(button_press_event): Moved the grab_focus call until after
	the inherited call, and only do it if not in renaming mode.

2000-09-13  Darin Adler  <darin@eazel.com>

	Fixed bug 1462 (File names containing spaces don't launch right)
	and bug 2404 (Help uri needs to be escaped properly) by adding a
	function to quote for strings for shell. I chose a name an an
	implementation that matches the function that will be added to
	glib 2.0 for this purpose.

	* libnautilus-extensions/nautilus-glib-extensions.h:
	* libnautilus-extensions/nautilus-glib-extensions.c:
	(nautilus_shell_quote), (nautilus_self_check_glib_extensions):
	Add a shell_quote function and tests for it.

	* components/help/help-method.c: (help_uri_to_string): Call the
	new nautilus_shell_quote function.
	* libnautilus-extensions/nautilus-program-choosing.h:
	* libnautilus-extensions/nautilus-program-choosing.c:
	(nautilus_launch_application_parented): Use a URI by default, and
	a path only for applications that can't use URIs.
	(nautilus_launch_application_from_command): Quote the parameter
	for the shell with the new nautilus_shell_quote function.

2000-09-13  J Shane Culpepper  <pepper@eazel.com>

	* components/services/summary/nautilus-view/nautilus-summary-view.c
	: (generate_summary_form), (generate_service_entry_row):

	Quick snapshot of what I have done so that I can pick changes that
	fixed nautilus breakage.

2000-09-13  Andy Hertzfeld  <andy@eazel.com>

	* src/nautilus-sidebar-tabs.c: (draw_tab_piece_aa):
	fixed bug 2983, sidebar tabs don't handle missing images well, by
	checking for a null pixbuf in draw_tab_piece_aa.
	
2000-09-13  Darin Adler  <darin@eazel.com>

	Fixed uninitialized variable problems found by compiling with -O
	on. Thanks to Michael Meeks for pointing these out.
	
	* libnautilus-extensions/nautilus-icon-canvas-item.c:
	(draw_or_measure_label_text_aa): Added some otherwise-gratuitous
	code that will make the uninitialized-variable warning quiet down.
	* libnautilus-extensions/nautilus-volume-monitor.c:
	(nautilus_volume_monitor_mount_unmount_removable): Added some
	otherwise-gratuitous code that will make the
	uninitialized-variable warning quiet down.
	* src/file-manager/fm-icon-view.c: (insert_one_context_menu_item):
	Initialize a variable even in the "not reached" case.
	* src/nautilus-switchable-search-bar.c: (real_activate): Moved the
	default "not reached" case so that when asserts are off we don't
	have an uninitialized variable bug.

2000-09-13  Darin Adler  <darin@eazel.com>

	Fixed the ref. count problem that was causing crash on startup
	with sidebar panels on. Sorry, I was a bit careless with my
	earlier check-in.

	* src/nautilus-window.c: (nautilus_window_add_sidebar_panel),
	(nautilus_window_remove_sidebar_panel): Keep a reference to a sidebar
	panel as long as it's in the sidebar panel list.
	(window_update_sidebar_panels_from_preferences): Got rid of an extra
	ref in this code that's no longer needed.

	* src/nautilus-window-manage-views.c:
	(nautilus_window_has_really_changed): Turned sidebars back on.
	(report_sidebar_panel_failure_to_user): Added _() around some strings
	that require translation.
	(nautilus_window_update_state): Used nautilus_gtk_object_list_free to
	save some code.

	* libnautilus-extensions/nautilus-file.c:
	(get_id_from_digit_string): Made this function simpler by using
	a local variable instead of g_new.
	
	* libnautilus-extensions/nautilus-glib-extensions.h:
	* libnautilus-extensions/nautilus-glib-extensions.c:
	(nautilus_setenv), (nautilus_unsetenv): Renamed to get rid of the
	gratuitous g prefix. Also fixed some comments to be more accurate.
	Added a prototype for a shell escape function -- haven't written
	the function yet, but I will shortly.
	
	* src/nautilus-first-time-druid.c:
	(next_proxy_configuration_page_callback), (set_http_proxy),
	(attempt_http_proxy_autoconfigure): Take out some g_message calls
	and use the nautilus_setenv call by its new name.
	* src/nautilus-main.c: (main): Use nautilus_unsetenv by the new name.
	* src/nautilus-shell.c: (corba_restart): Use nautilus_setenv by
	the new name.
	
2000-09-13  Andy Hertzfeld  <andy@eazel.com>

	* src/nautilus-zoom-control.c: (draw_number):
	fixed bug 2181, number in zoom control is left justified at first.
	Fixed by using the widget->allocation.width in the centering
	calculation, instead of the passed-in box width.
	
2000-09-13  Andy Hertzfeld  <andy@eazel.com>

	* src/nautilus-window-manage-views.c:
	(nautilus_window_has_really_changed):
	Temporarily disabled sidebar panels so that Nautilus doesn't crash
	on startup. Darin or Maciej will need to do a real fix.

2000-09-13  Gene Z. Ragan  <gzr@eazel.com>

	More work on tree view UI issues.
	
	* libnautilus-extensions/nautilus-ctree.c:
	(nautilus_ctree_class_init), (nautilus_ctree_init),
	(nautilus_ctree_event), (nautilus_ctree_draw_expander),
	(nautilus_ctree_draw_node):
	* libnautilus-extensions/nautilus-ctree.h:

2000-09-13  Michael Engber  <engber@eazel.com>

	Added a fixme + misc cleanup while investigating
	bugs 3022 and 3038
	* libnautilus-extensions/nautilus-background.c:
	(nautilus_background_set_image_uri_no_emit),
	(nautilus_background_set_image_uri),
	(nautilus_background_receive_dropped_background_image):
	* libnautilus-extensions/nautilus-directory-background.c:
	(nautilus_directory_background_read_desktop_settings),
	(nautilus_directory_background_event_filter):

2000-09-13  Darin Adler  <darin@eazel.com>

	Fixed bug 2916 "Shouldn't be able to create new items in trash."

	* libnautilus-extensions/nautilus-file.c:
	(nautilus_file_is_in_trash): Made this return TRUE for the trash
	itself.

2000-09-13  Darin Adler  <darin@eazel.com>

	* libnautilus-extensions/nautilus-file.c:
	(nautilus_file_get_string_attribute_with_default),
	(nautilus_file_get_top_left_text): Unmark strings that are
	unlikely candidates for localization at the request of one of the
	translators (menthos).
	
	* libnautilus-extensions/nautilus-icon-canvas-item.c:
	(draw_or_measure_label_text), (draw_or_measure_label_text_aa):
	Move line break characters into a separate string constant, in
	part to make the comment about why it's localizable appear in the
	pot file.
	
	* src/file-manager/fm-properties-window.c:
	(directory_contents_value_field_update): Unmark strings that are
	unlikely candidates for localization at the request of one of the
	translators (menthos).

2000-09-13  J Shane Culpepper  <pepper@eazel.com>

	* components/services/nautilus-dependent-shared/icons/Makefile.am:
	* components/services/summary/nautilus-view/nautilus-summary-view.c
	: (generate_summary_form), (generate_service_entry_row),
	(generate_eazel_news_entry_row), (generate_update_news_entry_row),
	(maintenance_button_cb):

	More work on the summary view xml voodoo.  Still a few more problems
	but getting close to complete.

2000-09-13  Darin Adler  <darin@eazel.com>

	Fixed bugs in Nautilus link management, some other minor problems
	I encountered along the way, and did the first cut at a state
	machine for NautilusViewFrame based on Maciej's design that can
	mostly replace the super-complicated one for NautilusWindow.

	* README: We no longer can use the ORBit that comes with HC1.2
	with cvs HEAD, since warnings have been fixed in the code
	generated by the newer ORBit, so fix that line in the README.
	
	* libnautilus-extensions/nautilus-directory.c:
	(nautilus_directory_new): Use the new nautilus_uri_is_trash
	function to avoid hard-coding incorrect checks for "trash:".
	(nautilus_directory_copy_move_metadata_key): Make simple fix for
	empty metadata. This code gets replaced soon anyway.
	* libnautilus-extensions/nautilus-drag.c:
	(nautilus_drag_can_accept_item): Simplify code to get rid of
	illegal sync. I/O. It's OK to assume all NautilusLink objects
	point to directories for now, and if we make a change to do
	something fancier later, we have to do it with async.
	(nautilus_drag_default_drop_action_for_icons): Use the new
	nautilus_uri_is_trash function to avoid hard-coding incorrect
	checks for "trash:".
	* libnautilus-extensions/nautilus-drag.h: Fixed a typo.
	* libnautilus-extensions/nautilus-file-operations.c:
	(get_link_name): Fix unintialized variable warning in a simple
	way that avoids adding too much code.
	(get_duplicate_name): Fix unintialized variable warning in a
	simple way that avoids adding too much code.
	(nautilus_file_operations_copy_move): Use the new
	nautilus_uri_is_trash function to avoid hard-coding incorrect
	checks for "trash:".

	* libnautilus-extensions/nautilus-file-utilities.h:
	* libnautilus-extensions/nautilus-file-utilities.c:
	(nautilus_uri_is_trash): Add new function to avoid hard-coding
	incorrect checks for "trash:".
	(nautilus_make_uri_canonical), Use nautilus_uri_is_trash.

	* libnautilus-extensions/nautilus-icon-container.h:
	* libnautilus-extensions/nautilus-icon-container.c:
	Remove nautilus_icon_container_trash_link_is_in_selection for 3
	reasons. It doesn't belong in NautilusIconContainer, the use of it
	in drag code was incorrectly looking at the destination
	directory's selection, and it used sync. I/O.
	
	* libnautilus-extensions/nautilus-icon-dnd.c:
	(selection_includes_trash),
	(nautilus_icon_container_receive_dropped_icons):
	Changed code to actually check selection -- the old code would
	check the selection in the target window. Unfortunately this still
	uses sync. I/O, but that's now covered by bug 3020.
	
	* libnautilus-extensions/nautilus-icon-factory.c:
	(nautilus_icon_factory_get_icon_for_file): Change to use new
	"local" API for links to make it clear that it uses sync. I/O and
	only works on local files.
	
	* libnautilus-extensions/nautilus-link.h:
	* libnautilus-extensions/nautilus-link.c: (get_tag),
	(get_link_type): Added functions to handle tags internally as part
	of getting rid of tag string values from the API.
	(nautilus_link_local_create): Changed name to local to emphasize this
	takes a path not a URI and uses sync. I/O.
	(local_set_root_property): Share code among the set
	functions. Before there were a lot of copies of the same
	code. Also made sure that it does no rewrite of the file if called
	to set a property to the same value it already has.
	(nautilus_link_local_set_icon),
	(nautilus_link_local_set_link_uri),
	(nautilus_link_local_set_type): Changed name to local to emphasize
	these take a path not a URI and use sync. I/O.  Reimplement by
	calling local_set_root_property.
	(nautilus_link_local_get_additional_text): Change name to local
	and make it take a path instead of a URI to make it clear it uses
	sync.  I/O and doesn't work on remote URIs.
	(nautilus_link_local_get_image_uri): Change name to local and make
	it take a path instead of a URI to make it clear it uses sync.
	I/O and doesn't work on remote URIs.
	(nautilus_link_local_get_link_uri): Change name to local and make
	it take a path instead of a URI to make it clear it uses sync.
	I/O and doesn't work on remote URIs.
	(nautilus_link_local_get_link_type): Change return value to be the
	NautilusLinkType enum instead of the type tag string to make the
	interface cleaner. Also changed name to local to make it clear
	that it takes a path instead of a URI and uses sync. I/O.
	(nautilus_link_local_is_volume_link),
	(nautilus_link_local_is_home_link),
	(nautilus_link_local_is_trash_link): Changed all three of these to
	take advantage of the new simpler get_link_type, and changed name
	to local to make it clear that they take a path instead of a URI
	and use sync. I/O.
	
	* src/file-manager/fm-desktop-icon-view.c: (create_mount_link):
	Use call by new "local" name.
	(trash_link_is_selection): Call new "local" function, which now
	requires a path rather than a URI.
	(fm_desktop_icon_view_trash_state_changed_callback): Use call by
	new "local" name.
	(volume_unmounted_callback): Fix bug where the unmounted callback
	was using a path as a URI without converting.
	(find_and_update_home_link): Use call by new "local" name.
	(place_home_directory): Use call by new "local" name.
	(find_and_rename_trash_link): Use call by new "local" name.
	(create_or_rename_trash): Use call by new "local" name.
	(remove_old_mount_links): Use call by new "local" name.
	(get_sort_category): Use new get_link_type call and a case
	statement instead of the old one and a list of string compares.
	
	* src/file-manager/fm-directory-view.c:
	(fm_directory_trash_link_in_selection): Wrote a new version of
	this function. This is similar to what was in
	NautilusIconContainer, but the one in there didn't belong there,
	and didn't really work for other callers. Also, the one in there
	didn't work at all for the list view case. This new function works
	for either icon or list view. It still has the limitation that it
	won't recognize a trash link if it's not local.
	
	* src/file-manager/fm-icon-view.c:
	(get_icon_drop_target_uri_callback): Fix to use new local calls, but
	still does sync. I/O. Bug 3020 reported about that.
	(get_icon_text_callback): Changed to use new local calls. Still a
	problem that it works only locally and uses sync. I/O. Bug 2531 was
	already reported about that.
	
	* src/file-manager/fm-properties-window.c:
	(get_and_ref_file_to_display): Changed to use new local calls and the
	simpler link type interface.
	
	* src/nautilus-view-frame-private.h: Moved some private
	declarations here since they are for objects used in one file and
	declared in another.
	
	* src/nautilus-view-frame.h:
	* src/nautilus-view-frame.c: (nautilus_view_frame_destroy_client):
	Destroy the "check if view is gone" timeout here; makes more sense
	than the way it was managed before.
	(nautilus_view_frame_destroy): Don't destroy the timeout here any
	more. Also, label was moved into details.
	(nautilus_view_frame_handle_client_gone): Renamed from
	handle_client_destroy_2.
	(view_frame_wait), (view_frame_underway),
	(view_frame_wait_is_over), (view_frame_loaded),
	(view_frame_failed): Added functions to implement view frame state
	machine transitions.
	(check_if_view_is_gone): Moved code to check if view is gone here;
	it's now activated automatically without requiring an explicit
	call to turn it on, since all callers were turning it on at
	load_client time.
	(nautilus_view_frame_load_client): Add state management. Moved the
	code to turn on the object check timeout here.
	(nautilus_view_frame_load_location): Add state management.
	(nautilus_view_frame_open_location): Add state management.
	(nautilus_view_frame_open_location_in_new_window): Add state management.
	(nautilus_view_frame_open_in_new_window_and_select): Add state management.
	(nautilus_view_frame_report_location_change): Add state management.
	(nautilus_view_frame_report_selection_change): Add state management.
	(nautilus_view_frame_report_status): Add state management.
	(nautilus_view_frame_report_load_underway): Add state management.
	(nautilus_view_frame_report_load_progress): Add state management.
	(nautilus_view_frame_report_load_complete): Add state management.
	(nautilus_view_frame_report_load_failed): Add state management.
	(nautilus_view_frame_set_title): Add state management.
	(nautilus_view_frame_zoom_level_changed): Add state management.,
	(nautilus_view_frame_get_label), (nautilus_view_frame_set_label):
	Moved label into details structure.
	
	* src/nautilus-window-manage-views.c:
	(nautilus_window_load_sidebar_panel): Fixed code structure a bit
	(fixes bug 2463) and got rid of call to old
	nautilus_view_frame_set_active_errors function, which is no longer
	needed.
	(nautilus_window_load_content_view): Got rid of call to old
	nautilus_view_frame_set_active_errors function, which is no longer
	needed.
	* src/nautilus-window.c:
	(window_update_sidebar_panels_from_preferences): Got rid of call
	to old nautilus_view_frame_set_active_errors function, which is no
	longer needed.

2000-09-13  Pavel Cisler <pavel@eazel.com>

	* libnautilus-extensions/nautilus-file-operations.c:
	(icon_position_iterator_new):
	Remove an extra unescape call that worked around an escaping
	bug in the copy engine. This bug is now fixed in Gnome VFS
	and the workaround is not needed any more.

2000-09-12  Robey Pointer  <robey@eazel.com>

	* components/rpmview/nautilus-rpm-view-install.c:
	(nautilus_rpm_view_finished_working),
	(nautilus_rpm_view_install_done), (nautilus_service_need_password),
	(nautilus_service_try_again),
	(nautilus_rpm_view_install_package_callback),
	(nautilus_rpm_view_uninstall_package_callback):
	* components/rpmview/nautilus-rpm-view-private.h:
	* components/rpmview/nautilus-rpm-view.c:
	(nautilus_rpm_view_destroy), (nautilus_rpm_view_update_from_uri):

	Move private fields to a shared header.  Make the password query
	dialog work just like the installer's (ability to abort, stop
	trying after 3 times, etc).  Grey out install/uninstall buttons
	while working.  Clean up resources to avoid coredumps or getting
	into a screwy state.

2000-09-12  Andy Hertzfeld  <andy@eazel.com>

	* libnautilus-extensions/nautilus-icon-factory.c:
	(load_thumbnail_frame), (nautilus_icon_factory_make_thumbnails):
	fixed bug 2567, thumbnail frame size hardwired, by fetching the
	frame offsets from the theme.
	* icons/default.xml:
	added thumbnail frame offsets for default frame to default theme

2000-09-12  John Sullivan  <sullivan@eazel.com>

	Fixed part of bug 1537 (double-clicking in single-click
	mode and open-in-new-window mode opens 2 windows).

	Modes suck. Anyway, this was two separate bugs, one in
	list view and one in icon view. I fixed the list view
	one. The icon view one is more complicated, because
	there was already code to handle this case but it doesn't 
	work right, and it isn't obvious how to fix it.
	
	* libnautilus-extensions/nautilus-list.c:
	(nautilus_list_button_press): Ignore 2nd click of
	double-click if in single-click mode.

2000-09-12  Michael Engber  <engber@eazel.com>

	Dragging a image onto a background not clears the
	background color setting. Bug 1899.
	* libnautilus-extensions/nautilus-background.c:
	(nautilus_background_set_image_uri),
	(nautilus_background_receive_dropped_background_image):
	* libnautilus-extensions/nautilus-directory-background.c:
	(saved_settings_changed_callback):

2000-09-12  John Sullivan  <sullivan@eazel.com>

	Fixed bug 2020 (really long URIs make "can't go there"
	dialogs insanely wide)

	* src/nautilus-window-manage-views.c:
	(nautilus_window_end_location_change_callback): Use
	magic Ramiro truncating technology to display 
	middle-truncated URI if it's more than a certain number
	of characters wide.

2000-09-13  Ali Abdin  <aliabdin@aucegypt.edu>

	Fixed a few typos. Add in preliminary support for QUESTION/ANWSER tags
	First stab at getting book/chapter support in (Bug #2325) - It works
	as I want it to, but we may encounter bugs.

	This check-in is largely based on a patch by jfleck@inkstain.net (but
	I heavily modified it)

	* components/help/converters/gnome-db2html2/gdb3html.[ch]:
	Add question/answer/chapter tags to the list.
	(sect1_start_element): Renamed to 'sect1id_stack_add'
	New 'DocType' datatype (added to Context struct)
	(book_start_element): New function
	(article_start_element): Set the doctype. Fix to Eazel style.
		
	* components/help/converters/gnome-db2html2/sect-elements.[ch]:
	Fix a typo to make the computeroutput tag really work.
	Plug in the QUESTION/ANSWER/CHAPTER tags

	(sect_table_without_border_start_element): I thought I fixed this bug
	(forgot a '<')

	(sect_question_start_element): New function
	(sect_answer_start_element): ditto

	(sect_sect_start_element),
	(sect_sect_end_element),
	(sect_para_start_element),
	(sect_para_end_element),
	(sect_title_start_element),
	(sect_title_end_element),
	(sect_title_characters): Support for CHAPTER tag

	* components/help/converters/gnome-db2html2/toc-elements.c:
	There were a few typos here. Extended the table down all the way to
	CHAPTERS
	(toc_sect_end_element),
	(toc_title_start_element),
	(toc_title_end_element),
	(toc_title_characters),
	(toc_sect_start_element): Add support for chapter tag.

	* components/help/converters/gnome-db2html2/sect-preparse.c:
	Extend the table down all the way to CHAPTERS.

	(sect_preparse_sect_start_element): Add in support for chapter tags.
	Also update for function rename.
	(sect_preparse_title_characters): ditto

	(sect_preparse_set_doctype): Set the document type depending on the
	tag name

2000-09-12  Andy Hertzfeld  <andy@eazel.com>

	* src/nautilus-location-bar.c: (accumulate_name),
	(try_to_expand_path):
	fixed bug where it couldn't expand uris containing blanks or other
	escaped characters, by calling gnome_vfs_unescape_string on the
	basename before using it for comparison.
	
2000-09-13  Mathieu Lacage  <mathieu@eazel.com>

	* src/file-manager/Makefile.am: fix build for strange prefix.
	add a MEDUSA_CFLAGS.

2000-09-12  John Sullivan  <sullivan@eazel.com>

	Fixed bug 1649 (keyboard focus stays in location bar when
	you click in icon or list view)

	* libnautilus-extensions/nautilus-icon-container.c:
	(button_press_event): grab the focus
	
	* libnautilus-extensions/nautilus-list.c:
	(nautilus_list_button_press): grab the focus

2000-09-12  Gene Z. Ragan  <gzr@eazel.com>

	More work on bug 1595
	
	* libnautilus-extensions/nautilus-ctree.c:
	* libnautilus-extensions/nautilus-ctree.h:
	(nautilus_ctree_draw_expander),
	(tree_draw_node), (row_new), (nautilus_ctree_insert_node):
	More code to handle click and hold cases.
	
	(nautilus_ctree_draw_node)
	Created a public function to cause a tree node to be redrawn

	* components/tree/nautilus-tree-view.c:
	Replace gtk_widget_queue_redraw () with new 
	nautilus_ctree_draw_node ()

	Fixed logic so a mouse click and drag on expander and then
	out of the twisty hot spot properly resets expander to
	unclicked state.	
	
2000-09-12  John Sullivan  <sullivan@eazel.com>

	Fixed bug 1305 (Selecting file with really long name makes
	window wider)

	* libnautilus-extensions/nautilus-any-width-bin.h:
	* libnautilus-extensions/nautilus-any-width-bin.c:
	(nautilus_any_width_bin_initialize_class),
	(nautilus_any_width_bin_initialize), (nautilus_any_width_bin_new),
	(nautilus_any_width_bin_size_request): New files, implementing
	new bin class that ignores its children's clamorous pleas for
	width but generously distributes any width it obtains to them.
	* libnautilus-extensions/Makefile.am: Add new files to build.
	
	* src/nautilus-window.c: 
	(install_status_bar): New function, installs status bar into
	a nautilus_any_width_bin. Now the status bar won't cause the
	window to resize no matter how long the text is.
	(nautilus_window_constructed): Call install_status_bar instead
	of gnome_app_set_statusbar.

2000-09-12  Mathieu Lacage  <mathieu@eazel.com>

	* src/nautilus-sidebar.c: (nautilus_sidebar_press_event):
	fix bug 2685. the fix is a 3 liner. evil gtk.

2000-09-12  Pavel Cisler <pavel@eazel.com>

	* src/nautilus-throbber.c: (nautilus_throbber_destroy),
	(nautilus_throbber_remove_update_callback),
	(nautilus_throbber_stop):
	Fix a bug in the throbber that I ran into -- the timeout callback was
	being called after the throbber got destroyed.

2000-09-12  John Sullivan  <sullivan@eazel.com>

	Fixed bug 884 (Long URI in Go menu doesn't get cut off)
	Fixed bug 2667 (Really long bookmark titles stretch bookmarks menu)

	* libnautilus-extensions/nautilus-gtk-extensions.h:
	* libnautilus-extensions/nautilus-gtk-extensions.c:
	(nautilus_truncate_text_for_menu_item): New function,
	uses nautilus_str_middle_truncate to create a string
	that isn't ridiculously long.

	* libnautilus-extensions/nautilus-bookmark.c:
	(nautilus_bookmark_menu_item_new): Use new function to
	keep the menu items in the Back/Forward context menus
	from getting too wide.
	* src/nautilus-window-menus.c: (append_bookmark_to_menu):
	Use new function to keep the menu items in the Go and
	Bookmarks menus from getting too wide.

2000-09-12  Gene Z. Ragan  <gzr@eazel.com>

	Work in progress on making the expander UI in the tree view
	more responsive to the user.

	* libnautilus-extensions/Makefile.am:
	Added two new files to the build,
	nautilus-ctree.c
	nautilus-ctree.h

	I may subclass as I learn more about what needs to be 
	modified to add the functionality we need.
	
	* components/tree/nautilus-tree-view.c: (insert_hack_node),
	* components/tree/nautilus-tree-view.h:
	(remove_hack_node), (freeze_if_have_hack_node),
	(nautilus_tree_view_insert_model_node):
	Experimenting with the right way to add new feature.
	
	* libnautilus-extensions/nautilus-ctree.c: 
	* libnautilus-extensions/nautilus-ctree.h:
	(COLUMN_FROM_XPIXEL),
	(nautilus_ctree_get_type), (nautilus_ctree_class_init),
	(nautilus_ctree_set_arg), (nautilus_ctree_get_arg),
	(nautilus_ctree_init), (ctree_attach_styles),
	(ctree_detach_styles), (nautilus_ctree_realize),
	(nautilus_ctree_unrealize), (nautilus_ctree_button_press),
	(draw_drag_highlight), (draw_cell_pixmap), (get_cell_style),
	(nautilus_ctree_draw_expander), (nautilus_ctree_draw_lines),
	(draw_row), (tree_draw_node), (nautilus_ctree_last_visible),
	(nautilus_ctree_link), (nautilus_ctree_unlink), (real_row_move),
	(real_tree_move), (change_focus_row_expansion), (real_tree_expand),
	(real_tree_collapse), (column_auto_resize), (auto_resize_columns),
	(cell_size_request), (set_cell_contents), (set_node_info),
	(tree_delete), (tree_delete_row), (tree_update_level),
	(tree_select), (tree_unselect), (tree_expand), (tree_collapse),
	(tree_collapse_to_depth), (tree_toggle_expansion), (row_new),
	(row_delete), (real_select_row), (real_unselect_row),
	(real_tree_select), (real_tree_unselect), (select_row_recursive),
	(real_select_all), (real_unselect_all), (ctree_is_hot_spot),
	(nautilus_ctree_construct), (nautilus_ctree_new_with_titles),
	(nautilus_ctree_new), (real_insert_row),
	(nautilus_ctree_insert_node), (nautilus_ctree_insert_gnode),
	(nautilus_ctree_export_to_gnode), (real_remove_row),
	(nautilus_ctree_remove_node), (real_clear),
	(nautilus_ctree_post_recursive),
	(nautilus_ctree_post_recursive_to_depth),
	(nautilus_ctree_pre_recursive),
	(nautilus_ctree_pre_recursive_to_depth),
	(nautilus_ctree_is_viewable), (nautilus_ctree_last),
	(nautilus_ctree_find_node_ptr), (nautilus_ctree_node_nth),
	(nautilus_ctree_find), (nautilus_ctree_is_ancestor),
	(nautilus_ctree_find_by_row_data),
	(nautilus_ctree_find_all_by_row_data),
	(nautilus_ctree_find_by_row_data_custom),
	(nautilus_ctree_find_all_by_row_data_custom),
	(nautilus_ctree_is_hot_spot), (nautilus_ctree_move),
	(nautilus_ctree_expand), (nautilus_ctree_expand_recursive),
	(nautilus_ctree_expand_to_depth), (nautilus_ctree_collapse),
	(nautilus_ctree_collapse_recursive),
	(nautilus_ctree_collapse_to_depth),
	(nautilus_ctree_toggle_expansion),
	(nautilus_ctree_toggle_expansion_recursive),
	(nautilus_ctree_select), (nautilus_ctree_unselect),
	(nautilus_ctree_select_recursive),
	(nautilus_ctree_unselect_recursive),
	(nautilus_ctree_real_select_recursive),
	(nautilus_ctree_node_set_text), (nautilus_ctree_node_set_pixmap),
	(nautilus_ctree_node_set_pixtext), (nautilus_ctree_set_node_info),
	(nautilus_ctree_node_set_shift), (remove_grab),
	(nautilus_ctree_node_set_selectable),
	(nautilus_ctree_node_get_selectable),
	(nautilus_ctree_node_get_cell_type),
	(nautilus_ctree_node_get_text), (nautilus_ctree_node_get_pixmap),
	(nautilus_ctree_node_get_pixtext), (nautilus_ctree_get_node_info),
	(nautilus_ctree_node_set_cell_style),
	(nautilus_ctree_node_get_cell_style),
	(nautilus_ctree_node_set_row_style),
	(nautilus_ctree_node_get_row_style),
	(nautilus_ctree_node_set_foreground),
	(nautilus_ctree_node_set_background),
	(nautilus_ctree_node_set_row_data),
	(nautilus_ctree_node_set_row_data_full),
	(nautilus_ctree_node_get_row_data), (nautilus_ctree_node_moveto),
	(nautilus_ctree_node_is_visible), (nautilus_ctree_set_indent),
	(nautilus_ctree_set_spacing), (nautilus_ctree_set_show_stub),
	(nautilus_ctree_set_line_style), (tree_sort),
	(nautilus_ctree_sort_recursive), (real_sort_list),
	(nautilus_ctree_sort_node), (fake_unselect_all), (selection_find),
	(resync_selection), (real_undo_selection),
	(nautilus_ctree_set_drag_compare_func), (check_drag),
	(drag_dest_info_destroy), (drag_dest_cell),
	(nautilus_ctree_drag_begin), (nautilus_ctree_drag_motion),
	(nautilus_ctree_drag_data_received):
	New source files

2000-09-12  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 2992, Should not be able to context drag
	Trash to link or duplicate
	
	* libnautilus-extensions/nautilus-icon-container.c:
	* libnautilus-extensions/nautilus-icon-container.h:
	(nautilus_icon_container_trash_link_is_in_selection):
	Renamed function and pass in NautilusIconContainer
	that selection is retrieved from.
	
	* libnautilus-extensions/nautilus-icon-dnd.c:
	(nautilus_icon_container_receive_dropped_icons):
	Check and see if any special cases are in the
	selection.  For now, this is only the Trash link.
	
	* src/file-manager/fm-directory-view.c:
	(fm_directory_trash_link_in_selection):
	Changed function internal to call
	nautilus_icon_container_trash_link_is_in_selection

2000-09-12  John Sullivan  <sullivan@eazel.com>

	Fixed bug 2668 (Switching to Search mode should move the
	focus to the search text field).

	* src/nautilus-navigation-bar.h: Added signal and public
	function for nautilus_navigation_bar_activate.
	* src/nautilus-navigation-bar.c:
	(nautilus_navigation_bar_initialize_class): Wire up
	activate signal; default function is NULL.
	(nautilus_navigation_bar_activate): New function, emits
	signal.

	* src/nautilus-switchable-navigation-bar.h:
	* src/nautilus-switchable-navigation-bar.c:
	Defined a NautilusSwitchableNavigationBarDetails struct,
	and moved implementation details into it. Set the types
	of the fields in this struct to reflect actual needs,
	instead of using GtkWidget and casting up to other
	classes.
	(nautilus_switchable_navigation_bar_initialize): Create
	details struct.
	(nautilus_switchable_navigation_bar_destroy): New function,
	free details struct.
	(nautilus_switchable_navigation_bar_initialize_class):
	Wire up destroy handler.
	(nautilus_switchable_navigation_bar_set_mode): Call
	nautilus_navigation_bar_activate on switched-to bar.
	(nautilus_switchable_navigation_bar_get_mode),
	(nautilus_switchable_navigation_bar_get_location),
	(nautilus_switchable_navigation_bar_set_location): Updated
	to use bar->details.

	* src/nautilus-switchable-search-bar.c:
	(nautilus_switchable_search_bar_initialize_class):
	Wire up activate signal to real_activate.
	(real_activate): Call nautilus_navigation_bar_activate
	on the current search bar.

	* src/nautilus-simple-search-bar.c:
	(nautilus_simple_search_bar_initialize_class): Wire up
	activate signal to real_activate.
	(real_activate): Set focus to text field.

	* src/nautilus-complex-search-bar.c:
	(nautilus_complex_search_bar_initialize_class): Wire up
	activate signal to real_activate.
	(get_first_text_field): New helper function to find the
	first text field in a search criterion (or NULL).
	(real_activate): Set focus to first text field.

2000-09-11  Pavel Cisler  <pavel@eazel.com>

	* libnautilus-extensions/nautilus-directory-notify.h:
	* libnautilus-extensions/nautilus-directory.c:
	* libnautilus-extensions/nautilus-file-changes-queue.c:
	* libnautilus-extensions/nautilus-file-changes-queue.h:
	* libnautilus-extensions/nautilus-file-operations.c:
	(icon_position_iterator_new), (icon_position_iterator_free),
	(create_xfer_dialog), (handle_xfer_vfs_error), 
	(apply_one_position), (sync_xfer_callback),
	(nautilus_file_operations_copy_move),
	(nautilus_file_changes_queue_schedule_position_setting),
	(position_setting_list_free),
	(nautilus_directory_set_icon_position),
	(nautilus_directory_schedule_metadata_copy),
	(nautilus_directory_schedule_metadata_move),
	(nautilus_file_changes_consume_changes),
	(nautilus_directory_schedule_position_setting):

	Work in progress on saving drop locations during a copy/move operation.
	Add a new NautilusFileChangesQueue element type to handle scheduling
	of the position saving operation. Hook it up to a call that saves the
	icon position into the metadata.
	Add icon position handling to the synchronous copy engine callback.
	
	* libnautilus-extensions/nautilus-icon-container.h:
	* libnautilus-extensions/nautilus-icon-dnd.c:
	(handle_nonlocal_move):
	Pass relative icon positions (FIXME 626).
	
	* src/file-manager/fm-directory-view.c:
	(fm_directory_view_move_copy_items):
	* src/file-manager/fm-directory-view.h:
	* src/file-manager/fm-icon-view.c: (icon_view_move_copy_items):
	Add drop location to relative icon positions to get correct icon drop
	placement.

	* libnautilus-extensions/nautilus-file-operations.c:
	(get_link_name), (get_duplicate_name), (handle_xfer_duplicate):
	Rework a bit, fix a leak (FIXME 2556).
	
	* libnautilus-extensions/nautilus-file-operations.c:
	(nautilus_file_operations_copy_move),
	Fix a leak.

	* libnautilus-extensions/nautilus-file-operations.c:
	(create_xfer_dialog):
	Fix a bug in dialog result handling code.

	* libnautilus-extensions/nautilus-drag.h:
	Some minor tweaks

2000-09-12  Andy Hertzfeld  <andy@eazel.com>

	* src/nautilus-zoom-control.c: (draw_number):
	fixed bug 2979, numbers in zoom control need to prelight, too.
	
2000-09-12  Andy Hertzfeld  <andy@eazel.com>

	* components/music/nautilus-music-view.c: (determine_attribute):
	fixed bug 2160, don't display album title and artist for mixed
	directories in music view.
	
2000-09-11  Andy Hertzfeld  <andy@eazel.com>

	* libnautilus-extensions/nautilus-icon-text-item.c:
	(fetch_themed_color), (iti_paint_text):
	fixed bug 2568, hardwired colors in icon_text_item, by fetching
	them from the theme
	* libnautilus-extensions/nautilus-theme.c:
	(nautilus_theme_get_theme_data):
	made the theme machinery look in the default theme when it can't find
	a property in the current theme
	* icons/default.xml:
	defined default icon text colors

2000-09-11  Robey Pointer  <robey@eazel.com>

	* components/services/install/nautilus-view/nautilus-service-instal
	l-view.c: (dig_up_errors), (nautilus_service_install_failed):

	Show a detailed error message when an install fails for some
	non-trivial reason.

2000-09-11  Robey Pointer  <robey@eazel.com>

	* components/services/install/nautilus-view/nautilus-service-instal
	l-view.c: (nautilus_service_install_view_initialize),
	(reply_callback), (nautilus_service_install_preflight_check),
	(nautilus_service_install_download_failed),
	(nautilus_service_install_done), (nautilus_service_install_failed),
	(nautilus_service_install_delete_files),
	(nautilus_service_install_view_update_from_uri),
	(nautilus_service_install_view_load_uri),
	(service_install_load_location_callback),
	(service_install_stop_loading_callback):
	* components/services/install/nautilus-view/nautilus-service-instal
	l-view.h:

	Add dialog to ask for confirmation during preflight check (give
	the user one last chance to back out after downloading, before
	installing).  Add dialog to ask whether finished RPM files should
	be deleted.
	
2000-09-11  Seth Nickell  <seth@eazel.com>

	* helper-utilities/authenticate/nautilus-authenticate-pam.c:
	(pam_conversion_func), (nautilus_authenticate_authenticate):

	Fix function prototype problem with PAM on Linux.
	
	* libnautilus/nautilus-view-component.idl:
	Commented FIXMEs better.
	
2000-09-11  Eskil Heyn Olsen  <eskil@eazel.com>

	* nautilus-installer/src/installer.c: (install_failed):
	Fixme comment.

2000-09-11  Seth Nickell  <seth@eazel.com>

	* configure.in:
	Add checks to fix things on Solaris regarding mounting,
	environment variables, and fonts.

	Added tests for compiler warning flags that are not supported 
	with all versions of GCC.
	
	* helper-utilities/authenticate/nautilus-authenticate-pam.c:
	(pam_conversion_func):
	Remove "const" from system call for compatibility with Solaris.
	
	* libnautilus-extensions/nautilus-file.c:
	(get_id_from_digit_string):
	uid_t != int, so change functions converting from string to
	uid_t to deal with greater bit uids properly.

	* libnautilus-extensions/nautilus-glib-extensions.h:
	* libnautilus-extensions/nautilus-glib-extensions.c:
	(nautilus_g_setenv), (nautilus_g_unsetenv):
	Add system gnostic functions for setting and removing variables
	from the environment.
	
	* libnautilus-extensions/nautilus-scalable-font.c:
	(initialize_global_stuff_if_needed):
	Temporary fix to deal with the absence of "RedHat-style" font
	paths on Solaris and Debian whilst font paths are still
	hard-coded.
	
	* libnautilus-extensions/nautilus-volume-monitor.c:
	(nautilus_volume_monitor_get_volume_name),
	(nautilus_volume_monitor_volume_is_mounted),
	(mount_volumes_update_is_mounted), (mnttab_add_mount_volume),
	(mntent_add_mount_volume), (find_volumes):

	Rewrite sections to use the appropriate Solaris mounting 
	functions if Linux-style mount/umount/mount-table manipulation
	functions are not available.
	
	* libnautilus/nautilus-view-component.idl:
	* src/nautilus-view-frame-corba.c:
	* src/nautilus-zoomable-frame-corba.c:
	(impl_Nautilus_ZoomableFrame_report_zoom_level_changed):

	Change doubles to floats to work around an ORBit problem on
	Solaris wherein doubles are not correctly aligned.

	* src/file-manager/fm-desktop-icon-view.c:

	remove gratuitous linux specific header inclusion
	
	* src/nautilus-first-time-druid.c: (set_http_proxy):
	* src/nautilus-main.c: (main):
	* src/nautilus-shell.c: (corba_restart):
	(impl_Nautilus_ViewFrame_report_load_progress):

	Changed "setenv" and "unsetenv" calls to use nautilus_g_setenv
	and nautilus_g_unsetenv.
	
	* src/nautilus-window-manage-views.c:
	(report_sidebar_panel_failure_to_user):

	Add better error message to sidebar failures where it can't
	figure out which sidebar failed. Done in order to fix null
	string being passed to dialogue function which segfaulted
	Nautilus on Solaris.
	
2000-09-11  Robey Pointer  <robey@eazel.com>

	* components/services/trilobite/libtrilobite/trilobite-root-helper.
	c: (discard_line), (eazel_helper_start), (eazel_helper_password):

	Fix up the root-helper to work with usermode 1.28 and 1.35 (which
	send new status messages and change the protocol a lot).

2000-09-11  Eskil Heyn Olsen  <eskil@eazel.com>

	* components/services/install/lib/eazel-install-metadata.c:
	(done_with_gconf), (check_gconf_init), (get_conf_string),
	(get_conf_int), (get_conf_boolean):
	#ifdef magic to make the SLIM version always use the default, and
	spare the bootstrap installer of having to link with gconf.
	
	* components/services/install/lib/eazel-install-protocols.c:
	(get_url_for_package):
	Uses malloc for the putenv value.
	Fixed a evil g_free.
	
	* components/services/install/lib/eazel-install-query.c:
	(eazel_install_simple_rpm_query):
	Commented out a g_message, 
	
	* components/services/install/lib/eazel-install-rpm-glue.c:
	(eazel_install_download_packages),
	(eazel_install_check_for_file_conflicts),
	Don't conflict with same package or if the file is a directory.
	(eazel_install_monitor_rpm_propcess_pipe),
	Don't print that "panic ensues" thingy...
	(eazel_install_fetch_rpm_dependencies):
	Do check_existence before check_for_file_conflicts.
	
	* components/services/install/lib/eazel-install-xml-package-list.c:
	(parse_osd_xml_from_memory):
	commented out a xmlFreeDoc, as it was coredumping on me.
	
	* components/services/trilobite/libtrilobite/trilobite-core-utils.c
	: (trilobite_fetch_uri):
	* nautilus-installer/src/HACKING:
	* nautilus-installer/src/Makefile:
	* nautilus-installer/src/installer.c:
	(get_detailed_errors_foreach), (get_detailed_errors),
	(install_failed), (eazel_install_preflight):
	* nautilus-installer/src/link.sh:
	Stuff...

2000-09-11  Michael Engber  <engber@eazel.com>

	Backout change made to fix bug 1899 - it caused problems
	for the desktop.
	* libnautilus-extensions/nautilus-background.c:
	(nautilus_background_set_image_uri_no_emit):

2000-09-11  Andy Hertzfeld  <andy@eazel.com>

	* libnautilus-extensions/nautilus-entry.c:
	(nautilus_entry_initialize), (nautilus_entry_key_press):
	fixed bug 2829, location bar should treat TAB like right arrow
	when there's a selection, by adding a mode to our entry class to do so.
	* libnautilus-extensions/nautilus-entry.h:
	defined a "special tab handling mode"
	* src/nautilus-location-bar.c: (nautilus_location_bar_initialize):
	set the special tab handling mode for the location bar's entry
	
	* src/nautilus-first-time-druid.c: (initiate_file_download):
	fixed bug 1826, change "initial update" download to real uri, now using
	one specified by Susan Space.
	
2000-09-11  Ramiro Estrugo  <ramiro@eazel.com>

	* libnautilus-extensions/nautilus-icon-canvas-item.c:
	(measure_label_text), (draw_label_text_aa):
	Remove the SMOOTH_FONTS define and code from before aa fonts.
	
2000-09-11  Rebecca Schulman  <rebecka@eazel.com>

	* icons/Makefile.am:
	* icons/i-search-72.png:
	* libnautilus-extensions/nautilus-icon-factory.c:
	(nautilus_icon_factory_get_icon_name_for_directory),
	(nautilus_icon_factory_get_icon_name_for_file):
	Added search icon to the sidebar for search results

2000-09-11  Mathieu Lacage  <mathieu@eazel.com>

	Fix nautilus part of bug 2906. There are still issues
	but they are located in gnome-vfs uri handling code.
	* libnautilus-extensions/nautilus-file-operations.c:
	(append_basename) : rename from append_basename_unescaped 
	since it takes escaped uris into account now.
	(nautilus_file_operations_copy_move),
	(nautilus_file_operations_new_folder),
	(nautilus_file_operations_move_to_trash),
	(nautilus_file_operations_delete): use gnome_vfs_uri_new 
	to create new uris from escaped strings.

2000-09-11  John Sullivan  <sullivan@eazel.com>

	Some cleanups of directory view menu code to share more between
	the context menus and menu-bar menus. These had gotten into a
	really ugly mess; hopefully this will make them a little more
	straightforward to deal with.

	* src/file-manager/fm-directory-view.c: 
	(bonobo_menu_open_callback),
	(bonobo_menu_open_in_new_window_callback),
	(bonobo_menu_other_program_callback),
	(bonobo_menu_move_to_trash_callback),
	(bonobo_menu_duplicate_callback),
	(bonobo_menu_new_folder_callback),
	(bonobo_menu_open_properties_window_callback):
	Removed these callbacks, in favor of the use-one-callback-
	for-both-gtk-and-bonobo-menus style.
	(open_callback),
	(open_in_new_window_callback), 
	(other_application_callback), (other_viewer_callback),
	(trash_callback),
	(duplicate_callback), (create_link_callback),
	(new_folder_callback), (open_properties_window_callback):
	Changed these callbacks to work with either gtk or
	bonobo menus.
	(open_with_other_program): New helper function called
	from other_application_callback and other_viewer_callback.
	(check_selection_not_empty): New debugging helper function.
	(append_gtk_menu_item): Renamed append_gtk_menu_item_with_view,
	now it always passes the view as the callback data, and doesn't
	store it with gtk_object_set_data anymore.
	(fm_directory_view_real_create_background_context_menu_items),
	(create_open_with_gtk_menu),
	(fm_directory_view_real_create_selection_context_menu_items),
	(reset_bonobo_trash_delete_menu), (reset_bonobo_open_with_menu),
	(fm_directory_view_real_merge_menus): Updated for API changes.

2000-09-11  J Shane Culpepper  <pepper@eazel.com>

	* components/services/install/nautilus-view/nautilus-service-instal
	l-view.c:
	pointing to services.eazel.com instead of ham.eazel.com
	* components/services/summary/nautilus-view/nautilus-summary-view.c
	: (generate_summary_form), (goto_service_cb), (goto_update_cb):
	Working on the different state views determined by the anonymous and
	logged in usermodes.

2000-09-11  Andy Hertzfeld  <andy@eazel.com>

	* components/hardware/nautilus-hardware-view.c:
	(get_RAM_description), (setup_form_title), (add_element_to_table),
	(setup_overview_form), (setup_CPU_form), (setup_RAM_form),
	(setup_IDE_form):
	made the hardware view use a table for 2D layout instead of a
	horizontal box, since the IDE drives were making it too wide.  Also,
	removed an obsolete fixme.
	
2000-09-11  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 818, clicking on .doc and .pdf crashes Nautilus

	This was a bug where the action would be to open the document
	in an application but the application returned would be NULL
	due to some inconsistancy in the mime database.  We now check
	for this case and default to the componet view if this 
	situation arises.
	
	* src/file-manager/fm-directory-view.c: (activate_callback):

2000-09-11  John Sullivan  <sullivan@eazel.com>

	Fixed bug 2938 (Shouldn't open a zillion Properties windows
	without asking first). I generalized this bug to include
	other multiple-window situations.

	* src/file-manager/fm-directory-view.h,
	* src/file-manager/fm-directory-view.c: 
	(get_containing_window): Just moved this function earlier in
	the file.
	(fm_directory_view_confirm_multiple_windows): New public function,
	asks user whether they really want to open some large number
	of windows. The cutoff point is determined by a constant,
	currently set to 10.
	(bonobo_menu_open_in_new_window_callback),
	(bonobo_menu_open_properties_window_callback),
	(open_in_new_window_callback), (open_properties_window_callback),
	(fm_directory_view_activate_files): Confirm before opening
	lots o' windows.
	* src/file-manager/fm-search-list-view.c:
	(reveal_selected_items_callback): Confirm before opening lots o'
	windows.

2000-09-11  Michael Engber  <engber@eazel.com>

	* src/nautilus-main.c: (nautilus_main_event_loop_unregister):
	* src/nautilus-shell.c: (corba_quit), (corba_restart):
	bug 2942 the quit code now kills all the event loops, not
	just the top one.

2000-09-11  Andy Hertzfeld  <andy@eazel.com>

	* libnautilus-extensions/nautilus-icon-dnd.c:
	(nautilus_icon_dnd_begin_drag):
	fixed big 914, icons are sometimes semi-transparent when dragged, by
	removing the stippled mask code.  Someday we'll get this back as
	X Windows improves
	
2000-09-11  John Sullivan  <sullivan@eazel.com>

	Fixed bug 2317 (Right-click on sidebar uses menu items in
	a confusing way)

	* src/nautilus-sidebar.c: (nautilus_sidebar_add_panel_items):
	The bug was confusion over the gtk_check_menu_item API. It had
	been calling set_show_toggle when it meant set_active.

	* src/file-manager/fm-list-view.c: Updated a comment.

2000-09-11  Andy Hertzfeld  <andy@eazel.com>

	* src/nautilus-first-time-druid.c: (set_up_user_level_page),
	(set_up_update_page):
	fixed bug 2911, "no" option for Nautilus Update doesn't fit, by
	shortening the message.  Also, cleaned up other layout problems.
	
2000-09-11  John Sullivan  <sullivan@eazel.com>

	Fixed bug 2308 ("Where" column should be after "Name" column)
	Fixed bug 1931 (Search list columns need better widths)

	* src/file-manager/fm-search-list-view.c: 
	(real_get_column_specification): Switched order of Where/Name
	columns, tweaked column widths.
	(real_get_link_column): Changed link column number to match
	ordering change.

2000-09-11  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 2447, Check permissions when mounting floppy
	The check permissions call is not needed.

	Fixed bug 2453, Error ignored when mounting/unmounting
	We now check for the error.

	Fixed bug 2449, Directory path creation does not handle
	paths containing ".."
	
	* libnautilus-extensions/nautilus-volume-monitor.c:
	(mount_volume_floppy_add), (mount_volume_add_aliases),
	(nautilus_volume_monitor_mount_unmount_removable):

2000-09-10  Maciej Stachowiak  <mjs@eazel.com>

	* configure.in: Add AM_PATH_GTK check

	* libnautilus/Makefile.am: include GTK_CFLAGS in INCLUDES

	* libnautilus/nautilus-view.c (view_frame_call_begin): Fix yet
	another screwup.

2000-09-11  Mathieu Lacage  <mathieu@eazel.com>

	* libnautilus/nautilus-view.c: (view_frame_call_begin),
	(view_frame_call_end): fix 2 typos introduced my last 
	maciej commit breaking the build.

2000-09-10  Maciej Stachowiak  <mjs@eazel.com>

	* libnautilus/nautilus-view.c (view_frame_call_begin,
	view_frame_call_end): Handle a QI failure properly, fixing
	bugzilla.eazel.com 2545.

2000-09-10  Eskil Heyn Olsen  <eskil@eazel.com>

	* components/services/install/lib/eazel-install-object.c:
	(eazel_install_finalize):
	Free the private parts of EazelInstall. (bug 2717)

2000-09-10  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 1266, application and component lists should
	be sorted somehow.

	GnomeVFS sorts these list alphabetically now.
	
	* libnautilus-extensions/nautilus-mime-actions.c:
	(nautilus_mime_get_short_list_applications_for_uri),
	(nautilus_mime_get_all_applications_for_uri):
	Lists are returned sorted alphabetically.

2000-09-10  Eskil Heyn Olsen  <eskil@eazel.com>

	* components/hardware/nautilus-hardware-view.c:
	(setup_overview_form):
	Fixed bug 2823
	
	* components/rpmview/nautilus-rpm-view-install.c:
	(get_detailed_errors_foreach):
	Updated for the extra packagedata status enum
	
	* components/services/install/command-line/eazel-alt-install-corba.
	c: (tree_helper_helper), (tree_helper), (install_failed),
	(uninstall_failed), (eazel_preflight_check_signal), (dep_check),
	(main):
	Nicer output.
	
	* components/services/install/idl/trilobite-eazel-install.idl:
	* components/services/install/lib/eazel-install-corba-types.c:
	(corba_packagedatastruct_from_packagedata),
	(packagedata_from_corba_packagedatastruct):
	Added a PACKAGE_FILE_CONFLICT status enum to PackageData

	* components/services/install/lib/eazel-install-protocols.c:
	(get_url_for_package), (get_search_url_for_package):
	Changed >= to = for version, 
	
	* components/services/install/lib/eazel-install-rpm-glue.c:
	(eazel_install_download_packages),
	(eazel_install_check_for_file_conflicts),
	(eazel_install_pre_install_packages), (revert_transaction),
	(eazel_install_monitor_rpm_propcess_pipe),
	(eazel_install_do_transaction_md5_check),
	(eazel_install_package_version_compare),
	(eazel_install_package_provides_basename_compare),
	(eazel_install_package_provides_compare),
	(eazel_install_package_modifies_provides_compare),
	(eazel_install_check_existing_packages),
	(eazel_install_check_if_related_package),
	(eazel_install_fetch_rpm_dependencies), (print_package_list),
	(eazel_install_ensure_deps):
	Mucho work, closed bug 2956, 2958, 1514 and 2596. Basically it
	now handles the case where a installing eg. gnome-print which has
	libgnomeprint.so.7 breaks gnumeric because it requires
	libgnomeprint.so.6. It also now checks for file conflicts before
	beginning the install. This is the one case that rpmDepCheck
	doesn't check.
	
	* components/services/install/lib/eazel-install-types.c:
	(packagedata_fill_from_rpm_header),
	Read the provides list with full filenames. Should hopefully also
	work on rpm-3.0.x | x < 4.
	(packagedata_status_enum_to_str),
	(packagedata_status_str_to_enum):
	Handle FILE_CONFLICT tag
	
	* components/services/install/lib/eazel-install-types.h:
	Added the FILE_CONFLICT. If installed package A which has a file
	foo which conflicts with B (already installed, and also has file
	foo), file B will go into A->breaks with status =
	PACKAGE_FILE_CONFLICT.

2000-09-09  Josh Barrow  <linuxfan@ionet.net>

	* components/music/nautilus-music-view.c:
	(music_view_set_selected_song_title), (reset_playtime),
	(play_status_display), (slider_moved_callback),
	(add_play_controls):
	Made the time to go and the total time in the Music View 
	use the anti aliased fonts.

2000-09-09  Andy Hertzfeld  <andy@eazel.com>

	* src/nautilus-sidebar-tabs.c: (nautilus_sidebar_tabs_expose):
	fixed bug 2910, sidebar tabs crash in arlo theme when sidebar is
	closed, by making them not try to draw when the sidebar is closed
	
2000-09-09  Mathieu Lacage  <mathieu@eazel.com>

	* components/tree/nautilus-tree-view.c: port to new
	shared function.
	* libnautilus-extensions/nautilus-icon-dnd.c: port to
	new shared function.
	* libnautilus-extensions/nautilus-drag.c:
	(nautilus_drag_autoscroll_calculate_delta),
	(nautilus_drag_file_receive_dropped_keyword): add a new 
	fucntion to be shared.
	* libnautilus-extensions/nautilus-drag.h: add prototype
	* libnautilus-extensions/nautilus-list.c:
	(nautilus_list_get_drop_action),
	(nautilus_list_receive_dropped_icons),
	(nautilus_list_receive_dropped_keyword),
	(nautilus_list_drag_data_received):
	use the above function and add support to the list view 
	for many new drop types. Need to fix bug 2485 properly
	to get 2874 fully implemented.

2000-09-09  Mathieu Lacage  <mathieu@eazel.com>

	* components/tree/nautilus-tree-view.c: fix bug 2417.
	cursor is now updated.
	* libnautilus-extensions/nautilus-list.c:
	(nautilus_list_drag_begin), (nautilus_list_drag_end),
	(nautilus_list_drag_leave), (nautilus_list_get_drop_action),
	(nautilus_list_drag_motion), (nautilus_list_drag_drop),
	(nautilus_list_drag_data_received): remove debugging output.

2000-09-09  Andy Hertzfeld  <andy@eazel.com>

	* src/nautilus-about.c: (nautilus_about_destroy),
	(nautilus_about_initialize), (randomize_authors),
	(draw_author_list), (nautilus_about_draw_info),
	(nautilus_about_update_authors), (nautilus_about_close),
	(update_authors_if_necessary):
	made the about box "scalable" by picking and ordering the
	authors randomly, shuffling the list peroidically.
	* src/nautilus-about.h:
	added nautilus_about_update_authors
	
	* src/nautilus-window-menus.c: (help_menu_about_nautilus_callback):
	made it call nautilus_about_update_authors if the about dialog
	already exists
	
	* libnautilus-extensions/nautilus-graphic-effects.c:
	just moved a comment to it's proper place

2000-09-09  Ali Abdin  <aliabdin@aucegypt.edu>

        Should fix bug #2229. Also make HTML output more 'valid'

        * components/help/converters/gnome-db2html2/gdb3html.h:
        Add legalnotice tag, and prototype of print_footer (since it is no
        longer static)

        * components/help/converters/gnome-db2html2/sect-elements.[ch]:
        (sect_inlinegraphic_start_element): Forgot to initialize a
        variable.

        (sect_legalnotice_start_element),
        (sect_legalnotice_characters),
        (sect_legalnotice_end_element): New functions for special handling of
        the legalnotice tag.

        (sect_para_end_element),
        (sect_para_start_element): Modified to also work in the legalnotice
        tag

        (sect_article_end_element): Commented out an area of code that creates
        erroneous HTML tags (now that the 'footer' prints them out).

        (sect_title_characters): Somebody forgot to 'open' the <HEAD>

        * components/help/converters/gnome-db2html2/toc-elements.c:
        (toc_artheader_end_element): Make 'Copyright' link to the legalnotice.

        * components/help/help-method.conf:
        Add 'gnome-help:' at mjs' suggestion (do we need to remove 'help:'
        now?)

2000-09-08  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 773, Context menu items wrong when used on Trash item

	Removed items that are improper when the Trash icon 
	is in the selection.
	
	* src/file-manager/fm-directory-view.c:
	* src/file-manager/fm-directory-view.h:
	(fm_directory_view_real_create_selection_context_menu_items):
	Do a check for Trash in selection.  Disable Duplicate and
	Make Link	
		
	* src/file-manager/fm-icon-view.c:
	(fm_icon_view_create_selection_context_menu_items):
	Do a check for Trash in selection.  Disable Rename

2000-09-08  Eskil Heyn Olsen  <eskil@eazel.com>

	* components/services/install/idl/trilobite-eazel-install.idl:
	* components/services/install/command-line/eazel-alt-install-corba.
	c: (eazel_preflight_check_signal):
	* components/services/install/lib/eazel-install-corba-callback.h:
	* components/services/install/lib/eazel-install-corba-callback.c:
	(impl_preflight_check), (eazel_install_callback_class_initialize):
	* components/services/install/lib/eazel-install-public.h:
	* components/services/install/lib/eazel-install-private.h:
	* components/services/install/lib/eazel-install-object.c:
	(xml_from_packagedata_list), (eazel_install_class_initialize),
	(eazel_install_emit_preflight_check),
	(eazel_install_emit_preflight_check_default):
	* components/services/install/lib/eazel-install-rpm-glue.h:
	* components/services/install/lib/eazel-install-rpm-glue.c:
	(eazel_install_get_total_size_of_packages),
	(eazel_install_start_transaction):
	Implemented bug #2858. The preflight signal now gets the toplevel
	packages to install and can return true/false.
	Amazing how much I had to change to alter one corba signal...

	* components/services/docs/installer-security-issues
	About the security issues of libeazelinstall (this is an email
	that gives a rundown of how the installer handles downloaded,
	filepermissions etc).
	
	* components/services/install/lib/eazel-install-metadata.c:
	(get_conf_int):
	Fixed a bug where it returned the wrong variable (odd that -Werror
	didn't stop it)
	
	* components/services/install/lib/eazel-install-types.c:
	(categorydata_new), (categorydata_destroy_foreach),
	(packagedata_new), (packagedata_destroy), 
	(packagedata_remove_soft_dep),
	uses trilobite_debug now
	(packagedata_fill_from_rpm_header),
	Read the provides from the header. They're not used yet, but
	they'll be used for handling bug 2583 (and part of 1514).
	
	* components/services/install/lib/eazel-install-types.h:
	Added a glist to packagedata, contains the basenames of the files
	the package provides.
	
2000-09-08  Rebecca Schulman  <rebecka@eazel.com>

	* libnautilus-extensions/nautilus-search-uri.c:
	(nautilus_self_check_search_uri):
	Fixed make check for my earlier changes
	* src/nautilus-search-bar-criterion.c: (get_emblem_location_for):
	fixed the emblem criteria uris so they now are recognized by
	medusa

2000-09-08  Rebecca Schulman  <rebecka@eazel.com>

	Fixed bugzilla.eazel.com bugs 1937, 2014, and 2633,
	to disallow repeat criteria in the search bar,
	limit number of criteria on the bar, 
	and to disallow searching  for the emblem
	"erase" which doesn't really exist.

	* libnautilus-extensions/nautilus-search-uri.c: (parse_uri):
	a few more text brush ups
	* src/nautilus-complex-search-bar.c:
	* src/nautilus-complex-search-bar.h:
	(search_bar_criterion_type_changed_callback),
	(update_criteria_choices),
	(nautilus_complex_search_bar_initialize), (more_options_callback),
	(fewer_options_callback), (update_options_buttons_state),
	(nautilus_complex_search_bar_get_search_criteria):
	Add a callback to update when a criteria is added removed or
	changed, to update what criteria are sensitive in the menus
	Added an accessor function to get the list of search criteria
	so the search criterion class can use it to figure out
	what to leave sensitive in the available criteria menu.
	Add code to desensitize the "more options" button when
	all criteria are displayed.

	* src/nautilus-search-bar-criterion-private.h:
	* src/nautilus-search-bar-criterion.c:
	(nautilus_search_bar_criterion_initialize_class),
	(nautilus_search_bar_criterion_destroy),
	(nautilus_search_bar_criterion_new),
	(nautilus_search_bar_criterion_initialize),
	(nautilus_search_bar_criterion_new_from_values),
	(nautilus_search_bar_criterion_next_new),
	(nautilus_search_bar_criterion_new_with_type),
	(nautilus_search_bar_criterion_first_new),
	(nautilus_search_bar_criterion_get_location),
	(get_next_default_search_criterion_type),
	(nautilus_search_bar_criterion_update_valid_criteria_choices),
	(make_emblem_value_menu), (criterion_type_changed_callback),
	(emblems_changed_callback), (criterion_is_of_type),
	(criterion_type_already_is_displayed), (get_next_criterion_type):
	* src/nautilus-search-bar-criterion.h:
	convert this to a gtk class so that it can emit signals
	(criterion_type_changed) and let the bar know.
	Add code to handle figuring out when criteria has changed,
	and what criteria are still available.  Add special code
	to get rid of the erase emblem.  Also, since it is now a 
	gtk class, add more type checking where appropriate.

2000-09-08  Gene Z. Ragan  <gzr@eazel.com>

	* libnautilus-extensions/nautilus-file.c:
	(nautilus_file_forget_activation_uri):
	Add call to nautilus_directory_async_state_changed.
	
	* libnautilus-extensions/nautilus-link.c:
	(nautilus_link_set_link_uri):
	Removed private nautilus_directory_async_state_changed call.
	
	* src/nautilus-window-menus.c: (help_menu_about_nautilus_callback):
	Added middle inital to my name.
	
2000-09-08  Mathieu Lacage  <mathieu@eazel.com>

	* components/tree/nautilus-tree-view.c: fix many bugs.
	The tree view now receives drops as colors, backgrounds,
	and emblems. I am supposed to remove emblems per Arlo
	request but will do so later after having moved the code 
	to the list view.
	* libnautilus-extensions/nautilus-drag.h: add a shared 
	declaration

2000-09-08  Arlo Rose  <arlo@eazel.com>

	* icons/i-web-72.png:
	Added yet another placeholder image for web view.
	This is not final, but looks better than the previous
	placeholder Andy added.

2000-09-08  Robin * Slomkowski  <rslomkow@eazel.com>

	* README: updated to note we use LIBXML_1_BRANCH

2000-09-08  Robey Pointer  <robey@eazel.com>

	* components/services/install/lib/eazel-install-metadata.c:
	(init_default_install_configuration),
	(init_default_transfer_configuration):

	Removed "uninstall" and "package-list-storage-path" settings, and
	clarified update/downgrade to "allow-update", "allow-downgrade" in
	the gconf tree.

2000-09-08  Gene Z. Ragan  <gzr@eazel.com>

	* libnautilus-extensions/nautilus-link.c:
	(nautilus_link_set_link_uri):
	Added a call to nautilus_directory_async_state_changed ()
	as part of my last bug fix to update the NautilusFile
	that its activation URI has changed.

2000-09-08  J Shane Culpepper  <pepper@eazel.com>

	* components/services/login/nautilus-view/nautilus-login-view.c:
	(generate_login_form):
	* components/services/nautilus-dependent-shared/shared-service-widg
	ets.c: (show_feedback):
	* components/services/startup/nautilus-view/nautilus-service-startu
	p-view.c: (generate_startup_form):
	* components/services/summary/nautilus-view/nautilus-summary-view.c
	: (generate_summary_form):

	Converting to nautilus label to use aa text.

2000-09-08  John Sullivan  <sullivan@eazel.com>

	Fixed bug 2120 (Shouldn't be able to create new files in
	search view) and most of bug 2916 (Shouldn't be able to
	create new files in Trash). Also fixed the more general
	but unreported bug: Shouldn't be able to create new
	files in read-only directories.

	* src/file-manager/fm-directory-view.h,
	* src/file-manager/fm-directory-view.c:
	(fm_directory_view_is_read_only): New function, overridable via
	function pointer, that reports whether the contents of a 
	directory view are entirely read-only. 		
	(fm_directory_view_real_is_read_only): Default implementation of
	is_read_only, checks the permissions of the model NautilusDirectory.
	(fm_directory_view_supports_creating_files): New function,
	overridable via function pointer, that reports whether a
	directory supports creating new files inside it
	(fm_directory_view_real_supports_creating_files): Default
	implementation of supports_creating_files, returns TRUE unless
	is_read_only is true or the displayed directory is in the trash.
	The remaining part of bug 2916 is that the NautilusFile for 
	"trash:" doesn't think it's in the trash.
	(fm_directory_view_initialize_class): Wire up default function
	pointers.
	(compute_menu_item_info): Make sensitivity of "Move to Trash"
	depend on is_read_only; make sensitivity of "New Folder",
	"Duplicate", and "Create Link" depend on supports_creating_files.
	(fm_directory_view_real_update_menus): Add "New Folder" to the
	set of dynamic ones.
	(get_directory_as_file): New helper function to get a NautilusFile
	object for the displayed directory.
	(showing_trash_directory): New helper function to check whether
	the displayed directory is trash.
	
	* src/file-manager/fm-icon-view.c:
	(get_stored_icon_position_callback): Removed call to
	fm_directory_view_get_model whose result was not used.
	(tighter_layout_callback): Removed an unnecessary cast.
	
	* src/file-manager/fm-search-list-view.c:
	(real_supports_creating_files): Overridden to return FALSE.
	(fm_search_list_view_initialize_class): Wire up overridden
	function pointer.

2000-09-08  Josh Barrow  <linuxfan@ionet.net>

	* components/hardware/nautilus-hardware-view.c: (setup_form_title),
	(setup_overview_form), (setup_CPU_form), (setup_RAM_form),
	(setup_IDE_form): 
	Change all text to aa text using nautilus_label and its friends.

2000-09-08  Andy Hertzfeld  <andy@eazel.com>

	* libnautilus-extensions/nautilus-icon-dnd.c:
	(drag_data_received_callback):
	fixed bug 2919, erase emblem doesn't work anymore.  In fact, all the
	emblems were broken by Mathieu's drag and drop changes; fixed by
	replacing the GtkSelectionItem with the data it points to.
	
2000-09-08  Ali Abdin  <aliabdin@aucegypt.edu>

        Should fix bug #2749, #2754, and #2755

        * components/help/converters/gnome-db2html2/gdb3html.h:
        Add in ENVAR, COMPUTEROUTPUT, and INLINEGRAPHIC tags.

        * components/help/converters/gnome-db2html2/sect-elements.[ch]:
        Add in the above tags to the sect_elements struct.
        (sect_inlinegraphic_start_element): New function to handle inline
        graphics.
        (sect_graphic_start_element): If format was NULL the g_strcasecmp
        would output warning messages screwing up the HTML, changed the code
        around a bit to handle this. Also made this function to be more
        compliant with Eazel style guidelines

2000-09-08  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 2816, Home icon doesn't link to changed home directory.

	The fix required a new private function that invalidates a NautilusFiles
	activation URI and forces it to be reloaded.
	
	* libnautilus-extensions/nautilus-directory-notify.h:
	Added nautilus_file_changed () and nautilus_file_forget_activation_uri ()
	
	* libnautilus-extensions/nautilus-file.c: 
	(nautilus_file_changed),	
	(nautilus_file_forget_activation_uri):
	New function that invalidates the activation URI and frees it and
	sets got_activation_uri to FALSE so that it is reloaded.
	
	* libnautilus-extensions/nautilus-file.h:
	Removed nautilus_file_changed ()
	
	* libnautilus-extensions/nautilus-icon-factory.c:
	* libnautilus-extensions/nautilus-directory-async.c:
	Added include to nautilus-directory-notify.h
	
	* libnautilus-extensions/nautilus-link.c:
	(nautilus_link_set_link_uri):
	Added call to nautilus_file_forget_activation_uri ()
	
	* src/file-manager/fm-desktop-icon-view.c: 
	(event_callback):
	Removed debugging code.

2000-09-08  Mathieu Lacage  <mathieu@eazel.com>

	* components/tree/nautilus-tree-view.c: fixes one more ccrash.
	nautilus_model_node_get_file does not return a refed NautilusFile
	for you. So, must not unref it.

2000-09-08  Mathieu Lacage  <mathieu@eazel.com>

	* components/tree/nautilus-tree-view.c: fix bug 2918.

2000-09-08  Maciej Stachowiak  <mjs@eazel.com>

	* src/nautilus-window-menus.c (help_menu_about_nautilus_callback):
	Added Ali Abdin and Ian McKellar.

	* AUTHORS: Updated to match about box (it would be nice if we
	could keep this name list in just one place).

	* THANKS: New file; I credited everyone who has contributed and
	who is not in AUTHORS, as far as I could tell from the various
	ChangeLogs.

2000-09-08  Andy Hertzfeld  <andy@eazel.com>

	* libnautilus-extensions/nautilus-icon-canvas-item.c:
	(draw_or_measure_label_text), (draw_or_measure_label_text_aa),
	(nautilus_icon_canvas_item_get_max_text_width):
	fixed bug 2060, implement Arlo's text layout scheme, which is now 135 pixel
	instead of 80 in the standard layout mode; it's still 80 in the tighter
	layout mode.
	 
2000-09-07  Rebecca Schulman  <rebecka@eazel.com>

	* components/tree/nautilus-tree-view.c:
	Fixed a "gtk_entry_list_unref" that should
	have been a "gtk_target_list_unref"
	
2000-09-07  Mathieu Lacage  <mathieu@eazel.com>

	Moves the tree view to the new standard way of dnd.
	This now makes it consistant with the rest of the icon
	and list view.
	Fixes a number of bugs in the process: 2897, 2905, 2353
	
	* components/tree/nautilus-tree-view.c: it just changes 
	a lot of things and cleans the code. Dnd should be now fully 
	functional for file drag and drops. Please, test and report
	bugs.

2000-09-07  Maciej Stachowiak  <mjs@eazel.com>

	* components/tree/nautilus-tree-model.c
	(nautilus_tree_model_directory_files_changed_callback): Look up
	the node based on the NautilusFile, not the uri, since the URI may
	have changed, if we are getting a "change" signal.
	
2000-09-07  Eskil Heyn Olsen  <eskil@eazel.com>

	* components/services/install/command-line/eazel-alt-install-corba.
	c: (set_parameters_from_command_line), (md5_check_failed), (main):
	Fixed the setting of server/port/tempdir now that libeazelinstall
	uses gconf.
	Uses the md5_check_failed signal/
	
	* components/services/install/idl/trilobite-eazel-install.idl:
	Added the md5_check_failed signal.
	
	* components/services/install/lib/eazel-install-corba-callback.h:
	* components/services/install/lib/eazel-install-corba-callback.c:
	(impl_md5_check_failed), (eazel_install_callback_get_epv),
	(eazel_install_callback_finalize),
	(eazel_install_callback_class_initialize):
	Added the md5_check_failed signal.
	
	* components/services/install/lib/eazel-install-corba-types.h:
	* components/services/install/lib/eazel-install-corba-types.c:
	(corba_packagedatastructlist_from_packagedata_list),
	(corba_packagedatastruct_from_packagedata),
	(packagedata_from_corba_packagedatastruct):
	Changed corba_packagedatastruct_from_packagedata to return a
	pointer instead of a struct. Hope it doesn't introduce any funky
	leaks in corba_packagedatastructlist_from_packagedata_list.
	
	* components/services/install/lib/eazel-install-md5.h:
	* components/services/install/lib/eazel-install-md5.c:
	(md5_get_string_from_md5_digest):
	Added a method to convert a md5 digest to a human-readable string.
	
	* components/services/install/lib/eazel-install-metadata.c:
	Added authors and includeds trilobite-core-utils (for
	trilobite_debug)
	
	* components/services/install/lib/eazel-install-public.h:
	* components/services/install/lib/eazel-install-object.c:
	(create_temporary_directory),
	Open tmpdir in 0700 instead of 0755.
	(eazel_install_alter_mode_on_temp),
	(eazel_install_delete_downloads), 
	(eazel_install_install_packages),
	(eazel_install_emit_install_progress_default),
	(eazel_install_class_initialize), 
	Changed all 'g_.* ("D: ' to trilobite_debug
	(eazel_install_emit_md5_check_failed),
	(eazel_install_emit_md5_check_failed_default),
	Added the md5_check_failed signal
	(eazel_install_emit_dependency_check_default),
	Modified because of the change in eazel-install-corba-types.
	(eazel_install_emit_done):
	Output cleaning.
	
	* components/services/install/lib/eazel-install-protocols.c:
	(gnome_vfs_xfer_callback), (gnome_vfs_fetch_remote_file),
	(eazel_install_fetch_file), (eazel_install_fetch_package),
	(get_url_for_package):
	Changed all 'g_.* ("D: ' to trilobite_debug
	Output cleaning.
	Always add downloaded file to downloaded_files, thus always doing
	md5 check on them.
	
	* components/services/install/lib/eazel-install-query.c:
	(eazel_install_simple_rpm_query):
	Output cleaning.

	* components/services/install/lib/eazel-install-rpm-glue.c:
	(eazel_install_download_packages),
	(eazel_install_pre_install_packages), (hest),
	(eazel_install_monitor_rpm_propcess_pipe),
	(eazel_install_monitor_subcommand_pipe),
	(eazel_install_do_transaction_md5_check),
	(eazel_install_free_rpm_system_close_db_foreach),
	(eazel_install_free_rpm_system),
	(eazel_install_prepare_rpm_system),
	(eazel_install_fetch_rpm_dependencies), (print_package_list),
	(eazel_install_ensure_deps), (eazel_uninstall_upward_traverse),
	(eazel_uninstall_downward_traverse),
	(eazel_uninstall_check_for_install), (eazel_uninstall_globber):
	Changed all 'g_.* ("D: ' to trilobite_debug
	Output cleaning.

	* components/services/install/lib/eazel-install-xml-package-list.c:
	(generate_xml_package_list), (osd_parse_implementation),
	(osd_parse_softpkg), (osd_parse_shared),
	(parse_osd_xml_from_memory):
	Changed all 'g_.* ("D: ' to trilobite_debug
	Output cleaning.

	* components/services/trilobite/libtrilobite/trilobite-root-client.
	c: (trilobite_root_client_unref),
	(trilobite_root_client_initialize):
	* components/services/trilobite/libtrilobite/trilobite-root-helper.
	c: (trilobite_root_helper_destroy),
	(trilobite_root_helper_initialize):
	Removed some debug output.
	
2000-09-07  Robey Pointer  <robey@eazel.com>

	* components/services/install/lib/eazel-install-metadata.c:
	(get_conf_string), (get_conf_int), (get_conf_boolean):

	Work around fatal API flaw in gconf, so we can detect whether
	ints/bools are set before we substitute default values.

2000-09-07  Andy Hertzfeld  <andy@eazel.com>

	* libnautilus-extensions/nautilus-icon-dnd.c:
	(receive_dropped_tile_image):
	fixed bug 2896, tiled backgrounds don't work in the icon view.
	nautilus_background_receive_dropped_background_image was passing the
	GtkSelectionData object, instead of the data it points to.  Mathieu
	caused this when he reworked the drag and drop stuff recently.
	
	
2000-09-07  John Sullivan  <sullivan@eazel.com>

	Fixed bug 2218 (Duplicate items appear in history list)

	Also changed a few places to compare uris with the new
	nautilus_uris_match instead of strcmp.

	* libnautilus-extensions/nautilus-bookmark.h,
	* libnautilus-extensions/nautilus-bookmark.c:
	(nautilus_bookmark_compare_with): Use nautilus_uris_match.
	(nautilus_bookmark_compare_uris): New function, compares
	bookmarks' uris with nautilus_uris_match; ignores names.
	
	* src/nautilus-window-manage-views.c:
	(nautilus_window_set_displayed_location), (handle_go_elsewhere),
	(open_location): Use nautilus_uris_match.
	
	* src/nautilus-window.c: (nautilus_add_to_history_list):
	Use nautilus_bookmark_compare_uris instead of _compare_with.
	This was the source of the bug. Due to asynchronicity introduced
	sometime after this code was written, when the bookmark for the 
	current location was created it did not	yet know what name to use, 
	and so it did not match any of the old History items that had the 
	correct name. But for the History list we only want one entry per 
	uri anyway, so it needn't have been comparing the names in the 
	first place.

2000-09-07  Andy Hertzfeld  <andy@eazel.com>

	* src/nautilus-sidebar.c: (nautilus_sidebar_initialize):
	fixed bug 1246 by adding event initializing code
	* src/nautilus-window.c: (nautilus_window_constructed):
	removed the sidebar event initializing code from the window class.
	
	* src/nautilus-zoom-control.c:
	(nautilus_zoom_control_initialize_class),
	(nautilus_zoom_control_initialize), (draw_pixbuf_with_prelight),
	(draw_zoom_control_image),
	(nautilus_zoom_control_set_prelight_mode),
	(nautilus_zoom_control_leave_notify),
	(nautilus_zoom_control_motion_notify):
	fixed bug 838, zoom control doesn't prelight, by receiving motion
	events and prelighting appropriately.
	
2000-09-07  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug causing icon view not to display trash:
	URI.
	
	* libnautilus-extensions/nautilus-mime-actions.c:
	(is_known_mime_type):
	New function to return if mime type is recognized.
	Return FALSE if mim tye if NULL or of type
	application/octet-stream.
	
	(nautilus_mime_get_default_component_for_uri_internal),
	(nautilus_do_component_query):
	Call is_known_mime_type () instead of old != NULL check.
	
2000-09-07  Robey Pointer  <robey@eazel.com>

	* components/services/install/lib/eazel-install-metadata.c:
	(done_with_gconf), (check_gconf_init), (get_conf_string),
	(get_conf_int), (get_conf_boolean), (get_urltype_from_string),
	(init_default_install_configuration),
	(init_default_transfer_configuration), (transferoptions_destroy),
	(installoptions_destroy):
	* components/services/install/lib/eazel-install-metadata.h:
	* components/services/install/lib/eazel-install-object.c:
	(eazel_install_new_with_config):
	* components/services/install/lib/eazel-install-public.h:
	* components/services/install/server/main.c:
	(eazel_install_service_factory):
	
	Rip out all the old XML-based configuration code, and replace it
	with gconf-based code.

	* components/services/trilobite/libtrilobite/trilobite-redirect.c:

	Put redirection table into the same subtree as other trilobite
	stuff.  (This may change soon anyway.)

2000-09-08  Daniel Egger  <egger@suse.de>

	* components/help/converters/gnome-db2html2/gdb3html.c:
	Reverted patch from 2000-09-06 on popular demand because
	it doesn't match the Eazel styleguide.

2000-09-07  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 2134, items cannot be dragged from desktop or windows
	onto Trash icon.
	
	* libnautilus-extensions/nautilus-drag.c:
	(nautilus_drag_default_drop_action_for_icons):
	Check and see if target is trash: URI. If it is,
	use find_directory to locate the actual trash directory
	URI.
	
	* libnautilus-extensions/nautilus-file-operations.c:
	(nautilus_file_operations_copy_move):
	Check and see if target is trash: URI. If it is,
	use find_directory to locate the actual trash directory
	URI for the volume of the source file.
	
2000-09-07  Michael Engber  <engber@eazel.com>
	
	Added Robin to the about box.
	* src/nautilus-window-menus.c: (help_menu_about_nautilus_callback):

2000-09-07  John Sullivan  <sullivan@eazel.com>

	Fixed bug 2875 (update set of built-in bookmarks)

	* data/static_bookmarks.xml:

	Fixed bug 2872 (Complaint about bookmark location mismatch 
	when visiting new folder)

	* libnautilus-extensions/nautilus-file-utilities.h:
	* libnautilus-extensions/nautilus-file-utilities.c:
	(nautilus_uris_match): New function, compares two uris
	after canonicalizing each.
	
	* src/nautilus-window-manage-views.c:
	(check_last_bookmark_location_matches_window):
	Use nautilus_uris_match to compare bookmark's uri with
	window's uri.

2000-09-07  Ramiro Estrugo  <ramiro@eazel.com>

	Turn on smooth fonts in the icon view.  This is controlled by the
	SMOOTH_GRAPHICS preference.  I tried to cause a minimum amount of
	disruption to the icon-canvas-item beast.  For this reason, there
	are some serious preformance problems.  I plan to attack those
	next.

	In case of emergency, i left a life boat in there.  Just comment
	out the SMOOTH_FONTS define in the top of the file.  I expect to
	yank this out in the next day or so.

	* libnautilus-extensions/nautilus-icon-canvas-item.c:
	(draw_or_measure_label_text), Teach it about the smooth fonts
	case.  (measure_label_text),  Same here.
	(draw_label_text), Here too.  (draw_or_measure_label_text_aa), New
	function to do the drawing or measuring using NautilusScalableFont
	instead of GdkFont.
	(draw_label_text_aa): New function that draws the smooth text into
	a pixbuf so what we can continue to use the old rendering
	machinery.  This is the reason for at least on of the performance
	problems.  We should be able to render directly into the canvas
	item's buffer.  
	
2000-09-07  Ramiro Estrugo  <ramiro@eazel.com>

	* libnautilus-extensions/nautilus-icon-canvas-item.c:
	(nautilus_icon_canvas_item_initialize_class),
	(draw_or_measure_label_text):
	Simplify the highlight color initialization.
	
	* libnautilus-extensions/nautilus-scalable-font.c:
	(nautilus_text_layout_paint):
	Restore rendering in the passed in color.  Add a mini hack to make
	sure the color is opaque.
	
2000-09-07  John Sullivan  <sullivan@eazel.com>

	Better job of what I did in my last checkin. I caught one case
	before, but there are two other cases I skipped. Now they're
	all equally de-fatal.

	* src/nautilus-window-manage-views.c:
	(check_last_bookmark_location_matches_window), (handle_go_back),
	(handle_go_forward), (handle_go_elsewhere):

2000-09-07  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 2445,  Some volume monitor code applies only to desktop case.
	Fixed bug 2452,  find_volumes confused about which volumes to include.
	Fixed bug 2451,  Incorrect test for removability of ISO9660 volumes.
	
	* libnautilus-extensions/nautilus-volume-monitor.c: 
	* libnautilus-extensions/nautilus-volume-monitor.h:
	(floppy_sort):
	Changed function to use NautilusVolumes as opposed to paths
	
	(nautilus_volume_monitor_volume_is_removable):
	New function to check and see if volume is removable.
	
	(nautilus_volume_monitor_get_removable_volumes):
	New function to return a list of removable NautilusVolumes
	
	(nautilus_volume_monitor_get_volume_name):
	New function to return a human readable name of volume
	
	(nautilus_volume_monitor_volume_is_mounted),
	(mount_volume_floppy_set_state), (mount_volume_mount),
	(find_volumes), (nautilus_volume_monitor_mount_unmount_removable):
	Clean up and bug fix work.
	
	
	* src/file-manager/fm-desktop-icon-view.c: (create_mount_link),
	(fm_desktop_icon_view_create_background_context_menu_items),
	(volume_unmounted_callback):
	Use new functions in NautilusVolumeMonitor.

2000-09-07  John Sullivan  <sullivan@eazel.com>

	* src/nautilus-window-manage-views.c: (handle_go_elsewhere):

	De-fatalized bug 2872 (Common crash when navigating, complaint
	about last_location_bookmark not matching window->location).

	Changed an assert (fatal) to a message (annoying) to prevent
	this now very common bug from being fatal. I'll fix the real
	problem soon.

2000-09-07  Mathieu Lacage  <mathieu@eazel.com>

	* components/tree/nautilus-tree-view.c: add support for NautilusDragInfo.
	* libnautilus-extensions/nautilus-drag.c: add new scroll calculation fucntion.
	(nautilus_drag_autoscroll_calculate_delta):
	* libnautilus-extensions/nautilus-drag.h: add decalrtion of scroll function
	plus bits and pieces of constants used everywhere.
	* libnautilus-extensions/nautilus-icon-dnd.c:
	(auto_scroll_timeout_callback): move this to the shared version of the scroll
	* libnautilus-extensions/nautilus-list.c: implement auto scrolling.
	(nautilus_list_drag_leave), (nautilus_list_real_scroll),
	(auto_scroll_timeout_callback), (nautilus_list_start_auto_scroll),
	(nautilus_list_stop_auto_scroll), (nautilus_list_drag_motion):

2000-09-07  Eli Goldberg  <eli@eazel.com>

	* docs/smoketests.html:
	Updated to show test files in /h/public/QE/smoketests

2000-09-07  Ramiro Estrugo  <ramiro@eazel.com>

	* libnautilus-extensions/nautilus-label.c:
	(nautilus_label_initialize):
	Make the default font size something more reasonable.
	
2000-09-07  Ramiro Estrugo  <ramiro@eazel.com>

	* libnautilus-extensions/nautilus-icon-canvas-item.c:
	(nautilus_icon_canvas_item_set_smooth_font_size):
	The new font was not getting assigned.
	
2000-09-07  Ramiro Estrugo  <ramiro@eazel.com>

	* libnautilus-extensions/nautilus-icon-container.c: (destroy),
	(nautilus_icon_container_initialize),
	(nautilus_icon_container_update_icon),
	(nautilus_icon_container_set_label_font_for_zoom_level),
	(nautilus_icon_container_set_smooth_label_font):
	* libnautilus-extensions/nautilus-icon-container.h:
	* libnautilus-extensions/nautilus-icon-private.h:
	Add support for smooth fonts.  We simply manage one font and an
	array of sizes.  The management of the smooth font parallels that
	of regular non smooth Gdk fonts, except we have just one.  Instead
	of an array of fonts, we have an array of font sizes.  We use
	these to update the canvas icon items.
	
2000-09-07  Ramiro Estrugo  <ramiro@eazel.com>

	* libnautilus-extensions/nautilus-scalable-font.h:
	* libnautilus-extensions/nautilus-scalable-font.c:
	(nautilus_scalable_font_draw_text), (nautilus_text_layout_paint),
	(nautilus_gdk_pixbuf_new_from_text):
	Add function to create a GdkPixbuf from a string.  Also fixed a
	debuggin typo from before.

	* test/test-nautilus-font.c: (create_named_background),
	(rgba_run_alpha), (pixbuf_draw_rectangle),
	(pixbuf_draw_rectangle_around), (main):
	Add text to GdkPixbuf to GdkPixbuf compositing test.  Also add a
	bunch of hacks to make the tests more useful.
	
2000-09-07  Mathieu Lacage  <mathieu@eazel.com>

	First work toward bug 2353, fixes bug 2570, 1289
	
	* components/tree/nautilus-tree-view.c: fix a dnd bug in
	gtk_drag_dest_set.
	* libnautilus-extensions/nautilus-drag.c: (nautilus_drag_init):
	initialize the new field drop_occured to FALSE.
	* libnautilus-extensions/nautilus-drag.h: new field drop_occured.
	* libnautilus-extensions/nautilus-icon-dnd.c: use the new field
	and make it behave slightly more sanely by doing actual actions
	in data_received instead of drag_drop. This is the only way to avoid
	race conditions. (drag_data_received_callback), (drag_motion_callback),
	(drag_drop_callback)
	* libnautilus-extensions/nautilus-list.c:
	(nautilus_list_initialize_class), (nautilus_list_dnd_initialize),
	(nautilus_list_initialize), (nautilus_list_drag_start),
	(nautilus_list_ensure_drag_data), (nautilus_list_drag_begin),
	(nautilus_list_drag_end), (nautilus_list_drag_leave),
	(nautilus_list_find_drop_target), (nautilus_list_get_drop_action),
	(nautilus_list_drag_motion), (nautilus_list_drag_drop),
	(nautilus_list_drag_data_received):
	add support for the drop_occured field, fix the same bug as in tree view
	and make it behave slightly more sanely as in icon view.
	The tree view now needs some work to catch up with all those changes.
	* src/file-manager/fm-list-view.c: (fm_list_handle_dropped_icons):
	space.

2000-09-07  Ramiro Estrugo  <ramiro@eazel.com>

	* libnautilus-extensions/nautilus-scalable-font.c:
	(nautilus_text_layout_free), (nautilus_text_layout_new),
	(nautilus_text_layout_paint):
	* libnautilus-extensions/nautilus-scalable-font.h:
	Add support for drawing underlined text.  I also added a FIXME for
	the issue of hard coding the underline baseline rather than
	fetching the information from the rendred string.
	
	* test/test-nautilus-font.c: (main):
	Add underlined text test.
	
2000-09-07  Ramiro Estrugo  <ramiro@eazel.com>

	* libnautilus-extensions/nautilus-scalable-font.c:
	(nautilus_scalable_font_measure_text), (invert_glyph),
	(nautilus_scalable_font_draw_text),
	(nautilus_scalable_font_draw_text_lines_with_dimensions),
	(nautilus_scalable_font_draw_text_lines),
	(nautilus_text_layout_paint):
	* libnautilus-extensions/nautilus-scalable-font.h:
	Add support for drawing inverted text.  Also cleanup the rendering
	function a bit.  
	
	* libnautilus-extensions/nautilus-icon-factory.c: (embed_text):
	* libnautilus-extensions/nautilus-label.c: (render_buffer_pixbuf):
	* src/nautilus-about.c: (draw_aa_string):
	* src/nautilus-sidebar-tabs.c: (draw_one_tab_plain),
	(draw_one_tab_themed):
	Update all these for the new inverted scalable font api.
	
	* test/test-nautilus-font.c: (main):
	Add a inverted text test.
	
2000-09-07  Eskil Heyn Olsen  <eskil@eazel.com>

	* nautilus-installer/src/Makefile:
	Just to clear things up : this file is in cvs since it's 
	not created by configure.in (yet)

	* nautilus-installer/src/Makefile.am:
	* nautilus-installer/src/link.sh:
	makefile/link stroking to make it work after the changes
	to trilobite-core-utils.

	* libnautilus-adapter/Makefile.am
	Removed libnautilus.la to fix build

2000-09-07  Maciej Stachowiak  <mjs@eazel.com>

	* components/tree/nautilus-tree-model.c (report_node_added):
	ifdef'd out a g_warning that happens a lot more often than I
	expected.

2000-09-07  Maciej Stachowiak  <mjs@eazel.com>

	* libnautilus-adapter/Makefile.am: Link against libnautilus.

	* src/nautilus-component-adapter-factory.h,
	src/nautilus-component-adapter-factory.c: Fist cut at the easy to
	use wrapper interface for the soon to come adapter component (part
	of the work for bugzilla.eazel.com 1994). I made this a singleton
	object with the object actually exposed, but maybe I should hide
	the object details completely and just expose the actually useful
	function (which will instantiate the singleton when/if
	appropriate).

	* src/Makefile.am: Add to the build. Link against libnautilus-adapter.

2000-09-07  Ramiro Estrugo  <ramiro@eazel.com>

	* libnautilus-extensions/nautilus-scalable-font.c:
	(text_layout_free_row), (nautilus_text_layout_free),
	(nautilus_text_layout_new), (nautilus_text_layout_paint):
	* libnautilus-extensions/nautilus-scalable-font.h:
	Add text layout functions copied from
	libgnomeui/gnome-icon-text.[ch] and modified to work with
	NautilusScalalbleFont and GdkPixbuf instead of GdkFont and
	GdkDrawable.

	* test/test-nautilus-font.c: (main):
	Add text layout test.
	
2000-09-07  Ramiro Estrugo  <ramiro@eazel.com>

	* libnautilus-extensions/nautilus-icon-factory.c: (embed_text):
	Make the empty line height 1/2 of the font size to cram more stuff
	into the embedded text.
	
	* libnautilus-extensions/nautilus-label.c:
	(nautilus_label_size_request), (render_buffer_pixbuf),
	(label_get_empty_line_height),
	(label_get_total_text_and_line_offset_height),
	(label_recompute_line_geometries):
	Update for scalable font changes.
	
	* libnautilus-extensions/nautilus-scalable-font.c:
	(nautilus_scalable_font_measure_text_lines),
	(nautilus_scalable_font_draw_text_lines_with_dimensions),
	(nautilus_scalable_font_draw_text_lines):
	* libnautilus-extensions/nautilus-scalable-font.h:
	Add empty_line_height argument to text line measuring and drawing
	functions.  Use this in both measure and drawing computations.
		
	* test/test-nautilus-font.c: (gdk_pixbuf_draw_rectangle),
	(draw_rectangle_around), (main):
	Update for scalable font changes.  Also draw a box around area
	that is being clipped (or measured) to determine whether things
	work precisely.

2000-09-07  Eskil Heyn Olsen  <eskil@eazel.com>

	* components/services/install/command-line/eazel-alt-install-corba.
	c: (install_failed), (main):
	Default to services.eazel.com instead of ham.eazel.com
	Nicer print for install failed in the case the package is already
	installed.
	Free the category & package date structures.
	
	* components/services/install/lib/eazel-install-corba-callback.c:
	(impl_install_failed), (impl_uninstall_failed):
	Free some category & package date structures (leak fixing project)
	
	* components/services/install/lib/eazel-install-corba-types.c:
	(categorydata_list_from_corba_categorystructlist):
	Fixed a g_new(categorydata) to categorydata_new
	
	* components/services/install/lib/eazel-install-corba.c:
	(impl_Eazel_Install_install_packages),
	(impl_Eazel_Install_simple_query):
	Inserted some newlines (exiting eh ?)
	
	* components/services/install/lib/eazel-install-md5.h:
	* components/services/install/lib/eazel-install-md5.c:
	(md5_get_digest_from_md5_string):
	Added a call that converts a md5 string into a 16 byte digest
	string.
	
	* components/services/install/lib/eazel-install-object.c:
	(eazel_install_finalize):
	Some newlines!!
	
	* components/services/install/lib/eazel-install-protocols.h:
	* components/services/install/lib/eazel-install-protocols.c:
	(http_fetch_remote_file), (eazel_install_fetch_package),
	(eazel_install_fetch_package_which_provides),
	(get_url_for_package):
	Added comments to what get_url_for_package and
	get_search_url_for_package does.
	Removed excess code from http_fetch_remote_file (creation of temp
	dir).
	Changed get_url_for_package to take a packagedata object as last
	argument. This is used for setting the serverside md5. Also uses
	trilobite_fetch_uri now.
	
	* components/services/install/lib/eazel-install-query.c:
	(eazel_install_simple_rpm_query):
	Inserted newlines (okay, I do that a lot, it makes the code
	readable...)
	
	* components/services/install/lib/eazel-install-rpm-glue.c:
	(eazel_install_flatten_categories),
	Changed to initally copy the category->packages. That way I don't
	end up having a list in the category where the first element is
	NULL (leak).
	(eazel_install_download_packages),
	(eazel_install_pre_install_packages),
	Nuke the modifies list after called check_existing. No reason to
	send those to the client, since the status flags is updated to
	show that the package is already installed.
	(eazel_install_do_transaction_md5_check),
	Finished the md5 checking (thus my required milestone bugs are
	done now, woohoo)
	(eazel_install_prune_packages),
	Commented out the block that destroys packagedata objects.
	(eazel_install_check_existing_packages),
	Set the stats to "already installed".
	(eazel_install_fetch_rpm_dependencies),
	(eazel_uninstall_check_for_install):
	Removed silly g_messages in danish that I used for debugging.
	
	* components/services/install/lib/eazel-install-types.h:
	Removed some weird old structure defines.
	
	* components/services/install/lib/eazel-install-types.c:
	(categorydata_new), (categorydata_destroy_foreach),
	(packagedata_destroy):
	Added some more messages in the category/packagedata alloc/dealloc
	debugging.
	
	* components/services/install/lib/eazel-install-xml-package-list.c:
	(generate_xml_package_list), (osd_parse_implementation),
	(osd_parse_softpkg), (osd_parse_shared),
	(parse_osd_xml_from_memory):
	Added D: to some stdout stuff.
	Decodes the MD5 tag
	Had to add a hack to compensate for lack of useragent in gnome-vfs
	http (bug 2862)
	
	* components/services/trilobite/libtrilobite/trilobite-core-utils.h
	* components/services/trilobite/libtrilobite/trilobite-core-utils.c
	: (trilobite_fetch_uri), (trilobite_fetch_uri_to_file),
	(trilobite_fetch_uri), (trilobite_fetch_uri_to_file):
	Wrote "slim" versions that use libghttp, for the bootstrap
	installer.
	
	* nautilus-installer/src/.cvsignore:
	Ignore the prezip binary
	* nautilus-installer/src/Makefile:
	* nautilus-installer/src/link.sh:
	Makefile cosmetics
	
	* nautilus-installer/src/rpmsearch.cgi:
	The makeshift rpmsearch cgi script.

	* libnautilus-adapter/.cvsignore
	stuff to ignore stuff.
	
2000-09-06  Daniel Egger  <egger@suse.de>

	* components/help/converters/gnome-db2html2/gdb3html.c: 
	A small beatification.

2000-09-06  Raph Levien  <raph@acm.org>

	* librsvg/test-ft-gtk.c: Added "-a" option for attaching AFM
	files, used to confirm that bugzilla.eazel.com 2141 affects
	TrueType and not Type1 fonts. Also added const to filename
	argument.

	* librsvg/rsvg.c (rsvg_start_svg): Patch for bugzilla.eazel.com
	2239. If width and height are not specified in the SVG file,
	defaults are used. Previously, the creation of the pixbuf was
	failing, causing downstream code to segfault on the NULL.

2000-09-07  Andy Hertzfeld  <andy@eazel.com>

	* libnautilus-extensions/nautilus-background.c:
	(nautilus_background_draw_aa),
	(nautilus_background_set_color_no_emit),
	(nautilus_background_set_image_uri_no_emit):
	
	fixed bug 1899, background customization lost when theme changes,
	by clearing the color when the an image is set.  Also, fixed
	bug where color customization wasn't working for the arlo theme,
	by removing the solid color case in background_draw_aa.
	
2000-09-06  Maciej Stachowiak  <mjs@eazel.com>

	* src/nautilus-application.c, src/nautilus-shell.c: Fixed FIXME
	bugzilla.eazel.com 2535 (had to be fixed once I made the idl file
	properly includable).

2000-09-06  Maciej Stachowiak  <mjs@eazel.com>

	* libnautilus/Makefile.am: Fix makefile problem

2000-09-06  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 2011, Numeric keypad enter key doesn't work
	right in Search field.

	Fixed bug 2012, Undo doesn't work in search 
	text-entry fields.

	I switched the GtkEntry items to be NautilusEntry items
	and wired up the undo signal handlers.
	
	* src/nautilus-complex-search-bar.c:
	* src/nautilus-search-bar-criterion-private.h:
	* src/nautilus-search-bar-criterion.c:
	(nautilus_search_bar_criterion_destroy),
	(nautilus_search_bar_criterion_new_from_values):
	* src/nautilus-search-bar-criterion.h:
	* src/nautilus-simple-search-bar.c:
	(nautilus_simple_search_bar_initialize),
	(nautilus_simple_search_bar_destroy),
	(nautilus_simple_search_bar_set_location),
	(nautilus_simple_search_bar_get_location):

2000-09-06  John Sullivan  <sullivan@eazel.com>

	I almost fixed bug 2598 ("Select All Files" enabled when the
	directory is empty), only to realize at the last moment that
	there is no current API to tell whether a directory view is
	displaying any files or not (just as there is no API to tell
	the count of displayed files, which is part of the problem
	with bug 480).

	While fixing this, I changed the directory view menu-updating 
	mechanism so that the real work gets done in an idle handler 
	instead of immediately, to prevent/fix performance problems 
	caused by multiple menu	updates happening in succession. So I'm
	checking in this performance change but not yet addressing
	bug 2598 itself.

	* src/file-manager/fm-directory-view.c:
	(fm_directory_view_destroy): remove menu-updating idle handler.
	(update_menus_idle_callback): New function, calls
	fm_directory_view_update_menus and resets idle handler id.
	(schedule_update_menus): New function, adds idle handler that
	calls update_menus_idle_callback.
	(remove_custom_icons_callback), 
	(fm_directory_view_notify_selection_changed),
	(fm_directory_view_load_uri),
	(fm_directory_view_trash_state_changed_callback),
	(fm_directory_view_real_merge_menus): schedule menu update instead
	of doing it immediately.
	(compute_menu_item_info): Add FIXME with bug 2598 here.
	(fm_directory_view_real_update_menus): Update Select All item.

000-09-06  Maciej Stachowiak  <mjs@eazel.com>

	* libnautilus-adapter/nautilus-adapter-factory.idl: New IDL
	interface for the special adapter component that will be used to
	wrap ordinary Bonobo components to look like Nautilus::Views as
	part of the solution to bugzilla.eazel.com #1994.
	* libnautilus-adapter/Makefile.am: Build a library containing the
	stubs and sekeletons.

	* libnautilus/nautilus-view-component.idl: Some changes so this
	IDL file can be included in others safely.
	* libnautilus/Makefile.am: Made necessary build adjustments for
	the above.

	* configure.in, Makefile.am: add libnautilus-adapter directory to
	build.
	
2000-09-06  Robin * Slomkowski  <rslomkow@eazel.com>

	* README: added requirment of BEFORE_NEW_UI_HANDLER_1
	tag for bonobo, gtkhtml, eog, xpdf

2000-09-06  Andy Hertzfeld  <andy@eazel.com>

	* src/nautilus-sidebar-tabs.c: (get_tab_width):
	fixed bug 2505, scale in sidebar tabs shouldn't be hardwired.
	This was made irrelevant when we changed it to use scalable fonts
	instead of the old scaling hack, so I'm just removing the fixme.
	
2000-09-06  Raph Levien  <raph@acm.org>

	* librsvg/test-ft-gtk.c (test_ft_quit): Invoke rsvg_ft_ctx_done()
	to facilitate testing of cleanup and for checking for mem leaks.

	* librsvg/rsvg-ft.c: Actually evict glyphs when glyph cache
	becomes full. Fixed some mem leaks in rsvg_ft_ctx_done - it
	wasn't freeing everything in the context.

2000-09-06  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 2816, Home icon doesn't link to changed home directory.

	Now the link is updated both at dekstop launch and whenever
	the user changed the preference in the Navigation pane of
	the preferences dialog.
	
	* src/file-manager/fm-desktop-icon-view.c: (home_uri_changed),
	(fm_desktop_icon_view_initialize), (find_and_update_home_link),
	(place_home_directory), (find_and_rename_trash_link),
	(remove_old_mount_links):

2000-09-06  Andy Hertzfeld  <andy@eazel.com>

	* src/nautilus-sidebar-title.c: (update_font):
	fixed bug 2499, font leak in sidebar title.
	
	* icons/vector/Makefile.am:
	* icons/vector/vector.xml:
	fixed bug 2206, vector icon zoom control draws wrong, by removing
	the custom zoom control for the vector theme, which was
	experimental and not intended to stay around.

2000-09-06  Robey Pointer  <robey@eazel.com>

	* components/services/install/lib/eazel-install-md5.c:
	(_byte_reverse), (md5_update), (md5_final), (md5_get_digest),
	(md5_get_digest_from_file), (main):
	* components/services/install/lib/eazel-install-md5.h:

	Fix evil gint/gchar types in MD5 to use native types according to
	the style guide.
	
2000-09-06  John Sullivan  <sullivan@eazel.com>

	Fixed bug 1794 (New directory view background context menu design)

	Any complaints or revisions of the context menus in directory
	views should be written up as new bugs.

	* libnautilus-extensions/nautilus-gtk-extensions.h,
	* libnautilus-extensions/nautilus-gtk-extensions.c:
	(nautilus_gtk_menu_insert_separator): New function, slight
	generalization of _append_separator that takes a position.
	(nautilus_gtk_menu_append_separator): Now calls _insert_separator.
	
	* src/file-manager/fm-icon-view.h: Added supports_auto_layout 
	function pointer for subclasses to optionally override.
	
	* src/file-manager/fm-icon-view.c: 
	renamed details->updating_bonobo_marked_menu_item to
	updating_toggle_menu_item since I realized that it's not
	a Bonobo-specific problem.
	(tighter_layout_callback): updated for API changes.
	(fm_icon_view_using_auto_layout),
	(fm_icon_view_using_tighter_layout): New convenience function
	to share a little code.
	(compute_menu_item_info): Changed toggle_item boolean parameter
	to menu_item_type that returns an enum for normal, check,
	radio, and subtree items; moved some layout-related items in
	here so the context menu can avoid duplicating code.
	(context_menu_layout_radio_item_callback),
	(append_one_context_menu_layout_item): New functions, used by
	layout items in context menu. 
	(insert_one_context_menu_item): Now handles the various menu item 
	types returned by compute_menu_item_info, and returns the new item.
	(append_one_context_menu_item): Now returns the new item.
	(fm_icon_view_create_background_context_menu_items): Add the
	layout items to the context menu per bug 1794.
	(fm_icon_view_supports_auto_layout): New function, calls
	virtual function.
	(real_supports_auto_layout): Returns TRUE.
	(fm_icon_view_initialize_class): Wire up supports_auto_layout.
	(update_layout_menus): Now skips some work if supports_auto_layout
	is false; also updates reversed_order item in a way that works
	even the reversed_order field was changed elsewise.
	(fm_icon_view_get_directory_sort_by),
	(fm_icon_view_set_directory_sort_by),
	(fm_icon_view_get_directory_sort_reversed),
	(fm_icon_view_set_directory_sort_reversed),
	(fm_icon_view_get_directory_auto_layout),
	(fm_icon_view_set_directory_auto_layout): Bail out early if
	supports_auto_layout is false.
	(fm_icon_view_begin_loading): Refactor a little.
	(insert_bonobo_menu_item): Handle the different menu item types
	returned by compute_menu_item_info.
	(set_sort_criterion_by_path): New function, extracted from
	sort_callback so it could be used elsewhere.
	(sort_callback): Now calls set_sort_criterion_by_path.
	(sort_direction_callback): Changed signature so it can be used
	for both Bonobo and Gtk menus; changed implementation not to
	rely on Bonobo menu state.
	(manual_layout_callback): Changed signature so it can be used
	for both Bonobo and Gtk menus
	(layout_changed_callback),  (icon_position_changed_callback): 
	Use new convenience functions.
	(fm_icon_view_merge_menus): Use insert_bonobo_menu_item for
	more items to avoid duplicating code with context menus.
	(update_one_menu_item): Updated for compute_menu_item_info API change.

	* src/file-manager/fm-desktop-icon-view.c:
	(fm_desktop_icon_view_get_directory_sort_by),
	(fm_desktop_icon_view_set_directory_sort_by),
	(fm_desktop_icon_view_get_directory_sort_reversed),
	(fm_desktop_icon_view_set_directory_sort_reversed),
	(fm_desktop_icon_view_get_directory_sort_auto_layout),
	(fm_desktop_icon_view_set_directory_sort_auto_layout): Removed
	these overridden function pointers, obviated by new
	supports_auto_layout.
	(fm_desktop_icon_view_initialize_class): removed function
	pointer wiring for the above set; added function pointer
	wiring for supports_auto_layout.
	(real_supports_auto_layout): New function, returns FALSE.

2000-09-06  Darin Adler  <darin@eazel.com>

	* libnautilus-extensions/nautilus-search-uri.c: Got rid of a FIXME
	for a bug that was already fixed.
	* libnautilus-extensions/nautilus-volume-monitor.c: (eject_cdrom):
	Got rid of a FIXME for a bug that was already fixed.

2000-09-06  Andy Hertzfeld  <andy@eazel.com>

	* src/nautilus-location-bar.c: (try_to_expand_path):
	fixed bug 2828, append a slash when auto-completing
	directory names.
	
2000-09-06  Eli Goldberg  <eli@eazel.com>

	Checked in Nautilus Smoke Tests to doc tree.

	* docs/smoketests.html

2000-09-06  Darin Adler  <darin@eazel.com>

	Fixed bug 1960 (nautilus_strdup_strftime relies on glibc strftime
	behavior) and bug 2820 (date/time formatting uses non-standard
	glibc extension).

	* libnautilus-extensions/nautilus-glib-extensions.h:
	* libnautilus-extensions/nautilus-glib-extensions.c:
	(nautilus_strdup_strftime): Rewrote nautilus_strdup_strftime so
	that it provides the features we need, but no longer requires the
	GNU glibc version of strftime.
	(nautilus_g_string_append_len): Added a half-assed version of the
	GLib 2.0 function g_string_append_len, since I needed it for
	nautilus_strdup_strftime.
	(test_strftime), (nautilus_self_check_glib_extensions): Added
	light self-checks for the nautilus_strdup_strftime function to
	confirm that my rewrite didn't break it.

	* libnautilus-extensions/nautilus-file.c:
	(nautilus_file_get_date_as_string): Refined the comments for
	localizers to make it clear that the GNU "%-" and "%_" extensions
	are allowed, but other GNU extensions are not.

	* components/services/trilobite/libtrilobite/.cvsignore:
	Ignore some generated files that weren't in the list.
	
2000-09-06  Arlo Rose  <arlo@eazel.com>

	* icons/arlo/left-bumper-active-prelight.png:
	Lopped off a pixel.

2000-09-06  Mathieu Lacage  <mathieu@eazel.com>

	* components/tree/nautilus-tree-view.c: implement autoscroll
	by stealing code from nautilus-icon-dnd.c fixes task 2418
	* libnautilus-extensions/nautilus-icon-container.c:
	(nautilus_icon_container_scroll), (reveal_icon),
	(nautilus_icon_container_update_scroll_region): do not access
	the GtkLayout internal structures but use the gtk accessors.
	ie: gtk_layout_get_[vh]adjustment

2000-09-06  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 2644, Enter and Return should invoke file renaming.
	
	* libnautilus-extensions/nautilus-icon-container.c:
	(key_press_event):

2000-09-06  Darin Adler  <darin@eazel.com>

	Added checks in Nautilus to guarantee we will notice leaks
	of UI handlers in the future.

	The check will fire unless you get new Bonobo, since I just fixed
	a UI handler leak bug in Bonobo.

	* src/nautilus-window.c: (nautilus_window_real_set_content_view):
	Added code to check for a still-merged Open menu item in the file
	menu. This will catch leaks of UI handlers fairly quickly, instead
	of the traditional way we discover them, after long debugging
	sessions.

	* components/history/nautilus-history-view.c:
	(history_view_frame_call_end):
	* libnautilus-extensions/nautilus-undo-manager.c:
	(release_transaction), (nautilus_undo_manager_undo):
	* libnautilus/nautilus-clipboard.c: (add_menu_items_callback):
	* libnautilus/nautilus-undo.c: (undo_manager_unref_cover),
	(nautilus_undo_attach_undo_manager):
	* libnautilus/nautilus-view.c: (view_frame_call_end):
	* src/file-manager/fm-directory-view.c:
	(bonobo_control_activate_callback):
	* src/nautilus-application.c: (nautilus_application_startup):
	* src/nautilus-view-frame-bonobo-embeddable.c:
	(bonobo_subdoc_load_location):
	* src/nautilus-view-frame-nautilus-view.c:
	(nautilus_view_try_load_client):
	* src/nautilus-view-frame.c: (nautilus_view_frame_destroy_client),
	(nautilus_view_frame_load_client):
	Use bonobo_object_dup_ref and bonobo_object_release_unref to
	simplify some code.
	
	* components/loser/content/nautilus-content-loser.c:
	(loser_merge_bonobo_items_callback):
	* components/loser/sidebar/nautilus-sidebar-loser.c:
	(loser_merge_bonobo_items_callback):
	* components/mozilla/nautilus-mozilla-content-view.c:
	(mozilla_merge_bonobo_items_callback):
	* components/sample/nautilus-sample-content-view.c:
	(sample_merge_bonobo_items_callback):
	Add missing unref to avoid leaking a UI handler.
	
	* components/services/time/nautilus-view/trilobite-eazel-time-view.c:
	Remove a bunch of code inside #if 0, which had out of date copies
	of the sample code. I decided this was better than trying to fix
	it.
	
2000-09-06  John Sullivan  <sullivan@eazel.com>

	Fixed bug 2377 (Menu separators in search date criterion
	look wrong and are selectable)

	* src/nautilus-search-bar-criterion.c:
	(get_date_modified_location_for): Replaced "--" with
	"" when defining menu item text.
	(nautilus_search_bar_criterion_new_from_values): When
	constructing option menu items, treat empty string specially
	by not translating it and making an insensitive separator.

2000-09-06  Eskil Heyn Olsen  <eskil@eazel.com>

	* components/services/install/lib/eazel-install-metadata.c:
	(create_default_metadata), (create_default_configuration_metafile),
	(xml_doc_sanity_checks):
	Removed \n's for g_print/warnings/messages
	
	* components/services/install/lib/eazel-install-object.c:
	(eazel_install_finalize), 
	Changed to call parents finalize
	(eazel_install_alter_mode_on_temp),
	(eazel_install_lock_tmp_dir), (eazel_install_unlock_tmp_dir),
	Calls to chmod all the downloaded files and the tmpdir.
	(eazel_install_delete_downloads),
	(eazel_install_install_packages):
	Moved the deletion of downloads to a seperate call, so revert can
	also reap it's benefits.
	
	* components/services/install/lib/eazel-install-protocols.c:
	(gnome_vfs_xfer_callback), (eazel_install_fetch_file),
	Fixed download progress emission to only emit with amount==0 once
	for gnome-vfs downloads.
	Also checks for existence of package prior to download. This
	should be safe once md5 checking is done, and prevents
	fetch_dependencies from fetching the same file over and over
	(which maybe should be solver in another way).
	(eazel_install_fetch_package),
	Moved the md5 checking code into eazel_install_start_transaction.
	(eazel_install_fetch_package_which_provides),
	Fixed evil bug I found now that i modified rpmsearch.cgi to
	support ?provides= searches.
	(get_url_for_package):
	Fixed a packagedata_destroy_foreach call.
	
	* components/services/install/lib/eazel-install-public.h:
	Prototypes for the calls to chmod unchmod tmpdir + downloads.
	
	* components/services/install/lib/eazel-install-rpm-glue.c:
	(eazel_install_flatten_categories), 
	Reversed the order of list concatenation.
	(install_new_packages),
	Creates tmpdir, needed for reverttransaction.
	(eazel_install_download_packages),
	Removed the EAZEL_INSTALL_DOWNLOADS status flag, check the
	downloaded_files list in private instead.
	(eazel_install_monitor_rpm_propcess_pipe),
	Moved a comment reg. parsing rpm --percent here.
	(eazel_install_monitor_subcommand_pipe),
	(eazel_install_do_transaction_md5_check),	
	(eazel_install_start_transaction),
	Moved the md5 checking to be near the installtion routine.
	(eazel_install_check_existing_packages),
	Modified some strings to be more i18n friendly
	(eazel_install_fetch_rpm_dependencies),
	Do a check so the some packages isn't added several times.
	(eazel_install_ensure_deps):
	list append rather then prepend. Seems rpm isn't as nonchalant
	about the order of rpm's as we were led to believe.
	
	* components/services/install/lib/eazel-install-rpm-glue.h:
	Removed the EAZEL_INSTALL_DOWNLOADS status flag, check the
	downloaded_files list in private instead.

	* components/services/install/lib/eazel-install-types.h:
	* components/services/install/lib/eazel-install-types.c:
	(packagedata_new), (packagedata_destroy):
	Made the md5 a pointer rather then char[16];
	
	* components/services/install/lib/makefile.staticlib.in:
	* components/services/trilobite/libtrilobite/makefile.staticlib.in:
	* components/services/trilobite/libtrilobite/trilobite-core-utils.c:
	I needed some cpp loving to keep the gnome-vfs stuff out of
	nautilus-installer.
	
	* components/services/trilobite/sample/service/sample-service-impl.
	c: (sample_service_finalize), (sample_service_unref),
	(sample_service_class_initialize):
	* components/services/trilobite/sample/command-line/main.c: (main):
	* components/services/trilobite/sample/lib/sample-service-public.h:
	* components/services/trilobite/sample/service/main.c:
	(trilobite_service_factory_destroy):
	Fixed the destroy mechanism's of sample-service (bug 967)
	
	* configure.in:
	Added the mystic libtrilobite/makefile/staticlib.in
	
	* nautilus-installer/src/Makefile:
	* nautilus-installer/src/callbacks.c: (begin_install),
	(prep_install), (prep_finish):
	* nautilus-installer/src/callbacks.h:
	* nautilus-installer/src/installer.c: (create_finish_page_good),
	(create_finish_page_evil), (create_window),
	(eazel_installer_initialize):
	* nautilus-installer/src/link.sh:
	More installer loving. Now it enables/disables the next/back
	buttons in a more sane manner, plus handles lack of
	package-list.xml better.

2000-09-05  Robey Pointer  <robey@eazel.com>

	* components/services/install/lib/eazel-install-object.c:
	(eazel_install_install_packages):
	* components/services/trilobite/libtrilobite/trilobite-core-utils.c
	: (trilobite_init):
	* components/services/trilobite/libtrilobite/trilobite-root-helper.
	c: (trilobite_root_helper_start):

	Fix bug 2684 that would cause an occasional crash if running as
	root (freeing a password that had never been collected).

2000-09-05  Ramiro Estrugo  <ramiro@eazel.com>

	* libnautilus-extensions/nautilus-icon-canvas-item.c:
	(nautilus_icon_canvas_item_initialize_class),
	(nautilus_icon_canvas_item_initialize),
	(nautilus_icon_canvas_item_destroy),
	(nautilus_icon_canvas_item_set_arg),
	(nautilus_icon_canvas_item_get_arg), (icon_canvas_item_is_smooth),
	(nautilus_icon_canvas_item_get_max_text_width),
	(nautilus_icon_canvas_item_set_smooth_font),
	(nautilus_icon_canvas_item_set_smooth_font_size):
	* libnautilus-extensions/nautilus-icon-canvas-item.h:
	Add arguments and setter functions to set the font and font size
	in smooth mode.  Also added a function to determine whether we are
	in smooth mode or not.
	
2000-09-05  Pavel Cisler  <pavel@eazel.com>

	* libnautilus-extensions/nautilus-directory-notify.h:
	* libnautilus-extensions/nautilus-directory.c:
	(nautilus_direcotry_copy_move_metadata_key),
	(nautilus_directory_move_metadata),
	(nautilus_directory_copy_metadata),
	(nautilus_directory_schedule_metadata_copy),
	(nautilus_directory_schedule_metadata_move),
	(nautilus_directory_schedule_metadata_remove):
	* libnautilus-extensions/nautilus-file-changes-queue.c:
	(nautilus_file_changes_queue_schedule_metadata_remove),
	(nautilus_file_changes_consume_changes):
	* libnautilus-extensions/nautilus-file-changes-queue.h:
	* libnautilus-extensions/nautilus-file-operations.c:
	(sync_xfer_callback):
	Add hooks for metadata removal.

2000-09-05  Ramiro Estrugo  <ramiro@eazel.com>

	* libnautilus-extensions/nautilus-lib-self-check-functions.h:
	Add hook for scalable fonts test which im going to add soon.

	* libnautilus-extensions/nautilus-scalable-font.h:
	* libnautilus-extensions/nautilus-scalable-font.c:
	(nautilus_scalable_font_text_width), New convenience function to
	measure just the text width.
	(nautilus_self_check_scalable_font): Add hook for scalable fonts
	test which im going to add soon.

2000-09-05  Ramiro Estrugo  <ramiro@eazel.com>

	* libnautilus-extensions/nautilus-scalable-font.c:
	(nautilus_scalable_font_draw_text),
	(nautilus_scalable_font_draw_text_lines_with_dimensions),
	(nautilus_scalable_font_draw_text_lines),
	(initialize_global_stuff_if_needed):
	Add support for rendering text on pixbufs without alpha channels.
	
	* libnautilus-extensions/nautilus-icon-factory.c: (embed_text):
	No longer need to create a pixbuf with alpha channel duplicate.
	
	* test/test-nautilus-font.c: (main):
	Paint the pixbuf white before drawing stuff to it.		
	
2000-09-05  Andy Hertzfeld  <andy@eazel.com>

	* icons/arlo/sidebar_tab_pieces/Makefile.am:
	* icons/arlo/sidebar_tab_pieces/fill-active-prelight.png:
	* icons/arlo/sidebar_tab_pieces/left-bumper-active-prelight.png:
	* icons/arlo/sidebar_tab_pieces/right-top-active-prelight.png:
	added new tab pieces for active prelight state
	
	* src/nautilus-sidebar-tabs.c:
	(nautilus_sidebar_tabs_load_tab_pieces), (draw_one_tab_themed),
	(nautilus_sidebar_tabs_expose):
	fixed bug 2504, active tabs don't prelight, by adding, loading
	and drawing the appropriate tab pieces.  Also, moved the text
	down one pixel at Arlo's request.
	
2000-09-05  Arlo Rose  <arlo@eazel.com>
	
	* icons/arlo/sidebar_tab_pieces/left-bumper.png        
	* icons/arlo/sidebar_tab_pieces/left-bumper-active.png
        * icons/arlo/sidebar_tab_pieces/left-bumper-prelight.png
	Took off left side pixel in order to get rid of the double
	black line that was there.

2000-09-05  Ramiro Estrugo  <ramiro@eazel.com>

	* test/Makefile.am:
	* test/font-test.sh:
	Add a dumb script to make it easy to run the font test.
	
	* test/test-nautilus-font.c: (main):
	Make the clipping test better; clip both vertically and
	horizontally.

2000-09-05  John Sullivan  <sullivan@eazel.com>

	Much context-menu-related cleanup and some bug fixes.

	2734: comment fm_directory_view_add_context_menu_item

	* libnautilus-extensions/nautilus-gtk-extensions.h,
	* libnautilus-extensions/nautilus-gtk-extensions.c:
	(nautilus_gtk_menu_append_separator): New convenience function
	for appending a separator to a GtkMenu.
	(nautilus_gtk_menu_set_item_visibility): New convenience function
	for hiding/showing a menu item in a GtkMenu.
	
	* src/file-manager/fm-directory-view.h:
	Removed overridable function pointers for 
	create_background_context_menu_zoom_items and
	create_background_context_menu_background_items; I made sure the
	API supports what these were used for in a more general way.
	Added overridable function pointer for supports_zooming. Now the
	base class handles disabling/removing things for subclasses that
	don't support zooming.
	Changed fm_directory_view_add_context_menu_item to
	_insert_context_menu_item and gave it a position parameter.
	* src/file-manager/fm-directory-view.c:
	(fm_directory_view_initialize_class): removed function pointer
	assignment for deleted calls; added function pointer assignment
	for new supports_zooming call.
	(select_all_callback): Removed this function because I removed
	the item from the context menu (as per bug 1794).
	(fm_directory_view_bump_zoom_level),
	(fm_directory_view_zoom_to_level),
	(fm_directory_view_set_zoom_level),
	(fm_directory_view_restore_default_zoom_level),
	(fm_directory_view_can_zoom_in), (fm_directory_view_can_zoom_out):
	Bail out without calling overridable function pointer for these
	calls if supports_zooming is FALSE.
	(finish_inserting_menu_item): New function, generalization of
	finish_appending_menu_item that takes a position.
	(finish_appending_menu_item): Now calls finish_inserting_menu_item.
	Also, renamed this from finish_adding_menu_item.
	(compute_menu_item_info): Removed ellipsis from "Show Properties"
	and added comment explaining why it needs no ellipsis.
	(append_gtk_menu_item_with_view),
	(append_selection_menu_subtree): Update for adding -> appending rename.
	(fm_directory_view_insert_context_menu_item): Generalization of
	_append_context_menu_item that takes a position parameter.
	(fm_directory_view_append_context_menu_item): Renamed from
	_add_context_menu_item, and now calls _insert_context_menu_item.
	(real_create_background_context_menu_zoom_items),
	(real_create_background_context_menu_background_items):
	Removed these functions. These menu items are no longer treated as
	special cases.
	(fm_directory_view_real_create_background_context_menu_items):
	Now inserts zooming items only if supports_zooming is TRUE;
	resurrected the accidentally-obliterated "Reset Background" item.
	(add_separator): Removed this function in favor of 
	nautilus_gtk_menu_append_separator.
	(add_application_to_gtk_menu), (add_component_to_gtk_menu),
	(create_open_with_gtk_menu),
	Update for API renames.
	(fm_directory_view_real_create_selection_context_menu_items):
	Use nautilus_gtk_menu_append_separator.
	(fm_directory_view_supports_zooming): New function, calls 
	virtual function.
	(fm_directory_view_real_supports_zooming): New function,
	returns TRUE.

	* src/file-manager/fm-icon-view.c:
	(fm_icon_view_create_background_context_menu_items):
	Remove "Icon Captions..." item per bug 1794

	* src/file-manager/fm-desktop-icon-view.c:
	(fm_desktop_icon_view_create_background_context_menu_zoom_items),
	(fm_desktop_icon_view_create_background_context_menu_background_items),
	(bump_zoom_level), (zoom_to_level), (restore_default_zoom_level),
	(can_zoom_in), (can_zoom_out): Removed these functions due to
	reworking the responsibilities of super- and subclass.
	(real_supports_zooming): New function, returns FALSE.	
	(fm_desktop_icon_view_initialize_class): Remove overrides of various
	functions; add override for supports_zooming.
	(new_folder_menu_item_callback): Removed this now that it inherits
	New Folder from parent.
	(fm_desktop_icon_view_create_background_context_menu_items):
	Cleaned this up to start with inherited and make modifications
	as necessary rather than reimplementing the whole thing.

2000-09-05  Robey Pointer  <robey@eazel.com>

	* components/services/install/lib/eazel-install-protocols.c:
	(eazel_install_fetch_package):
	* components/services/install/lib/eazel-install-rpm-glue.c:
	(eazel_install_download_packages):
	* components/services/install/nautilus-view/nautilus-service-instal
	l-view.c: (nautilus_service_install_downloading):
	* components/services/install/server/main.c:
	(trilobite_service_factory_destroy), (main):

	Fix small bug in eazel-install (don't set the downloaded flag if
	the rpm didn't get downloaded); correct FIXME comment; clean up
	install main to have the right log domain and remove unused code.

2000-09-05  Michael Engber  <engber@eazel.com>
	
	We now update the gnome_config settings that store the list
	of background images that populate the background capplet's
	popup menu. bug 2343.

	* libnautilus-extensions/nautilus-directory-background.c:
	(nautilus_directory_background_write_desktop_settings):

2000-09-05  Mathieu Lacage  <mathieu@eazel.com>

	* components/tree/nautilus-tree-view.c: implement task bugzilla.eazel.com
	2416

2000-09-05  Andy Hertzfeld  <andy@eazel.com>

	fixed bug 2610, can't delete duplicate colors from property browser.
	Also, made property browser use anti-aliased item labels
		
	* src/nautilus-property-browser.c: (remove_color),
	(add_new_button_callback), (remove_button_callback),
	(element_clicked_callback), (make_properties_from_directories):
	fixed bug by checking for delete property when finding item to delete;
	also, set up nautilus_buffered_widget properities for labels
	* src/nautilus-search-bar-criterion.c: (make_emblem_value_menu):
	made it use nautilus_label routines to access returned label text	
	* libnautilus-extensions/nautilus-customization-data.h:
	changed type of label returned from GtkLabel to GtkWidget
	* libnautilus-extensions/nautilus-customization-data.c:
	(nautilus_customization_data_get_next_element_for_display):
	return a nautilus_label instead of a gtk_label
	
2000-09-05  Mathieu Lacage  <mathieu@eazel.com>

	* components/tree/nautilus-tree-view.c:
	(nautilus_tree_view_insert_model_node): add some dnd UI nicety.
	GtkCTreeNode now hold a pointer to their NautilusTreeNode instead 
	of their char *uri.
	
	* libnautilus-extensions/nautilus-search-uri.c:
	(nautilus_self_check_search_uri): fix tests after rebecka 
	second break of them :)

2000-09-05  Darin Adler  <darin@eazel.com>

	* check-FIXME.pl: Removed some special-case file names
	that aren't needed any more.
	
	* libnautilus-extensions/nautilus-file-operations.c:
	(get_link_name): Added comments to help localizers.
	* libnautilus-extensions/nautilus-file.c:
	(nautilus_file_get_date_as_string): Added comments to help
	localizers. Deals with bug 2720 (Please add a comment to help
	localizers do date translations)
	* libnautilus-extensions/nautilus-icon-canvas-item.c:
	(draw_or_measure_label_text): Added a comment to help localizers.
	* src/file-manager/fm-directory-view.c:
	(fm_directory_view_display_selection_info): Unmarked one string
	that doesn't make sense to translate and adding a comment to
	another to explain why it is marked for translation.
	(add_separator): Changed add_open_with_gtk_menu_item into this
	function, which deals with bug 2735 (add_open_with_gtk_menu_item
	only called to create separator?).
	(create_open_with_gtk_menu): Call the new add_separator function.
	* src/nautilus-zoom-control.c: (create_zoom_menu_item): Added a
	comment to help localizers.
	
	* libnautilus-extensions/nautilus-link.c: (make_local_path): Fixed
	logic here that was doing strange things with URIs.  This deals
	with bugs 2492 (Incorrect unescaping when dealing with link
	files), 2493 (Mysterious and probably incorrect "+7" when escaping
	URI for link file), and 2737 (link code must make path into URI).
	
	* libnautilus-extensions/nautilus-search-bar-criterion.c:
	* libnautilus-extensions/nautilus-search-bar-criterion.h:
	* po/POTFILES.in:
	Removed these duplicate files. Rebecca moved them to src, but she
	didn't remove the old ones. I didn't have to remove them from the
	makefile, since they were already removed, but I had to remove
	them from the list of files to translate.
	
	* src/nautilus-search-bar-criterion.h:
	* libnautilus-extensions/nautilus-search-uri.h:
	Moved some of the stuff from nautilus-search-bar-criterion.h to
	here, since it's really about search URIs, not specific to the
	search bar. Over time we will move more.
	
	* src/nautilus-search-bar-criterion.c: Added include of the
	nautilus-search-uri.h header now that stuff was moved there.
	
	* src/file-manager/fm-search-list-view.c:
	Fixed includes to get the nautilus-search-bar-criterion.h from its
	new location. This is not a real solution to the problem that was
	exposed by moving the search bar code. The bug 2815 covers this.
	* src/nautilus-complex-search-bar.c: Fix search bar so it gets
	the real location of the header. It was including the old one.
	* src/nautilus-simple-search-bar.c: Fix search bar so it gets
	the real location of the header. It was including the old one.

	* src/nautilus-main.c: (main): Some small cleanups including some
	additional parameter checking and returning a failure code to
	the invoking shell in the case where the parameters are not
	consistent.
	
2000-09-05  Pavel Cisler  <pavel@eazel.com>

	* configure.in:
	Remove the -Wuninitialized to unbreak the build.
	(It should be part of -Wall so it's probably not needed anyhow).

2000-09-05  Pavel Cisler  <pavel@eazel.com>

	* components/help/converters/gnome-db2html2/gdb3html.c:
	(xml_parse_document):
	* components/help/hyperbola-nav-index.c: (end_element):
	* components/services/summary/nautilus-view/nautilus-summary-view.c
	: (logout_button_cb):
	* components/services/time/service/trilobite-eazel-time-service.c:
	(trilobite_eazel_time_service_do_http_request):
	* components/tree/nautilus-tree-view.c:
	* configure.in:
	* libnautilus-extensions/bonobo-stream-vfs.c:
	(bonobo_stream_vfs_open):
	* libnautilus-extensions/nautilus-background.c:
	(nautilus_background_draw), (nautilus_background_draw_aa):
	* libnautilus-extensions/nautilus-customization-data.c:
	(nautilus_customization_data_new):
	* libnautilus-extensions/nautilus-directory-background.c:
	(nautilus_directory_background_write_desktop_settings):
	* libnautilus-extensions/nautilus-file-operations.c:
	(nautilus_file_operations_move_to_trash), (do_empty_trash):
	* libnautilus-extensions/nautilus-file.c: (nautilus_file_dump):
	* libnautilus-extensions/nautilus-icon-canvas-item.c:
	(draw_or_measure_label_text), (emblem_layout_next):
	* libnautilus-extensions/nautilus-icon-factory.c:
	(get_image_from_cache):
	* libnautilus-extensions/nautilus-icon-text-item.c:
	(iti_paint_text):
	* libnautilus-extensions/nautilus-list.c: (draw_cell), (draw_row):
	* libnautilus-extensions/nautilus-mime-actions.c:
	(nautilus_mime_add_application_to_short_list_for_uri):
	* libnautilus-extensions/nautilus-program-chooser.c:
	(program_file_pair_get_short_status_text),
	(program_file_pair_get_long_status_text):
	* libnautilus-extensions/nautilus-program-choosing.c:
	(nautilus_choose_component_for_file),
	(nautilus_choose_application_for_file):
	* libnautilus-extensions/nautilus-scalable-font.c:
	(nautilus_scalable_font_draw_text_lines_with_dimensions):
	* libnautilus-extensions/nautilus-theme.c:
	(nautilus_theme_make_selector):
	* librsvg/rsvg-ft.c: (rsvg_ft_get_glyph):
	* librsvg/test-ft-gtk.c: (set_text):
	* librsvg/test-ft.c: (save_pixbuf_to_file_internal),
	(save_pixbuf_to_file):
	* librsvg/test-rsvg.c: (save_pixbuf_to_file_internal),
	(save_pixbuf_to_file):
	* src/file-manager/fm-directory-view.c: (display_pending_files),
	(compute_menu_item_info):
	* src/file-manager/fm-icon-view.c: (compute_menu_item_info):
	* src/file-manager/fm-list-view.c: (get_column_from_attribute):
	* src/nautilus-application.c: (nautilus_application_startup):
	* src/nautilus-search-bar-criterion.c:
	(nautilus_search_bar_criterion_next_new),
	(nautilus_search_bar_criterion_get_location),
	(get_date_modified_location_for):
	* src/nautilus-sidebar-tabs.c: (draw_one_tab_themed),
	(draw_or_layout_all_tabs):
	* src/nautilus-toolbar.c: (nautilus_toolbar_size_allocate):
	* src/nautilus-window-manage-views.c:
	(nautilus_window_get_current_location_title):
	* test/test-nautilus-label.c: (justification_changed_callback):

	Fix all the warnings -Wuninitialized found.
	Quite a number of them were actual bugs.
	Turn on -Wuninitialized in configure.in now that ORBit generates 
	warning-free code.
	
2000-09-05  John Sullivan  <sullivan@eazel.com>

	Fixed bug 1247 ("Edit Novice Settings" menu item
	needs to be handled better)

	Now this menu item is enabled, and choosing it explains
	that you can't edited the Novice settings but offers
	to switch to Intermediate and let you edit those
	settings.

	* libnautilus-extensions/nautilus-user-level-manager.c,
	* libnautilus-extensions/nautilus-user-level-manager.h:
	Made the #defines for the user level ints public, so
	code elsewhere could use them rather than hardwiring
	a bunch of 0s, 1s, and 2s.

	* libnautilus-extensions/nautilus-caption-table.h:
	* libnautilus-extensions/nautilus-caption.h:
	* libnautilus-extensions/nautilus-font-picker.h:
	* libnautilus-extensions/nautilus-global-preferences.h:
	* libnautilus-extensions/nautilus-password-dialog.h:
	* libnautilus-extensions/nautilus-preference.h:
	* libnautilus-extensions/nautilus-preferences-box.h:
	* libnautilus-extensions/nautilus-preferences-dialog.h:
	* libnautilus-extensions/nautilus-preferences-group.h:
	* libnautilus-extensions/nautilus-preferences-item.h:
	* libnautilus-extensions/nautilus-preferences-pane.h:
	* libnautilus-extensions/nautilus-preferences-private.h:
	* libnautilus-extensions/nautilus-preferences.h:
	* libnautilus-extensions/nautilus-radio-button-group.h:
	* libnautilus-extensions/nautilus-string-picker.h:
	* libnautilus-extensions/nautilus-text-caption.h:
	Changed the closing BEGIN_GNOME_DECLS in these header files
	to END_GNOME_DECLS.
	
	* src/nautilus-window-menus.c:
	(get_user_level_string_for_display): New function, extracted
	from get_customize_user_level_string. Returns the user level
	string to be put into user messages or menu item names.
	(get_customize_user_level_string): Now calls 
	get_user_level_string_for_display
	(switch_and_show_intermediate_settings_callback): New function,
	switches to intermediate level and displays the user level
	settings dialog.
	(user_level_customize_callback): If the current user level is
	NAUTILUS_USER_LEVEL_NOVICE, puts up a dialog telling the user
	that the Novice settings can't be changed, and asking them if
	they want to switch to Intermediate and edit those settings.
	(get_user_level_image), (user_level_changed_callback),
	(nautilus_window_initialize_menus), 
	(convert_menu_path_to_user_level),
	(convert_user_level_to_menu_path): 
	Use #defines for user levels instead of hardwiring integers.
	(switch_to_user_level): New function, extracted from
	user_level_menu_item_callback. Switches to a specified user
	level and updates menu items & title image appropriately.
	(user_level_menu_item_callback): Now calls switch_to_user_level.
	(update_user_level_menu_items): Don't desensitize the Edit 
	Settings item at Novice user level anymore.

2000-09-05  Andy Hertzfeld  <andy@eazel.com>

	* src/nautilus-shell.c: (display_caveat):
	Now that Ramiro fixed the problems in NautilusLabel,
	made the caveat dialog use anti-aliased text

2000-09-05  Gene Z. Ragan  <gzr@eazel.com>

	* libnautilus-extensions/nautilus-link.c:
	(nautilus_link_get_image_uri):
	Added a check for a NULL image tag returned
	by am XML property retrieval.

2000-09-05  Pavel Cisler  <pavel@eazel.com>

	* libnautilus-extensions/nautilus-directory.c:
	(nautilus_direcotry_copy_move_metadata_key),
	(nautilus_directory_copy_metadata_key),
	(nautilus_directory_move_metadata_key),
	(nautilus_directory_move_metadata),
	(nautilus_directory_copy_metadata),
	(nautilus_directory_schedule_metadata_copy),
	(nautilus_directory_schedule_metadata_move):
	Work on metadata copying.
	For now hardcode the metadata keys that get copied.
	Metadata move does not remove old metadata in source location yet.

2000-09-05  Ramiro Estrugo  <ramiro@eazel.com>

	* libnautilus-extensions/nautilus-icon-factory.c: (embed_text):
	Fix a bug I just introduced drawing embedded text in the non
	smooth case.  We need to make sure the pixbuf we feed to the text
	rendering code has an alpha channel.
	
2000-09-05  Ramiro Estrugo  <ramiro@eazel.com>

	More work on task 1588.

	* libnautilus-extensions/nautilus-icon-factory.c: (embed_text):
	Use NautilusScalableFont to render embedded text.
	
2000-09-05  Ramiro Estrugo  <ramiro@eazel.com>

	* libnautilus-extensions/nautilus-scalable-font.c:
	(nautilus_scalable_font_draw_text_lines):
	Add a FIXME for a performance issue.
	
2000-09-05  Ramiro Estrugo  <ramiro@eazel.com>

	* libnautilus-extensions/nautilus-label.c: (render_buffer_pixbuf):
	* libnautilus-extensions/nautilus-scalable-font.c:
	(nautilus_scalable_font_draw_text_lines_with_dimensions),
	(nautilus_scalable_font_draw_text_lines):
	* libnautilus-extensions/nautilus-scalable-font.h:
	Simpify the text line drawing function to not reuqire passing in
	the number of lines or their dimensions.  Compute these when
	needed.  An alternate function that accepts the dimensions is
	available as well.

	* test/test-nautilus-font.c: (main):
	Draw both text lines and single line clipped text to test more
	stuff.
	
2000-09-05  Ramiro Estrugo  <ramiro@eazel.com>

	Complete task 1733 - need mozilla component support for grokking
	eazel: uris.

	* components/mozilla/nautilus-mozilla-content-view.c:
	(nautilus_mozilla_content_view_initialize),
	(nautilus_mozilla_content_view_destroy), (bonobo_mozilla_callback),
	(mozilla_net_state_callback), (mozilla_open_uri_callback),
	(mozilla_dom_mouse_click_callback):
	For mozilla M17, add support for registering the eazel protocol
	handler.  For mozilla M18, add support for peeking dom events -
	this is the preffered way to deal with these special uris, however
	we cant turn this on until mozilla M18 is released.

2000-09-05  Ramiro Estrugo  <ramiro@eazel.com>

	* components/mozilla/eazel-protocol-handler/eazel-protocol-channel.cpp:
	Damn, some of this code only builds with mozilla M18.  Updating
	for that.
	
2000-09-05  Ramiro Estrugo  <ramiro@eazel.com>

	More work on task 1733.

	* components/mozilla/eazel-protocol-handler/.cvsignore:
	* components/mozilla/eazel-protocol-handler/Makefile.am:
	* components/mozilla/eazel-protocol-handler/eazel-protocol-channel.cpp:
	* components/mozilla/eazel-protocol-handler/eazel-protocol-channel.h:
	* components/mozilla/eazel-protocol-handler/eazel-protocol-handler.cpp:
	* components/mozilla/eazel-protocol-handler/eazel-protocol-handler.h:
	* components/mozilla/eazel-protocol-handler/eazel-protocol-module.cpp:
	New files.  A mozilla XPCOM component to grok eazel: protocol uris.
	
	* components/mozilla/Makefile.am:
	Build the eazel-protocol-handler
	
	* configure.in:
	Build the eazel-protocol-handler

2000-09-05  Ramiro Estrugo  <ramiro@eazel.com>

	* components/tree/.cvsignore:
	Ignore generated files.
	
2000-09-05  Ramiro Estrugo  <ramiro@eazel.com>

	More work on task 1588.

	* libnautilus-extensions/nautilus-scalable-font.c:
	(nautilus_scalable_font_draw_text),
	(nautilus_scalable_font_measure_text_lines),
	(nautilus_scalable_font_draw_text_lines):
	* libnautilus-extensions/nautilus-scalable-font.h:
	Change text rendering api to take in x,y coordinates along with a
	clip_area.  

	Remove some #if 0 code i left in before.

	Also change the text lines rendering api to optionally do its own
	line measuring - for the convenience of the caller.
	
	* libnautilus-extensions/nautilus-label.c: (render_buffer_pixbuf):
	Update for text rendering changes.
	Fix the justification bug.
	Fix the multiple newlines bug.
	
	* src/nautilus-about.c: (draw_aa_string):
	Update for text rendering changes.
	
	* src/nautilus-sidebar-tabs.c: (draw_one_tab_plain),
	(draw_one_tab_themed):
	Update for text rendering changes.

	* test/test-nautilus-font.c: (main):
	Update for text rendering changes.
	Also add multiple new lines test and clipping test.
	
	* test/test-nautilus-label.c: (main):
	Update for text rendering changes.

2000-09-05  Ramiro Estrugo  <ramiro@eazel.com>

	* librsvg/rsvg-ft.c: (rsvg_ft_render_string):
	Add a band aid fix for the unknown character problem when trying
	to index glyphs from a font face.  I filed a bug for this issue:
	2775.
	
2000-09-04  Maciej Stachowiak  <mjs@eazel.com>

	* src/nautilus-window-manage-views.c
	(nautilus_window_update_view): Fix bug 2462 by causing a NULL
	selection to be interpreted as no selection, rather than an empty
	selection.

2000-09-05  Andy Hertzfeld  <andy@eazel.com>

	* src/nautilus-theme-selector.c:
	(nautilus_theme_selector_initialize), (add_theme_to_icons),
	(dialog_destroy), (add_new_theme_button_callback):
	implement the "add new theme" command by invoking a file dialog;
	this still isn't finished yet.
	
2000-09-04  Ramiro Estrugo  <ramiro@eazel.com>

	Work on task 1588.

	* configure.in:
	* data/Makefile.am:
	* data/fonts/.cvsignore:
	* data/fonts/Makefile.am:
	* data/fonts/urw/.cvsignore:
	* data/fonts/urw/Makefile.am:
	* data/fonts/urw/README:
	* data/fonts/urw/fonts.dir:
	Add a fallback font in case no Type1 fonts are found in the
	system.  This font was plucked from the ghostscript-fonts-5.10a
	package. See data/fonts/urw/README for more info.
	
2000-09-04  Andy Hertzfeld  <andy@eazel.com>

	* icons/Makefile.am:
	* icons/i-web-72.png:
	added a new icon for generic http documents, which is just a
	placeholder.
	* libnautilus-extensions/nautilus-icon-factory.c:
	(nautilus_icon_factory_get_icon_name_for_regular_file):
	made it use a distinct icon for generic documents if the protocol
	associated with the file is "http", so the sidebar can have a decent
	icon when displaying websites.  The current icon is just a placeholder.
	
2000-09-04  Ramiro Estrugo  <ramiro@eazel.com>

	Work on task 1733.

	* configure.in:
	Add macros for only xpcom and nspr libs (for components)
	Add check for mozilla M18 - evil in its purest form.
	
2000-09-04  Ramiro Estrugo  <ramiro@eazel.com>

	Work on task 1733.

	* components/mozilla/mozilla-components.cpp:
	Quiet down the debug noise.

	* components/mozilla/mozilla-events.cpp:
	* components/mozilla/mozilla-events.h:
	A new wrapper for grokking mozilla dom events.

	* components/mozilla/Makefile.am:
	Build the events code.
	
2000-09-04  Ramiro Estrugo  <ramiro@eazel.com>

	* libnautilus-extensions/nautilus-buffered-widget.c:
	(create_background_pixbuf_from_ancestor):
	Remove an assertion that is not needed.
	
2000-09-04  Ramiro Estrugo  <ramiro@eazel.com>

	Work on task 1588.
	
	* libnautilus-extensions/nautilus-scalable-font.c:
	(nautilus_scalable_font_measure_text),
	(nautilus_scalable_font_draw_text),
	(nautilus_scalable_font_measure_text_lines),
	(nautilus_scalable_font_draw_text_lines),
	(nautilus_scalable_font_measure_text_lines),
	(nautilus_scalable_font_draw_text_lines),
	(nautilus_scalable_font_largest_fitting_font_size):
	* libnautilus-extensions/nautilus-scalable-font.h:
	Change api to accept a string with embedded new lines instead of
	an array of strings.  This simplifies many things.
	
	* libnautilus-extensions/nautilus-label.c:
	(nautilus_label_initialize), (nautilus_label_destroy),
	(render_buffer_pixbuf), (label_recompute_line_geometries):
	Update for NautilusScalalbleFont api changes.  No longer need to
	tokenize the text string.  we can feed the string to the rendering
	api as is.
	
	* librsvg/rsvg-ft.c: (rsvg_ft_render_string):
	* librsvg/rsvg-ft.h:
	Change the string to glyph rendering api to accept the string
	length rather than computing it.  This makes it possible to feed
	it arbitrary lengths.
	
	* librsvg/rsvg.c: (rsvg_text_handler_characters):
	* librsvg/test-ft-gtk.c: (draw_line):
	* librsvg/test-ft.c: (main):
	Update for api changes.
	
	* src/nautilus-about.c: (draw_aa_string):
	* src/nautilus-sidebar-tabs.c: (draw_one_tab_plain),
	(draw_one_tab_themed), (get_tab_width):
	* test/test-nautilus-font.c: (main):
	Update test to use text lines drawing api.
	
	* test/test-nautilus-label.c:
	(alpha_background_color_value_changed_callback), (main):
	Update test for 2 new lines in a row.

2000-09-04  Ramiro Estrugo  <ramiro@eazel.com>

	* libnautilus-extensions/nautilus-string-list.c:
	(nautilus_self_check_string_list):
	Make the tokens test a little better.

2000-09-04  Maciej Stachowiak  <mjs@eazel.com>

	* configure.in: Set shared library tree view as default,
	completing task 1647.

2000-09-04  Maciej Stachowiak  <mjs@eazel.com>

	* components/tree/nautilus-tree-model.c:
	(nautilus_tree_model_initialize), (nautilus_tree_model_destroy),
	(nautilus_tree_model_for_each_postorder),
	(nautilus_tree_model_monitor_remove),
	(nautilus_tree_model_get_node), (report_node_added),
	(report_node_changed), (report_node_removed_internal),
	(nautilus_tree_model_directory_files_changed_callback):
	* components/tree/nautilus-tree-node-private.h:
	* components/tree/nautilus-tree-node.c:
	(nautilus_tree_node_destroy), (nautilus_tree_node_new),
	(nautilus_tree_node_get_uri):
	* components/tree/nautilus-tree-node.h:
	* components/tree/nautilus-tree-view.c:
	(nautilus_tree_view_insert_model_node):

	Architecture changes to properly handle the case where a
	NautilusFile object changes name or location. In brief, the tree
	model keeps a hash keyed on NautilusFiles instead of on uris, and
	tries to remember the URI of a node to detect when the URI
	changes. When the URI changes, it gives a remove notification
	followed by an add notification.
	
2000-09-03  Andy Hertzfeld  <andy@eazel.com>

	made the arlo sidebar tabs use the official anti-aliased text machinery,
	instead of the scaling hack it was using.  Also, made the non-themed
	tabs use anti-aliased text.
	
	* src/nautilus-sidebar-tabs.c:
	(nautilus_sidebar_tabs_load_theme_data),
	(nautilus_sidebar_tabs_destroy), (make_colored_pixbuf),
	(draw_one_tab_plain), (draw_one_tab_themed), (get_tab_width):
	use NautilusScalableFont to render and measure the labels, for both
	types of tabs
	
Sun Sep 03 19:09:49 2000  George Lebl <jirka@5z.com>

	* src/nautilus-first-time-druid.c (nautilus_first_time_druid_show):
	  mark druid_welcome.png for translation (it contains english text)
	  and put in a comment explaining why which should appear in the
	  .po file.

2000-09-03  Maciej Stachowiak  <mjs@eazel.com>

	* components/tree/nautilus-tree-model.c
	(nautilus_tree_model_for_each_postorder): Some optional debugging
	statements.
	(nautilus_tree_model_monitor_remove): Also unmonitor any nodes
	that might be monitored by this client.

	* components/tree/nautilus-tree-view.c
	(nautilus_tree_view_destroy): Stop monitoring the model

2000-09-03  Ali Abdin  <aliabdin@aucegypt.edu>

        I now consider navigation links to be 'done' (Fixes bug #2201)

        * components/help/converters/gnome-db2html2/gdb3html.c:
        (parse_file): Renamed a variable. Updated the call to sect_footer.
        Cleaned up in a couple misc. spots
        (sect_footer): Renamed the variables to be more descriptive. Modified
        calls to print_footer (function changed + we now pass the full URI).
        Fixed memory leaks by actually freeing the variables.
        (print_footer): Change the function arguments to make it a 'sane'
        function. Also - just print what we recieve.

        * components/help/converters/gnome-db2html2/toc-elements.c:
        (toc_title_start_element),
        (toc_title_end_element):
        Disable the links to sect2/sect3/sect4/sect5 tags as they already get
        'included' with the sect1 tags.

        Ideally we should create anchor tags in the sect1 'pages' and use that
        instead, but this will not work due to mozilla issues

2000-09-03  Maciej Stachowiak  <mjs@eazel.com>

	* components/services/install/lib/eazel-install-protocols.c:
	(eazel_install_fetch_package):
	* components/services/login/nautilus-view/nautilus-login-view.c:
	(nautilus_login_view_initialize):
	* components/services/summary/nautilus-view/nautilus-summary-view.c
	: (authn_cb_succeeded), (authn_cb_failed), (login_button_cb),
	(nautilus_summary_view_initialize):
	* components/tree/libmain.c: (tree_shlib_object_destroyed):
	* components/tree/nautilus-tree-view.c:
	* libnautilus-extensions/nautilus-link.c: (make_local_path):
	* libnautilus-extensions/nautilus-search-bar-criterion.c:
	(make_emblem_value_menu):
	* src/file-manager/fm-directory-view.c:
	(add_open_with_gtk_menu_item):
	* src/nautilus-search-bar-criterion.c: (make_emblem_value_menu),
	(emblems_changed_callback):

	Added bug numbers for FIXMEs
	
2000-09-03  Pavel Cisler  <pavel@eazel.com>

	* libnautilus-extensions/nautilus-directory-notify.h:
	* libnautilus-extensions/nautilus-directory.c:
	(nautilus_directory_schedule_metadata_copy),
	(nautilus_directory_schedule_metadata_move):
	* libnautilus-extensions/nautilus-file-changes-queue.c:
	(nautilus_file_changes_queue_schedule_metadata_copy),
	(nautilus_file_changes_queue_schedule_metadata_move),
	(nautilus_file_changes_consume_changes):
	* libnautilus-extensions/nautilus-file-changes-queue.h:
	* libnautilus-extensions/nautilus-file-operations.c:
	(progress_dialog_set_files_remaining_text),
	(handle_xfer_vfs_error), (handle_xfer_duplicate),
	(sync_xfer_callback):
	Work on task bugzilla task 330.
	Add notification hooks for metadata copying to NautilusFileChangesQueue.
	Using the new top_level_item, call the hooks from the copy engine 
	synchronous callback. 

2000-09-03  Maciej Stachowiak  <mjs@eazel.com>

	* components/tree/nautilus-tree-view.c: (insert_hack_node,
	remove_hack_node, freeze_if_have_hack_node): Remove gratuitous
	debugging messages.

2000-09-03  Andy Hertzfeld  <andy@eazel.com>

	* components/rpmview/nautilus-rpm-verify-window.h:
	added "continue" signal
	* components/rpmview/nautilus-rpm-verify-window.c:
	(nautilus_rpm_verify_window_initialize_class),
	(continue_button_callback), (cancel_button_callback),
	(nautilus_rpm_verify_window_initialize),
	(nautilus_rpm_verify_window_set_error_mode):
	implemented verify error presentation, by adding a continue and cancel button,
	with a method to show them, and a signal to resume verification after errors
	
	* components/rpmview/nautilus-rpm-view.c:
	(nautilus_rpm_view_verify_files),
	(nautilus_rpm_view_verify_package_callback),
	(rpm_view_continue_verify):
	connect to the "continue" signal and resume verification; remember where we
	left off in an instance variable.  We still need more descriptive messages.
	
2000-09-02  Andy Hertzfeld  <andy@eazel.com>

	* components/rpmview/Makefile.am:
	* components/rpmview/nautilus-rpm-verify-window.c,h:
	(nautilus_rpm_verify_window_initialize_class),
	(nautilus_rpm_verify_window_destroy),
	(nautilus_rpm_verify_window_initialize),
	(nautilus_rpm_verify_window_new),
	(nautilus_rpm_verify_window_set_message):
	added verify window class to give feedback during the verify operation
	* components/rpmview/nautilus-rpm-view.c:
	(nautilus_rpm_view_destroy), (nautilus_rpm_view_update_from_uri),
	(nautilus_rpm_view_verify_package_callback):
	made the verify command work, but it's still needs to handle verification errors
	made the file list work correctly with rpmlib version >= 3.0
	
	* src/nautilus-about.c: (nautilus_about_draw_info):
	at Arlo's request, made the comment text in the about window have a white shadow
	
2000-09-02  Eskil Heyn Olsen  <eskil@eazel.com>

	* components/hardware/nautilus-hardware-view.c:
	(get_RAM_description), (get_IDE_description),
	(setup_overview_form), (setup_IDE_form),
	(nautilus_hardware_view_load_uri):
	Added Shane Butlers <sbutle@deakin.edu.au> patch for showing IDE
	devices in the hardware overview. Also fixed the size display
	problem (unsigned long overflow).
	
Sat Sep 02 02:56:48 2000  George Lebl <jirka@5z.com>

	* libnautilus-extensions/nautilus-icon-canvas-item.c (map_pixbuf),
	  libnautilus-extensions/nautilus-theme.c (load_theme_document):
	  Deal with the fact that nautilus_pixmap_file can return a NULL
	  if the file doesn't exist.

	* src/nautilus-first-time-druid.c (create_named_pixbuf),
	  (make_hbox_user_level_radio_button):
	  Deal with nautilus_pixmnap_file_returning NULL.  Also do
	  not assert out when no icon can be loaded.  Things need to
	  work/fail gracefully if icons are not installer properly instead of
	  just asserting.
	  (set_page_sidebar) (nautilus_first_time_druid_show):
	  Use the create_named_pixbuf function for loading the pixbufs

	* src/nautilus-shell.c (display_caveat):  Again deal with
	  non-existant image.  If it doesn't exist don't even create the
	  frame for the image.

2000-09-01  Eskil Heyn Olsen  <eskil@eazel.com>

	* components/services/install/lib/eazel-install-types.h:
	* components/services/install/lib/eazel-install-rpm-glue.h:
	* components/services/install/lib/eazel-install-types.c:
	(categorydata_destroy_foreach), (packagedata_new),
	(packagedata_destroy), (packagedata_remove_soft_dep):
	The packagedata_destroy_foreach has been removed,
	packagedata_destroy now takes a boolean that controls the deep
	destroy.
	
	* components/rpmview/nautilus-rpm-view.c:
	(nautilus_rpm_view_destroy), (nautilus_rpm_view_update_from_uri):
	* components/services/install/command-line/eazel-alt-install-corba.
	c: (main):
	Use the categorydata_new call
	
	* components/services/install/lib/eazel-install-corba-callback.c:
	(impl_dep_check), (impl_install_progress),
	(impl_uninstall_progress):
	Fixed to use the changed packagedata_destroy
	
	* components/services/install/lib/eazel-install-corba.c:
	(impl_Eazel_Install_simple_query):
	Call the correct query call
	
	* components/services/install/lib/eazel-install-private.h:
	Added a glist to hold downloaded packages
	
	* components/services/install/lib/eazel-install-object.c:
	(eazel_install_initialize), (eazel_install_install_packages),
	(eazel_install_uninstall_packages),
	(eazel_install_revert_transaction_from_xmlstring),
	(eazel_install_query_package_system),
	(eazel_install_emit_install_progress_default):
	Modified the deletion, so it now deletes all downloaded files (and
	only downloaded files). Also this file is now responsible for
	calling prepare_package_system.
	
	* components/services/install/lib/eazel-install-protocols.c:
	(eazel_install_fetch_file):
	Added downloaded packages to the glist in eazel_install.
	
	* components/services/install/lib/eazel-install-query.c:
	(eazel_install_simple_rpm_query), (eazel_install_simple_query):
	Removed the prepare/free_package_system calls
	
	* components/services/install/lib/eazel-install-rpm-glue.c:
	(eazel_install_flatten_categories),
	(eazel_install_download_packages),
	(eazel_install_pre_install_packages),
	(eazel_install_do_install_packages), (uninstall_all_packages),
	(ei_get_packages_with_mod_flag), (ei_check_uninst_vs_downgrade),
	(revert_transaction), (eazel_install_do_transaction_fill_hash),
	(eazel_install_do_transaction_get_total_size),
	(eazel_install_start_transaction_make_argument_list),
	(eazel_install_do_transaction_save_report_helper),
	(eazel_install_display_arguments),
	(eazel_install_start_transaction),
	(eazel_install_prune_packages_helper),
	(eazel_install_prune_packages), (eazel_install_load_rpm_headers),
	(eazel_install_free_rpm_system),
	(eazel_install_prepare_rpm_system), (eazel_install_add_to_rpm_set),
	(eazel_install_add_to_extras_foreach),
	(eazel_install_check_existing_packages),
	(eazel_install_fetch_rpm_dependencies), (print_package_list),
	(eazel_install_ensure_deps), (eazel_uninstall_upward_traverse),
	(eazel_uninstall_downward_traverse),
	(eazel_uninstall_check_for_install), (eazel_uninstall_globber):
	changed all the iterations to use g_list_next.
	Changed the packagedata_destroy calls
	Fixed the reversion
	Modified the prepare package system scheme
	
	* components/services/install/nautilus-view/nautilus-service-instal
	l-view.c: (nautilus_install_parse_uri),
	(nautilus_service_install_view_update_from_uri):
	Changed the packagedata_destroy calls.
	Used categorydata_new instead of g_new
	
	* components/services/install/nautilus-view/nautilus-service-instal
	l.c: (nautilus_service_install_view_install_package_callback),
	(nautilus_service_install_view_uninstall_package_callback):
	Used categorydata_new instead of g_new

	* nautilus-installer/src/druid-sidebar.xpm:
	Nicer ui
	
	* nautilus-installer/src/installer.c: (check_system):
	Comment to the danish dialog box...

2000-09-01  J Shane Culpepper  <pepper@eazel.com>

	* components/services/summary/nautilus-view/nautilus-summary-view.c
	: (generate_summary_form), (maintenance_button_cb),
	(community_button_cb), (register_button_cb):

	Adding missing buttons to the summary view.

2000-09-01  Robey Pointer  <robey@eazel.com>

	* components/services/login/nautilus-view/Makefile.am:
	* components/services/login/nautilus-view/nautilus-login-view.c:
	(generate_login_form), (entry_changed_cb), (authn_succeeded),
	(authn_failed), (start_login), (login_button_cb),
	(nautilus_login_view_initialize), (nautilus_login_view_destroy):

	Fix the "login view" so that it's really the change-password
	view.  Another bug (2710) has been filed on cleaning this up and
	possibly renaming it.

2000-09-01  Darin Adler  <darin@eazel.com>

	* libnautilus-extensions/nautilus-directory-private.h:
	* libnautilus-extensions/nautilus-directory-async.c:
	(nautilus_directory_is_anyone_monitoring_file_list):
	Made this function public because it's needed to get the
	assert right.
	(start_or_stop_io): Use it by the new public name.
	* libnautilus-extensions/nautilus-vfs-directory.c:
	(vfs_is_not_empty): Use the new function to get the assert
	right, which fixes bug 2706 (crash at startup with
	bookmark for nonexistent trash file).
	
	* libnautilus-extensions/nautilus-trash-directory.c:
	(remove_trash_volume): Fix a NautilusDirectory leak.

	* libnautilus-extensions/nautilus-glib-extensions.c:
	(print_key_string), (free_hash_tables_at_exit):
	Print keys before complaining about hash table so you
	see them first if you have things set to drop into
	the debugger on warnings.

2000-09-01  John Sullivan  <sullivan@eazel.com>

	Changed all nautilus dialog calls to take a window title
	(or NULL to get "Nautilus: Error" and the like). Updated 
	all callers to pass a window title.

	* libnautilus-extensions/nautilus-stock-dialogs.h,
	* libnautilus-extensions/nautilus-stock-dialogs.c:
	(show_message_box), (show_ok_box), (nautilus_info_dialog),
	(nautilus_warning_dialog), (nautilus_error_dialog),
	(nautilus_error_dialog_with_details), (nautilus_yes_no_dialog):
	Updated all public & private dialog-creating calls to take
	a dialog_title parameter.

	* components/rpmview/nautilus-rpm-view-install.c:
	(nautilus_rpm_view_install_done):
	* libnautilus-extensions/nautilus-file-operations.c:
	(confirm_empty_trash):
	* libnautilus-extensions/nautilus-program-chooser.c:
	(nautilus_program_chooser_show_no_choices_message):
	* libnautilus-extensions/nautilus-program-choosing.c:
	(nautilus_launch_application_parented):
	* src/file-manager/fm-error-reporting.c:
	(fm_report_error_renaming_file), (fm_report_error_setting_group),
	(fm_report_error_setting_owner),
	(fm_report_error_setting_permissions):
	* src/nautilus-application.c:
	(nautilus_application_check_user_directories),
	(nautilus_application_startup):
	* src/nautilus-first-time-druid.c:
	(nautilus_first_time_druid_show):
	* src/nautilus-property-browser.c: (emblem_image_file_changed),
	(add_background_to_browser):
	* src/nautilus-sidebar.c: (receive_dropped_uri_list):
	* src/nautilus-window-manage-views.c: (handle_unreadable_location),
	(report_content_view_failure_to_user),
	(report_sidebar_panel_failure_to_user),
	(nautilus_window_end_location_change_callback):
	* src/nautilus-window-menus.c: (forget_history_if_confirmed),
	(show_bogus_bookmark_window): Made up dialog titles for all
	title-less dialogs. A few were already setting titles after
	the fact, so I removed the now-extraneous set_title calls.

2000-09-01  J Shane Culpepper  <pepper@eazel.com>

	* components/services/nautilus-dependent-shared/shared-service-widg
	ets.c: (create_summary_service_title_top_widget),
	(create_summary_service_title_bottom_widget),
	(create_services_header_widget),
	(create_summary_service_large_grey_header_widget),
	(create_summary_service_small_grey_header_widget):
	* components/services/nautilus-dependent-shared/shared-service-widg
	ets.h:
	* components/services/summary/nautilus-view/nautilus-summary-view.c
	: (generate_summary_form):

	Finishing Bug #2631.  Arlo titles to all sections of the summary view.

2000-09-01  Michael Engber  <engber@eazel.com>
	
	Removed our quitting logic from nautilus-application
	(where it was tied to nautilus-window closing) and added
	a more general mechanism in main.c - by which you can
	register any gtk object to keep the main event loop
	alive while the object is around. This, in turn, fixed 
	a problem with the first-time-druid not causing nautilus
	to quit when it was cancel via the close box (bug 2211)
	and also a problem with nautilus quitting before you had
	a chance to see an error dialog (bug 1871). Also, added
	nautilus_main_event_loop_quit as the preferred way to
	cause nautilus to quit (as opposed to gtk_main_quit)

	* src/nautilus-application.c: (nautilus_application_startup),
	(nautilus_application_close_desktop),
	(nautilus_application_destroyed_window):
	* src/nautilus-application.h:
	* src/nautilus-first-time-druid.c: (druid_finished),
	(nautilus_first_time_druid_show):
	* src/nautilus-main.c: (nautilus_main_is_event_loop_needed),
	(nautilus_main_event_loop_unregister),
	(nautilus_main_event_loop_register),
	(nautilus_main_is_event_loop_mainstay),
	(nautilus_main_event_loop_quit), (main):
	* src/nautilus-main.h:
	* src/nautilus-shell.c: (corba_quit), (corba_restart):
	* src/nautilus-window-manage-views.c:
	(nautilus_window_end_location_change_callback):
	* src/nautilus-window.c: (nautilus_window_initialize):

2000-09-01  J Shane Culpepper  <pepper@eazel.com>

	* components/services/nautilus-dependent-shared/icons/Makefile.am:
	* components/services/nautilus-dependent-shared/shared-service-widg
	ets.c: (create_summary_service_title_top_widget),
	(create_summary_service_title_bottom_widget):
	* components/services/nautilus-dependent-shared/shared-service-widg
	ets.h:
	* components/services/summary/nautilus-view/nautilus-summary-view.c
	: (generate_summary_form):

	First part of the arlo titles for the summary view.

2000-09-01  Darin Adler  <darin@eazel.com>

	* libnautilus-extensions/nautilus-glib-extensions.c:
	(print_key_string), (free_hash_tables_at_exit),
	(nautilus_g_hash_table_new_free_at_exit): Added code to print out
	the keys for the hash table at exit time if it's a hash table with
	string keys. I can tell the keys are strings because the hash
	function is g_str_hash.
	
	* src/file-manager/nautilus-trash-monitor.c:
	(nautilus_trash_monitor_initialize): Used connect_while_alive
	instead of connect to get rid of some nasty problems with
	lingering signal handlers.

2000-09-01  Maciej Stachowiak  <mjs@eazel.com>

	* components/tree/libmain.c (tree_shlib_object_destroyed): Don't
	call oaf_plugin_unuse for now, it kills stuff.

	* components/tree/nautilus-tree-model.c:
	(nautilus_tree_model_destroy,
	nautilus_tree_model_for_each_postorder): Bug fixes to avoid crashing.
	
	* components/tree/nautilus-tree-view.c: (insert_hack_node,
	remove_hack_node, freeze_if_have_hack_node): Assorted fixes to
	avoid crashing or locking up when in-process.

	* configure.in: Fix configure text for in-proc tree view.

2000-09-01  John Sullivan  <sullivan@eazel.com>

	Fixed bug 1476 (Using bogus local bookmark should update
	its icon). The specific bug led me to changing some of
	the internals of NautilusBookmark in a way that has nice
	UI consequences. Now if you use Nautilus to move a bookmarked
	file, the bookmark will continue to find the moved file, and
	if you delete a file, the bookmark's icon will change to the
	"missing location" icon.

	* libnautilus-extensions/nautilus-bookmark.c:
	(nautilus_bookmark_disconnect_file),
	(nautilus_bookmark_connect_file): New helper functions that
	handle wiring or unwiring the connection between a bookmark
	and its NautilusFile.
	(nautilus_bookmark_destroy): Use nautilus_bookmark_disconnect_file.
	(nautilus_bookmark_new_with_icon): Use nautilus_bookmark_connect_file.
	(bookmark_file_changed_callback): Notice changes in the file's URI
	and update the bookmark to use the new URI; notice when the file
	is gone and disconnect/reconnect to file.

	Miscellaneous tweaks:
	
	* src/file-manager/fm-search-list-view.c:
	(compute_reveal_item_name_and_sensitivity): At the suggestion of
	a localizer (menthos), added explanatory comments before the use
	of "Reveal in New Window" and "Reveal in <n> New Windows". It turns
	out that a comment just before a translatable text string will
	appear in the .pot files that localizers use.
	* src/nautilus-first-time-druid.c: (set_up_user_level_page):
	Fixed two misspellings of "technical" and one missing period. Thanks
	to menthos for pointing these out.
	* src/nautilus-window-menus.c: 
	(show_bogus_bookmark_window): Use nautilus_format_uri_for_display
	for bookmark uris shown in user messages. Simplify the message you
	get if you choose a known-bogus URI from the Go menu.

2000-09-01  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 2491, remove GtkHtml web browser from build.
	
	* components/Makefile.am:
	Removed the http component
	
2000-09-01  Ali Abdin  <aliabdin@aucegypt.edu>

        * components/help/converters/gnome-db2html2/sect-elements.c:
        Ooops - Make the QUOTE tag actually print the characters out

2000-09-01  Maciej Stachowiak  <mjs@eazel.com>

	* components/tree/nautilus-tree-model.c:
	(nautilus_tree_model_destroy, nautilus_tree_model_unref_callback,
	nautilus_tree_model_for_each_postorder, remove_all_nodes,
	report_node_removed_internal, report_node_removed): Clean up all
	the nodes when destroying the model.
	
	* components/tree/nautilus-tree-view.c: Unref the model when
	destroying the view.

	* components/tree/nautilus-tree-node-private.h,
	components/tree/nautilus-tree-node.c:
	(nautilus_tree_node_remove_from_parent): Renamed from
	`nautilus_tree_remove_from_parent'

2000-09-01  Pavel Cisler  <pavel@eazel.com>

	Fix bugzilla 2186 - Move/Copy/Make-Link for times from multiple directories
	fails. Still needs more testing.
	Reworked file operations to match new gnome_vfs_xfer... APIs that now take
	lists of URIs for copy source and destination.

	* components/services/install/lib/eazel-install-protocols.c:
	(gnome_vfs_fetch_remote_file):
	Update to use new API. 
	
	* libnautilus-extensions/nautilus-file-operations.c:
	(check_target_directory_is_or_in_trash),
	(new_uri_from_escaped_string), (append_basename_unescaped),
	(nautilus_file_operations_copy_move),
	(nautilus_file_operations_new_folder),
	(nautilus_file_operations_move_to_trash),
	(nautilus_file_operations_delete), (do_empty_trash):
	Reworked to use new APIs.
	Eliminated FIXME 1107.
	Updated find_directory calls to use proper "create if needed" flags.
	
	* libnautilus-extensions/nautilus-file-utilities.c:
	(nautilus_get_user_main_directory):
	* libnautilus-extensions/nautilus-file.c: (nautilus_file_rename):
	Updated to use new APIs.

2000-09-01  Eskil Heyn Olsen  <eskil@eazel.com>

	* components/rpmview/nautilus-rpm-view-install.c:
	(nautilus_rpm_view_download_progress_signal),
	(nautilus_rpm_view_install_progress_signal),
	(nautilus_rpm_view_download_failed), 
	Emits load_underway signals, although they do not seem to start
	the spinner.
	(get_detailed_errors_foreach),
	(get_detailed_errors), 
	(nautilus_rpm_view_install_failed),
	Generates contents for the dialog box showed when the operation
	failed.
	(nautilus_rpm_view_dependency_check),
	(nautilus_rpm_view_install_done), 
	If failed, show a box to the user
	(nautilus_service_need_password),
	(nautilus_service_try_again), 
	(set_root_client), 
	Added Robeys password dialog stuff
	(delete_files),
	emits a FALSE when asked to delete files.	
	(nautilus_rpm_view_install_package_callback),
	(nautilus_rpm_view_uninstall_package_callback):
	Still defaults to testmachine.eazel.com (bad, but landa.eazel.com
	seems to be down). Sets up the password query thing.
	
	* components/rpmview/nautilus-rpm-view.c:
	(nautilus_rpm_view_initialize), 
	(nautilus_rpm_view_destroy),
	(check_installed):
	Fixed the nautilus_label problem by ifdeffing it to use gtk_label
	for the strings that will most likely contain \n\n
	
	* components/rpmview/nautilus-rpm-view.h:
	Added some calls to get div fields from details.
	
	* components/services/install/command-line/eazel-alt-install-corba.
	c: (set_parameters_from_command_line):
	Fixed the --root handling of dirs.
	
	* components/services/install/lib/eazel-install-protocols.c:
	Now set to use the old CGI stuff while landa doesn't serve me my
	rpm's..
	
	* components/services/install/lib/eazel-install-rpm-glue.c:
	(eazel_install_prune_packages_helper),
	Added some debug output
	(eazel_install_package_name_compare):
	Removed some debug output
	
	* components/services/install/lib/eazel-install-types.c:
	(packagedata_destroy_foreach), (packagedata_destroy),
	free the pack structure itself
	(packagedata_remove_soft_dep):
	paranoia check
	
	* components/services/trilobite/libtrilobite/trilobite-root-client-
	public.h:
	Changed the include to use "'s instead of <'s. 
	
	* nautilus-installer/src/Makefile:
	* nautilus-installer/src/installer.c: (create_pixmap),
	(create_what_to_do_page), (create_install_page),
	(create_finish_page_good), (create_finish_page_evil),
	(create_window), (create_info_druid_page):
	Better image loading for the static installer.

2000-09-01  J Shane Culpepper  <pepper@eazel.com>

	* components/services/nautilus-dependent-shared/icons/Makefile.am:
	Forgot to update the Makefile.am for the new icons.

2000-09-01  J Shane Culpepper  <pepper@eazel.com>

	* components/services/summary/nautilus-view/nautilus-summary-view.c
	: (generate_summary_form):

	Minor ui fixes to prepare adding the arlo title widgets.  Adding
	several images as well.

2000-09-01  Andy Hertzfeld  <andy@eazel.com>

	* components/rpmview/nautilus-rpm-view.c:
	(nautilus_rpm_view_initialize), (check_installed),
	(nautilus_rpm_view_update_from_uri):
	removed anti-aliased text from rpm_view, since it was causing
	too many problems; displayed icon contained in package header, or
	a generic package icon if there isn't one; gather and display
	package install time correctly.
	
2000-08-31  Maciej Stachowiak  <mjs@eazel.com>

	* ChangeLog: rolled over to ChangeLog-20000831.

