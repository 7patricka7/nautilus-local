2001-02-21  John Harper  <jsh@eazel.com>

	reviewed by: Darin Adler <darin@eazel.com>

	Fixed bug 6828 (Moving directories in tree view makes contents
	become top-level nodes):

	* components/tree/nautilus-tree-node.h,
	components/tree/nautilus-tree-node.c,
	components/tree/nautilus-tree-node-private.h

	(nautilus_tree_node_update_uri): new private function, updates
	the node's cached URI from its NautilusFile and updates the new
	is_toplevel flag

	(nautilus_tree_node_is_toplevel): new function, returns true if
	the node shouldn't have a parent node

	* components/tree/nautilus-tree-model.c: track nodes that have
	no parent but aren't top-level nodes. If suitable parents later
	appear the unparented nodes will be connected to them

	* components/tree/nautilus-tree-view.c,
	components/tree/nautilus-tree-view-private.h: do similar
	tracking of unparented nodes (but from the point of view of the
	view, not the model)

	[ Having both modules duplicate this similar functionality
	isn't ideal, but I don't see how to unify it ]


	Fixed bug 6820 (directory sort order is different in tree
	view):

	* components/tree/nautilus-tree-view.c (ctree_compare_rows):
	new function, set as the comparison function for tree views.
	It calls nautilus_file_compare_for_sort () on the files
	associated with the tree rows (with hardcoded type
	NAUTILUS_FILE_SORT_BY_NAME for now)

	* libnautilus-extensions/nautilus-ctree.c
	(nautilus_ctree_insert_node): for sorted insertions, link the
	inserted node into the tree before finding the correct place,
	then move it afterwards. This ensures that the comparison
	function is able to find the node pointers from the row
	pointers that it's given

2001-02-21  Rebecca Schulman  <rebecka@eazel.com>
	Remove the "backup unindexed search" preference for 1.0, which is
	bugzilla.eazel.com bug 6775.  We will not be doing backup
	searches, and with Ramiro's help redo preference changes more
	cleanly, and to be more compatible with his preference changes.

	reviewed by: Ramiro Estrugo <ramiro@eazel.com>

	* libnautilus-extensions/nautilus-global-preferences.c:
	(global_preferences_install_descriptions),
	(global_preferences_install_defaults),
	(global_preferences_install_visibility),
	(global_preferences_create_dialog),
	(global_preferences_install_home_location_defaults),
	(global_preferences_use_fast_search_changed_callback),
	(global_preferences_medusa_state_changed_callback),
	(global_preferences_install_medusa_defaults):
	* libnautilus-extensions/nautilus-global-preferences.h:
	Remove the old BACKUP_SEARCH preference, and add functions
	to install medusa preference defaults, and to synchronize
	the gconf value of the preference with the system configuration
	file used by medusa.
	
	* libnautilus-extensions/nautilus-preferences.c:
	(nautilus_preferences_set_boolean),
	(nautilus_preferences_get_boolean):
	Remove old system preferences calls

	* libnautilus-extensions/Makefile.am:	
	* libnautilus-extensions/nautilus-system-preferences.c:
	* libnautilus-extensions/nautilus-system-preferences.h:
	Remove these
	* libnautilus-extensions/nautilus-medusa-support.c:
	(nautilus_medusa_services_have_been_enabled_by_user),
	(nautilus_medusa_blocked), (nautilus_medusa_enable_services),
	(nautilus_medusa_add_system_state_changed_callback):
	* libnautilus-extensions/nautilus-medusa-support.h:
	Add this file to hide potentially ifdef'd out medusa 
	code.
	
	* src/file-manager/fm-search-list-view.c: (load_location_callback):
	* src/nautilus-complex-search-bar.c:
	(nautilus_complex_search_bar_get_location):
	Remove logic related to the BACKUP_SEARCH feature.

2001-02-21  Robin * Slomkowski  <rslomkow@eazel.com>

	* nautilus.spec.in: moved documentation to
	%{prefix}/share/gnome/help/nautilus-user-manual/C/*
	and added gnugpl dir BUG 6837 

2001-02-21  Gene Z. Ragan  <gzr@eazel.com>

	reviewed by: John Sullivan <sullivan@eazel.com>
	
	Fixed bug 6465, Music view buttons stretch for songs
	with very long titles.
	
	* components/music/nautilus-music-view.c: (add_play_controls),
	(nautilus_music_view_set_album_image):
	Change the way that the play controls are added to the pack box
	so that they do not expand in strange ways or change their position
	when a custom image is added.
		
2001-02-21  Darin Adler  <darin@eazel.com>

	reviewed by: Mike Fleming <mfleming@eazel.com>

	Busted the Tinderbox again! (Another attempt to fix it.)

	* libnautilus-extensions/nautilus-file-utilities.c:
	(nautilus_self_check_file_utilities): Changed the tests
	to match reality.

	* configure.in:
	* user-guide/Makefile.am:
	Turned the user guide off again. Dan explained that this
	is what he meant to do (I got it wrong).

2001-02-21  Eric Fischer <eric@eazel.com>

	* nautilus-installer/install-lib/Makefile.am:
	Use ln to make links into the real install/lib directory;
	add header file prerequisites

	* nautilus-installer/libtrilobite/Makefile.am:
	Use ln to make links into the real libtrilobite directory;
	fix header file prerequisites

	* nautilus.spec.in:
	Again, try to build the installer in tinderbox.  With luck,
	it'll actually work this time.

2001-02-21  Darin Adler  <darin@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	An attempt to fix the Tinderbox.

	* user-guide/Makefile.am: Add C subdir.

	Other changes.

	* libnautilus-extensions/nautilus-file-utilities.c:
	(nautilus_format_uri_for_display): Simplify to take advantage of
	the new gnome_vfs_get_local_path_from_uri, which rejects paths
	that have "#" characters in them.
	(nautilus_self_check_file_utilities): Add more test cases for
	host names that are case sensitive.

	* omf-install/.cvsignore: Ignore generated files in this new
	directory.

2001-02-21  Laszlo Kovacs <laszlo.kovacs@sun.com>
	* components/help/Makefile.am
	enabling Scrollkeeper to be the default help system

2001-02-21  Ramiro Estrugo  <ramiro@eazel.com>

	* README: Clarify the Mozilla version requirements.

2001-02-21 John Fleck <jfleck@inkstain.net>

	* components/help/converters/gnome-db2html2/sect-preparse.c
	add a test to gloss_term_append - if a glossentry has not id (a
	special case, but one that does on occasion occur) bail out of the
	function without trying to add it to the hash of glossentries
	fixes bug #6511
	
2001-02-20  Maciej Stachowiak  <mjs@eazel.com>

	reviewed by: Ian McKellar  <ian@eazel.com>

	* components/services/summary/eazel-summary-shared.c
	(parse_service), (parse_eazel_news_item),
	(parse_update_news_item),
	(build_services_glist_from_xml),
	(build_eazel_news_glist_from_xml),
	(build_update_news_glist_from_xml): Make this more robust against
	unusual data from the server. In particular, if the SERVICES list
	or other lists are emtpy, do not crash.

2001-02-21  Andy Hertzfeld  <andy@eazel.com>

	fixed bug 5939, margins in text icons are weirdly proportioned.
	Fixed by distinguishing the rectangles for the anti-aliased and
	non-aa icon types
	
	* icons/i-regular.xml:
	added and tweaked both aa and non-aa text rectangles
	* libnautilus-extensions/nautilus-icon-factory.c:
	(get_themed_icon_file_path):
	get a separate text rectangle for anti-aliased mode if present
	
	fixed bug 6708, Change "support" link in menus, by moving and
	renamed the "support" item from the services menu to the help menu.
	This bug isn't finished yet, since we still have to rename the
	support uri, but it isn't ready on the service yet.
	
	* src/nautilus-service-ui.xml:
	removed support item
	* src/nautilus-shell-ui.xml:
	added customer service item
	* src/nautilus-window-menus.c: (help_menu_customer_service),
	(nautilus_window_initialize_menus):
	added code to handle the customer service command
	* src/nautilus-window-service-ui.c:
	(nautilus_window_install_service_ui):
	removed callback for the support command

2001-02-21  Dan Mueth  <dan@eazel.com>

	reviewed by: Mike Fleming  <mfleming@eazel.com>

	The old help tree, "user-guide/*", was broken in several ways.
	It assumed there was only one doc, called "user-guide", whereas
	we have multiple docs.  Plus it had odd subdirectories which
	are unusual and we don't want to use.  Plus the convention is
	to put all docs in a directory called "help" (modelled after
	$prefix/gnome/help) and figures in a subdir called "figures".
	So, I'm creating a new tree for this called "help" and installing
	the latest version of Vera's Nautilus User Manual with
	screenshots.  I also added a nifty makefile, help/docs.make,
	which we will use for all the SGML docs and translations
	to keep things tidy and working with low maintenance.

	* Makefile.am: Including help/
	* configure.in: Including help/ and subdirs
	* help/Makefile.am: added
	* help/docs.make: added nifty makefile to be used by all
	  SGML docs and translations of SGML docs
	* help/nautilus-user-manual/C/Makefile.am: added
	* help/nautilus-user-manual/C/figures/custicon.png: added
	* help/nautilus-user-manual/C/figures/full.png: added
	* help/nautilus-user-manual/C/figures/link.png: added
	* help/nautilus-user-manual/C/figures/locbar.png: added
	* help/nautilus-user-manual/C/figures/noread.png: added
	* help/nautilus-user-manual/C/figures/nowrite.png: added
	* help/nautilus-user-manual/C/figures/part.png: added
	* help/nautilus-user-manual/C/figures/player.png: added
	* help/nautilus-user-manual/C/figures/prefmenu.png: added
	* help/nautilus-user-manual/C/figures/sidebar.png: added
	* help/nautilus-user-manual/C/figures/viewmenu.png: added
	* help/nautilus-user-manual/C/figures/viewmusic.png: added 
	* help/nautilus-user-manual/C/nautilus-user-manual-C.omf: added
	* help/nautilus-user-manual/C/nautilus-user-manual.sgml: added
	* help/nautilus-user-manual/Makefile.am: added
	* user-guide/Makefile.am: turned off old user guide installation

2001-02-21  Robey Pointer  <robey@eazel.com>

	* components/services/install/nautilus-view/callbacks.c:
	(nautilus_service_install_download_progress):

	Workaround possible redundant 100% progress callback.

2001-02-21  Pavel Cisler <pavel@eazel.com>

	* components/help/help-method.c:

	Fix broken build - add the right includes that got dropped by
	GnomeVFS header file shuffle.

2001-02-20  John Harper  <jsh@eazel.com>

	reviewed by Maciej Stachowiak  <mjs@eazel.com>

	Fixed bug where a renamed node in the tree view doesn't get
	resorted:

	* libnautilus-extensions/nautilus-ctree.c (set_node_info): if
	the ctree is in auto-sort mode, sort the branch containing the
	changed node


	Fixed a crash in the tree view when expanding nodes that have
	been moved across directories:

	* components/tree/nautilus-tree-node.c
	(nautilus_tree_node_remove_children): new function, unparents
	all children of the given node

	(nautilus_tree_node_destroy): emit a warning if the list of
	children is non-null (then call remove_children). Ideally the
	remove_children function should get called before the final
	unref of a directory node

	* components/tree/nautilus-tree-model.c
	(report_node_removed_internal): call
	nautilus_tree_node_remove_children before unref'ing the node


	Mostly fixed bug where expansion state hash table accumulates
	cruft over time (e.g. directories that no longer exist or got
	moved to locations where they can never be displayed):

	* components/tree/nautilus-tree-view.h
	(NautilusTreeViewDetails): added `view_node_to_uri_map' hash
	table. This is used to map view nodes to the URIs we believe
	they are displaying. This is necessary since by the time we
	find out about changes to nodes, the names of the underlying
	NautilusFile objects have often already been changed

	* components/tree/nautilus-tree-view.c
	(unlink_view_node_from_uri, link_view_node_with_uri,
	map_view_node_to_uri): functions accessing the new hash table

	(nautilus_tree_view_would_include_file): new function, returns
	true iff the given file may possibly appear in the tree view.
	Climbs through all parents of the file to do this

	(nautilus_tree_view_model_node_renamed_callback): only
	propagates the expansion state if the would_include function
	indicates that the new URI of the file would be included in the
	tree view

	* components/tree/nautilus-tree-model.c (report_node_changed):
	no need to suppress the `node_removed' signal when renaming the
	node (now that the view always deletes the expansion state of
	the correct URI)

	* libnautilus-extensions/nautilus-file.c,
	libnautilus-extensions/nautilus-file-private.h, 
	libnautilus-extensions/nautilus-file-utilities.c, 
	libnautilus-extensions/nautilus-file-utilities.h
	(nautilus_file_name_matches_hidden_pattern,
	nautilus_file_name_matches_backup_pattern): moved these
	functions from being private in nautilus-file to being public
	in nautilus-file-utilities


	Fixed tree view bug where moving nodes across directories still
	loses the expansion state: 

	* components/tree/nautilus-tree-model.c
	(nautilus_tree_model_directory_files_changed_callback):
	separated the cases of the file being deleted and it being
	moved across directories. In the move case emit the
	`being_renamed' signal so the expansion state gets propagated

	(nautilus_tree_view_remove_model_node, forget_view_node): moved
	the code to delete the expansion state from forget_view_node to
	nautilus_tree_view_remove_model_node - avoids deleting
	expansion state of nodes that will later be renamed. It may
	leave non-existent directories in the expansion state, but this
	is a lesser bug than losing the expansion state totally. Also,
	use the map_view_node_to_uri function to find the URI whose
	expansion state needs to be removed


	Fixed the bug where tree view icons often got chopped at top
	and bottom when they're drawn (if the icon height is greater
	than the font height). This means that fewer rows may fit in
	the same vertical space, but visually it's (imho) a huge
	improvement (I think this is bug 6085):

	* components/tree/nautilus-tree-view.c
	(nautilus_tree_view_initialize): call gtk_clist_set_row_height
	with the maximum of the font height and the icon height

	* libnautilus-extensions/nautilus-ctree.c (draw_row): always
	calculate row_center_offset locally, and do it in such a way
	that the text really is in the center of the row!


	Fixed bug 5165 - repeatedly expanding and collapsing an empty
	directory doesn't change how the node's icon is drawn after the
	first expansion:

	* libnautilus-extensions/nautilus-ctree.c (real_tree_expand,
	real_tree_collapse): before returning, call tree_draw_node on
	the node that changed state

2001-02-20  Robey Pointer  <robey@eazel.com>

	* components/services/install/nautilus-view/Makefile.am:
	* components/services/install/nautilus-view/callbacks.c:
	* components/services/install/nautilus-view/callbacks.h:
	* components/services/install/nautilus-view/forms.c:
	* components/services/install/nautilus-view/forms.h:

	Added callbacks.[ch] and forms.[ch] to split the ridiculously huge
	install view into smaller, more managable chunks.
	
	* components/services/install/nautilus-view/main.c: (quit_timer),
	(service_install_object_destroyed):
	* components/services/install/nautilus-view/nautilus-service-instal
	l-view.c: (deps_destroy_foreach),
	(nautilus_service_install_view_destroy),
	(nautilus_service_install_view_finalize),
	(nautilus_service_install_view_initialize_class),
	(nautilus_service_install_view_initialize),
	(nautilus_service_install_view_update_from_uri_finish),
	(service_install_stop_loading_callback):
	* components/services/install/nautilus-view/nautilus-service-instal
	l-view.h:

	Turn the preflight dialog into a question asked inline.  Do some
	wacky hoop-jumping so that we do the right thing if the user
	leaves our view while we're waiting for a button press.  Turn off
	some of the distractions (progress bar, etc) while waiting for
	info and feedback.

2001-02-20  Andy Hertzfeld  <andy@eazel.com>

	* libnautilus-extensions/nautilus-tabs.c: (draw_tab_label):
	fixed bug 6804, resizing sidebar crashes summary view.  Fixed by
	adding a check to not draw the label when it's position is past
	the right edge of the pixbuf.
		
2001-02-20  Eskil Heyn Olsen  <eskil@eazel.com>

	reviewed in part by: Robey Pointer  <robey@eazel.com>

	This patch fixes bug 6458, 5722, 6602, 6788 and 5826.
	Removed soft_depends from PacakgeData.

	This has some major changes in the logic, and (taaadaa) is fairly
	untestet because of the sorry state of the testservers these
	days. This will most likely no longer work with
	services.eazel.com, but only with the newest server code.
	
	* components/rpmview/nautilus-rpm-view-install.c:
	(get_detailed_errors_foreach), (get_detailed_errors):
	Fixed to parse PackageBreaks objects.
	
	* components/services/install/lib/eazel-install-logic2.c:
	(dump_tree_helper), (prune_failed_packages_helper),
	(eazel_install_check_existing_packages), (get_softcat_info),
	(is_satisfied), (is_satisfied_from_package_list),
	(is_satisfied_features), (check_dependencies_foreach),
	(check_dependencies), (check_tree_helper),
	(check_no_two_packages_has_same_file),
	(check_conflicts_against_already_installed_packages),
	(check_feature_consistency), (do_file_conflict_check),
	(do_dep_check_internal), (download_packages),
	(get_packages_with_mod_flag), (eazel_uninstall_upward_traverse),
	(eazel_uninstall_check_for_install), (eazel_uninstall_globber),
	(install_packages), (uninstall_packages):
	Ouput status in the tree dump.
	Improved the way I fail ALREADY_INSTALLED packages.
	Check the new package system error field in check_existing.
	Get_info don't check for fillflag to decide if softcat success was
	ok, since suites don't get the fillflag.
	Don't try and dedupe suite objects.
	Mark packages already installed with same version as CANCELLED.
	If a ALREADYINSTALLED package is cancelled due to install options
	(upgrade/downgrade), set a data field called "cancelled" to
	represent.
	Added a (currently not fully functional) check to see if a
	dependency is solved by the current work set (bug 6809).
	is_satisfied now uses is_satisfied_from_packages before checking
	if dependency is installed.
	Modified check_dependencies_foreach to pass around the package
	list.
	No longer do dependency check on cancelled packages (bug 6485).
	Don't package depcheck packages with suite_id, treat it's contents
	at comming toplevel packages.
	Output crack sentence when trying to revice PackageFeatureMissing
	breaks (file bug 6811)
	Don't file uniqueness or file conflict check suites.
	Fixed a bug in the feature_consistency, required a new query enum
	in eazelpackagesystem query call.
	Spewed out some comments.
	Always add children of a suite to K.
	Check download status (bug 5722)
	Commented out expand_package_suites.
	get_packages_with_mod_flag can now parse down into ->depends.
	Nicyfied debug output.
	
	* components/services/install/lib/eazel-install-protocols.c:
	(gnome_vfs_xfer_callback), (gnome_vfs_fetch_remote_file),
	(eazel_install_fetch_package):
	No longer use rpmvercmp.
	Define flag to make all downloads fail (to test failed downloads).
	Note when VFS is lying about bytes_copied.
	Removed some ancient code.
	
	* components/services/install/lib/eazel-install-xml-package-list.c:
	(parse_package), (eazel_install_packagedata_to_xml_int):
	Removed soft_depends.
	
	* components/services/install/lib/eazel-package-system-rpm3-private
	.h:
	* components/services/install/lib/eazel-package-system-rpm3.c:
	(eazel_package_system_rpm3_db_locked),
	(eazel_package_system_rpm3_dbs_locked),
	(eazel_package_system_rpm3_open_dbs),
	(eazel_package_system_rpm3_packagedata_fill_from_header),
	(eazel_package_system_rpm3_query_foreach),
	(eazel_package_system_rpm3_query_requires_feature),
	(eazel_package_system_rpm3_query),
	(eazel_package_system_rpm3_verify):
	Did the db lock check voodoo.
	Added REQUIRES_FEATURE query enum.
	Loads features from a given file (bug 5826)
	
	* components/services/install/lib/eazel-package-system-types.h:
	* components/services/install/lib/eazel-package-system-types.c:
	(packagedata_finalize), (packagedata_initialize),
	(packagedata_copy), (packagedata_fill_in_missing),
	(packagedata_remove_soft_dep), (packagedata_add_pack_to_depends),
	(eazel_install_package_name_compare), (packagedata_dump_int):
	Good bye soft_depends.
	
	* components/services/install/lib/eazel-package-system.c:
	(eazel_package_system_load_implementation),
	(eazel_package_system_load_package), (eazel_package_system_query),
	(eazel_package_system_fail_all_packages),
	(eazel_package_system_install), (eazel_package_system_uninstall),
	(eazel_package_system_verify), (eazel_package_system_initialize),
	(eazel_package_system_new_with_id):
	Fixed 6788.
	Added REQUIRES_FEATURE query enum.

	* components/services/install/lib/eazel-package-system.h:
	* components/services/install/lib/eazel-softcat.c:
	(eazel_softcat_get_info):
	Fixed some suite_id majick.

2001-02-20  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 6029, No option to mount zip drive in desktop menu.
	Fixed bug 6751, Nautilus does not detect all of my removable disks.
	Fixed bug 6194, SCSI CD-ROM drives are not displayed on desktop.
	Fixed bug 6396, cd-rom not detected
	
	Special thanks to liblit@acm.org for persisting and looking at the
	code. The check permissions code is an artifact from when we were
	considering having a mount daemon.  I don't think it is needed at all
	because the volume monitor is not running as root.  I wil mark
	the bugs fixed and wait for status but I think this will work.
	
	* libnautilus-extensions/nautilus-volume-monitor.c:
	(mount_volume_ext2_add), (mount_volume_udf_add),
	(mount_volume_vfat_add), (mount_volume_msdos_add):
	Remove old check_permissions code.

2001-02-20  John Sullivan  <sullivan@eazel.com>

	Fixed bug 6785 ("Trash" should be capitalized)

	I grepped Nautilus sources for "the trash" and replaced
	it with "the Trash". Let me know if you can think of
	any references to the Trash that don't start with "the".

	* libnautilus-extensions/nautilus-file-operations.c:
	(build_error_string), (confirm_empty_trash):
	* src/file-manager/fm-directory-view.c:
	(fm_directory_view_confirm_deletion), (confirm_delete_from_trash),
	(report_broken_symbolic_link):
	* src/file-manager/nautilus-desktop-icon-view-ui.xml:
	* src/file-manager/nautilus-directory-view-ui.xml:

2001-02-20  Dan Mueth  <dan@eazel.com>

	* user-guide/C/Makefile.am: Changed so only a warning is
	given if ScrollKeeper is not installed.

2001-02-20  Mike Fleming  <mfleming@eazel.com>

	reviewed by: <ian@eazel.com>

	Added "x-directory/webdav-prefer-directory" for bug 5325

	* components/mozilla/Nautilus_View_mozilla.oaf.in:
	* src/Nautilus_shell.oaf.in:

2001-02-15  Michael K. Fleming  <mfleming@eazel.com>

	reviewed by: <darin@eazel.com>

	Part of 2057: URI's with fragments behave oddly

	* libnautilus-extensions/nautilus-file-utilities.c:
	(nautilus_format_uri_for_display), (uris_match),
	(nautilus_uris_match), (nautilus_uris_match_ignore_fragments),
	(nautilus_self_check_file_utilities):
	* libnautilus-extensions/nautilus-file-utilities.h:

	nautilus_format_uri_for_display returns "file:" URI's if the URI
	in question has a fragment, other file: URI's get translated into paths
	Also no longer calls the evil gnome_vfs_unescape_string_for_display (see
	bug 6694)

	Also fixes bug 6722: re-entering search query results in location bar
	results in error dialog

	Added nautilus_uris_match_ignore_fragments function which strips
	fragments before comparing.  Also added test cases.

	* components/tree/nautilus-tree-view.c:
	(got_activation_uri_callback):
	* src/nautilus-window-manage-views.c:
	(viewed_file_changed_callback):

	Fixed two locations that made the implicit assumption that
	nautilus_file_get_uri should return a URI that's directly comparable
	to the current navigation location.  Other cases may still lurk.

	* src/nautilus-window-menus.c:

	A few calls to gnome_vfs_get_local_path_from_uri that should have
	been gnome_vfs_get_uri_from_local_path.  Eliminating dumb behaviour
	in gnome_vfs_get_local_path_from_uri exposed them.

2001-02-20  Darin Adler  <darin@eazel.com>

	reviewed by: Gene Ragan <gzr@eazel.com>

	Fixed bug 5676 (Moving a directory with multiple nested
	directories causes improper locations to be displayed):

	* libnautilus-extensions/nautilus-directory-private.h:
	* libnautilus-extensions/nautilus-directory.c:
	(nautilus_directory_moved_internal): Made this build a list of the
	affected files.
	(nautilus_directory_moved): Send a changed notice to each affected
	file.
	(nautilus_directory_notify_files_moved): Send a changed notice to
	each affected file, but share code to avoid sending changed
	notices twice for any directory.
	
	Fixed some callers that were assuming a
	gnome_vfs_get_local_path_from_uri would return a non-NULL
	value. This is not safe to assume just because
	gnome_vfs_uri_get_local returns true.

	* components/music/nautilus-music-view.c: (read_id_tag): Use
	gnome_vfs_get_local_path_from_uri to define what a local path is.
	The old code used a mix.
	* libnautilus-extensions/nautilus-file.c:
	(nautilus_file_can_rename): Simplified code to use
	gnome_vfs_get_local_path_from_uri to define what a local path
	is. The old code used a mix.
	* libnautilus-extensions/nautilus-thumbnails.c: (make_thumbnails):
	Added NULL checks after calls to
	gnome_vfs_get_local_path_from_uri.
	* src/nautilus-sidebar.c: (uri_is_local_image): Took out redundant
	check. The definition of local image we want here is: "uses a
	standard file: URI".
	* src/file-manager/fm-directory-view.c:
	(fm_directory_link_type_in_selection): Fixed bug where it would
	only look at the first item in the selection. Simplified logic.
	(is_link_type_special): Added a new function.
	(special_link_in_selection): Instead of calling
	fm_directory_link_type_in_selection, copied it. The problem with
	the other approach is that it was reading each link file three
	time to rule out each of the three special link types.

	Other changes.

	* libnautilus-extensions/nautilus-volume-monitor.c:
	(nautilus_volume_monitor_get_volume_name),
	(modify_volume_name_for_display): Marked "Unknown" for
	localization.
	
	* libnautilus-extensions/nautilus-file-utilities.c:
	* libnautilus-extensions/nautilus-icon-factory.c:
	* src/file-manager/fm-icon-view.c:
	Added 2001 to the copyright since we modified these recently.

2001-02-20  John Sullivan  <sullivan@eazel.com>

	reviewed by: Darin Adler <darin@eazel.com>

	* src/file-manager/fm-error-reporting.c:
	(fm_report_error_renaming_file): Middle-truncate
	really long file names to avoid an error dialog
	that is much wider than the screen.

2001-02-20  Andy Hertzfeld  <andy@eazel.com>

	* src/nautilus-location-bar.c: (try_to_expand_path):
	fixed bug 6717, problem editing a uri with a '#' in the middle,
	by adding a check to the auto-complete code to not substitute
	zero length strings.
	
2001-02-20  Andy Hertzfeld  <andy@eazel.com>

	* components/text/nautilus-text-view.c: (file_close_callback),
	(done_file_read):
	fixed bug 6732, can't unmount volumes after viewing text files;
	fixed by closing the file in done_file_read.
	
2001-02-20  Rebecca Schulman  <rebecka@eazel.com>

	reviewed by: John Sullivan <sullivan@eazel.com>

	* src/file-manager/nautilus-indexing-info.c:
	(show_indexing_info_dialog):
	Complete fix for 6417, by swapping Vera's text into the
	new index status dialog

2001-02-20  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 6384, Nautilus program chooser uses
	"nautilus-mime-type-capplet" to launch capplet
	
	* libnautilus-extensions/nautilus-program-chooser.c:
	(launch_mime_capplet):
	Rename capplet to "file-types-capplet"

2001-02-20  Darin Adler  <darin@eazel.com>

	reviewed by: Gene Ragan <gzr@eazel.com>

	Fixed bug 5482 (If you've esc'd out of an icon stretch, change
	directories, then come back, the icon is the pre-esc'd stretched
	size)

	* libnautilus-extensions/nautilus-icon-container.c:
	(undo_stretching): Pass TRUE instead of FALSE so the "undone" size
	gets stored in metadata. Without this, we end up with the icon at
	the stretched size.

2001-02-20  Richard Boulton <richard@tartarus.org>

	reviewed by: Ali Abdin <aliabdin@aucegypt.edu>

	* components/help/converters/gnome-db2html2/*
	Fix to bug 6700; doesn't include config.h unless HAVE_CONFIG_H
	is defined, and has correct instructions for compiling standalone.

2001-02-20  Kjartan Maraas  <kmaraas@gnome.org>

	* components/services/summary/nautilus-summary-view.c: Fix some
	typos in strings.
	
2001-02-20  Maciej Stachowiak  <mjs@eazel.com>

	Assorted build twiddling.
	
	* components/services/install/command-line/Makefile.am: Remove
	-I/usr/include/rpm

	* components/services/install/nautilus-view/Makefile.am: Likewise.
	
	* components/services/install/nautilus-view/nautilus-service-install-view.c:
	Remove gratuitous include of rpm header.

	* components/services/inventory/Makefile.am: Formatting tweaks.
	
	* components/services/summary/*: flatten this whole directory:
	summary/lib => summary
	summary/nautilus-view => summary
	summary/nautilus-view/test => summary
	summary/nautilus-view/icons/gray_tab_pieces =>summary/nautilus-view/icons
	
	* configure.in: Adjust for flattening of
	components/services/summary
	
	* libnautilus-extensions/nautilus-clickable-image.c
	(adjust_coordinates_for_window): Formatting tweak.

	* user-guide/gnugpl/.cvsignore: Silence cvs.

2001-02-20  Maciej Stachowiak  <mjs@eazel.com>

	reviewed by: Eskil Heyn Olsen  <eskil@eazel.com>

	* components/services/install/server/Makefile.am: Remove
	-I/usr/include/rpm

2001-02-19  Robey Pointer  <robey@eazel.com>

	* components/services/install/nautilus-view/nautilus-service-instal
	l-view.c: (install_message_new), (generate_install_form),
	(nautilus_service_install_preflight_check),
	(nautilus_service_install_done):

	Hide the install view's progress header until downloading begins.
	Try to use nautilus_view_go_back, though it appears to not be
	functional yet.
	
2001-02-20  Rebecca Schulman  <rebecka@eazel.com>
	Complete bug 6416, to add dialogs to explain
	that searches will be slow when medusa is disabled or 
	blocked.  The work was previously complete, but 
	I've swapped in Vera's text, and added an 
	info_dialog_with_details to the stock dialogs.

	reviewed by: Gene Ragan <gzr@eazel.com>

	* libnautilus-extensions/nautilus-stock-dialogs.c:
	(details_dialog_clicked_callback),
	(nautilus_show_info_dialog_with_details),
	(nautilus_show_error_dialog_with_details):
	* libnautilus-extensions/nautilus-stock-dialogs.h:
	* src/file-manager/fm-search-list-view.c:
	(display_system_services_are_blocked_dialog),
	(display_system_services_are_disabled_dialog):

2001-02-20  Rebecca Schulman  <rebecka@eazel.com>
	Fix bugzilla.eazel.com 6414 to add prefence to nautilus
	to enable/disable medusa

	* libnautilus-extensions/nautilus-global-preferences.h:	
	* libnautilus-extensions/nautilus-global-preferences.c:
	(global_preferences_install_descriptions),
	(global_preferences_install_defaults),
	(global_preferences_install_visibility),
	(global_preferences_create_dialog):
	Add the fast search preference pane, visibility level,
	change SEARCH_METHOD -> BACKUP_SEARCH

	* libnautilus-extensions/nautilus-system-preferences.c:	
	* libnautilus-extensions/nautilus-system-preferences.h:
	* libnautilus-extensions/Makefile.am:
	(nautilus_is_system_preference),
	(nautilus_system_preference_get_boolean),
	(nautilus_system_preference_set_boolean):
	Add setters and getters for system preferences that are not
	managed by gconf.  The current set and get functions
	turn on and off medusa services

	* libnautilus-extensions/nautilus-preferences.c:
	(nautilus_preferences_set_boolean),
	(nautilus_preferences_get_boolean):
	Use the new system preference setters and getters instead of the standard
	ones if the preference is not managed by gconf
	
	* src/file-manager/fm-search-list-view.c: (load_location_callback),
	(display_system_services_are_blocked_dialog):
	* src/nautilus-complex-search-bar.c:
	(nautilus_complex_search_bar_get_location):
	change SEARCH_METHOD -> BACKUP_SEARCH

2001-02-19  Maciej Stachowiak  <mjs@eazel.com>

	reviewed by: John Harper  <jsh@eazel.com> 

	Fixed bugs 3743 (Summary view gives the same vague error message
	for many different causes), 3972 (If user can't connect to
	service, they end up with gray content view), 5973 (blank summary
	view after install view finishes) and 6166 (Summary Login dialog
	does not have initial focus) and 6018 (Nautilus returns to wrong
	directory if services are unavailable). Also did much code
	cleanup, and made the service and featured download icons in the
	summary view prelighting and clickable. Fixed many other nits as
	well.

	* components/services/nautilus-dependent-shared/eazel-services-extensions.h,
	components/services/nautilus-dependent-shared/eazel-services-extensions.c
	(eazel_services_clickable_image_new_from_uri): Convenience wrapper
	to make a new clickable image from a URI.
	* components/services/nautilus-dependent-shared/eazel-services-footer.c
	(eazel_services_footer_update): Clear the footer before updating,
	instead of just dumping the new items in along with the old ones.

	* components/services/trilobite/libtrilobite/trilobite-core-network.h,
	components/services/trilobite/libtrilobite/trilobite-core-network.c:
	Adjusted formatting, fixed headers.

	* components/services/trilobite/libtrilobite/trilobite-file-utilities.h,
	components/services/trilobite/libtrilobite/trilobite-file-utilities.c:
	Cut 'n' pasted some useful code from libnautilus-extensions to
	avoid depending on it, whee.
	* components/services/trilobite/libtrilobite/Makefile.am: Added
	above to the build.

	* components/services/trilobite/libtrilobite/trilobite-redirect.h,
	components/services/trilobite/libtrilobite/trilobite-redirect.c:
	(trilobite_redirect_fetch_table_async,
	trilobite_redirect_fetch_table_cancel): Asynchronous version of
	redirect fetching code.
	(redirect_fetch_callback): Helper function.
	(trilobite_redirect_parse_xml): Null terminate buffer properly or
	XML parsing code will get confused.
	(trilobite_redirect_fetch_table): Removed the old synchronous code
	since now no one is using it.

	* components/services/summary/lib/eazel-summary-shared.h,
	components/services/summary/lib/eazel-summary-shared.c:
	(eazel_summary_fetch_data_cancel, eazel_summary_fetch_data_async):
	Asynchronous version of summary fetching code.
	(summary_data_fetch_callback): Helper function.
	(eazel_summary_data_parse_xml): Same null termination trick as for
	redirects.
	(parse_summary_xml_file): Removed old synchronous code since now
	no one is unsing it.

	* components/services/summary/nautilus-view/main.c (main): Set
	user agent to trilobite user agent; intialize gnome-vfs.
	
	* components/services/summary/nautilus-view/nautilus-summary-dialogs.h,
	components/services/summary/nautilus-view/nautilus-summary-dialogs.c 
	(nautilus_summary_show_login_failure_dialog): Renamed from
	`nautilus_summary_login_failure_dialog'
	(nautilus_summary_show_error_dialog): Renamed from
	`generate_error_dialog'.
	(nautilus_summary_show_login_dialog): Renamed from
	`generate_login_dialog'.
	(error_dialog_cancel_cb): Go back instead of (incorrectly) trying
	to go back to the user's homedir.
	(set_dialog_parent): Do the magic coordinate adjustment like
	gnome_dialog_set_parent, but do not set it transient, or it will
	not get focus in click to focus mode.

	* components/services/summary/nautilus-view/nautilus-summary-callbacks.c:
	(authn_cb_failed): Adjust to above renaming.
	* components/services/summary/nautilus-view/nautilus-summary-footer.c 
	(footer_item_clicked_callback): Ditto.
	* components/services/summary/nautilus-view/nautilus-summary-menu-items.c: 
	(bonobo_login_callback): Ditto.

	* components/services/summary/nautilus-view/nautilus-summary-view-private.h:
	Removed unused fields. Added async handles for redirect and summary XML 
	fetch.

	* components/services/summary/nautilus-view/nautilus-summary-view.c:
	(services_button_callback_data_free, summary_view_button_callback,
	goto_uri_on_clicked, summary_view_button_new,
	summary_view_link_image_new): Cleaned up summary view button code,
	added code for the clickable icons and refactored a bit.
	(create_header): Start out saying "Connecting to Eazel
	Services..." instead of blank, and don't call `update_header' from
	here.
	(update_footer): fix incorrect polarity of offline and online.
	(create_footer): remove call to update_footer; leave offline items
	in place until connected.
	(create_news_pane, create_services_list_pane,
	create_featured_downloads_pane): Do not call corresponding update
	func, updating is now separate from creating.
	(generate_service_entry_row, generate_update_news_entry_row): Make
	icons clickable.
	(update_summary_form): New function to update the existing summary
	view with new data, to avoid recreating even the fixed widgets
	from scratch all the time.
	(create_summary_form): Do not destroy all widgets at the
	beginning. Remove some useless widgetry.
	(nautilus_summary_view_initialize): Create the widgetry but do not
	fill it with data.
	(nautilus_summary_view_destroy, summary_fetch_callback,
	redirect_fetch_callback, cancel_load_in_progress),
	nautilus_summary_view_load_uri, summary_load_location_callback):
	Change things around so loading of the summary data is
	asynchronous.
	(summary_stop_loading_callback): Handle "stop_loading".

2001-02-19  Maciej Stachowiak  <mjs@eazel.com>

	reviewed by: Gene Z. Ragan  <gzr@eazel.com>

	Added auto-prelighting feature to NautilusClickableImage, and
	fixed a major bug that occurs for clickable images in scrolled
	areas.
	
	* libnautilus-extensions/nautilus-clickable-image.h,
	libnautilus-extensions/nautilus-clickable-image.c: 
	(nautilus_clickable_image_set_prelight): New public API call that
	allows for automatic prelight handling direct in
	NautilusClickableImage; made it settable because some users of
	this code want to manually prelight with an alternate image.
	(nautilus_clickable_image_set_up_pixbufs): helper function for the
	above that keeps track of the normal and prelit buffers.
	(label_enter, label_leave): When in prelight mode, switch images
	on enter and leave. Also, remove unnecessary queue_draw calls.

	(adjust_coordinates_for_window, ancestor_enter_notify_event,
	ancestor_leave_notify_event, ancestor_motion_notify_event): Do
	some coordinate adjustments so that if the NautilusClickableImage
	is in a scrolled area with NO_WINDOW widgets all the way in
	between, we do an appropriate coordinate adjustment. This should
	also handle other containers that put their children in a
	different window than their own. This was breaking for the summary
	view when I set it to use clickable images for the service icons.
	
	* libnautilus/nautilus-view-standard-main.c
	(nautilus_view_standard_main_multi): Do a g_thread_init to make
	views that use gnome-vfs happy.

2001-02-18  Ian McKellar  <ian@eazel.com>

	reviewed by: Robey Pointer  <robey@eazel.com>

	* libnautilus-extensions/nautilus-mime-actions.c:
	* libnautilus-extensions/nautilus-mime-actions.h:
	* src/nautilus-window.c: (load_view_as_menu_callback):
	Removed all the code related to Gnome-VFS sub-methods in Nautilus.
	(Bug 5086)

2001-02-18  Eskil Heyn Olsen  <eskil@eazel.com>

	reviewed by: Ian McKellar  <ian@eazel.com>

	Fixed bug 6681 ; make eazel-install output more machine parseable
	by adding option and always return !0 on any failure.
	
	* components/services/install/command-line/eazel-alt-install-corba.
	c: (eazel_file_conflict_check_signal),
	(eazel_file_uniqueness_check_signal),
	(eazel_feature_consistency_check_signal),
	(eazel_download_progress_signal), (eazel_install_progress_signal),
	(download_failed), (something_failed),
	(eazel_preflight_check_signal), (dep_check), (md5_check_failed),

2001-02-19  Simos Xenitellis  <simos@hellug.gr>

	* configure.in: Added el to ALL_LINGUAS.

2001-02-18  Michael K. Fleming  <mfleming@eazel.com>

	* components/mozilla/nautilus-mozilla-content-view.c:
	(try_transform_nautilus_uri_to_file_scheme),
	(view_load_location_callback),
	(should_uri_navigate_bypass_nautilus):

	Bug 4302: links in HTML help don't work.

	Now they do.  Since the "gnome-help:" scheme stuff doesn't know
	how to deal with files below the root and its to convoluted to fix,
	the Mozilla component discovers if a gnome-help scheme isgoing to be
	transformed into a file scheme and then redirects nautilus to that
	URI.  This means the full path to the HTML file appears in the location
	bar, just like in the old gnome help browser

2001-02-18  Darin Adler  <darin@eazel.com>

	* components/mozilla/nautilus-mozilla-embed-extensions.cpp:
	Get rid of initialization of nsString object to NULL
	to fix Tinderbox.

2001-02-17  Michael K. Fleming  <mfleming@eazel.com>

	reviewed by: <ramiro@eazel.com>

	Misc Mozilla changes.

	Bug 6542 -- Throbber keeps spinning
	Pages without network activity would never report_load_complete.  Switched
	to using net_start and net_stop to control throbber like galeon (didn't
	I do this before?).  Note that bug 6736 means the throbber might
	cut out early.  Oh well, the stop button isn't really hooked up anyway.

	Bug 6544 -- Crash while navigating help

	Caused by make_full_uri_from_relative going beyond a buffer.  Also added
	test case.

	Also fixed up logic in mozilla_dom_mouse_click_callback related to
	translating URI's that we know how to handle ourself but can't
	be handled by mozilla directly without intervention (eg, eazel-services,
	help URI's)

	Also removed mistaken cancel_pending_vfs_operation in update_nautilus_uri

	Also did some cleanup/rearranging of the async nautilus_view wrappers

	* components/mozilla/nautilus-mozilla-content-view.c:
	(nautilus_mozilla_content_view_initialize),
	(mozilla_location_callback), (mozilla_net_start_callback),
	(mozilla_net_stop_callback), (mozilla_dom_mouse_click_callback),
	(vfs_open_callback), (update_nautilus_uri),
	(make_full_uri_from_relative), (test_make_full_uri_from_relative),
	(dispatch_report_location_change):

	* src/nautilus-sidebar.c: (add_command_buttons):
	Fixed improper assumption that nautilus_file_is_local being TRUE
	means gnome_vfs_get_local_path will return a file path.  The "local"
	concept seems to apply to expected latancy, not URI schemes.  This
	was causing assertion failures when browsing to help: schemes (as
	noted in the comments to bug 6544)
	

2001-02-17  Richard Boulton <richard@tartarus.org>

	reviewed by: Ali Abdin <aliabdin@aucegypt.edu>

	* components/help/converters/gnome-db2html2/gdb3html.c
	* components/help/converters/gnome-db2html2/sect-elements.c
	* components/help/converters/gnome-db2html2/toc-elements.c
	Fix format string vulnerabilities, see bug 6702.  Fixes
	segfault when % character occurs in input files.

2001-02-17  Dan Mueth  <dan@eazel.com>

	reviewed by: Eskil

	Updated toplevel docs data file. Updated and added FDL/GPL
	licenses. Added OMF file for Nautilus User Guide.

	* Makefile.am:  Adding omf-install/
	* components/help/topleveldocs.xml: Updated toplevel docs
	* configure.in: Adding omf-install and user-guide/gnugpl
	* omf-install/Makefile.am: Added for OMF files
	* user-guide/C/Makefile.am: Updated for OMF file
	* user-guide/C/nautilus-C.omf: Added this OMF file
	* user-guide/Makefile.am: Added gnufdl/
	* user-guide/gnufdl/gnufdl.sgml: Updated
	* user-guide/gnugpl/Makefile.am: Added this file
	* user-guide/gnugpl/gnugpl.sgml: Added this file, GPL

2001-02-17  Kjartan Maraas  <kmaraas@gnome.org>

	* src/file-manager/fm-search-list-view.c: Fix typo.
	
2001-02-16  Gene Z. Ragan  <gzr@eazel.com>

	reviewed by: Darin Adler <darin@eazel.com>

	Fixed bug 6689, Segmentation fault from volume_in_black_list after
	the death of the desktop.

	* src/file-manager/fm-desktop-icon-view.c: (volume_in_black_list):
	Add an assert to catch a NULL icon view being passed in.  We need to
	find out why this happens if it ever does.
	
	* src/nautilus-application.c: (window_can_be_closed),
	(is_last_closable_window), (volume_unmounted_callback):	
	Handle single window case in the code where we close the windows
	the are displaying the contents of the unmounted volume.  In the case
	of a single window, direct it back to the default home directory.

2001-02-16  Andy Hertzfeld  <andy@eazel.com>

	* src/nautilus-sidebar-tabs.c: (draw_one_tab_themed),
	(draw_or_layout_all_tabs):
	fixed bug where the left edge of a sidebar tab wasn't
	prelighting correctly when the one before it was active.
	
2001-02-16  Darin Adler  <darin@eazel.com>

	reviewed by: Gene Ragan <gzr@eazel.com>

	Fix bug 4070 (Repeated clicks of BACK cause core dump):
	
	* src/nautilus-window-manage-views.c:
	(viewed_file_changed_callback): Use end_location_change instead,
	since cancel_location_change just does extra "go back to old view"
	that we don't need.
	(cancel_location_change): A little more sanity checking. Not sure
	if it really helps. The other changes should fix the bug.
	(begin_location_change): Use end_location_change to get rid of any
	previous change in progress since cancel_location_change just does
	extra "go back to old view" that we don't need.
	(report_location_change_callback): Use end_location_change to get
	rid of any previous change in progress since
	cancel_location_change just does extra "go back to old view" that
	we don't need.

	* src/file-manager/fm-list-view.c: (get_list_if_exists),
	(fm_list_view_clear): Don't create a list just to clear it.
	Crashed here while I was trying to work on the other bug.
	
2001-02-16  John Sullivan  <sullivan@eazel.com>

	reviewed by: Darin Adler  <darin@eazel.com>

	Fixed bug 6724 (implement Vera's new text &
	organization for Preferences)

	There are a few open issues still, but they can be
	handled one at a time.

	* libnautilus-extensions/nautilus-global-preferences.c:
	(global_preferences_install_descriptions),
	(global_preferences_create_dialog),
	(global_preferences_install_sidebar_panel_descriptions):
	Tweak text, rework some comments, reorganize.

	* libnautilus-extensions/nautilus-program-chooser.c:
	(repopulate_program_list): Reinstated a one-line fix
	that was accidentally merged away earlier.

2001-02-16  Robey Pointer  <robey@eazel.com>

	* nautilus.spec.in:

	Don't reference the three files that used to be in top/.

2001-02-16  Andy Hertzfeld  <andy@eazel.com>

	* components/image-viewer/nautilus-image-view.c:
	(zoomable_zoom_to_fit_callback), (rezoom_control),
	(control_size_allocate_callback), (image_fits_in_container),
	(scrolled_window_size_allocate_callback),
	(scrollable_control_factory):
	fixed a bunch of problems in the image view, including making
	the initial shrink-to-fit feature work again, made unneccessary
	scroll bars go away by using GTK_POLICY_AUTOMATIC, improved the
	scaling to Arlo's taste by using GDK_INTERP_BILINEAR, and tweaked
	the scale factors, plus other clean-ups.
	
	* src/nautilus-zoom-control.c: (create_zoom_menu_item):
	fixed bug 6288, bogus zoom levels displayed in zoom control, by making
	the rounding algorithm used in the menu consistent with the one
	used in the control.
	
2001-02-16  Darin Adler  <darin@eazel.com>

	reviewed by: John Sullivan <sullivan@eazel.com>

	Fixed bug 6477 (no way for intall view to send user "back where
	they came from") by adding a "go back" command for views.
	
	* libnautilus/nautilus-view-component.idl: Add "go back".
	* libnautilus/nautilus-view.h:
	* libnautilus/nautilus-view.c: (nautilus_view_go_back): Add "go
	back".
	* src/nautilus-view-frame-private.h:
	* src/nautilus-view-frame-corba.c: (go_back),
	(impl_Nautilus_ViewFrame_go_back): Add "go back".
	* src/nautilus-view-frame.h:
	* src/nautilus-view-frame.c:
	(nautilus_view_frame_initialize_class),
	(nautilus_view_frame_go_back): Add "go back".
	* src/nautilus-window-manage-views.c: (go_back_callback): Add code
	to either go back or go home.
	
	* src/nautilus-window-toolbars.c:
	(back_or_forward_button_pressed_callback): Formatting tweak.

2001-02-16  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Mike Engber <engber@eazel.com>

	* libnautilus-extensions/nautilus-wrap-table.c:
	(wrap_table_get_content_dimensions):
	Fix bug 6683.  Bottom row is cut off in backgrounds/emblems dialog.
	
2001-02-16  Robey Pointer  <robey@eazel.com>

	* components/services/install/lib/eazel-install-logic2.c:
	(check_no_two_packages_has_same_file):
	* components/services/install/lib/eazel-install-xml-package-list.c:
	(osd_parse_file_list):
	* components/services/install/lib/eazel-softcat.c:
	(eazel_softcat_initialize),
	(remove_directories_from_provides_list), (eazel_softcat_get_info):

	Nobody wants to review my patch because everyone hates me.  This
	fixes the weird file/directory checks we were doing by using the
	new softcat fields to determine which ones are directories.  No
	more guesswork.  Also there's a softcat bug which causes the file
	list to sometimes contain repeated filenames, so this patch does a
	workaround for that too.

	* components/services/trilobite/doc/gconf.txt:

	Fix my dumb typo: jump-url is not a bool.
	
2001-02-16  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 6606, only show user-mountable volumes in Disks menu
		
	* libnautilus-extensions/nautilus-volume-monitor.c:
	(has_removable_mntent_options):
	Utility function to check the mntent structure for options
	that we have determined will do the best job of guessing that
	a volume is removable.
	
	(get_removable_volumes),
	(volume_is_removable), (get_current_mount_list),
	(mount_volume_add_filesystem), (open_cdda_device):
	Did some code cleanup.

2001-02-16  Darin Adler  <darin@eazel.com>

	Fix bug 6435 (report_location_change does not record in history).
	
	* src/nautilus-window-manage-views.c:
	(report_location_change_callback): Use change type of STANDARD
	instead of RELOAD.
	
2001-02-16  Ramiro Estrugo  <ramiro@eazel.com>

	* components/mozilla/nautilus-mozilla-embed-extensions.cpp:
	Restore the original cast and lose the const.  Remove an unused
	variable.
	
2001-02-16  Andy Hertzfeld  <andy@eazel.com>

	removed the translation text services from the build, since
	they are not ready for commercial release.  Also, made the
	google and webster services localizable.  This also fixes
	bug 6704, translation doesn't work with large files.

	* components/text/nautilus-text-view.c: (add_one_service):
	made it use the localization framework for the menu label and
	tooltip
	
	* components/text/services/Makefile.am:
	* components/text/services/english_to_french.xml:
	* components/text/services/french_to_english.xml:
	removed the translation services
	
	* components/text/services/google.xml:
	* components/text/services/webster.xml:
	made the selection-based services localizable
	
	* po/POTFILES.in:
	added the selection-based services
	
2001-02-16  Robey Pointer  <robey@eazel.com>

	* components/mozilla/nautilus-mozilla-embed-extensions.cpp:

	Fix build bustage by breaking cast into two pieces (weird C++ism).

2001-02-16  Josh Barrow  <josh@eazel.com>

	* docs/smoketests.html:
	Made a few corrections

2001-02-16  Darin Adler  <darin@eazel.com>

	reviewed by: Gene Ragan <gzr@eazel.com>

	Finish fixing bug 6286 (need to re-apply optimization where we do
	a single directory load):

	* src/nautilus-window-manage-views.c: (begin_location_change): Do
	the force_reload work in here. We want it on all 4 kinds of
	location change (forward, back, new location, reload). Other
	browsers don't do reload on back, so we may want to change this at
	some point.
	(nautilus_window_reload): Remove the old code to invalidate from
	here now that it's done in begin_location_change.

	* src/file-manager/fm-directory-view.c: (load_location_callback),
	(load_directory), (finish_loading), (filtering_changed_callback):
	Remove the old code to do force_reload. The NautilusDirectory part
	of triggering a reload is now handled by the shell.

	* libnautilus-extensions/nautilus-directory.h:
	* libnautilus-extensions/nautilus-directory.c:
	(nautilus_directory_file_monitor_add): No force_reload parameter
	any more.
	(nautilus_directory_force_reload): New separate call used to force
	a reload. A method call so subclasses can implement.
	(nautilus_self_check_directory): Removed the FALSE force_reload
	argument to file_monitor_add.
	* libnautilus-extensions/nautilus-vfs-directory.c:
	(vfs_file_monitor_add): No force_reload parameter any more.
	(vfs_force_reload): Call through to
	nautilus_directory_force_reload_internal to do the real work.
	(nautilus_vfs_directory_initialize_class): Install the new
	force_reload function.
	* libnautilus-extensions/nautilus-merged-directory.c:
	(merged_file_monitor_add): No force_reload parameter any more.
	(merged_force_reload): Tell all of the real directories to force a
	reload.
	(monitor_add_directory): No force_reload to track any more.
	(nautilus_merged_directory_initialize_class): Install the new
	force_reload function.
	
	* libnautilus-extensions/nautilus-directory-private.h:
	* libnautilus-extensions/nautilus-directory-async.c:
	(nautilus_directory_force_reload_internal): Change the name of
	this function, since there's now a public function that is named
	nautilus_directory_force_reload.
	
	* libnautilus-extensions/nautilus-file-private.h:
	* libnautilus-extensions/nautilus-file.c:
	(nautilus_file_get_all_attributes): Made a separate call so other
	parts of the framework can use it.
	(nautilus_file_invalidate_all_attributes): Use the new call.
	
	* components/tree/nautilus-tree-model.c:
	(nautilus_tree_model_monitor_add),
	(nautilus_tree_model_node_begin_monitoring_no_connect): Use the
	new force_reload call. The old one had more granularity and thus
	forced less to be reloaded, but it's OK to do a little more here.
	
	* libnautilus-extensions/nautilus-trash-monitor.c:
	(nautilus_trash_monitor_initialize): Removed the FALSE
	force_reload argument to file_monitor_add.

	Other stuff:
	
	* libnautilus-extensions/nautilus-directory-metafile.c:
	(get_metafile), (nautilus_directory_get_file_metadata),
	(nautilus_directory_get_file_metadata_list),
	(nautilus_directory_set_file_metadata),
	(nautilus_directory_set_file_metadata_list),
	(nautilus_directory_copy_file_metadata),
	(nautilus_directory_remove_file_metadata),
	(nautilus_directory_rename_file_metadata): Moved FIXMEs around.
	Pass NULL instead of &ev when calling bonobo_object_release_unref
	since we don't really want to do anything different if there's
	some kind of error.
	
	* nautilus-installer/install-lib/.cvsignore:
	* nautilus-installer/libtrilobite/.cvsignore:
	Gotta create these files when you make new directories.

	* README: Change xml-i18n-tools to mention the correct branch.

2001-02-16  Ramiro Estrugo  <ramiro@eazel.com>

	* components/mozilla/Makefile.am:
	* components/mozilla/bonobo-extensions.c:
	* components/mozilla/bonobo-extensions.h:
	New files.  Cut and paste from nautilus-extensions to workaround
	licensing issues.
	
	* components/mozilla/main.c: (mozilla_object_destroyed):
	Mike Fleming added a nice feature that caches the mozilla process
	by delaying exit.  This makes jumping from web page to web page
	much faster.  However, it makes it harder to debug the mozilla
	component because it sticks around for a while and killing it by
	hand doesnt allow for clean shutdown.  So I added an debug
	environment variable that can be set to turn the delayed exit off.
	
	* components/mozilla/mozilla-events.cpp: Include the mozembed
	private header.  Im not quite sure why we were declaring the
	prototype found thre ourselves.
	* components/mozilla/nautilus-mozilla-content-view.c:
	(nautilus_mozilla_content_view_initialize),
	(charset_encoding_changed_callback),
	(encoding_menu_data_free_cover),
	(mozilla_view_create_charset_encoding_submenu),
	(mozilla_view_merge_menus), (bonobo_control_activate_callback),
	(mozilla_title_changed_callback), (mozilla_location_callback),
	(mozilla_net_state_callback), (mozilla_net_stop_callback),
	(mozilla_link_message_callback), (mozilla_progress_callback),
	(mozilla_dom_mouse_click_callback), (vfs_open_callback),
	(vfs_read_callback), (cancel_pending_vfs_operation),
	(navigate_mozilla_to_nautilus_uri):
	Add a charset encoding menu.  Also, changed the type of the
	mozilla member to be GtkMozEmbed instead of GtkWidget to reduce
	the amount of casting we did.

	* components/mozilla/nautilus-mozilla-embed-extensions.cpp:
	* components/mozilla/nautilus-mozilla-embed-extensions.h:
	New files.  Start of mozilla embed extensions.  Right now only
	charset encoding stuff.  Inspired somewhat by Galeon.
	* components/mozilla/nautilus-mozilla-ui.xml:
	Update for charset encoding menu support.

2001-02-16  Josh Barrow  <josh@eazel.com>

	* README:
	Added some text to explain the freetype fiasco.

2001-02-16  Ramiro Estrugo  <ramiro@eazel.com>

	* README: Clarify the fact that Mozilla M18 no longer works.
	* components/mozilla/mozilla-components.cpp: Remove obsolete
	Mozilla M18 support.  M18 no longer works.

2001-02-16  Ramiro Estrugo  <ramiro@eazel.com>

	* README: Update Mozilla requirements.
	* configure.in: Update the Mozilla milestone names to match the
	current Mozilla naming scheme.  Add a flag indicating whether the
	version of Mozilla we use has profiles support.
	* components/mozilla/Makefile.am:
	* components/mozilla/nautilus-mozilla-content-view.c:
	(pre_widget_initialize): 
	Add better profile support ifdef hackery.

2001-02-15  Robey Pointer  <robey@eazel.com>

	* components/services/install/idl/trilobite-eazel-install.idl:
	* components/services/install/lib/eazel-install-corba-types.c:
	(corba_packagedatastruct_fill_from_packagedata),
	(corba_packagedatastruct_fill_deps),
	(packagedata_tree_from_corba_packagedatastructlist):

	Re-add 'provides' to the IDL so the install view can poke around
	for .desktop files.

	* nautilus-installer/src/installer.c:
	(get_detailed_errors_foreach), (get_detailed_errors):

	Speed up error checking by avoiding pieces of the graph we've
	already visited.

2001-02-15  Robey Pointer  <robey@eazel.com>

	* components/services/install/lib/eazel-install-logic2.c:
	(check_dependencies_foreach),
	(check_no_two_packages_has_same_file),
	(check_conflicts_against_already_installed_packages):

	Remove errant unref during dupe-file check.
	
	* components/services/install/nautilus-view/nautilus-service-instal
	l-view.c: (nautilus_install_parse_uri),
	(nautilus_service_install_done), (nautilus_service_install_failed),
	(nautilus_service_need_password),
	(nautilus_service_install_view_update_from_uri_finish),
	(nautilus_service_install_view_load_uri):
	* components/services/install/nautilus-view/nautilus-service-instal
	l-view.h:

	Set password prompt to something semi-reasonable.  Fix up a few
	wrong behaviors in the case of having multiple toplevel packages.
	This still isn't working very well.
	
2001-02-15  Andy Hertzfeld  <andy@eazel.com>

	fixed bug 5599, make objects in $USER/Nautilus localizable.  Fixed
	by creating a linkset to instead the Computer and Services icons,
	and removing the top directory and associated code, since it's no
	longer needed.
	
	* configure.in:
	removed data/top
	* data/Makefile.am:
	removed top directory
	* data/linksets/Makefile.am:
	* data/linksets/home.xml:
	added new home linkset
	
	* data/top/.cvsignore:
	* data/top/.nautilus-metafile.xml:
	* data/top/Computer:
	* data/top/Makefile.am:
	* data/top/Services:
	removed files from top
	
	* libnautilus-extensions/nautilus-file-utilities.c:
	(nautilus_get_user_main_directory):
	changed it to no longer copy the top directory; instead,
	install the new linkset
	
	* po/POTFILES.in:
	added home.xml to the files to be localized
	
2001-02-15  Eric Fischer  <eric@eazel.com>

	* nautilus.spec.in:
	Building the installer into RPMs doesn't work, because I got
	something in the Makefiles wrong.  Revert the changes to the
	spec file so tinderbox comes back to life.  Will try again
	once I think I have it right.

2001-02-15  Robey Pointer  <robey@eazel.com>

	reviewed by: Robin * Slomkowski  <rslomkow@eazel.com>

	* nautilus-installer/src/installer.c:

	For now, make the bootstrap installer always run in debug mode
	and point to checkpoint:8888.

2001-02-15  Robey Pointer  <robey@eazel.com>

	reviewed by: Eskil Heyn Olsen  <eskil@eazel.com>

	* components/services/trilobite/libtrilobite/trilobite-root-helper.
	c: (discard_line), (eazel_helper_start):

	Add debug info to the roothelper so that we can debug failures
	better.

2001-02-15  Robey Pointer  <robey@eazel.com>

	* components/services/install/lib/eazel-install-logic2.c:
	(dump_tree_helper), (dump_tree):

	Made dump_tree dump less redundant info (tries not to repeat
	sections of the graph it's already visited).
	
	* nautilus-installer/install-lib/Makefile.am:
	* nautilus-installer/libtrilobite/Makefile.am:

	Set LOG_DOMAIN to G_LOG_DOMAIN so our log catcher will actually
	work. :)

	* nautilus-installer/src/Makefile.am:

	Remove redundant object file.

	* nautilus-installer/src/create-eazel-installer.sh:

	By default, strip the installer binary before gzexe'ing it (this
	makes it much much smaller).  Eventually we'll want to add some
	sort of command-line option for deciding which kind to build.

	* nautilus-installer/src/installer.c: (conflict_check),
	(eazel_installer_initialize):

	Remember to nudge GTK+ after updating labels so they'll actually
	refresh.

	* nautilus-installer/src/link.sh:
	* nautilus-installer/src/main.c: (main):
	* nautilus-installer/src/prescript:

	Fix the prescript to work around a sad popt bug.

2001-02-15  Gene Z. Ragan  <gzr@eazel.com>

	reviewed by: Mike Engber <engber@eazel.com>

	Fixed bug 6670, Segmentation fault when trying to access mounted
	removable volume with no media.
	
	* src/file-manager/fm-desktop-icon-view.c:
	(create_unique_volume_name):
	Use the accessor function to access the volume name instead
	of accessing the structure directly.  The accessor protects
	us against NULL data.

2001-02-15  Eric Fischer  <eric@eazel.com>

	* nautilus.spec.in:
	Start building the eazel installer, and put it into its own RPM.
	(This should eventually be separate from building nautilus)

	* nautilus-installer/libtrilobite/Makefile.am:
	Add a dependency to create the .h files, since gmake complains
	otherwise.

2001-02-15  Andy Hertzfeld  <andy@eazel.com>

	fixed bug 6589, nautilus crashes if a moderate sized text block
	is used for dictionary lookup.  Fixed by imposing sanity limits
	on both the selection size passed to services and the sidebar
	title.
	
	* components/text/nautilus-text-view.c: (handle_service_menu_item):
	truncate the selection if it's greater than a reasonable size.
	
	* src/nautilus-sidebar-title.c:
	(nautilus_sidebar_title_initialize),
	(nautilus_sidebar_title_set_text):
	truncate the sidebar title if it's longer than a reasonable limit.
	
2001-02-15  Michael Engber  <engber@eazel.com>

	reviewed by: Gene Z. Ragan  <gzr@eazel.com>

	* src/file-manager/fm-icon-view.c: (fm_icon_view_bump_zoom_level):
	Change fm_icon_view_bump_zoom_level to ignore bumps to out
	of bounds values - bug 6347.

2001-02-15  Michael Engber  <engber@eazel.com>

	* libnautilus-extensions/nautilus-directory-metafile.c:
	(get_metafile), (nautilus_directory_get_file_metadata),
	(nautilus_directory_get_file_metadata_list),
	(nautilus_directory_set_file_metadata),
	(nautilus_directory_set_file_metadata_list),
	(nautilus_directory_copy_file_metadata),
	(nautilus_directory_remove_file_metadata),
	(nautilus_directory_rename_file_metadata):
	Added FIXMEs.

2001-02-15  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: John Sullivan <sullivan@eazel.com>

	* libnautilus-extensions/nautilus-image-table.h:
	* libnautilus-extensions/nautilus-image-table.c:
	(nautilus_image_table_add_empty_image): New function to add an
	empty space into the table.

	* libnautilus-extensions/nautilus-wrap-table.h:
	* libnautilus-extensions/nautilus-wrap-table.c:
	(nautilus_wrap_table_destroy), (nautilus_wrap_table_expose_event),
	(nautilus_wrap_table_map), (nautilus_wrap_table_unmap),
	(nautilus_wrap_table_add), (nautilus_wrap_table_remove),
	(nautilus_wrap_table_forall), (wrap_table_layout),
	(wrap_table_get_max_child_dimensions),
	(wrap_table_get_content_dimensions),
	(wrap_table_find_child_at_point),
	(nautilus_wrap_table_reorder_child): Change 'items' to 'childern'
	(nautilus_wrap_table_get_num_children): New function to get the
	number of chilren.

	* src/nautilus-property-browser.c: (labeled_image_configure),
	(labeled_image_new), (make_properties_from_directories),
	(add_reset_property), (make_properties_from_xml_node),
	(nautilus_property_browser_update_contents):
	Modify some constants and add new ones for the image table
	layout.  Andy is going to tweak these later.
	Move the erase object back to the end of the table.

2001-02-15  J Shane Culpepper  <pepper@eazel.com>

	reviewed by: Gene Z. Ragan  <gzr@eazel.com>

	* libnautilus-extensions/nautilus-file-operations.c:
	(handle_transfer_ok):

	Fix for Bug #1505, Cancelled copy operations leave partial
	files.  Nautilus now catches cancel and deletes the partial
	file.

2001-02-15  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Darin Adler  <darin@eazel.com>
                     Except for the self checks code.
	
	Change code that used a ArtIRect as a "frame" to use
	NautilusDimensions instead.  Change all foo_frame functions to
	foo_dimensions.

	* libnautilus-extensions/nautilus-art-extensions.h:
	Add a new structure to represent dimensions using signed integers.
	Retire nautilus_art_ipoint_assign.
	* libnautilus-extensions/nautilus-art-extensions.c:
	(nautilus_dimensions_empty): New function to check for empty
	dimensions.
	(nautilus_art_irect_assign_dimensions): New function to assign
	dimensions to a rectangle.
	(nautilus_self_check_art_extensions): New self checks.

	* libnautilus-extensions/nautilus-art-gtk-extensions.h:
	* libnautilus-extensions/nautilus-art-gtk-extensions.c:
	(nautilus_gdk_rectangle_to_art_irect),
	(nautilus_screen_get_dimensions), (nautilus_gdk_window_get_bounds),
	(nautilus_gdk_window_get_screen_relative_bounds),
	(nautilus_gtk_widget_get_bounds),
	(nautilus_gtk_widget_get_dimensions),
	(nautilus_gdk_window_clip_dirty_area_to_screen),
	(nautilus_art_irect_to_gdk_rectangle),
	(nautilus_gdk_window_get_dimensions): New function to get
	the dimensions of a GdkWindow.
	Update for frame to dimensions changes.  Change functions names to
	lose the "irect" sub-prefix.

	* libnautilus-extensions/nautilus-gdk-pixbuf-extensions.h:
	* libnautilus-extensions/nautilus-gdk-pixbuf-extensions.c:
	(nautilus_gdk_pixbuf_get_dimensions),
	(nautilus_gdk_pixbuf_fill_rectangle_with_color),
	(nautilus_gdk_pixbuf_draw_to_drawable),
	(nautilus_gdk_pixbuf_draw_to_pixbuf),
	(nautilus_gdk_pixbuf_draw_to_pixbuf_alpha),
	(nautilus_gdk_pixbuf_new_from_pixbuf_sub_area),
	(pixbuf_draw_tiled), (nautilus_gdk_pixbuf_draw_to_pixbuf_tiled),
	(nautilus_gdk_pixbuf_draw_to_drawable_tiled),
	(nautilus_gdk_pixbuf_intersect): New functions 
	(nautilus_self_check_gdk_pixbuf_extensions): New self checks.
	Update for frame vs dimenensions changes.  Simplify clipping code
	by using nautilus_gdk_pixbuf_intersect.  Move
	nautilus_gdk_window_get_dimensions to
	nautilus_gdk_window_get_dimensions in art-gtk-extensions.

	* libnautilus-extensions/nautilus-debug-drawing.c:
	(debug_pixbuf_viewer_size_request),
	(nautilus_debug_pixbuf_draw_point),
	(nautilus_debug_pixbuf_draw_rectangle),
	(nautilus_debug_pixbuf_draw_rectangle_inset):
	Update for frame vs dimenensions changes.

	* libnautilus-extensions/nautilus-clickable-image.c:
	(label_handle_motion):
	Update for art-gtk extensions changes.
	
	* libnautilus-extensions/nautilus-glyph.h:
	* libnautilus-extensions/nautilus-glyph.c: (nautilus_glyph_new):
	Change order of parameters to match NautilusScalalbleFont.
	(nautilus_glyph_get_dimensions), (nautilus_glyph_draw_to_pixbuf):
	Update for frame vs dimenensions changes.

	* libnautilus-extensions/nautilus-lib-self-check-functions.h:
	New declaration for art_extensions and gdk_pixbuf_extensions.
	
	* libnautilus-extensions/nautilus-self-checks.c:
	(nautilus_check_rectangle_result),
	(nautilus_check_dimensions_result):
	* libnautilus-extensions/nautilus-self-checks.h:
	Add support for checking functions that return rectangles and
	dimensions.
	
	* libnautilus-extensions/nautilus-scalable-font.h:
	* libnautilus-extensions/nautilus-scalable-font.c:
	(nautilus_scalable_font_measure_text): Return
	NautilusDimensions instead of using pointer parameters.
	(nautilus_scalable_font_text_width): Simplify by calling
	scalable_font_measure_text.
	(nautilus_scalable_font_draw_text),
	(nautilus_scalable_font_measure_text_lines),
	(nautilus_scalable_font_draw_text_lines_with_dimensions),
	(nautilus_scalable_font_draw_text_lines):
	Update for frame vs dimenensions changes.  Use NautilusDimensions
	arrays instead of individial width and height arrays.  Change all
	function signatures to pass in only a font_size instead of both
	font_width and font_height.  Simplifies using these a bit.
	(nautilus_scalable_font_largest_fitting_font_size): Fix bug where
	we were always using the wrong font size to compute the largest
	fitting font.
	
	* libnautilus-extensions/nautilus-icon-factory.c: (embed_text):
	Update for scalable font font_size api changes.
	
	* libnautilus-extensions/nautilus-image-table.c:
	(image_table_clear_dirty_areas):
	Update for frame vs dimenensions changes.

	* libnautilus-extensions/nautilus-image.c:
	(nautilus_image_size_request), (image_get_pixbuf_dimensions),
	(image_get_pixbuf_bounds), (image_get_tile_dimensions):
	Update for frame vs dimenensions changes.

	* libnautilus-extensions/nautilus-label.h:
	* libnautilus-extensions/nautilus-label.c:
	(nautilus_label_initialize_class), (nautilus_label_set_arg),
	(nautilus_label_get_arg), (nautilus_label_size_request),
	(nautilus_label_size_allocate), (label_composite_pixbuf_callback),
	(label_draw_text_to_pixbuf): Fix a type.  Was using [x,x] instead
	of [x,y] to render the string.
	(label_get_text_dimensions), (label_get_text_bounds),
	(label_get_tile_dimensions), (label_line_geometries_clear),
	(label_line_geometries_recompute),
	Update for frame vs dimenensions changes.  Make the
	'smooth_line_wrap' attribute an int instead of a guint.  Use an
	array of NautilusDimensions to store text lines geometries instead
	of separete width and height arrays.
	(label_get_default_line_wrap_width),
	(nautilus_label_set_smooth_line_wrap_width),
	(nautilus_label_get_smooth_line_wrap_width):
	Change signature to return an int instead of a guint.
	
	* libnautilus-extensions/nautilus-labeled-image.c:
	(nautilus_labeled_image_size_request),
	(labeled_image_get_image_dimensions),
	(labeled_image_get_label_dimensions),
	(labeled_image_get_image_bounds_fill),
	(nautilus_labeled_image_get_image_bounds),
	(labeled_image_get_label_bounds_fill),
	(nautilus_labeled_image_get_label_bounds),
	(labeled_image_get_content_dimensions),
	(labeled_image_get_content_bounds):
	Update for frame vs dimenensions changes.

	* libnautilus-extensions/nautilus-smooth-widget.h:
	* libnautilus-extensions/nautilus-smooth-widget.c:
	(smooth_widget_paint_tile_transparent),
	(nautilus_smooth_widget_get_preferred_dimensions):
	Update for frame vs dimenensions changes.

	* libnautilus-extensions/nautilus-tabs.c: (measure_tab_name),
	(draw_tab_label):
	Update for font api changes.
	
	* libnautilus-extensions/nautilus-text-layout.c:
	(nautilus_text_layout_new), (nautilus_text_layout_paint):
	Update for frame vs dimenensions changes.

	* libnautilus-extensions/nautilus-wrap-table.c:
	(nautilus_wrap_table_size_request), (wrap_table_layout),
	(wrap_table_art_irect_max_dimensions),
	(wrap_table_get_max_child_dimensions),
	(wrap_table_get_content_dimensions):
	Update for frame vs dimenensions changes.

	* src/nautilus-about.c: (draw_aa_string):
	Update for frame vs dimenensions changes.

	* src/nautilus-sidebar-tabs.c: (draw_one_tab_plain),
	(draw_one_tab_themed), (get_tab_width):
	Update for frame vs dimenensions changes.

	* test/test-nautilus-font-simple.c: (main):
	* test/test-nautilus-font.c: (main):
	* test/test-nautilus-glyph-simple.c: (glyph_new):
	* test/test-nautilus-glyph.c: (glyph_new), (main):
	* test/test-nautilus-pixbuf-tile.c:
	* test/test.c: (test_pixbuf_draw_rectangle_tiled):
	Update test for frame vs dimenensions changes and font api
	changes.

2001-02-14  Mike Fleming  <mfleming@eazel.com>

	* components/mozilla/mozilla-preferences.cpp:

	Bug 6592 -- Embedded Mozilla defaults to port 8080 when HTTP
	proxy is enabled like everything else

2001-02-14  Robey Pointer  <robey@eazel.com>

	reviewed by: Eskil Heyn Olsen  <eskil@eazel.com>

	* components/services/install/lib/eazel-install-xml-package-list.c:
	(osd_parse_shared), (eazel_install_packagelist_parse):
	* components/services/install/lib/eazel-install-xml-package-list.h:
	* components/services/install/lib/eazel-softcat-private.h:
	* components/services/install/lib/eazel-softcat.c:
	(eazel_softcat_finalize), (eazel_softcat_initialize),
	(eazel_softcat_reset_server_update_flag), (eazel_softcat_query):

	Return the softcat DB revision with the parsed package list, and
	use that info to hook into Eskil's error trap.  Also free up the
	softcat private data when the object goes away.

2001-02-14  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 6653, throwing away something with the desktop not on will
	bring up an empty trash if the desktop is later turned on
	
	* src/file-manager/fm-desktop-icon-view.c:
	(update_trash_link_and_delete_copies):
	Preflight state of trash icon when we are doing all of the other
	icon state validity checks.

2001-02-14  Andy Hertzfeld  <andy@eazel.com>

	* libnautilus-extensions/nautilus-icon-factory.c:
	(is_supported_mime_type),
	(nautilus_icon_factory_get_icon_for_file):
	fixed bug 6623, .fig files cause warnings to spew, by checking for
	types that we don't support and excluding them from thumbnailing.
	
2001-02-14 John Fleck <jfleck@inkstain.net>

	reviewed by: Ali Abdin <aliabdin@aucegypt.edu>
	* components/help/converters/gnome-db2html2/toc-elements.c
	fix bug # 6551 - add test to see if article header has already
	been printed and don't print it a second time

2001-02-14  Rebecca Schulman  <rebecka@eazel.com>
	Fix bugzilla.eazel.com bug 6416, that the search results view
	needs to inform the user if indexing is disabled or blocked
	on their system.  I haven't added the final text yet, since
	it is not complete.  The final text will be swapped in.

	reviewed by: Maciej Stachowiak <mjs@eazel.com>

	* src/file-manager/fm-search-list-view.c:
	(load_location_callback),
	(real_load_error), (display_indexed_search_problems_dialog),
	(display_system_services_are_blocked_dialog),
	(display_system_services_are_disabled_dialog): Add the dialogs for
	the cases when searches are enabled and disabled in the right
	cases.  Stop displaying an error dialog about a problem loading
	the location in the case where the directory load is cancelled.

	* src/file-manager/nautilus-indexing-info.c:
	(show_index_progress_dialog), (show_reindex_request_dialog),
	(show_indexing_info_dialog):
	Fix an obscure bug introduced in my last checkin by
	removing a reference to the index status that was kept by the
	medusa system state poller on destroy. If this reference was left around,
	enabling or disabling indexing could crash nautilus.

2001-02-14  Darin Adler  <darin@eazel.com>

	reviewed by: Gene Ragan <gzr@eazel.com>

	* src/nautilus-applicable-views.c:
	(got_minimum_file_info_callback),
	(nautilus_determine_initial_view),
	(nautilus_determine_initial_view_cancel): Get rid of the code to
	monitor the directory. It's now moved up one level to the
	manage-views.c code.
	* src/nautilus-window-private.h:
	* src/nautilus-window-manage-views.c: (free_location_change),
	(begin_location_change): Move the code that starts monitoring the
	directory up here instead.

	* src/nautilus-application.c: (volume_unmounted_callback): Rewrote
	this code to not use the viewed_file private field. There's a
	public call to get the current location that should work just as
	well. Also fix bug where it would ignore the scheme and just look
	at the path part.
	
	* libnautilus-extensions/nautilus-directory-metafile.c:
	(nautilus_directory_use_self_contained_metafile_factory): Added
	check to detect if this is called after using the factory.
	(free_factory): Simplified.
	(get_factory): New function to simplify get_metafile.
	(get_metafile): Simplified.

	* src/nautilus-location-bar.c: (try_to_expand_path): Fix storage
	leak.

	* libnautilus-extensions/nautilus-entry.c:
	(nautilus_entry_key_press): Added FIXME after noticing a
	particularly lame version of tilde expansion in here. I'm not sure
	this is even used to good effect, since the location bar now does
	its own tidle expansion.

	* README: Fixed many inaccuracies.
	
	* libnautilus-extensions/nautilus-stock-dialogs.c:
	(timed_wait_free): Formatting tweaks.
	* src/nautilus-theme-selector.c:
	(get_theme_description_and_display_name): Formatting tweaks.

2001-02-14  Michael Engber  <engber@eazel.com>

	reviewed by: Gene Z. Ragan  <gzr@eazel.com>

	* libnautilus-extensions/nautilus-stock-dialogs.c:
	(timed_wait_delayed_close_destroy_dialog_callback),
	(timed_wait_delayed_close_timeout_callback), (timed_wait_free),
	(timed_wait_dialog_destroy_callback), (timed_wait_callback),
	(nautilus_timed_wait_start_with_duration),
	(nautilus_timed_wait_stop):
	Non-cancellable timed wait dialogs do not free the timed wait
	when the dialog is dismissed - instead they wait for the call to
	timed_wait_stop to do it - otherwise the call to timed_wait_stop
	asserts. Removed superfluous argument in timed_wait_callback.
	When timed wait dialog remaining up due to minimum uptime feature
	are closed by the user, we now cancel the pending timeout that
	would close them without user intervention.

2001-02-14  Eskil Heyn Olsen  <eskil@eazel.com>

	reviewed by: Robey Pointer  <robey@eazel.com>

	* components/services/install/lib/eazel-install-logic2.c:
	(eazel_install_check_existing_packages), 
	Final fix for 3511, if multiple packages with same name are
	already installed, and more than one passes verify, fail
	operation.
	(install_packages),
	(uninstall_packages):
	call softcat reset db update mjick.
	
	* components/services/install/lib/eazel-softcat.h:
	* components/services/install/lib/eazel-softcat-private.h:
	* components/services/install/lib/eazel-softcat.c:
	(eazel_softcat_initialize),
	(eazel_softcat_reset_server_update_flag),
	(eazel_softcat_error_string), (eazel_softcat_query):
	Code to make get_info return a enum indicating that the db was
	updated since last time.
	Also a code to reset the flag.

2001-02-14  Robin * Slomkowski  <rslomkow@eazel.com>

	* nautilus.spec.in: added support for scrollkeeper
	this also requires having the scrollkeeper package
	to run, have not added that dependancy as it is not
	easily available.

2001-02-14  Gene Z. Ragan  <gzr@eazel.com>

	reviewed by: Mike Engber <engber@eazel.com>

	Fixed bug 6606, only show user-mountable volumes in Disks menu.
	
	Look for options "user" or "owner" instead of "noauto"
	to determine if volume if removable.

	* libnautilus-extensions/nautilus-volume-monitor.c:
	(volume_is_removable), (close_error_pipe):
		
2001-02-14  Eric Fischer <eric@eazel.com>

	* nautilus-installer/install-lib/Makefile.am:
	Gmake seems to have trouble recognizing .c -> .o dependencies
	when the .c files don't appear until after the make has begun,
	so explicitly add the rpm3 and rpm4 dependencies.

2001-02-13  Eskil Heyn Olsen  <eskil@eazel.com>

	reviewed by: Robey Pointer  <robey@eazel.com>

	* components/services/install/command-line/eazel-alt-install-corba.
	c: (eazel_file_conflict_check_signal),
	(eazel_file_uniqueness_check_signal),
	(eazel_feature_consistency_check_signal), (something_failed),
	(eazel_preflight_check_signal), (dep_check), (md5_check_failed),
	(delete_files):
	Added --silent, suppresses random spewage.
	Added autocont, so if there was multiple problems, answering y to
	first "continue y/n ?" will answer y to all.
	Fixed for the modified preflight signal.
	
	* components/services/install/lib/eazel-install-corba-types.c:
	(corba_packagedatastruct_fill_from_packagedata),
	(packagedata_from_corba_packagedatastruct):
	* components/services/install/lib/eazel-install-corba-callback.c:
	(impl_preflight_check), (eazel_install_callback_class_initialize):
	* components/services/install/lib/eazel-install-corba-callback.h:
	* components/services/install/idl/trilobite-eazel-install.idl:
	Changed preflight to take the operation type as argument.
	Added modification status to the corba version of package data.
	
	* components/services/install/lib/eazel-install-logic2.c:
	(prune_failed_packages_helper),
	(eazel_install_check_existing_packages), (get_softcat_info),
	(is_satisfied), (check_dependencies_foreach),
	(do_file_conflict_check), (execute),
	(eazel_uninstall_upward_traverse), (install_packages):
	Fixed bug 3511, 4502 (libeazelinstall part, view still needs
	stuff).
	
	* components/services/install/lib/eazel-install-public.h:
	* components/services/install/lib/eazel-install-object.c:
	(eazel_install_install_packages), (eazel_install_init_transaction),
	(eazel_install_emit_preflight_check_default):
	More debug spewage.
	Fixed cut'n'paste bug in init_transaction.
	Updated preflight signal.
	
	* components/rpmview/nautilus-rpm-view-install.c
	* components/services/install/nautilus-view/nautilus-service-install-view.c
	Updated preflight signal.

	* components/services/install/lib/eazel-install-problem.h:
	* components/services/install/lib/eazel-install-problem.c:
	(get_detailed_messages_breaks_foreach),
	(get_detailed_messages_foreach), (compare_problem_case),
	(add_continue_with_flag_case), (add_force_install_both_case),
	(add_force_remove_case), (get_detailed_cases_foreach),
	(eazel_install_problem_case_to_string),
	(eazel_install_problem_case_foreach_destroy),
	(build_categories_from_problem_list),
	(eazel_install_problem_step_problem), (eazel_install_problem_done),
	(eazel_install_problem_wait_for_completion),
	(eazel_install_problem_handle_cases):
	s/Fuckup/Feature dependency/
	Lots of improvement.
	Change some cases.
	Did stuff...
	Added cases of "cancelling package", "continue with flag",
	"invalid".
	Made EazelInstallProblem wait for the operation to complete, as
	not to confuse the service object by starting it and resetting
	values.
	
	
	* components/services/install/lib/eazel-package-system-types.h:
	* components/services/install/lib/eazel-package-system.c:
	(eazel_package_system_is_installed), (eazel_package_system_verify):
	* components/services/install/lib/eazel-package-system.h:
	* components/services/install/lib/eazel-package-system-private.h:
	* components/services/install/lib/eazel-package-system-rpm3-private
	.h:
	* components/services/install/lib/eazel-package-system-rpm3.c:
	(rpmmonitorpiggybag_new), (eazel_package_system_rpm3_verify_impl),
	(eazel_package_system_rpm3_verify):
	* components/services/install/lib/eazel-package-system-skeleton.c:
	(eazel_package_system_skeleton_verify):
	Fixed 6494, also made verify return boolean, propageted change
	down throughout the hierachy.
	
	* components/services/install/lib/eazel-package-system-types.c:
	(eazel_install_gtk_marshal_BOOL__ENUM_POINTER_INT_INT):
	New signal for preflight.

2001-02-14  Eric Fischer <eric@eazel.com>

	This is a bunch of changes leading up to Bug 6515, so
	the installer can get built by just an extra flag to
	configure rather than its own script.

	* Makefile.am:
	Add nautilus-installer to SUBDIRS

	* acconfig.h:
	Add ENABLE_INSTALLER to things that can be configured

	* configure.in:
	Add --enable-installer command line flag.  Set PACKAGE_SYSTEM_OBJECT
	and PACKAGE_SYSTEM_SOURCE based on whether rpm 3 or 4 is installed.
	Create nautilus-installer Makefiles

	* nautilus-installer/Makefile.am:
	Remove things that Robey said were no longer used.  Add libtrilobite
	and install-lib to SUBDIRS that need to be built.

	* nautilus-installer/install-lib/Makefile.am:
	New Makefile that builds a second copy of the installer libraries
	with weird flags as needed by the installer.

	* nautilus-installer/libtrilobite/Makefile.am:
	New Makefile that builds a second copy of the trilobite libraries
	with weird flags as needed by the installer.
	
	* nautilus-installer/src/Makefile.am:
	Do in the Makefile what formerly had been done in link.sh (build
	the installer, and create a self-extracting version of it).

	* nautilus-installer/src/create-eazel-installer.sh:
	Script, adapted from what's in link.sh, to create a self-extracting
	installer.

2001-02-14  Josh Barrow  <josh@eazel.com>

	* README:
	Made a few changes to URLs and a couple of places where things wer
	worded in odd ways.

2001-02-14  John Sullivan  <sullivan@eazel.com>

	Fixed bug 2917 (Wrong capitalization in "Lay Out" menu)

	* src/file-manager/nautilus-icon-view-ui.xml:
	Verafied the capitalization.

2001-02-14  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 6465, Music view buttons stretch for songs with
	very long titles.
	
	* components/music/nautilus-music-view.c: (add_play_controls):
	Set the pack box flag so that the buttons don't expand.
	
2001-02-14  Laszlo Kovacs <laszlo.kovacs@sun.com>
	* components/help/hyperbola_top_doc_tree_populate.h:
          components/help/hyperbola-filefmt.c:
          components/help/hyperbola-nav-tree.c:
          (ctree_populate_subnode, ctree_populate,
           hyperbola_navigation_tree_new,
           hyperbola_navigation_tree_load_location,
           hyperbola_navigation_tree_select_row):
        Toplevel docs put into a separate ctree in
        the GUI of the help sidebar if Scrollkeeper
        is enabled.
        Note that this is not the final GUI, only the widget
        layout is right, the look will be changed by somebody
        who knows more gtk than me. Dan Mueth tries to find the
        right person.

2001-02-14  Ramiro Estrugo  <ramiro@eazel.com>

	* librsvg/Makefile.am: Move $(FREETYPE2_CFLAGS) all the way to the
	top of $(INCLUDES), so that if there are multiple versions of
	freetype installed in the build machine, then we will catch only
	the one we are interested in.

2001-02-14  Kjartan Maraas  <kmaraas@gnome.org>

	* configure.in: Added Norwegian (nynorsk) to ALL_LINGUAS.
	
2001-02-14  Ramiro Estrugo  <ramiro@eazel.com>

	* libnautilus-extensions/nautilus-viewport.c:
	(nautilus_viewport_set_never_smooth):
	Fix a very dumb typo with the last commit.  Thanks for 
	JP Rosevear <jpr@ximian.com> for spotting this.
	
2001-02-14  Ramiro Estrugo  <ramiro@eazel.com>

	* nautilus.spec.in:
	Require 'freetype >= 2.0' not 'freetype2 >= 2.0'
	
2001-02-14  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: JP Rosevear <jpr@ximian.com>

	* libnautilus-extensions/nautilus-viewport.c:
	(nautilus_viewport_initialize), (nautilus_viewport_realize),
	(nautilus_viewport_set_is_smooth),
	(nautilus_viewport_get_is_smooth),
	(nautilus_viewport_set_never_smooth):
	Make sure the "never_smooth" and "is_smooth" attributes work as
	advertised.  Make the "never_smooth" attribute default to TRUE,
	since that makes it work with more gtk widgets.
	
	* src/nautilus-property-browser.c:
	(nautilus_property_browser_initialize),
	(nautilus_property_browser_update_contents):
	Set the "never_smooth" attribute of the viewports to FALSE so that
	the can be smooth.

2001-02-13  Ramiro Estrugo  <ramiro@eazel.com>

	* test/test-nautilus-glyph.c: (main):
	* test/test-nautilus-label-simple.c: (main):
	Two very tiny tweaks to help debug clipping bugs.
	
2001-02-13  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Rebecca Schulman  <rebecka@eazel.com>

	* libnautilus-extensions/nautilus-gdk-pixbuf-extensions.c:
	(nautilus_gdk_pixbuf_new_from_pixbuf_sub_area),
	(nautilus_gdk_pixbuf_new_from_existing_buffer):
	* libnautilus-extensions/nautilus-gdk-pixbuf-extensions.h:
	New function to create a pixbuf from an existing buffer and clip
	area.
	
2001-02-13  Robey Pointer  <robey@eazel.com>

	* Makefile.am:

	Add nautilus-installer to EXTRA_DIST to fix tinderbox breakage.
	
2001-02-13  Rebecca Schulman  <rebecka@eazel.com>

	reviewed by: Seth Nickell <seth@eazel.com>

	Fix bugzilla.eazel.com bug 6417, that the indexing
	information dialog should not be shown if indexing is
	disabled or blocked.

	* src/file-manager/nautilus-indexing-info.c: (dialog_close_cover),
	(show_index_progress_dialog), (show_reindex_request_dialog),
	(show_indexing_info_dialog):
	Add new dialogs for the case when indexing is off,
	and close each dialog in the case where the status of indexing
	changes.

2001-02-13  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Arik Devens  <arik@eazel.com>

	* libnautilus-extensions/Makefile.am:
	* libnautilus-extensions/nautilus-label.c:
	* libnautilus-extensions/nautilus-icon-canvas-item.c:
	* libnautilus-extensions/nautilus-scalable-font.c:
	* libnautilus-extensions/nautilus-scalable-font.h:
	* libnautilus-extensions/nautilus-text-layout.c:
	* libnautilus-extensions/nautilus-text-layout.h:
	* test/test-nautilus-font.c:
	Move the text layout code to its own place.  No real code changes.

2001-02-13  Andy Hertzfeld  <andy@eazel.com>

	reviewed by: Arik Devens  <arik@eazel.com>

	* src/nautilus-property-browser.c: (add_pattern_to_browser):
	fixed bug 6554, typing random text into the background selector
	crashes, by adding a check for a valid path and displaying an
	error dialog if the path isn't valid.

2001-02-13  Arik Devens  <arik@eazel.com>

	reviewed by: Andy Hertzfeld  <andy@eazel.com>

	Fixed bug 6582, Editing location bar crashes Nautilus, leaves
	spurious text.
	Fixed duplicate bug 6585, Nautilus crashed if type "~/asdfasdf" in
	location bar.
	
	* src/nautilus-location-bar.c: (try_to_expand_path): Removed
	spurious g_free that was causing massive breakage.
	
2001-02-13  John Sullivan  <sullivan@eazel.com>

	reviewed by: Darin Adler <darin@eazel.com>

	Fixed bug 6385 (Properties window doesn't set/display
	icon correctly for Nautilus link files)

	Now the Properties window keeps around an "original
	file" and a "target file", which are currently the
	same for all files except Nautilus links. The original
	file is used to display/set the icon & name. (So you
	can edit the name of your Home icon in the properties
	window now also.)

	* src/file-manager/fm-properties-window.c:
	Renamed details->file to details->target_file. Added
	details->original_file. Removed two details fields
	that were unused.
	
	(directory_contents_value_field_update),
	(attach_directory_contents_value_field),
	(update_visibility_of_item_count_fields),
	(should_show_custom_icon_buttons), (should_show_file_type),
	(should_show_accessed_date), (should_show_mime_type),
	(create_emblems_page),
	(append_special_execution_checkbox), (create_permissions_page),
	(should_show_emblems), (should_show_permissions),
	(real_shutdown):
	Updated for name change only.
	
	(create_basic_page): Use original file for icon & name widgetry.

	(startup_data_new), (startup_data_free): New functions used to
	manipulate the data needed before a Properties window object
	exists for a given file.

	(create_properties_window): Reworked to use StartupData and set up
	both target_file and original_file.

	(get_target_file): Renamed from get_and_ref_file_to_display.

	(create_properties_window_callback): Reworked to use StartupData;
	slight reordering due to object lifetime issues.
	
	(cancel_create_properties_window_callback),
	(directory_view_destroyed_callback), (remove_pending_file),
	(fm_properties_window_present):
	Reworked to use StartupData.
	
	(real_destroy): clean up after original_file and target_file.
	
	(set_icon_callback): Use original_file.
	(select_image_button_callback),
	(remove_image_button_callback): Changed signatures to take
	FMPropertiesWindows instead of NautilusFiles; use original_file.

2001-02-13  Michael Engber  <engber@eazel.com>

	reviewed by: John Sullivan

	* libnautilus-extensions/nautilus-directory-metafile.c:
	(nautilus_directory_set_file_metadata_list):
	Fix call to CORBA_sequence_set_release on the wrong
	(non-CORBA) list - bug 6575.

2001-02-13  Darin Adler  <darin@eazel.com>

	reviewed by: John Sullivan <sullivan@eazel.com>

	Fix bug 6408 (nautilus_view_report_load_failed causes Nautilus to
	segfault in an idle callback):

	* libnautilus/nautilus-idle-queue.c: (execute_queued_functions),
	(nautilus_idle_queue_destroy): Changed the idle queue so it can
	handle being destroyed while inside one of the queued functions.

	Fix bug 6402 (Click desktop icon -> Nautilus window not moved to
	front):
	
	* src/nautilus-window-manage-views.c: (open_location): Bring the
	existing window up when it's reused in the "open icon on desktop"
	in single-window mode.

	Other changes:

	* libnautilus-extensions/nautilus-icon-factory.c:
	(is_theme_in_user_directory): Rename from "check_local_theme"
	and changed it to use a normal function result instead of taking
	a gboolean pointer.
	(set_theme): Use new function and booleans by their new names.
	"in_user_directory" instead of "local".
	(make_full_icon_path): Just the name change.
	(get_themed_icon_file_path): Take a boolean parameter instead of
	trying to figure out if the theme is in the user directory, because
	the old way would get it wrong for the default theme.
	(get_icon_file_path): Pass in the boolean to say if the theme is
	in the user directory or not.

	* libnautilus-extensions/nautilus-string.h: Remove repeated
	declaration for nautilus_str_get_prefix.

	(These not reviewed:)
	
	* librsvg/rsvg-ft.c: (rsvg_ft_glyph_evict): Fix code that was
	looking at the "prev" pointer of a victim after freeing it. Also
	made some other code simplifications.

	* src/nautilus-theme-selector.c:
	(render_theme_name_and_description): Added an explicit call to
	gtk_widget_realize before grabbing the style field and expecting
	it to have gc's in it. Not sure why no one ran into this before.

2001-02-13  Eric Fischer <eric@eazel.com>

	* configure.in:
	Allow RPM 4.* instead of only 4.0

2001-02-13  Andy Hertzfeld  <andy@eazel.com>

	* components/text/nautilus-text-view.c: (add_services_to_menu),
	(nautilus_text_view_build_service_menu):
	made the text view look for services in the updates folder, so we
	can add new services in the same fashion as bookmarks.  Also,
	keep a list of the added service filenames so if the same service
	is present in multiple directories, it only gets added once.
	
2001-02-13  Robin * Slomkowski  <rslomkow@rslomkow.org>

	* nautilus.spec.in: enabled make -k check

2001-02-13  Michael Engber  <engber@eazel.com>

	reviewed by: Darin Adler  <darin@eazel.com>

	* libnautilus-extensions/nautilus-directory-metafile.c:
	(nautilus_directory_use_self_contained_metatfile_factory),
	(get_metafile), (nautilus_directory_set_file_metadata_list):
	* libnautilus-extensions/nautilus-directory-metafile.h:
	* libnautilus-extensions/nautilus-metafile.c: (destroy),
	(corba_get_list):
	* src/nautilus-main.c: (main):
	The metafile code now circumvents oaf when nautilus is performing
	a self check - bug 6552.

2001-02-13  Robin * Slomkowski  <rslomkow@rslomkow.org>

	* nautilus.spec.in: re-enabled building...

2001-02-13  John Sullivan  <sullivan@eazel.com>

	Fixed bug 5647 (Control-left/right for keyboard focus
	movement conflicts with Sawfish keyboard shortcuts)

	* libnautilus-extensions/nautilus-icon-container.c:
	(keyboard_move_to), (keyboard_space): Use Alt instead
	of Control for keyboard focus movement and selection
	toggling, per Don.

2001-02-13  Robin * Slomkowski  <rslomkow@rslomkow.org>

	* nautilus.spec.in: took make check out of here
	* src/Makefile.am: re-enabled test target

2001-02-13  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Maciej Stachowiak  <mjs@eazel.com>

	* libnautilus-extensions/Makefile.am:
	* libnautilus-extensions/nautilus-glyph.h:
	* libnautilus-extensions/nautilus-glyph.c:
	New class.  A wrapper on RsvgGlyph that makes it simple and fast
	to draw smooth text on pixbufs
	
	* libnautilus-extensions/nautilus-clickable-image.c:
	(nautilus_clickable_image_initialize_class),
	(nautilus_clickable_image_realize):
	Remove unrealize() method that was a noop.
	
	* libnautilus-extensions/nautilus-debug-drawing.c:
	(nautilus_debug_pixbuf_draw_point),
	(nautilus_debug_pixbuf_draw_rectangle),
	(nautilus_debug_pixbuf_draw_rectangle_inset):
	* libnautilus-extensions/nautilus-debug-drawing.h:
	Add some pixbuf drawing functions to debug clip areas in pixbufs.

	* libnautilus-extensions/nautilus-image-table.c:
	(nautilus_image_table_initialize_class),
	(nautilus_image_table_remove):
	Remove add() method that was a noop. 

	* test/.cvsignore:
	* test/Makefile.am:
	* test/test-nautilus-font-simple.c: (main):
	* test/test-nautilus-font.c: (main):
	* test/test-nautilus-glyph-simple.c: (glyph_new), (main):
	* test/test-nautilus-glyph.c: (glyph_new), (main):
	* test/test.c: (test_window_set_title_with_pid),
	(test_pixbuf_draw_rectangle_tiled):
	* test/test.h:
	New NautilusGlyph tests.  Also remove the broken pixbuf drawing
	debug code.  Use the debugging code in nautilus-debug-drawing.[ch]
	instead.
	
2001-02-13  Arik Devens  <arik@eazel.com>

	reviewed by: Maciej Stachowiak  <mjs@eazel.com>

	Fixed bug 5837, 'Home Location' preference should accept ~.
	Fixed bug 6463, GNOME-VFS spews critical errors as you type an
	incomplete path in the location bar. 
	Fixed bug 6478, nautilus crashes on ~somedir/ if that dir
	doesn't exist.
	Fixed bug 6506, Entering "~" in Add New Background Dialogue box
	causes Nautilus to crash.

	* libnautilus-extensions/nautilus-entry.c:
	(nautilus_entry_initialize), (nautilus_entry_key_press): Added
	setting of expand_tilde to FALSE. Added a slash case so that ~/
	gets expanded to $(HOMEDIR).
	* libnautilus-extensions/nautilus-entry.h: Added gboolean
	expand_tilde to the NautilusEntry struct.
	* libnautilus-extensions/nautilus-file-utilities.c:
	(nautilus_make_uri_from_input): Added falling into default case
	on ~'s if the dir doesn't exist so they end up at http://'s.
	* libnautilus-extensions/nautilus-preferences-item.c:
	(preferences_item_create_editable_string): Added special case
	setting of expand_tilde to TRUE on the home dir preference box.
	As well as a FIXME saying this should be dealt with later on.
	* libnautilus-extensions/nautilus-text-caption.c:
	(nautilus_text_caption_initialize), (entry_changed_callback),
	(nautilus_text_caption_set_editable),
	(nautilus_text_caption_set_expand_tilde): Changed
	NautilusTextCaption to use NautilusEntry instead of GtkEntry.
	Added function to set expand tilde on NautilusText Caption.
	Updated set_editable to work with NautilusEntry.
	* libnautilus-extensions/nautilus-text-caption.h: Added
	nautilus_text_caption_set_expand_tilde function prototype.
	* src/nautilus-location-bar.c: (try_to_expand_path),
	(nautilus_location_bar_initialize): Added expanding of ~'s at
	the beginning of the location to full path. Added setting of
	expand_tilde to TRUE.
	* src/nautilus-property-browser.c: (add_pattern_to_browser):
	Added if statement to not attempt to do anything if the dir
	chosen uses ~ do to gtk brokenness. Also added error dialog
	that explains what happened to the user.

2001-02-13  Andy Hertzfeld  <andy@eazel.com>

	* src/nautilus-theme-selector.c:
	(nautilus_theme_selector_initialize), (theme_style_set_callback),
	(render_theme_name_and_description), (add_pixbuf_to_theme_list),
	(add_theme):
	fixed bug 5951, hard-coded geometry in the theme selector, by
	implementing the design that Arlo wanted, with the theme name
	above the theme description instead of in separate columns.
	
2001-02-12  Robey Pointer  <robey@eazel.com>

	reviewed by: Eskil Heyn Olsen  <eskil@eazel.com>

	* configure.in:

	Move -lrpmio earlier in the RPM_LIBS line, because the bootstrap
	installer is picky about it.  Also, generate the installer's
	Makefile during the 'configure' stage.
	
	* nautilus-installer/src/Makefile.am:

	Use predefined macros for most libraries (still keeping them to
	the mininum) and get libtool/automake to do the heavy lifting part
	of making a static binary.
	
	* nautilus-installer/src/callbacks.c: (druid_cancel),
	(druid_finish):

	Try to avoid unref'ing or using the installer object during button
	callbacks if it hasn't been created yet.

	* nautilus-installer/src/installer.c: (eazel_installer_finalize):

	Don't unref the service object, it causes assertions.
	
	* nautilus-installer/src/link.sh:

	Make it so that (at least for me) the bootstrap installer will
	build on a RH70 system now.

2001-02-12  Robin * Slomkowski  <rslomkow@eazel.com>

	* src/Makefile.am: disabled "make check" by commenting
	out the TEST directive

2001-02-12  John Harper  <jsh@eazel.com>

	reviewed by Michael Engber  <engber@eazel.com>

	Fix bug 6383 (Esc-cancel from icon stretching doesn't work on
	desktop):

	* libnautilus-extensions/nautilus-icon-container.c
	(start_stretching): call nautilus_gdk_window_focus on the
	toplevel widget of the icon container

2001-02-12  Robey Pointer  <robey@eazel.com>

	reviewed by: Eskil Heyn Olsen  <eskil@eazel.com>

	* src/nautilus-application.c: (nautilus_application_startup):

	Follow --quit's lead and avoid unref'ing to avoid hanging.
	
	* src/nautilus-shell.c: (restore_window_states):

	Don't double-free the list elements in the restored window list
	after restart.

2001-02-12  Robey Pointer  <robey@eazel.com>

	* components/services/install/lib/eazel-install-protocols.c:
	(gnome_vfs_fetch_remote_file):

	Erase the package if it didn't finish downloading.
	
	* components/services/trilobite/libtrilobite/trilobite-core-messagi
	ng.c:

	Add <string.h> header for RH7.
	
	* nautilus-installer/src/callbacks.c: (druid_cancel),
	(druid_delete), (druid_finish):
	* nautilus-installer/src/main.c: (main):

	Clean up object unref'ing to quiet up the install lib's memory
	checker.  Don't hook up with the session manager.
	
	* nautilus-installer/src/installer.c: (eazel_download_progress),
	(eazel_install_preflight), (check_system),
	(eazel_installer_finalize), (eazel_installer_set_default_texts),
	(eazel_installer_initialize):
	* nautilus-installer/src/installer.h:
	* nautilus-installer/src/link.sh:

	Change the no-RH7 message into RH6 and RH7 specific messages, so
	we can build one installer for each platform.  Don't ask to delete
	files if none were downloaded.
	
2001-02-12  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Darin Adler  <darin@eazel.com>

	* libnautilus-extensions/nautilus-gtk-extensions.h:
	* libnautilus-extensions/nautilus-gtk-extensions.c:
	(while_realized_disconnecter),
	(nautilus_gtk_signal_connect_while_realized):
	New function to connect to a signal of an object while a widget is
	realized.
	(while_realized_disconnecter): Changed signature to be void - no
	need to return a value here.  As such, the GTK_SIGNAL_FUNC casts
	are no longer needed.
	
	* libnautilus-extensions/nautilus-clickable-image.c:
	(nautilus_clickable_image_realize),
	(nautilus_clickable_image_unrealize):
	Use nautilus_gtk_signal_connect_while_realized so that we dont
	have to keep track of the signal ids and ancestor widget.
	
	* libnautilus-extensions/nautilus-image-table.c:
	(nautilus_image_table_realize), (nautilus_image_table_unrealize):
	Use nautilus_gtk_signal_connect_while_realized so that we dont
	have to keep track of the signal ids and ancestor widget.

	* test/test-nautilus-clickable-image.c: (main):
	Add a windowed ancestor inbetween in order to test
	nautilus_gtk_signal_connect_while_realized.
	
2001-02-12  Mike Fleming  <mfleming@eazel.com>

	reviewed by: <ramiro@eazel.com>

	* components/mozilla/nautilus-mozilla-content-view.c:
	(view_load_location_callback), (mozilla_net_stop_callback),
	(mozilla_link_message_callback), (mozilla_progress_callback),
	(mozilla_dom_mouse_click_callback), (vfs_read_callback),
	(update_nautilus_uri), (dispatch_report_location_change),
	(dispatch_report_load_complete):

	Bug 6436: Throbber wasn't thobbing on mozilla-to-mozilla navigation.

	Confirmed with Darin: call report_load_underway and report_load_complete
	in case where report_location_changed is used.

2001-02-12  John Harper  <jsh@eazel.com>

	* src/nautilus-application.c (set_session_restart): set the
	restart command to be `nautilus --no-default-window'

2001-02-12  Ian McKellar  <ian@eazel.com>

	* configure.in:
	Updated the check to check for RPM 3.0.5 not 3.0.4.

2001-02-12  Gene Z. Ragan  <gzr@eazel.com>

	Turn off repawn behavior in debug mode at request of Andy.
	
	* src/nautilus-application.c: (set_session_restart):
	Check for debug environment variable.
	
2001-02-12  Robin * Slomkowski  <rslomkow@eazel.com>

	* nautilus.spec.in: merged changes from branch into
	head BUG 6067

2001-02-11  Michael K. Fleming  <mfleming@eazel.com>

	reviewed by: <sullivan@eazel.com>

	Bug 5961: Starting nautilus with path to local HTML file
	causes images not to load.

	The problem here was that any argument specified on the commandline
	was being passed directly into Nautilus and its components as a
	valid URI.  Added pre-processing to commandline arguments, including
	ability to handle relative file pathnames. (so you can do "nautilus ."
	to open a window on the current directory)

	* libnautilus-extensions/nautilus-file-utilities.c:
	(file_uri_from_local_relative_path),
	(nautilus_make_uri_from_shell_arg), (is_uri_partial),
	(remove_internal_relative_components),
	(nautilus_uri_make_full_from_relative),
	(nautilus_self_check_file_utilities):
	* libnautilus-extensions/nautilus-file-utilities.h:
	* src/nautilus-application.c:
	(nautilus_make_uri_list_from_shell_strv),
	(nautilus_application_startup):


2001-02-12  Rebecca Schulman  <rebecka@eazel.com>
	Fix bugzilla.eazel.com bug 4962 that open with
	mpg123 fails.  The problem was a check for 
	a file uri that had its logic backwards

	reviewed by: Mike Engber <engber@eazel.com>

	* libnautilus-extensions/nautilus-program-choosing.c:
	(nautilus_launch_application):
	Change if (file_uri) to if (!file_uri)

2001-02-12  Michael Engber  <engber@eazel.com>

	reviewed by: John Sullivan

	* libnautilus-extensions/nautilus-directory-async.c:
	(metafile_read_mark_done), (metafile_read_done_callback):
	* libnautilus-extensions/nautilus-directory-metafile.c:
	(free_factory), (get_metafile),
	(nautilus_directory_get_file_metadata),
	(nautilus_directory_get_file_metadata_list),
	(nautilus_directory_set_file_metadata),
	(nautilus_directory_set_file_metadata_list),
	(nautilus_directory_copy_file_metadata),
	(nautilus_directory_remove_file_metadata),
	(nautilus_directory_rename_file_metadata):
	* libnautilus-extensions/nautilus-directory-metafile.h:
	* libnautilus-extensions/nautilus-directory.c:
	(nautilus_directory_destroy):
	* libnautilus-extensions/nautilus-metafile-factory.c:
	(free_factory_instance):
	* libnautilus-extensions/nautilus-metafile-factory.h:
	* libnautilus-extensions/nautilus-metafile-server.idl:
	* libnautilus-extensions/nautilus-metafile.c: (destroy),
	(corba_get), (corba_get_list), (corba_set), (corba_set_list),
	(corba_copy), (corba_remove), (corba_rename),
	(get_or_add_directory_monitor_list_entry),
	(remove_directory_monitor_list_entry), (find_monitor_link),
	(corba_register_monitor), (corba_unregister_monitor),
	(get_metadata_from_node), (get_metadata_list_from_node),
	(create_metafile_root), (get_file_node),
	(get_metadata_string_from_metafile),
	(get_metadata_list_from_metafile),
	(set_metadata_string_in_metafile), (set_metadata_list_in_metafile),
	(metadata_value_new), (metadata_value_new_list),
	(metadata_value_destroy), (metadata_value_equal),
	(set_metadata_in_metafile), (get_metadata_string_from_table),
	(get_metadata_list_from_table), (str_or_null_hash),
	(str_or_null_equal), (set_metadata_eat_value),
	(free_file_table_entry), (free_directory_table_entry),
	(destroy_metadata_changes_hash_table), (destroy_xml_string_key),
	(nautilus_metafile_destroy), (get_file_metadata),
	(get_file_metadata_list), (set_file_metadata),
	(set_file_metadata_list), (rename_file_metadata),
	(apply_one_change), (apply_file_changes), (apply_one_file_changes),
	(nautilus_metafile_apply_pending_changes), (copy_file_metadata),
	(remove_file_metadata), (nautilus_metafile_set_metafile_contents):
	* libnautilus-extensions/nautilus-metafile.h:
	* src/nautilus-application.h:

	Metadata setting/getting is now done via CORBA so that
	out of process components stay in sync. bug 5958

2001-02-12  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: John Sullivan <sullivan@eazel.com>

	* src/nautilus-property-browser.c:
	(make_properties_from_directories):
	Dont free the object name so soon.  Its needed to determine where
	to put the reset and erase objects.
	
2001-02-12  Rebecca Schulman  <rebecka@eazel.com>
	Fix bug 6333, that a warning about not finding
	unindexed files should not be displayed if the
	backup search is turned on.

	reviewed by: John Sullivan <sullivan@eazel.com>

	* libnautilus-extensions/nautilus-global-preferences.h:
	Leave a note that we should change the SEARCH_METHOD
	name to be more clear about what the preference is for
	(whether or not we  do a slow background search)
	* src/file-manager/fm-search-list-view.c: (load_location_callback):
	Check the SEARCH_METHOD preference 

	
2001-02-12  John Sullivan  <sullivan@eazel.com>

	reviewed by: Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 6500 (tighter layout option not saved).

	It actually was being saved, it was just being clobbered back to
	off every time a directory was loaded.

	* src/file-manager/fm-icon-view.c: (fm_icon_view_begin_loading):
	Moved the tighter-layout setting code up one line and refined
	comments to explain why.

2001-02-12  Robey Pointer  <robey@eazel.com>

	* components/services/install/lib/eazel-install-logic2.c:
	(do_dep_check_internal), (install_packages_helper):

	Make the dep-check logic bail out early if the user has cancelled
	the install.  (It's possible to get the async "stop" callback
	during a package info fetch, I found out the hard way...)
	
	* components/services/install/lib/eazel-install-protocols.c:
	(http_fetch_remote_file):

	Make get_failed into an official bool, since it acts like one
	already.
	
	* components/services/install/nautilus-view/nautilus-service-instal
	l-view.c: (nautilus_service_install_dependency_check),
	(nautilus_service_need_password),
	(service_install_stop_loading_callback):

	Treat aborted password dialog as a cancel, not a failure.  Fix
	abort callback so it doesn't loop endlessly in a GTK event
	handling cycle on fast downloads.

2001-02-11  Ramiro Estrugo  <ramiro@eazel.com>

	* test/.cvsignore:
	* test/Makefile.am:
	* test/test-nautilus-wrap-table.c: (main):
	New NautilusWrapTable test.
	
2001-02-11  Ramiro Estrugo  <ramiro@eazel.com>

	* test/test-nautilus-clickable-image.c: (main):
	* test/test-nautilus-labeled-image.c: (button_callback),
	(labeled_image_button_window_new):
	A tiny bit more debug code.
	
2001-02-11  Ramiro Estrugo  <ramiro@eazel.com>

	* applets/preferences-applet/nautilus-preferences-applet.c:
	(user_level_changed_callback), (main):
	Make toggle buttons insensitive on novice user level.

2001-02-11  Ramiro Estrugo  <ramiro@eazel.com>

	* libnautilus-extensions/nautilus-viewport.h:
	* libnautilus-extensions/nautilus-viewport.c:
	(nautilus_viewport_draw), (nautilus_viewport_expose_event),
	(nautilus_viewport_realize), (nautilus_viewport_set_is_smooth),
	(nautilus_viewport_get_is_smooth): Add public is_smooth getter.
	(nautilus_viewport_set_never_smooth): Add a 'never_smooth'
	attribute.

2001-02-11  Ramiro Estrugo  <ramiro@eazel.com>

	* libnautilus-extensions/nautilus-customization-data.h:
	Add comment clarifying API changes I made in my last checkin.
	* src/file-manager/fm-properties-window.c: (create_emblems_page):
	Remove some left over code from when the emblems table was hard
	coded to 2 columns.
	* src/nautilus-property-browser.c:
	(make_properties_from_directories):
	Fix a small memory leak.

2001-02-11 John Fleck <jfleck@inkstain.net>

	reviewed by: Ali Abdin <aliabdin@aucegypt.edu>

	* components/help/converters/gnome-db2html2/gdb3html.h
	* components/help/converters/gnome-db2html2/sect-elements.c
	* components/help/converters/gnome-db2html2/sect-elements.h
	* components/help/converters/gnome-db2html2/sect-preparse.c
	* components/help/converters/gnome-db2html2/toc-elements.c
	add support for <bridgehead> tag in DocBook, fix bug #6492

2001-02-11  Rebecca Schulman  <rebecka@eazel.com>

	reviewed by: Mathieu Lacage <mathieu@gnome.org>

	* cut-n-paste-code/widgets/nautilusclist/nautilusclist.c: Use
	binary instead of linear search to find the right insert new row
	into a sorted clist. This is part of addressing bug 6290

2001-02-10  Andy Hertzfeld  <andy@eazel.com>

	* src/nautilus-sidebar.c: (add_command_buttons),
	(empty_trash_callback),
	(nautilus_sidebar_trash_state_changed_callback),
	(nautilus_sidebar_update_buttons):
	fixed bug 6052, sidebar needs empty trash button when showing
	trash: directory
	
2001-02-09  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Maciej Stachowiak <mjs@eazel.com>

	* libnautilus-extensions/nautilus-image-table.c:
	(image_table_handle_motion), (ancestor_button_press_event),
	(ancestor_button_release_event):
	Ignore insensitive widgets when doing the event thing.
	
	* src/nautilus-property-browser.c:
	(make_properties_from_directories):
	Add an extra empty space between the erase emblem and the next to
	make it stand out more.  Cleanup property image creation a tiny bit.

2001-02-09  Robey Pointer  <robey@eazel.com>

	* po/POTFILES.in:

	Fix build bustage by removing the two missing install-lib files
	from POTFILES.in.

2001-02-09  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Robey Pointer  <robey@eazel.com>

	* libnautilus-extensions/Makefile.am:
	* libnautilus-extensions/nautilus-region.c:
	* libnautilus-extensions/nautilus-region.h:
	New class for super easy region management using rectangle.

	* libnautilus-extensions/nautilus-art-gtk-extensions.h:
	* libnautilus-extensions/nautilus-art-gtk-extensions.c:
	(nautilus_gdk_rectangle_assign_irect):
	New function to convert ArtIRect to GdkRectangles.

	* libnautilus-extensions/nautilus-customization-data.h:
	* libnautilus-extensions/nautilus-customization-data.c:
	(nautilus_customization_data_get_next_element_for_display):
	Return pixbufs and labels for the object instead of widgets.  This
	is so that the caller can use the widget that best suits its
	display needs.

	* libnautilus-extensions/nautilus-image-table.h:
	* libnautilus-extensions/nautilus-image-table.c:
	(nautilus_image_table_initialize_class),
	(nautilus_image_table_initialize),
	(nautilus_image_table_expose_event),
	(nautilus_image_table_realize), (nautilus_image_table_unrealize),
	(nautilus_image_table_set_is_smooth_signal),
	(image_table_foreach_child_subtract_content),
	(image_table_clear_dirty_areas), (image_table_peek_clear_gc),
	(image_table_emit_signal), (image_table_handle_motion),
	(ancestor_button_press_event), (ancestor_button_release_event),
	(nautilus_image_table_new), (nautilus_image_table_set_is_smooth),
	(nautilus_image_table_set_smooth_background_color):
	Add support for smoothnes.  Register widget as a possible smooth
	widget.  When smoothness changes, we modify our background drawing
	behavior such that in smooth mode we dont flicker at all.

	Remove grab/ungrab pair that could screw up operations.  Turns out
	these are not needed.

	Change event signal emissions to include more data from the raw
	gdk events without exposing these.

	* libnautilus-extensions/nautilus-image.c:
	(nautilus_image_initialize_class):
	Update for new smooth widget class registration scheme.

	* libnautilus-extensions/nautilus-label.c:
	(nautilus_label_initialize_class):
	Update for new smooth widget class registration scheme.

	* libnautilus-extensions/nautilus-labeled-image.h:
	* libnautilus-extensions/nautilus-labeled-image.c:
	(nautilus_labeled_image_size_allocate),
	(nautilus_labeled_image_get_image_bounds),
	(nautilus_labeled_image_get_label_bounds):
	Make these two functions public.
	
	* libnautilus-extensions/nautilus-smooth-widget.h:
	* libnautilus-extensions/nautilus-smooth-widget.c:
	(smooth_widget_type_list_free), (smooth_widget_list_free),
	(widget_is_smooth), (nautilus_smooth_widget_register),
	(nautilus_smooth_widget_register_type):
	Add mechanism for registering types that are meant to be smooth.
	That way we dont need to hardcode the list of smooth widget
	classes.  Also made sure to free the static lists at exit time.
	
	* libnautilus-extensions/nautilus-viewport.h:
	* libnautilus-extensions/nautilus-viewport.c:
	(nautilus_viewport_initialize_class),
	(nautilus_viewport_initialize), (nautilus_viewport_destroy),
	(nautilus_viewport_draw), (nautilus_viewport_expose_event),
	(nautilus_viewport_realize), (nautilus_viewport_paint),
	(nautilus_viewport_set_is_smooth_signal), (nautilus_viewport_new),
	(nautilus_viewport_set_is_smooth),
	(nautilus_viewport_get_scroll_offset):
	Add support for smoothness.  When the is_smooth attribute changes,
	the viewport will not clear the background on resize - and so its
	content will not flicker.

	Add function for querying the scroll offset.
	
	* libnautilus-extensions/nautilus-wrap-table.h:
	* libnautilus-extensions/nautilus-wrap-table.c:
	(wrap_table_get_content_frame), (wrap_table_get_scroll_offset),
	(nautilus_wrap_table_get_homogeneous),
	(nautilus_wrap_table_reorder_child):
	Fix a mod by zero error.
	Add support for reordering children.
	
	* src/file-manager/fm-properties-window.c: (create_emblems_page):
	Simplify a bit by using NautilusWrapTable instead of a GtkTable
	with a hard coded number of columns.  The emblems now wrap to fit
	the available space.  Also use NautilusLabeledImages instead of
	boxes.  Update for changes in customization data api.
	Remove check box painting workaround.  Its taken care of in
	NautilusLabeledImage now.
	
	* src/nautilus-property-browser.c:
	(nautilus_property_browser_initialize_class),
	(nautilus_property_browser_initialize), (element_clicked_callback),
	(nautilus_property_browser_preferences_changed),
	(make_property_tile), (make_properties_from_directories),
	(add_reset_property), (make_properties_from_xml_node),
	(property_browser_category_button_new), (make_category_link),
	(nautilus_property_browser_update_contents),
	(emit_emblems_changed_signal):
	Use a NautilusImageTable instead of a GtkTable to make things wrap
	propertly and thus not have to recreate the whole property box
	each time its resized.  Remove a lot of hard coded dimensions.
	Simplified a bit by using NautilusLabeledImages.
	
	* src/nautilus-search-bar-criterion.c: (make_emblem_value_menu):
	Update for changes in customization data api.
	
	* test/test-nautilus-image-table.c: (labeled_image_new),
	(foo_timeout), (image_table_size_allocate),
	(image_table_new_scrolled):
	Update for new image table features.

2001-02-09  Andy Hertzfeld  <andy@eazel.com>

	* src/nautilus-sidebar.c:
	(nautilus_sidebar_active_panel_matches_id),
	(nautilus_sidebar_remove_panel):
	fixed bug 6005, help tab still left on sidebar after view is hidden,
	by decrementing the active tab index when an earlier one is deleted,
	and checking for NULL in active_panel_matches_id.

	* components/rpmview/nautilus-rpm-view.c:
	(nautilus_rpm_view_initialize),
	(nautilus_rpm_view_update_from_uri):
	made it use nautilus_image so the package image is anti-aliased

2001-02-09  John Sullivan  <sullivan@eazel.com>

	Fixed bug 5903 ("Tighter Layout" can't be changed in
	manual layout, but affects Clean Up by Name)

	* libnautilus-extensions/nautilus-icon-container.c:
	(nautilus_icon_container_set_tighter_layout): When in
	manual layout mode, invalidate label sizes and update
	all items so the smaller caption width used for
	tighter layout can take effect immediately.
	
	* src/file-manager/fm-icon-view.c: 
	(update_layout_menus): Remove the code that was making
	this item insensitive in manual layout.

2001-02-09  Robey Pointer  <robey@eazel.com>

	reviewed by: Eskil Heyn Olsen  <eskil@eazel.com>

	* components/services/install/idl/trilobite-eazel-install.idl:
	* components/services/install/lib/eazel-install-corba-callback.c:
	(eazel_install_callback_get_epv):
	* components/services/install/lib/eazel-install-corba-types.c:
	(corba_packagedatastruct_fill_from_packagedata),
	(packagedata_from_corba_packagedatastruct):

	Remove some cruft from the IDL that's not implemented anymore or
	isn't being used by any of the clients.
	
	* components/services/install/lib/eazel-install-metadata.c:
	(eazel_install_configure_use_local_db):
	* components/services/install/lib/eazel-install-metadata.h:
	* components/services/install/lib/eazel-install-object.c:
	(eazel_install_initialize):
	* components/services/trilobite/doc/gconf.txt:

	Make an opt-out for people who don't want the "can't get shared
	lock" spam message scrolling endlessly on every install just
	because RPM can't deal with NFS directories well.
	
	* components/services/install/lib/makefile.staticlib.in:

	Remove dead files from the bootstrap installer's makefile, and
	make the package-system object be a var to be filled in later.
	
	* components/services/install/nautilus-view/nautilus-service-instal
	l-view.c: (nautilus_service_install_conflict_check),
	(nautilus_service_install_downloading),
	(nautilus_service_install_view_update_from_uri_finish),
	(user_login_callback),
	(nautilus_service_install_view_update_from_uri),
	(nautilus_service_install_view_load_uri):

	General cleanup, and the addition of the conflict_check signal
	handler.

	* nautilus-installer/src/Makefile:
	* nautilus-installer/src/installer.c: (eazel_install_progress),
	(conflict_check), (eazel_install_preflight),
	(eazel_installer_initialize):

	Add conflict check handler; fix 50% bug prior to downloading.

2001-02-09  John Sullivan  <sullivan@eazel.com>

	Fixed problems I ran into while trying to fix bug 5903,
	which is about making "Tighter Layout" sensitive even
	in manual layout, since it affects "Clean Up by Name"

	* libnautilus-extensions/nautilus-icon-container.c:
	(nautilus_icon_container_set_tighter_layout): Don't
	re-sort when tighter layout setting changes if not
	in auto_layout mode.
	
	* src/file-manager/fm-icon-view.c: 
	(handle_radio_item): Don't assume that every id passed
	to this routine is a sort ID; it might be a toggle
	button's id. Use get_sort_criterion_by_id to distinguish.
	(update_layout_menus): Added FIXME comment explaining
	why "tighter layout" is insensitive in manual layout.
	(set_sort_criterion_by_id): Check whether passed id is
	a valid sort criterion; don't try to sort if not.

2001-02-09  Eskil Heyn Olsen  <eskil@eazel.com>

	reviewed by: Robey Pointer  <robey@eazel.com>

	Fix for 6190, reuse check_if_related. If a package being revived
	is related to the broken (related by name and version diff), don't
	ask softcat for an update, but ask for an exact version.
	
	* components/services/install/lib/eazel-install-rpm-glue.c:
	* components/services/install/lib/eazel-install-rpm-glue.h:
	* components/services/install/lib/eazel-install-logic.c:
	* components/services/install/lib/eazel-install-logic.h:
	* components/services/install/lib/Makefile.am:
	Removed rpm-glue and logic.
	
	* components/services/install/lib/eazel-install-logic2.c:
	(is_satisfied), (check_if_related_package), (check_tree_helper),
	(download_packages):
	is_satisfied checks name!=null before doing is_installed.
	check_tree_helper now uses check_if_related before doing the
	softcat_available_update. If the packages are related, use
	get_info to get an exacat version (sense=EQ).
	Moved check_if_related here
	Output tuning...
	* components/services/install/lib/eazel-install-object.c:
	(eazel_install_emit_download_progress):
	Woops, undid a comment about bug 6425
	
	* components/services/install/lib/eazel-softcat.c:
	(eazel_softcat_available_update):
	Indention...

2001-02-08  John Harper  <jsh@eazel.com>

	reviewed by: Maciej Stachowiak <mjs@eazel.com>

	Fix bug 4423 (when a folder that is expanded in the tree view
	is renamed, it collapses)

	* components/tree/nautilus-tree-model.h,
	components/tree/nautilus-tree-model.c: added a new signal
	`node_being_renamed'. Has two arguments, the old and new URIs

	(report_node_changed): when the node is being renamed, use
	report_node_removed_internal instead of report_node_removed so
	we can avoid emitting the `node_removed' signal. Before doing
	this, emit the new `node_being_renamed' signal

	* components/tree/nautilus-tree-view.c
	(nautilus_tree_view_insert_model_node): if the node is already
	inserted in the tree, call nautilus_tree_view_update_model_node

	(nautilus_tree_view_model_node_renamed_callback): connected to
	the `node_being_renamed' signal, propagates the expansion state
	from the old URI to the new one

	Fix bug 4421 (Delete file while folder collapsed -> not
	reflected in Tree View)

	* components/tree/nautilus-tree-model.c
	(nautilus_tree_model_monitor_node): if the node being monitored
	is a directory, check if any of the files we think it contains
	got moved away (e.g. while the node was collapsed)

2001-02-09  Andy Hertzfeld  <andy@eazel.com>

	* icons/i-directory-12.png:
	* icons/i-directory-accept-12.png:
	fixed bug 6338, folder moves to the right when highlighted,
	by tweaking the associated images
	
	* src/nautilus-sidebar-tabs.c: (nautilus_sidebar_tabs_hit_test):
	consider the tab for hit-testing even if invisible
	* src/nautilus-sidebar.c: (nautilus_sidebar_release_event):
	fixed 3538, easier way to minimize active sidebar view, by
	making it close the active view when you click on the space
	its tab formerly occupied.

2001-02-09  Arlo Rose  <arlo@eazel.com>

	* icons/Makefile.am:
	* icons/emblem-symbolic-link-12.png:
	* icons/emblem-symbolic-link-24.png:
	* icons/emblem-symbolic-link-36.png:
	Made more link icons that will work at smaller zoom levels.
	Fixes bug number 5988.

2001-02-09  John Sullivan  <sullivan@eazel.com>

	Fixed bug 6473 (counting deep contents of folder in Properties
	window takes tons of CPU)

	Fixed by deploying a timeout, so that the displayed numbers
	only update periodically, instead of with every item count
	increment. The interval is 200 milliseconds. This makes the
	count faster as well as greatly reducing CPU thrashage by
	not pounding on the poor widdle widgets so often.

	* src/file-manager/fm-properties-window.c:
	(directory_contents_value_field_update): Changed signature
	to just take an FMPropertiesWindow, and get the other
	relevant objects from the Details struct.
	(update_directory_contents_callback): New function, updates
	field and clears timeout ID.
	(schedule_directory_contents_update): Schedules update if
	not already pending.
	(attach_directory_contents_value_field): Removed old hack
	to store the title_field in the object data of the value
	field; store value_field after creation in Details struct.
	(append_directory_contents_fields): Store title_field after
	creation in Details struct.
	(real_destroy): Remove timeout if still pending.

2001-02-09  John Sullivan  <sullivan@eazel.com>

	Fixed part of bug 6462 (two error messages after doing search
	in Red Hat 7). Now you should only get one error message.
	Rebecca gets to figure out that one.

	* src/file-manager/fm-search-list-view.c: (real_load_error),
	(fm_search_list_view_initialize_class),
	(fm_search_list_view_initialize): Now replaces function
	pointer for load_error instead of attaching to signal, to
	avoid triggering fm-directory-view's error-handling code
	(which I recently added).

2001-02-09  John Sullivan  <sullivan@eazel.com>

	Fixed bug 6343 (timed-wait dialog is too narrow, often
	clipping dialog title)

	* libnautilus-extensions/nautilus-stock-dialogs.c:
	(timed_wait_callback): Enforced a minimum width for timed-wait
	windows. They look better now, and don't clip the titles
	except with extremely long titles, for which the title-writer
	should be flogged.

2001-02-09  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 6453, Gnome VFS_CRITICAL received when dragging
	nautilus link icons over each other.
	
	* libnautilus-extensions/nautilus-drag.c:
	(nautilus_drag_default_drop_action_for_icons):
	
	* libnautilus-extensions/nautilus-icon-dnd.c:
	(nautilus_icon_container_dropped_icon_feedback),
	(nautilus_icon_dnd_end_drag):

2001-02-08  Robey Pointer  <robey@eazel.com>

	* components/mozilla/nautilus-mozilla-content-view.c:
	(pre_widget_initialize):

	Fix build bustage in Mozilla content view: profile_name ->
	profile_directory_name.

2001-02-08  Eskil Heyn Olsen  <eskil@eazel.com>

	reviewed by: Robey Pointer  <robey@eazel.com>

	This commit fixed bugs:
	5723 ei2: check that install_failed_signal was not called 
	5752 ei2: port the uninstall stuff to the new ei2 
	5753 ei2: port the revert stuff to ei2 
	5757 fix leaks in EazelProblemHander 
	5957 eazel-install cli tool no longer uninstalls nicely
	6100 RPM4: don't handle dependencies called "rpmlib(.*)"
	6173 ei2: finish conflict and feature breakage  
	6191 make revert work (ei2: resurrect transaction stuff) 
	
	* components/rpmview/nautilus-rpm-view-install.c:
	(get_detailed_errors_foreach):
	Updated for the CANCELLED status.
	* components/services/install/command-line/eazel-alt-install-corba.
	c: (eazel_preflight_check_signal):
	Fixed an output string.
	
	* components/services/install/idl/trilobite-eazel-install.idl:
	Added the CANCELLED status.
	uninstall_progress now has same signature as install_progress.
	
	* components/services/install/lib/eazel-install-corba-callback.h:
	* components/services/install/lib/eazel-install-corba-callback.c:
	(impl_uninstall_progress),
	(eazel_install_callback_class_initialize):
	uninstall_progress now has same signature as install_progress.

	* components/services/install/lib/eazel-install-corba-types.c:
	(corba_packagedatastruct_fill_from_packagedata),
	(traverse_packagetree_md5), (corba_packagedatastruct_fill_deps),
	(packagedata_from_corba_packagedatastruct),
	(packagedata_tree_from_corba_packagedatastructlist),
	(categorydata_list_from_corba_categorystructlist):
	Added the CANCELLED status.
	Commented out sending ->provides in signals.
	Added some g_asserts to find a bug.
	categorydata_list_from_corba_categorystructlist uses
	packagedata_list_from_corba_packagedatastructlist.
	
	* components/services/install/lib/eazel-install-logic.h:
	* components/services/install/lib/eazel-install-logic.c:
	(eazel_install_start_transaction), (dump_one_package),
	(compare_break_to_package_by_name),
	(eazel_uninstall_upward_traverse),
	(eazel_uninstall_downward_traverse):
	Threw out most of the old code. Keeping logic.c untill 6190 is
	closed.
	
	* components/services/install/lib/eazel-install-logic2.c:
	(dump_tree_helper), (check_md5_on_files), (is_satisfied),
	(check_tree_helper), (execute), (set_toplevel),
	(get_packages_with_mod_flag), (check_uninst_vs_downgrade),
	(debug_revert), (compare_break_to_package_by_name),
	(eazel_uninstall_upward_traverse),
	(eazel_uninstall_check_for_install), (eazel_uninstall_globber),
	(install_packages), (uninstall_packages), (revert_transaction):
	Moved revert and uninstall into logic2.c and updated them
	appropriately.
	Added paranoia check in case bad xml dependency has a version but
	an senseless sense.
	When reviving, set parent->topleve to TRUE, not revived package.
	Revived the transaction stuff (for revert).
	Don't allow a package to depend on a package of the same name,
	this is often a problem during softcat updates.
	
	* components/services/install/lib/eazel-install-public.h:
	* components/services/install/lib/eazel-install-private.h:
	* components/services/install/lib/eazel-install-object.c:
	(eazel_install_finalize), (eazel_install_start_signal),
	(eazel_install_end_signal), (eazel_install_progress_signal),
	(eazel_install_failed_signal), (eazel_install_class_initialize),
	(eazel_install_initialize), (eazel_install_install_packages),
	(eazel_install_uninstall_packages),
	(eazel_install_revert_transaction_from_xmlstring),
	(eazel_install_do_transaction_save_report_helper),
	(eazel_install_save_transaction_report),
	(eazel_install_init_transaction),
	(eazel_install_emit_uninstall_progress),
	(eazel_install_emit_uninstall_progress_default),
	(eazel_install_emit_download_progress):
	uninstall_progress now has same signature as install_progress.
	Fixed some dumb bugs in install/uninstall progress emission.
	Added some lists to check on install status.
	Moved some of the transaction stuff from logic.c here.
	
	* components/services/install/lib/eazel-install-problem.c:
	(get_detailed_messages_foreach),
	(get_detailed_uninstall_messages_foreach),
	(get_detailed_cases_foreach),
	(get_detailed_uninstall_cases_foreach),
	(eazel_install_problem_tree_to_case),
	(eazel_install_problem_tree_to_string),
	(build_categories_from_problem_list):
	Updated again for the new PackageBreaks objects.
	Fixed so cli uninstall works nice again.
	Added the CANCELLED status.
	The problem handler is deteriorating, either we use it or we scrap
	it.
	
	* components/services/install/lib/eazel-package-system-rpm3.c:
	(rpmmonitorpiggybag_new),
	(eazel_package_system_rpm3_set_mod_status),
	(monitor_rpm_process_pipe_percent_output),
	(eazel_package_system_rpm3_packagedata_fill_from_header),
	(eazel_package_system_rpm3_set_state),
	(eazel_package_system_rpm3_execute), (check_if_all_packages_seen),
	(eazel_package_system_rpm3_install_uninstall):
	Don't spam about the locales decimal seperator.
	Set modification status after handling a package, so transaction
	logs make sense.
	Don't accept requirements of type "rpmlib(.*".
	Ability to set all packages to CANCELLED if root helper failed
	login.
	If TEST is set, fake success all the time.
	
	* components/services/install/lib/eazel-package-system-types.h:
	* components/services/install/lib/eazel-package-system-types.c:
	(categorydata_new), (categorydata_destroy_foreach),
	(packagedata_status_enum_to_str),
	(packagedata_status_str_to_enum):
	Added the CANCELLED status.
	Improved the debug strings for alloc/dealloc of category data
	structures.
	
	* components/services/install/lib/eazel-package-system.c:
	(eazel_package_system_install):
	If TEST, disable FORCE.

2001-02-08  John Harper  <jsh@eazel.com>

	Fixed bug 6044 (Druid should be clearer on what the right
	choice is for proxy users)

	* src/nautilus-first-time-druid.c (set_up_update_page): added
	the text `If you know your computer uses a proxy connection,
	click Yes and Nautilus will use it.' to the middle of the label

	Fixed bug 5656 (First time druid should bail out at startup if
	it cannot create .nautilus and Nautilus directories)

	* src/nautilus-application.c (nautilus_application_startup):
	moved the call to check_required_directories () before that to
	nautilus_first_time_druid_show ()

2001-02-08  Michael K. Fleming  <mfleming@eazel.com>

	reviewed by: Maciej Stachowiak <mjs@eazel.com>

	* components/mozilla/main.c: (mozilla_process_delayed_exit),
	(mozilla_object_destroyed), (mozilla_make_object), (main):

	Bug 6328 -- Mozilla processes are now kept around for 30
	minutes after last used, so that re-activation is much faster.
	Navigating to and from web pages in Nautilus is much less agonizing
	now.

2001-02-07  Maciej Stachowiak  <mjs@eazel.com>

	reviewed by: Rebecca Schulman  <rebecka@eazel.com>

	This change is needed to enable the bonobo-level fix to Nautilus
	bug 6023 (throbber and proxy processes still around after Nautilus
	is quit). The throbber was unreffing itself on destroy, which is
	wrong. However, Bonobo was leaking a reference to any toolbar
	control item, so the two bugs were masking each other.
	
	* components/throbber/nautilus-throbber.c
	(nautilus_throbber_destroy): Remove incorrect unref.
	(nautilus_throbber_initialize): Formatting tweaks

2001-02-08  Andy Hertzfeld  <andy@eazel.com>

	* libnautilus-extensions/nautilus-gnome-extensions.c:
	(widget_destroy_callback), (icon_selected_callback),
	(icon_cancel_pressed):
	fixed bug 6458, crash if you quickly press cancel after pressing
	OK in the icon picker; fixed by setting a boolean once the
	picker has been dismissed, and checking it so we don't do it twice.
	
2001-02-08  Andy Hertzfeld  <andy@eazel.com>
	
	* src/nautilus-location-bar.c,h: (get_file_info_list),
	(try_to_expand_path), (editable_key_press_callback),
	(real_activate), (destroy), (nautilus_location_bar_initialize),
	(nautilus_location_bar_new), (nautilus_location_bar_set_location),
	(nautilus_location_bar_get_location),
	(nautilus_location_bar_update_label):

	fixed bug 6369, sluggish keyboard response in location bar. I improved
	this in two different ways: the expansion code is deferred to idle
	time now, so it doesn't get in the way of fast typing.  Also, the
	file info list is cached in memory, so it doesn't have to load it
	again for every keystroke.  I also made the instance variables
	private, instead of being exposed in the .h file.
	
2001-02-08  Robey Pointer  <robey@eazel.com>

	* components/services/install/nautilus-view/nautilus-service-instal
	l-view.c: (nautilus_service_install_downloading),
	(nautilus_service_install_preflight_check),
	(previous_install_finished), (nautilus_service_install_installing),
	(nautilus_service_install_done),
	(nautilus_service_install_view_update_from_uri_finish):

	Change texts to match Vera's refinements.

2001-02-08  Robey Pointer  <robey@eazel.com>

	reviewed by: Ian McKellar  <ian@eazel.com>

	* components/services/login/nautilus-view/nautilus-change-password-
	view.c: (generate_change_password_form),
	(change_password_button_cb):

	Stick the password panels in a viewport so they'll have
	opportunistic scrollbars.

2001-02-08  John Sullivan  <sullivan@eazel.com>

	Fixed bug 5946 (minimum Nautilus window size is too large)

	* src/nautilus-window-private.h: Made the minimum window
	size much much smaller. This exposes layout problems in
	some of the bars & such at very small sizes, but none of
	these layout problems seem like 1.0 show-stoppers. Better to
	allow the user who wants to use a stripped-down window at
	minimum size do so than to prevent this because it looks bad
	with some bars showing. Note that other Linux apps don't stop
	you from reducing the window down to nothing at all (the
	Nautilus limit is somewhat larger than "nothing at all").

	* src/nautilus-switchable-search-bar.c:
	(nautilus_switchable_search_bar_new): With Rebecca's OK,
	changed "Search For:" to "Find:" in order to save precious
	horizontal screen real estate.

2001-02-08  Gene Z. Ragan  <gzr@eazel.com>

	reviewed by: Mike Engber <angber@eazel.com>

	Fixed bug 3087, gmc to Nautilus transition tool
	
	Added all features except removing gmc from session. Will
	need some additional help to add that feature.
	
	* libnautilus-extensions/nautilus-global-preferences.h:
	Add a preferences constant to indicate if Nautilus should
	respawn in the Gnome session.
	
	* src/nautilus-application.c: (nautilus_application_startup),
	(volume_unmounted_callback), (removed_from_session),
	(save_session), (set_session_restart), (init_session):
	Check preferences add add ourselves to session with a respawn
	setting if the user has specified that they wish such behavior.
	
	* src/nautilus-first-time-druid.c: (druid_finished),
	(set_up_gmc_transition_page):
	Save gmc to nautilus transition values in nautilus preferences.

2001-02-08  Michael K. Fleming  <mfleming@eazel.com>

	reviewed by: <ramiro@eazel.com>

	Significant rework of nautilus-mozilla-content-view to use
	report_location_change and to do general house-cleaning.

	Fixes following bugs:

	Bug 3547  POSTs in the mozilla component don't update the URI 
	Bug 4682, 6142  Frame sets have difficulty in Nautilus
	Bug 5461  "http://localhost:xxxx" instead of "eazel-services:" on location bar
	
	Will fix following bugs when I talk with Darin about problems
	with report_location_change:

	5592  nautilus / mozilla back button goes back 2 pages

	Also removes all module-global and static variables, making gnome-vfs
	and general state-tracking per-instance, thus eliminating latent
	bugs related to using two browsers simultainously

	Removes all special-casing for form POST's and for iframes

	Removes usage of the mozilla "open_uri" signal, which was no longer really
	being used for anything (interruption of eazel-specific schemes is done
	at the DOM event level, notification to Nautilus of navigation is done
	as a result of the "location" signal

	Introduces/aggravates these bugs:

	6435	No history recorded when using report_location_change
	6436	Throbber doesn't throb when using report_location_change

	I'll wait until Darin returns to figure out solutions to this.

	* components/mozilla/Makefile.am:
	* components/mozilla/main.c: (main):
	* components/mozilla/mozilla-events.cpp:
	* components/mozilla/mozilla-events.h:
	* components/mozilla/nautilus-mozilla-content-view.c:
	* components/mozilla/nautilus-mozilla-content-view.h:

2001-02-08  Andy Hertzfeld  <andy@eazel.com>

	* libnautilus-extensions/nautilus-gnome-extensions.c:
	(icon_selected_callback), (nautilus_gnome_icon_selector_new):
	fixed bugs 6437 and 6438 by testing for a directory selected
	instead of a file in the icon selector, and putting up an error
	dialog in that case instead of invoking the callback with the
	directory path.
	
2001-02-08  Pavel Cisler  <pavel@eazel.com>
	
	Fix 6401 (Create Link yields "You cannot link a file to itself"
		  error)
	* libnautilus-extensions/nautilus-file-operations.c:
	(nautilus_file_operations_copy_move):
	Remove a confused link to self check.
	Pass the GNOME_VFS_XFER_USE_UNIQUE_NAMES option to xfer.

2001-02-08  Fatih Demir	<kabalak@kabalak.net>

	* components/services/install/lib/eazel-package-system-rpm3.c:
	Include locale.h as you use localeconv() without including
	it -- bad on debian...

2001-02-08  John Sullivan  <sullivan@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	* src/nautilus-sidebar-title.c:
	(nautilus_sidebar_title_size_allocate): Found useful
	optimization while investigating sidebar flashiness:
	now it only recomputes the sidebar font in
	size_allocate if the width actually changed.

2001-02-08  Robin * Slomkowski  <rslomkow@eazel.com>

	* nautilus.spec.in: updated to note that
	/usr/share/hyperbola/maps/*.map have moved to
	/usr/share/nautilus/components/hyperbola/maps/*.map

2001-02-08  John Sullivan  <sullivan@eazel.com>

	Fixed bug 6421 (Labels for permissions should look insensitive
	when permissions are not settable)

	* src/file-manager/fm-properties-window.c:
	(add_permissions_column_label), (create_permissions_page):
	Pass file parameter into add_permissions_column_label,
	set insensitive if can't set permissions.

	* libnautilus-extensions/nautilus-file.c:
	(nautilus_file_get_string_attribute_with_default):
	Use "--" as item count string instead of "..." when
	the preference is set to not display the item counts.
	("..." implied that it would show up eventually, not 
	true in this case.)
	
2001-02-08  Laszlo Kovacs  <laszlo.kovacs@sun.com>

	* components/help/Makefile.am:
	Man page map file moved to new hyperbola data
	directory.

        * components/help/hyperbola-filefmt.c:
	Compiler warnings fixed

2001-02-08  Laszlo Kovacs  <laszlo.kovacs@sun.com>

	* components/help/hyperbola-filefmt.c:
	Toplevel document support added. Docs specified in
	$(prefix)/share/nautilus/components/hyperbola/topleveldocs.xml
	will be added to the toplevel section of the help tree if
	Scrollkeeper is enabled
	
	* components/help/Makefile.am:
	topleveldocs.xml installed and hyperbola data directory
	changed to $(prefix)/share/nautilus/components/hyperbola

	* components/help/topleveldocs.xml:
	new xml file holding the docs that go into the toplevel
	section of the help tree

2001-02-07  Robey Pointer  <robey@eazel.com>

	* components/services/install/lib/eazel-install-logic2.c:
	(expand_package_suites), (install_packages):

	Do a softcat query for any suite ids in the initial package list,
	so they're expanded first and then all future queries will return
	single packages.
	
	* components/services/install/lib/eazel-install-object.c:
	(eazel_install_emit_preflight_check):

	Don't restrict the preflight signal to toplevel packages anymore:
	we send the whole package tree now so no editing is necessary.
	
	* components/services/install/lib/eazel-install-xml-package-list.c:
	(osd_parse_provides), (osd_parse_shared):

	Softcat server has started filling in the sense flag differently
	(without notice, I might grumpily add), so handle both types now
	and whine if we can't figure out how to decode it.  Log the
	softcat DB version now (eventually should store it somewhere).
	
	* components/services/install/lib/eazel-softcat.c:
	(eazel_softcat_error_string), (eazel_softcat_query),
	(eazel_softcat_get_info), (eazel_softcat_available_update):
	* components/services/install/lib/eazel-softcat.h:

	Split up the handling for single-package softcat queries and
	multi-package suite queries.
	
	* components/services/install/nautilus-view/main.c:
	(service_install_make_object), (main):

	Remove redundant 2nd ammonite_init call and a long-since useless
	printf from object creation.
	
	* components/services/install/nautilus-view/nautilus-service-instal
	l-view.c: (nautilus_service_install_downloading),
	(flatten_package_tree_foreach), (nautilus_service_install_done),
	(nautilus_service_install_failed):
	* components/services/install/nautilus-view/nautilus-service-instal
	l-view.h:

	Clean up final dialog text generation, and only ask about deleting
	RPMs if the user level is "advanced".  Also don't ask if no files
	were even downloaded.
	
2001-02-07  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Mike Fleming <mfleming@eazel.com>
	Minus the 2 new widgets.
		
	* libnautilus-extensions/Makefile.am:
	New files.

	* libnautilus-extensions/nautilus-labeled-image.h:
	* libnautilus-extensions/nautilus-labeled-image.c:
	(button_leave_callback), (button_focus_out_event_callback),
	(nautilus_labeled_image_check_button_new): Add workaround for
	rendering problems with GtkCheckButton.
	(nautilus_labeled_image_set_label_never_smooth): New function to
	make the label part possibly never smooth.

	* libnautilus-extensions/nautilus-clickable-image.h:
	* libnautilus-extensions/nautilus-clickable-image.c:
	(ancestor_button_press_event), (ancestor_button_release_event),
	(nautilus_clickable_image_new),
	(nautilus_clickable_image_new_from_file_name): New function to
	create clickable images from image files.  Add grab/ungrab calls
	to match the logic in GtkButton.

	* libnautilus-extensions/nautilus-wrap-table.h:
	* libnautilus-extensions/nautilus-wrap-table.c:
	New class.
	
	* libnautilus-extensions/nautilus-image-table.c:
	* libnautilus-extensions/nautilus-image-table.h:
	New class.

	* test/test-nautilus-image-table.c:
	* test/.cvsignore:
	* test/Makefile.am:
	Image table test.
	
2001-02-07  Robey Pointer  <robey@eazel.com>

	* components/services/install/lib/eazel-install-object.c:
	(eazel_install_start_signal):

	Remove break that caused 0% signals to never get sent on install.

	* components/services/install/lib/eazel-package-system-rpm3.c:
	(rpmmonitorpiggybag_new), (make_rpm_argument_list),
	(monitor_rpm_process_pipe_percent_output),
	(monitor_rpm_process_pipe), (monitor_subcommand_pipe),
	(manual_rpm_command), (eazel_package_system_rpm3_execute):

	Make percent a float for more accurate byte counts.  Give the IO
	channel a lower priority than normal, so that it doesn't outrank X
	refresh events (though this doesn't help much).  Reinsert the
	manual RPM execute from the old logic.c code.
	
	* nautilus-installer/src/installer.c: (insert_info_page),
	(eazel_install_progress), (eazel_download_progress),
	(get_detailed_errors_foreach_dep), (get_detailed_errors_foreach),
	(get_detailed_errors), (collect_failure_info),
	(eazel_install_preflight):
	* nautilus-installer/src/installer.h:

	Remove fixed "max assumed download" size and try to set it to the
	total bytes expected.  For some reason this still fails sometimes
	but at least it's on the right track.  Stop calling
	gtk_main_iteration from inside the install progress callback since
	that interacts horribly with the IO channel crap.  Getting
	detailed errors should avoid recursing, and should follow the
	depends struct instead of the old soft_depends one.
	
	* nautilus-installer/src/link.sh:

	Test for RPM4 build (should build now, but still not work due to
	lingering code that refuses to try under RPM4).
	
	* nautilus-installer/src/package-tree.c: (get_errant_children_int),
	(get_errant_children), (package_customizer_fill):

	Fix up tree tracing routines to avoid recursing and to use the new
	struct members instead of the old (now empty) ones.
	
2001-02-07  John Sullivan  <sullivan@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	Fixed bug 6405 (seg fault right-double-clicking when context
	menu is already showing)

	* libnautilus-extensions/nautilus-icon-container.c:
	(handle_icon_button_press): Don't create context-menu callback
	if one is already pending; don't let right-double-click activate.
	
	* src/file-manager/nautilus-directory-view-ui.xml: Added underscore
	accelerator for Show Trash, which didn't have one.

2001-02-07  Ian McKellar  <ian@eazel.com>

	reviewed by: Eskil Heyn Olsen  <eskil@eazel.com>

	* components/rpmview/nautilus-rpm-view.c:
	(nautilus_rpm_view_update_from_uri), (nautilus_rpm_view_load_uri),
	(rpm_view_load_location_callback):
	* components/rpmview/nautilus-rpm-view.h:
	If an RPM load fails then report it to Nautilus with:
	nautilus_view_report_load_failed,

	* components/services/install/lib/eazel-package-system-rpm3.c:
	(eazel_package_system_rpm3_packagedata_fill_from_header),
	(rpm_packagedata_fill_from_file):
	If an RPM load fails then report it to the caller.

	* components/services/trilobite/libtrilobite/trilobite-core-network
	.c: (trilobite_open_uri):
	Changed the unsafe `setenv' call to the safer `trilobite_setenv'.

2001-02-07  Ian McKellar  <ian@eazel.com>

	reviewed by: Maciej Stachowiak <mjs@eazel.com>

	* components/services/inventory/eazel-inventory-collect-hardware.c:
	(add_device_property), (eazel_inventory_collect_pci),
	(remove_trailing_whitespace), (ide_get_value),
	Separated whitespace removal into a separate function.

	(eazel_inventory_collect_usb), (eazel_inventory_collect_scsi),
	(eazel_inventory_collect_hardware):
	Added USB and SCSI bus scanning. Bugs: 5094, 6285.

2001-02-07  Pavel Cisler  <pavel@eazel.com>

	reviewed by: John Sullivan  <sullivan@eazel.com>

	Fix 6380 (** ERROR ** in trash_callback_destroy when
	          navigating to trash)
	* libnautilus-extensions/nautilus-trash-file.c:
	(trash_callback_destroy), (trash_file_call_when_ready):
	Add a missing ref and unref.

2001-02-07  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 5967, Music View slider is narrow in Eazel GTK theme
	
	Attempt to layout using Arlo's design.
	
	* components/music/nautilus-music-view.c:
	(music_view_set_selected_song_title), (add_play_controls),
	(nautilus_music_view_update),
	(music_view_background_appearance_changed_callback):

2001-02-07  Robin * Slomkowski  <rslomkow@eazel.com>

	* README: updated to note using the gnome-vfs-1 branch

2001-02-07  Andy Hertzfeld  <andy@eazel.com>

	fixed bug 6281, property browser should user gnome icon
	selection UI for adding patterns and emblems instead of
	generic file browsing
	
	* libnautilus-extensions/nautilus-gnome-extensions.c,h:
	(nautilus_gnome_open_terminal), (widget_destroy_callback),
	(icon_selected_callback), (icon_cancel_pressed),
	(list_icon_selected_callback), (entry_activated),
	(nautilus_gnome_icon_selector_new):
	moved code to integrate icon picking UI from the properties
	window into gnome-extensions, so other parts of nautilus can
	use it.
	
	* src/file-manager/fm-properties-window.c: (set_icon_callback),
	(select_image_button_callback):
	moved icon picking code out of properties window, but call it
	from here instead.
	
	* src/nautilus-property-browser.c: (nautilus_emblem_dialog_new),
	(add_pattern_to_browser), (add_new_pattern),
	(emblem_dialog_clicked):
	use icon picking code in property browser to pick patterns, and
	rework the emblem dialog to use gnome-icon-entry.
	
2001-02-07  Gene Z. Ragan  <gzr@eazel.com>

	reviewed by: Robin Slomkowski <robin@eazel.com>
	
	Fixed bug 6389, Extremely poor performance when
	autodir automounter is present
	
	Detect special NFS autofs directories and filter them out
	of the mount list.
	
	* libnautilus-extensions/nautilus-volume-monitor.c:
	(get_removable_volumes), (mount_volume_activate_nfs),
	(mount_volume_activate), (get_current_mount_list),
	(mount_volume_nfs_add), (mount_volume_add_filesystem):

	Worked on cleaning up placement of icons on the edges
	of the desktop based on input from Arlo.
	
	* libnautilus-extensions/nautilus-icon-container.c:
	(icon_set_position):
		
2001-02-07  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 6363, "Set Cover Image" button assumes
	fixed font height.
	
	* components/music/nautilus-music-view.c:
	(nautilus_music_view_initialize):
	Remove call to get_widget_set_usize
	
2001-02-07  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Pavel Cisler  <pavel@eazel.com>

	* libnautilus-extensions/nautilus-directory-async.c:
	(show_hidden_files_changed_callback),
	(show_backup_files_changed_callback),
	(get_filter_options_for_directory_count):
	* libnautilus-extensions/nautilus-file.c:
	(show_text_in_icons_changed_callback),
	(show_directory_item_count_changed_callback),
	(get_speed_tradeoff_preference_for_file),
	(nautilus_file_should_show_directory_item_count),
	(nautilus_file_should_get_top_left_text):
	* libnautilus-extensions/nautilus-theme.c:
	(theme_changed_callback), (nautilus_theme_get_theme),
	(nautilus_theme_get_theme_data), (nautilus_theme_get_image_path):
	* src/file-manager/fm-directory-view.c:
	(confirm_trash_changed_callback), (real_update_menus):
	* src/file-manager/fm-icon-text-window.c:
	(icon_captions_changed_callback),
	(fm_get_text_attribute_names_preference_or_default):
	Use calllbacks for some preferences values instead of peeking
	diectly.  The preferences in question here are peeked a lot during
	large directory loads, even though they hardly ever change.  This
	should get preferences stuff mostly out of Pavel's profiles.  Now,
	im still working on bug 6054 which is about making peeking
	preferences in general faster.

2001-02-06  Pavel Cisler  <pavel@eazel.com>

	reviewed by: Mike Fleming <mfleming@eazel.com>

	* libnautilus-extensions/nautilus-directory-async.c:
	(dequeue_pending_idle_callback), (mime_list_one):
	Handle the case where mime types don't get returned.

	* libnautilus-extensions/nautilus-file.c:
	Fix a comment.

2001-02-06  Andy Hertzfeld  <andy@eazel.com>

	* libnautilus-extensions/nautilus-mime-actions.c:
	(nautilus_do_component_query):
	fixed bug 5479, two "View as Text" items in "View as Other"
	dialog list, by special casing the sample text component so
	it doesn't get added to the list.
	
2001-02-06  Arik Devens  <arik@eazel.com>

	reviewed by: Eskil Heyn Olsen  <eskil@eazel.com>

	Fixed bug 5919, Preferences dialog jumps around the screen.
	
	* libnautilus-extensions/nautilus-preferences-dialog.c:
	(nautilus_preferences_dialog_construct): Removed the center
	positioning so that the dialog stays where the user put it.

2001-02-06  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 1736, if icons on desktop are offscreen, need to
	move them somewhre on screen.
	
	* libnautilus-extensions/nautilus-icon-container.c:
	(icon_set_position), (nautilus_icon_container_move_icon):
	icon_set_position may modify the x and y location of the
	icon.  nautilus_icon_container_move_icon should use the
	modified position instead of the original x and y postion
	when writing the position out into the metafile.

2001-02-06  Andy Hertzfeld  <andy@eazel.com>

	* src/file-manager/fm-properties-window.c:
	(widget_destroy_callback), (icon_selected_callback),
	(icon_cancel_pressed), (list_icon_selected_callback),
	(entry_activated), (select_image_button_callback):
	fixed bug 6280, custom icon selection should use gnome-icon-sel
	instead of the generic file browser, so now it does.
	 
2001-02-06  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Michael Engber  <engber@eazel.com>

	* src/nautilus-sidebar.c: (nautilus_sidebar_initialize_class),
	(nautilus_sidebar_size_allocate), (nautilus_sidebar_realize):
	Tell X not to clear the window contents when the sidebar is
	resized.  Since we double buffer its contents, this will reduce
	(but not eliminate) flicker in the sidebar.
	
2001-02-06  Maciej Stachowiak  <mjs@eazel.com>

	reviewed by: Laszlo Kovacs  <laszlo.kovacs@sun.com>

	Fixed bug 795 (help component installs files in nautilus prefix,
	but uses gnome-libs prefix to find them later) by expanding the
	set of places Nautilus looks for help files.

	* components/help/hyperbola-filefmt.c:
	(fmt_man_populate_tree_for_subdir): Changed to look in more places
	for help files: the help directory in the gnome prefix, the help
	directory in the nautilus prefix, and directories in GNOME_PATH.
	(fmt_help_populate_tree): New helper function.
	(append_help_dir_if_exists): New helper function.

	* components/help/Makefile.am: Define DATADIR in compile flags.

	* components/help/hyperbola-main.c: Add copyright notice.

	This part not reviewed:

	* .cvsignore, libnautilus-extensions/.cvsignore: gnore more
	things.

	* Makefile.am: distribute .in versions of xml-i18n-tools.
	
2001-02-06  John Sullivan  <sullivan@eazel.com>

	Fixed bug 5157 (Nautilus won't display directories for
	which it thinks it doesn't have permissions)

	I removed the code that prevented Nautilus from even
	trying to load a location for which the perceived
	permissions didn't allow reading (because the perceived
	permissions can be wrong with some file systems). Now
	it always tries, and puts up an error dialog only if
	it gets an error while actually loading the directory.

	* src/file-manager/fm-error-reporting.h:
	* src/file-manager/fm-error-reporting.c:
	(fm_report_error_loading_directory): New function, currently
	only handles GNOME_VFS_ERROR_ACCESS_DENIED and a fallback
	default case.
	(fm_report_error_renaming_file), (fm_report_error_setting_group),
	(fm_report_error_setting_owner),
	(fm_report_error_setting_permissions), (rename_callback):
	All the report_error functions now take a parent-window
	parameter (which is often NULL). Also, they now all use
	gnome_vfs_error_result_to_string when whining about
	unhandled cases.

	* src/file-manager/fm-directory-view.h: Changed comments
	and copyright notice only.
	* src/file-manager/fm-directory-view.c:
	(real_load_error): New function, calls 
	fm_report_error_loading_directory unless an error has already
	been reported for the current directory load operation.
	(fm_directory_view_initialize_class): Wire up real_load_error
	as default handler for LOAD_ERROR signal.
	(activate_callback): Pass parent window to error-reporting call.
	(load_directory): Reset the reported_load_error boolean since
	we're about to load anew.
	
	* src/file-manager/fm-properties-window.c: (rename_callback),
	(group_change_callback), (owner_change_callback),
	(permission_change_callback):
	Pass parent window to error-reporting-calls. I just passed NULL
	if it was not trivial to pass a good window.

	* src/nautilus-window-manage-views.c: 
	(handle_unreadable_location), (open_location): Remove code that
	was preventing "unreadable" locations from being loaded.

2001-02-06  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 6375, Certain menu shortcuts don't work when
	insertion point is in location bar.
	
	* libnautilus-extensions/nautilus-entry.c:
	(nautilus_entry_key_press):
	Filter out alt and control keyboard events and don't
	allow them to be passed to the parent GtkEntry.
	
2001-02-06  John Sullivan  <sullivan@eazel.com>

	reviewed by: Gene Ragan <gzr@eazel.com>

	Fixed bug 6365 (Crash at boot if invalid file name given)

	* src/nautilus-window-manage-views.c:
	(load_new_location_in_all_views): Added some parameter checking
	to make future bugs like this even easier to find.
	(cancel_location_change): Don't reset to old location when old
	location is NULL.

2001-02-05  Pavel Cisler  <pavel@eazel.com>

	reviewed by: Seth Nickel <seth@eazel.com>

	Fix 5930 (Copy dialog often shows "1" as total number of
		  fields in operation)

	* libnautilus-extensions/nautilus-file-operations-progress.c:
	(nautilus_file_operations_progress_update),
	(nautilus_file_operations_progress_new_file):
	* libnautilus-extensions/nautilus-file-operations.c:
	(create_transfer_dialog):
	Special case the preparing to copy/move phase -- when the
	bytes_total is 0, don't display the count.
	
	* libnautilus-extensions/nautilus-file-operations-progress.c:
	(nautilus_file_operations_progress_thaw):
	Formatting.

	* HACKING:
	Tiny tweak.

2001-02-05  Eskil Heyn Olsen  <eskil@eazel.com>

	* components/services/install/lib/eazel-install-public.h:
	* components/services/install/command-line/eazel-alt-install-corba.
	c: (eazel_file_conflict_check_signal),
	(eazel_file_uniqueness_check_signal),
	(eazel_feature_consistency_check_signal), (main):
	* components/services/install/idl/trilobite-eazel-install.idl:
	* components/services/install/lib/eazel-install-corba-callback.c:
	(impl_file_conflict_check), (impl_file_uniqueness_check),
	(impl_feature_consistency_check), (eazel_install_callback_get_epv),
	(eazel_install_callback_class_initialize):
	* components/services/install/lib/eazel-install-corba-callback.h:
	* components/services/install/lib/eazel-install-logic2.c:
	(check_no_two_packages_has_same_file),
	(check_conflicts_against_already_installed_packages),
	(check_feature_consistency):
	* components/services/install/lib/eazel-install-object.c:
	(eazel_install_class_initialize),
	(eazel_install_emit_file_conflict_check),
	(eazel_install_emit_file_conflict_check_default),
	(eazel_install_emit_file_uniqueness_check),
	(eazel_install_emit_file_uniqueness_check_default),
	(eazel_install_emit_feature_consistency_check),
	(eazel_install_emit_feature_consistency_check_default):
	Fixed bug 3459 (emit signals when doing file-conflict,
	feature-consistency and file-uniqueness checks).
	
	* components/services/install/lib/eazel-package-system-types.c:
	(packagedata_get_readable_name):
	Nyll poynter checking.

2001-02-05  John Sullivan  <sullivan@eazel.com>

	Fixed bug 6359 (Choosing current view from "View as" menu crashes)

	* src/nautilus-window-manage-views.c:
	(nautilus_window_content_view_matches_iid): New function, extracted
	from load_content_view, checks whether passed iid is the one in
	use by this window.
	(load_content_view): Now calls extracted function.
	(nautilus_window_set_content_view): Bail out early if the
	new content view is the old one. This avoids unpleasant crashing
	later on.

2001-02-05  Gene Z. Ragan  <gzr@eazel.com>

	Add code to send the mime type of the file being examined to the
	mime type capplet so that the capplet can scroll to the mime type
	being examined.
	
	* libnautilus-extensions/nautilus-program-chooser.c:
	(repopulate_program_list), (launch_mime_capplet),
	(launch_mime_capplet_and_close_dialog),
	(nautilus_program_chooser_show_no_choices_message):

2001-02-05  John Sullivan  <sullivan@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	Fixed part of bug 6329 (entering "gconf://" as location
	crashes Nautilus). After this fix, it still crashes Nautilus,
	but in a gconf-specific way.

	* src/nautilus-window-manage-views.c:
	(load_new_location_in_all_views): Don't try to load
	a location in new_content_view if it's NULL.

2001-02-05  John Sullivan  <sullivan@eazel.com>

	reviewed by: Mike Fleming <mfleming@eazel.com>

	Fixed bug 6324 (Switching views crashes every time)
	
	* src/nautilus-window-manage-views.c:
	(set_to_pending_location_and_selection): Added assert
	to make future similar bugs even easier to catch.
	(view_loaded_callback): Don't call set_to_pending_location_and_selection
	when the content view is changing without the location & selection 
	changing; just update the one view instead.

	* libnautilus-extensions/nautilus-stock-dialogs.c:
	Reduced the timed-wait timeout from 3 seconds to 2 after
	more investigation of timed-wait-related bugs. 3 seconds
	just felt a little too long.

2001-02-05  Michael Engber  <engber@eazel.com>

	* libnautilus-extensions/nautilus-metafile-factory.c:
	(nautilus_metafile_factory_new), (free_factory_instance),
	(nautilus_metafile_factory_get_instance):
	* libnautilus-extensions/nautilus-metafile-factory.h:
	* src/Nautilus_shell.oaf.in:
	* src/nautilus-application.c: (manufactures), (create_object),
	(nautilus_application_startup):
	* src/nautilus-application.h:
	Add the MetafileFactory to the main object factory.

2001-02-05  Rebecca Schulman  <rebecka@eazel.com>

	reviewed by: Maciej Stachowiak <mjs@eazel.com>

	* libnautilus-extensions/nautilus-mime-actions.c:
	(nautilus_mime_get_default_component_sort_conditions),
	(nautilus_mime_get_default_component_for_file_internal),
	(nautilus_mime_get_short_list_components_for_file):
	Changes to make sure the short list is sorted 
	correctly, so the correct default application is chosen.

2001-02-05  Andy Hertzfeld  <andy@eazel.com>

	* librsvg/rsvg.c: (rsvg_render_svp):
	fixed bug 6301, bad svg crashes Nautilus, by adding a check
	in rsvg_render_svp to make sure a pixbuf has been allocated; if
	not, don't try to render.
	
2001-02-05  John Sullivan  <sullivan@eazel.com>

	Fixed bug 6321 (Apparently arbitrary item initially selected
	in "Open with Other" dialog)

	* libnautilus-extensions/nautilus-program-chooser.c:
	(repopulate_program_list): Select first item in list after sorting.

2001-02-04  Ian McKellar,,,  <ian@eazel.com>

	reviewed by: Maciej Stachowiak <mjs@eazel.com>	

	* components/services/install/lib/Makefile.am:
	* components/services/install/lib/eazel-package-system-dpkg.c:
	(debpackage_free), (debpackage_fill_packagedata),
	(strip_trailing_whitespace), (parse_packages),
	(load_package_callback), (eazel_package_system_dpkg_load_package),
	(query_callback), (eazel_package_system_dpkg_query),
	(eazel_package_system_dpkg_install),
	(eazel_package_system_dpkg_uninstall),
	(eazel_package_system_dpkg_verify),
	(eazel_package_system_dpkg_compare_version),
	(eazel_package_system_dpkg_finalize),
	(eazel_package_system_dpkg_class_initialize),
	(eazel_package_system_dpkg_initialize),
	(eazel_package_system_dpkg_get_type),
	(eazel_package_system_dpkg_new),
	(eazel_package_system_implementation):
	* components/services/install/lib/eazel-package-system-dpkg.h:
	* components/services/install/lib/eazel-package-system.c:
	(eazel_package_system_suggest_id),
	(eazel_package_system_load_implementation):
	Created a minimal, sub-functional Debian package backend for 
	libeazelinstall - essentially only enough to allow me to test my
	software inventory work on my Debian machines.

	* components/services/inventory/Makefile.am:
	* components/services/inventory/eazel-inventory-collect-hardware.c:
	(add_device_property), (eazel_inventory_collect_pci),
	(ide_get_value), (eazel_inventory_collect_ide), (str_has_prefix),
	(add_info), (read_proc_info), (eazel_inventory_collect_memory),
	(eazel_inventory_collect_cpu), (eazel_inventory_collect_hardware):
	* components/services/inventory/eazel-inventory-collect-hardware.h:
	* components/services/inventory/eazel-inventory-collect-software.c:
	(str_has_prefix), (get_package_list),
	(eazel_inventory_collect_packages),
	(eazel_inventory_collect_software):
	* components/services/inventory/eazel-inventory-collect-software.h:
	* components/services/inventory/eazel-inventory-utils.c:
	(eazel_create_configuration_metafile):
	Moved software inventory code into eazel-inventory-collect-software.c
	and hardware inventory code into eazel-inventory-collect-hardware.c.
	Added coded to collect PCI and IDE bus information.

	* components/services/trilobite/libtrilobite/trilobite-core-distrib
	ution.c: (determine_suse_version), (determine_debian_version):
	Added version check code for SuSE and Debian.

2001-02-04  Jason Leach  <jasonleach@usa.net>

	reviewed by: Maciej Stachowiak <mjs@eazel.com>	
	
	* nautilus-clean.sh: Update to work with Solaris.

2001-02-04  Maciej Stachowiak  <mjs@eazel.com>

	* indent.sh: Script that calls indent with the right parameters to
	get a GNOME coding style (Nautilus subvariant).

	* components/help/hyperbola-filefmt.c,
	components/help/hyperbola-filefmt.h,
	components/help/hyperbola-main.c,
	components/help/hyperbola-nav-index.c,
	components/help/hyperbola-nav-search.c,
	components/help/hyperbola-nav-tree.c,
	components/help/hyperbola-nav.h,
	components/help/hyperbola-types.h: Run indent.sh on these.

2001-02-03  John Sullivan  <sullivan@eazel.com>

	Fixed bug 6254 ("Display" name for grouping in "Folder Views"
	category is poor)

	* libnautilus-extensions/nautilus-global-preferences.c:
	(global_preferences_install_descriptions),
	(global_preferences_create_dialog): Verafied a little text.

2001-02-03  Eskil Heyn Olsen  <eskil@eazel.com>

	* components/throbber/Makefile.am:
	Added the oaf.in files to EXTRA_DIST (tinderbox fix)

2001-02-03  Gene Z. Ragan  <gzr@eazel.com>

	Do a simple check for NULL instead of using
	g_return_if_fail.  We don't need the error
	reported to the terminal.
	
	* libnautilus-extensions/nautilus-volume-monitor.c:
	(get_removable_volumes), (volume_is_removable),
	(volume_is_read_only):

2001-02-02  Eskil Heyn Olsen  <eskil@eazel.com>

	* components/services/install/command-line/eazel-alt-install-corba.
	c: (tree_helper_helper), (tree_helper):
	Added check for PackageBreaks iterators.
	
	* components/services/install/lib/eazel-install-corba-callback.c:
	(impl_install_failed):
	Leakfix, freeing the list given to the signal handler after
	handling.
	
	* components/services/install/lib/eazel-install-corba-types.c:
	(empty_hash_table),
	(packagedata_tree_from_corba_packagedatastructlist):
	Leakfix, now correctly frees the contents of the md5_hashtable and
	unrefs the proper objects.

	* components/services/install/lib/eazel-install-logic2.c:
	(eazel_install_check_existing_packages), (get_softcat_info),
	(is_satisfied), (is_satisfied_features),	
	(check_dependencies_foreach), (check_tree_helper),
	(add_file_conflict),
	(check_conflicts_against_already_installed_packages),
	(check_feature_consistency):
	Proper fillflags for some EazelPackageSystem calls.
	Nicer log-output when debug is off.
	Leak fix, the PackageBreaks "objects".
	
	* components/services/install/lib/eazel-install-problem.c:
	(get_detailed_messages_breaks_foreach),
	(get_detailed_messages_foreach),
	(get_detailed_cases_breaks_foreach), (get_detailed_cases_foreach):
	Updated for the new PackageBreaks "objects".
	
	* components/services/install/lib/eazel-package-system-rpm4.c:
	(eazel_package_system_rpm4_query_impl):
	s/packagedata_destroy/gtk_object_unref/
	
	* components/services/install/lib/eazel-package-system-types.c:
	(at_exit_package_data_info), (categorydata_new),
	(categorydata_destroy_foreach), (packagedata_finalize),
	(packagedata_class_initialize), (packagedata_initialize),
	(packagedata_get_readable_name), (packagebreaks_finalize),
	(packagebreaks_class_initialize), (packagebreaks_initialize),
	(packagefileconflict_finalize),
	(packagefileconflict_class_initialize),
	(packagefeaturemissing_finalize),
	(packagefeaturemissing_class_initialize):
	Finally got the destroy crap working for the PackageBreak
	"objects".
	More leakcheck stuff for various structures.
	Again, fixed get_reabable_name.
	
	* components/services/install/lib/eazel-package-system-types.h:
	Added finalizes to the "objects".
	Removed packagedata_destroy prototype.
	
	* components/services/trilobite/libtrilobite/Makefile.am:
	Cleanup and possible tinderbox fix.
	
2001-02-02  Robey Pointer  <robey@eazel.com>

	* components/services/install/lib/eazel-install-corba-types.c:
	(packagedata_tree_from_corba_packagedatastructlist):

	Fix small bug in the package tree inflater that caused break
	structs to be messed up.
	
	* components/services/install/lib/eazel-softcat.c:
	(get_search_url_for_package):
	* components/services/install/nautilus-view/nautilus-service-instal
	l-view.c: (create_package),
	(nautilus_service_install_view_update_from_uri_finish):

	Encode and decode suite_id/suite_name/product_id/product_name from
	eazel-install: urls and pass through to softcat queries.  They are
	all treated like variant flavors of suite_id internally (group of
	packages with a single id).
	
	* nautilus-installer/src/Makefile:
	* nautilus-installer/src/installer.c:
	(get_detailed_errors_foreach), (get_detailed_errors),
	(eazel_install_preflight), (eazel_installer_set_default_texts),
	(eazel_installer_initialize):

	Remove eazel-hacking uninstall, since experts claim we no longer
	need it.  Some changes to sync up with the new world order where
	PackageData is now a GTK object.
	
	* nautilus-installer/src/package-tree.c:
	(find_package_parents_int), (find_package_parents),
	(get_errant_children_int), (get_errant_children),
	(package_customizer_fill_dep), (package_customizer_fill),
	(jump_to_package_tree_page):

	Fix the package customizer to cope with the new world order, where
	the package tree is sent across as a directed graph (instead of
	tree) and the deps are in 'depends' not 'soft_depends'.
	
	* nautilus-installer/src/prescript:

	Up version to 1.0.

2001-02-02  Darin Adler  <darin@eazel.com>

	reviewed by: John Sullivan <sullivan@eazel.com>

	Fixed bug 6163 (Need NautilusViewFrame ::
	report_location_changed). This is re-adding a feature we also had
	long ago, where a view reports a location change, but does not
	want the location change to come back to it in the form of a
	load_location call.

	* src/nautilus-applicable-views.h:
	* src/nautilus-applicable-views.c:
	(get_view_result_from_gnome_vfs_result), (got_file_info_callback),
	(got_minimum_file_info_callback),
	(nautilus_determine_initial_view),
	(nautilus_determine_initial_view_cancel): Changed this entire file
	to have a much easier-to-understand API.
	
	* src/nautilus-view-frame-private.h:
	* src/nautilus-view-frame-corba.c: (free_location_plus_callback):
	Change existing structure so it can be used for the location-change
	case, which includes a title too.
	(open_force_new_window): Use new structure.
	(report_location_change): Implement new call.
	(impl_Nautilus_ViewFrame_open_location_force_new_window): Use new
	structure.
	(impl_Nautilus_ViewFrame_report_location_change): Implement new
	call.
	
	* libnautilus/nautilus-view-component.idl: Add the new call.
	* libnautilus/nautilus-view.h:
	* libnautilus/nautilus-view.c:
	(nautilus_view_report_location_change): Add the new call.

	* src/nautilus-view-frame.h:
	* src/nautilus-view-frame.c:
	(nautilus_view_frame_initialize_class): Add new signal.
	(nautilus_view_frame_report_location_change): Implement new call.
	
	* src/nautilus-window-private.h:
	* src/nautilus-window-manage-views.h:
	* src/nautilus-window-manage-views.c: (update_for_new_location):
	Got rid of obsolete assert. Also, no longer clear the selection.
	The selection is set properly earlier, and clearing it at this
	point serves no purpose.
	(location_has_really_changed): Call free_location_change to share
	more code. Also no reason to free "pending_ni" any more, because
	we don't keep it around in the success case.
	(load_new_location_in_one_view): New name.
	(load_new_location_in_sidebar_panels): New name. Also take a
	parameter of a view to skip.
	(load_new_location_in_all_views): New function.
	(set_to_pending_location_and_selection): New name, and removed
	code to handle the case where there is no pending location, since
	that doesn't happen. Also take a parameter of a view to skip. Also
	broke out the guts into load_new_location_in_all_views.
	(free_location_change): Free things by their new names. There's
	also less to free now.
	(cancel_location_change): Key off pending_location instead of
	pending_ni. Also save code by using new function that skips a
	view.
	(determined_initial_view_callback): Changed name, and use new
	interface. No longer need "end_reached" trick, because the new
	interface handles that.
	(begin_location_change): Made a static after moving all the
	functions that use it in here. Also moved some of the reload
	code out into nautilus_window_reload.
	(report_location_change_callback): New function. Does all the
	steps neede for a location change in place.
	(nautilus_window_back_or_forward), (nautilus_window_reload): Moved
	these two functions in here from nautilus-window.c so we could
	make begin_location_change more private.
	
	* src/nautilus-window.h:
	* src/nautilus-window.c: (nautilus_window_go_to): Changed the name.
	(nautilus_window_get_location): New function for callers that used
	to get the location field directly.
	(go_to_callback): Changed name.

	* src/nautilus-desktop-window.c: (nautilus_desktop_window_new):
	* src/nautilus-location-bar.c: (drag_data_received_callback):
	* src/nautilus-shell.c: (open_window), (save_window_states),
	(restore_window_states):
	* src/nautilus-window-menus.c: (services_button_callback),
	(help_menu_nautilus_manual_callback),
	(help_menu_nautilus_license_callback),
	(help_menu_nautilus_feedback_callback),
	(activate_bookmark_in_menu_item):
	* src/nautilus-window-service-ui.c: (goto_services_summary),
	(goto_online_storage), (goto_software_catalog),
	(goto_services_support):
	* src/nautilus-window.c: (location_change_at_idle_callback),
	(nautilus_window_constructed), (view_as_menu_vfs_method_callback),
	(nautilus_window_go_web_search), (nautilus_window_go_home):
	Use nautilus_go_to under its new name.
	
	* src/nautilus-shell.c: (restore_window_states): Use
	nautilus_istr_has_prefix instead of g_strncasecmp. Also did other
	code cleanup.
	
	* libnautilus-extensions/nautilus-gtk-extensions.h: Added a new
	marshal function that I needed.
	
	* libnautilus-extensions/nautilus-thumbnails.c: Added a FIXME.
	
	* libnautilus-extensions/nautilus-view-identifier.h:
	* libnautilus-extensions/nautilus-view-identifier.c:
	(nautilus_view_identifier_copy),
	(nautilus_view_identifier_compare): Use const.
	
	* src/nautilus-application.c: (nautilus_application_startup): Only
	check for root if we are actually running nautilus, not if we are
	just killing off an existing copy.
	(confirm_ok_to_run_as_root): Changed name of the function and
	improved the wording of the message and button. Also added an
	environment variable you can set to get rid of this. (Probably
	should have been a preference instead, but I am officially being
	lazy about this.)

	Fixed bug that was revealed by the change in the loading sequence
	I made. John didn't review this part:
	
	* libnautilus-extensions/nautilus-directory-private.h:
	* libnautilus-extensions/nautilus-directory-async.c:
	(load_directory_state_destroy), (load_directory_done):
	Separate out code to free the partly-done state so it can
	be used in the cancel case.
	(dequeue_pending_idle_callback): Ref the directory object
	so that we won't get messed up if the callback destroys it.
	(directory_load_cancel): Separated out the old part of
	file_list_cancel so that we can cancel the idle part too
	when we want to.
	(file_list_cancel): Use the new calls to cancel the idle
	part of directory loading.
	(directory_load_done): Use directory_load_cancel instead of
	file_list_cancel.
	(nautilus_directory_stop_monitoring_file_list): Use
	directory_load_cancel instead of file_list_cancel.
	(nautilus_directory_async_state_changed): Added state variables to
	protect cases where we re-enter this function.

2001-02-02  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Michael Engber  <engber@eazel.com>

	* applets/preferences-applet/nautilus-preferences-applet.c:
	(restart_button_clicked_callback), (main):
	Add a restart button.
	
2001-02-02  Gene Z. Ragan  <gzr@eazel.com>

	Fixed a small bug where I was assuming a value would be valid
	when it could be NULL. Now I check for NULL.
	
	* src/nautilus-application.c: (volume_unmounted_callback):

2001-02-02  Brett Neely  <brett@eazel.com>

	reviewed by: Eric Fischer  <eric@eazel.com>

	* nautilus-clean.sh:
	Kill oafd last so nautilus-clean.sh -x only needs to be run once.

2001-02-02  Gene Z. Ragan  <gzr@eazel.com>

	reviewed by: Maciej Stachowiak  <mjs@eazel.com>
	
	Fixed bug 5222,
	Nautilus allows users to rename .Trash (but not copy or link)
	
	* libnautilus-extensions/nautilus-file-utilities.c:
	* libnautilus-extensions/nautilus-file-utilities.h:
	(nautilus_uri_is_trash_folder):
	Utility function to indentify if the folder is trash based
	on a text uri.
	
	* libnautilus-extensions/nautilus-file.c:
	(nautilus_file_can_rename):
	Call nautilus_uri_is_trash_folder to identify a trash
	folder and disallow renaming.
	
2001-02-02  John Sullivan  <sullivan@eazel.com>

	reviewed by: Darin Adler <darin@eazel.com>

	Fixed bug 5749 (bookmarks are untranslated)

	* data/static_bookmarks.xml:
	An earlier checkin to update the bookmarks stripped off
	all the underscores from "_name=" strings, which was what
	was causing them to be translated. Fixed by returning the
	underscores.

2001-02-02  Ramiro Estrugo  <ramiro@eazel.com>

	* applets/preferences-applet/nautilus-preferences-applet.c:
	(boolean_toggle_button_new), (start_button_clicked_callback),
	(main):
	Add a Nautilus start button.  Also make the fonts smaller to
	conserver panel space.
	
2001-02-02  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Maciej Stachowiak  <mjs@eazel.com>

	Fix bug 6131 - NautilusLabel does not support proper line wrap.
	Its fixed for smooth mode.  Theres a bug (6243) for the more
	complicated issue of wrapping in non smooth mode.

	* libnautilus-extensions/nautilus-label.h:
	* libnautilus-extensions/nautilus-label.c:
	(nautilus_label_initialize_class), (nautilus_label_set_arg),
	(nautilus_label_get_arg), (nautilus_label_size_allocate),
	(nautilus_label_set_never_smooth),
	(nautilus_label_set_adjust_wrap_on_resize),
	(nautilus_label_get_adjust_wrap_on_resize):
	Add a boolean attribute 'adjust_wrap_on_resize' that controls
	whether the label will automatically update its line wrap width
	when its resized.

	* components/services/summary/nautilus-view/nautilus-summary-view.c
	: (summary_view_item_label_new), (summary_load_location_callback):
	No longer need size_allocate hack.  Use NautilusLabel's
	'adjust_wrap_on_resize' attribute instead.
	
	* test/test-nautilus-label-wrapped.c: (create_nautilus_label),
	(create_gtk_label_window), (create_nautilus_label_window), (main):
	Update for 'adjust_wrap_on_resize'.
	
2001-02-01  Maciej Stachowiak  <mjs@eazel.com>

	reviewed by: Pavel Cisler  <pavel@eazel.com>

	Fix bug 4678 (Clicking on a Nautilus link file in tree view causes
	Nautilus cannot handle item type error box).
	
	* components/tree/nautilus-tree-view.c:
	(nautilus_tree_view_destroy), (got_activation_uri_callback),
	(cancel_possible_activation), (tree_select_row_callback): Activate
	activation URI instead of file URI to support Nautilus links
	properly. If the link resolves to a "command:" URI, however,
	silently ignore it to avoid giving an ugly error message because
	per John Sullivan, selecting things in the tree view should not
	launch apps.

	* components/tree/nautilus-tree-view-private.h: Added
	activation_uri_wait_file field to details struct.

	* data/top/Computer, data/top/Services: Updated to new nautilus
	link format.

2001-02-02  Robey Pointer  <robey@eazel.com>

	* components/services/install/nautilus-view/nautilus-service-instal
	l-view.c: (flatten_package_tree_foreach):

	Fix build breakage caused by my previous checkin.

2001-02-02  Robey Pointer  <robey@eazel.com>

	reviewed by: Eskil Heyn Olsen  <eskil@eazel.com>

	* components/services/install/lib/eazel-install-logic2.c:
	(is_satisfied), (download_packages):
	* components/services/install/lib/eazel-install-protocols.c:
	(gnome_vfs_fetch_remote_file):

	Fix thinko (caused by myself in October) that caused the stop
	button to only cancel one download and then aggravatingly continue
	with the remaining downloads.

	* components/services/install/idl/trilobite-eazel-install.idl:
	* components/services/install/lib/eazel-install-corba-callback.c:
	(impl_download_progress), (impl_preflight_check),
	(impl_download_failed), (impl_dep_check), (impl_install_progress),
	(impl_uninstall_progress), (impl_md5_check_failed),
	(impl_install_failed), (impl_uninstall_failed),
	(eazel_install_callback_simple_query):
	* components/services/install/lib/eazel-install-corba-types.c:
	(corba_string_sequence_to_glist),
	(g_list_to_corba_string_sequence),
	(corba_packagedatastruct_fill_from_packagedata),
	(corba_packagedatastruct_from_packagedata),
	(corba_packagedatastructlist_fill_from_packagedata_list),
	(corba_packagedatastructlist_from_packagedata_list),
	(new_fake_md5), (traverse_packagetree_md5),
	(corba_packagedatastruct_fill_deps),
	(corba_packagedatastructlist_foreach),
	(corba_packagedatastructlist_from_packagedata_tree),
	(packagedata_from_corba_packagedatastruct),
	(packagedata_list_from_corba_packagedatastructlist),
	(packagedata_tree_from_corba_packagedatastructlist),
	(corba_category_list_from_categorydata_list),
	(categorydata_list_from_corba_categorystructlist):
	* components/services/install/lib/eazel-install-corba-types.h:
	* components/services/install/lib/eazel-install-corba.c:
	(impl_Eazel_Install_install_packages),
	(impl_Eazel_Install_uninstall_packages),
	(impl_Eazel_Install_simple_query):
	* components/services/install/lib/eazel-install-object.c:
	(eazel_install_emit_preflight_check_default),
	(eazel_install_emit_install_failed_default),
	(eazel_install_emit_uninstall_failed_default):
	* components/services/install/lib/eazel-install-xml-package-list.c:
	(parse_package), (eazel_install_packagedata_to_xml_int),
	(eazel_install_packagedata_to_xml),
	(eazel_install_packagelist_to_xml):
	* components/services/install/lib/eazel-install-xml-package-list.h:

	Add proper "breaks", "modifies", and "depends" structures to the
	corba interface, by using package MD5 strings to serve as "soft
	pointers" between packages in a package tree.  Convert the
	preflight, install_failed, and uninstall_failed signals to use the
	new package-tree type instead of munging into and out of XML.
	Also fixed up the API's to the corba conversion routines so they
	would make a valiant attempt not to leak memory.

	* components/services/install/lib/eazel-package-system-types.c:
	(packagedata_copy):

	Don't forget to copy that pesky MD5!
	
	* components/services/install/lib/eazel-package-system-types.h:

	Satisfy Robey's desire to avoid Carpal Tunnel Syndrome.
	
	* components/services/install/lib/eazel-softcat.c:
	(eazel_softcat_string_to_sense_flags),
	(get_search_url_for_package):
	* components/services/install/lib/eazel-softcat.h:

	Add function to convert a sense string back into flags.
	
	* components/services/install/nautilus-view/nautilus-service-instal
	l-view.c: (flatten_package_tree_depends_foreach),
	(flatten_package_tree_foreach):

	Fix up the install view to use the new "depends" chain instead of
	the old "soft_depends" which is now empty.

2001-02-02  Ramiro Estrugo  <ramiro@eazel.com>

	* libnautilus-extensions/nautilus-metafile-factory.c: (corba_open):
	Add new line at end of file to make redhat7 build happy. 
	
2001-02-01  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Maciej Stachowiak  <mjs@eazel.com>

	* libnautilus-extensions/nautilus-global-preferences.c:
	(global_preferences_install_defaults),
	(global_preferences_install_visibility),
	(global_preferences_install_sidebar_panel_defaults):
	* libnautilus-extensions/nautilus-preferences.c:
	(nautilus_preferences_get_user_level):
	* libnautilus-extensions/nautilus-preferences.h:
	* src/nautilus-first-time-druid.c: (set_up_user_level_page):
	* src/nautilus-window-menus.c: (get_user_level_icon_name),
	(nautilus_window_initialize_menus), (convert_verb_to_user_level),
	(convert_user_level_to_path):
	* test/test-nautilus-preferences-change.c: (main):
	Change 'hacker' to 'advanced' for the advanced user level so that
	the names used for storage match those used for display.

2001-02-01  Maciej Stachowiak  <mjs@eazel.com>

	reviewed by: Darin Adler  <darin@eazel.com> and 
	             Robey Pointer  <robey@eazel.com>

	Fix bugs 5528 (oaf command-line options show up in main program
	section, not a separate section) and 5510 (descriptions of
	OAF-specific options in --help are not translated). To do this I
	had to change the way the oaf popt options are processed in all
	the places that do so.

	* components/adapter/main.c: (main):
	* components/hardware/main.c: (main):
	* components/help/hyperbola-main.c: (main):
	* components/image-viewer/Nautilus_View_image.oaf.in:
	* components/image-viewer/nautilus-image-view.c:
	(init_server_factory):
	* components/loser/content/main.c: (main):
	* components/loser/sidebar/main.c: (main):
	* components/mozilla/main.c: (main):
	* components/music/main.c: (main):
	* components/notes/nautilus-notes.c: (main):
	* components/rpmview/main.c: (main):
	* components/services/install/command-line/eazel-alt-install-corba.
	c: (main):
	* components/services/install/nautilus-view/main.c: (main):
	* components/services/login/nautilus-view/main.c: (main):
	* components/services/summary/nautilus-view/main.c: (main):
	* components/services/time/command-line/main.c: (main):
	* components/services/time/nautilus-view/main.c: (main):
	* components/services/trilobite/libtrilobite/trilobite-core-utils.c
	: (trilobite_init):
	* components/shell/shell.c:
	* components/text/Nautilus_View_text.oaf.in:
	* components/text/main.c: (main):
	* components/throbber/main.c: (main):
	* components/tree/main.c: (main):
	* libnautilus/nautilus-view-standard-main.c:
	(nautilus_view_standard_main_multi):
	* src/Nautilus_shell.oaf.in:
	* src/nautilus-main.c: (main):
	* test/test-nautilus-mime-actions-set.c: (main):
	* test/test-nautilus-mime-actions.c: (main): Register oaf options
	with gnomelib_register_popt_options and move oaf_init call to
	before gnome_init to fix the aforementioned bugs.

2001-02-01  Rebecca Schulman  <rebecka@eazel.com>
	Fixed bug 5648, bad ui in the indexing info
	dialog.

	reviewed by: Maciej Stachowiak <mjs@eazel.com>

	* src/file-manager/nautilus-indexing-info.c:
	(get_index_percentage_complete), (initialize_dialog),
	(get_text_for_progress_label), (update_progress_display),
	(show_index_progress_dialog), (show_reindex_request_dialog),
	(recreate_and_show_reindex_request_dialog),
	(update_file_index_callback),
	(last_index_time_and_reindex_button_dialog_new),
	(index_progress_dialog_new),
	(destroy_indexing_info_dialogs_on_exit),
	(show_indexing_info_dialog): Rework this file.  Use two separate
	index dialogs for the case where the index is going, and not
	going.  When "update now" is pressed, switch to the index progress
	dialog.  Report errors reported by and unavailibility of the
	indexing service.

	* libnautilus-extensions/nautilus-stock-dialogs.c:
	(nautilus_create_info_dialog):
	* libnautilus-extensions/nautilus-stock-dialogs.h:
	Add this for use in creating the indexing info dialog.
	

2001-02-01  Michael K. Fleming  <mfleming@eazel.com>

	reviewed by: <robey@eazel.com>

	Bug 6103 a user can install any package from softcat without login 
	Bug 4514 error msg when register during softcat install 

	Login dialog for the install view, with working registration, cancel,
	etc.


	* components/services/install/nautilus-view/Makefile.am:
	* components/services/install/nautilus-view/main.c: (main):
	* components/services/install/nautilus-view/nautilus-service-instal
	l-view.c: (nautilus_service_install_view_destroy),
	(nautilus_install_parse_uri), (nautilus_service_install_done),
	(user_login_callback),
	(nautilus_service_install_view_update_from_uri),
	(nautilus_service_install_view_update_from_uri_finish),
	(nautilus_service_install_view_load_uri):
	* components/services/summary/nautilus-view/nautilus-summary-menu-i
	tems.c: (merge_bonobo_menu_items):
	* components/services/summary/nautilus-view/nautilus-summary-view.c
	: (update_header), (nautilus_summary_view_load_uri):
	* src/nautilus-window-service-ui.c: (goto_online_storage),
	(goto_software_catalog):

2001-02-01  Michael Engber  <engber@eazel.com>

	* libnautilus-extensions/Makefile.am:
	* libnautilus-extensions/nautilus-metafile-factory.c:
	(nautilus_metafile_factory_initialize_class),
	(nautilus_metafile_factory_get_epv),
	(nautilus_metafile_factory_get_vepv),
	(nautilus_metafile_factory_create_servant),
	(nautilus_metafile_factory_initialize), (destroy),
	(nautilus_meta_file_factory_new), (corba_open):
	* libnautilus-extensions/nautilus-metafile-factory.h:
	* libnautilus-extensions/nautilus-metafile-server.idl:
	* libnautilus-extensions/nautilus-metafile.c:
	(nautilus_metafile_initialize_class), (nautilus_metafile_get_epv),
	(nautilus_metafile_get_vepv), (nautilus_metafile_create_servant),
	(nautilus_metafile_initialize), (destroy), (nautilus_metafile_new),
	(corba_get), (corba_get_list), (corba_set), (corba_set_list),
	(corba_copy), (corba_remove), (corba_rename),
	(corba_register_monitor), (corba_unregister_monitor):
	* libnautilus-extensions/nautilus-metafile.h:
	Initiall check-in of new metadata APIs (corba) - not hooked
	up yet.

2001-02-01  Gene Z. Ragan  <gzr@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>
	
	Fixed bug 6941, 'Clean Up By Name' feature on the desktop keep
	switching file locations after being 'cleaned up'
	
	* src/file-manager/fm-desktop-icon-view.c:
	(desktop_icons_compare_callback):
	In the case of identical links tpyes, compare by name.	
		
	More work on gmc transition tool
	
	* src/nautilus-first-time-druid.c:
	(druid_finished):
	Hide druid widget before performing startup tasks.
	
	(next_proxy_configuration_page_callback),
	(add_nautilus_to_session):

2001-02-01  Pavel Cisler  <pavel@eazel.com>

	reviewed by: Gene Ragan <gzr@eazel.com>

	Fix 6152 (Dragging a file to the trash will bring up a replace
		  dialog)
	Fix 5387 (Dragging a file within Trash gives "already exists"
		 error)

	* libnautilus-extensions/nautilus-drag.c:
	* libnautilus-extensions/nautilus-drag.h:
	(nautilus_drag_items_local), (nautilus_drag_items_in_trash):
	Add more convenience calls for Trash handling.
	
	* libnautilus-extensions/nautilus-file-utilities.h:
	* libnautilus-extensions/nautilus-file-utilities.c:
	(nautilus_uri_is_in_trash):
	New convenience call for Trash handling.

	* libnautilus-extensions/nautilus-file.c:
	(nautilus_file_is_in_trash):
	Use the new nautilus_uri_is_in_trash call.

	* libnautilus-extensions/nautilus-file-operations.c:
	(nautilus_file_operations_copy_move):
	Handle the case where a file is dragged into a Trash window or
	onto a Trash icon as if the "Move to Trash" command was issued -
	if there is a name conflict with a pre-existing file in the Trash,
	use a new unique name for the new file.
	
	* libnautilus-extensions/nautilus-icon-dnd.c:
	(nautilus_icon_container_selection_items_local):
	Handle files in the Trash properly - doing a parent match with
	the container URI fails for these, special case Trash handling.

2001-02-01  John Sullivan  <sullivan@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	Fixed bug 143 (zooming in list view doesn't affect font size)

	Maybe I get the award for "oldest reported bug fixed recently"?

	* src/file-manager/fm-list-view.c: 
	(fm_list_view_update_font): New function, started with guts of
	fm_list_view_font_family_changed but also takes zoom level into
	account when choosing font size.
	(set_up_list): Call _update_font instead of _font_family_changed,
	just 'cuz it makes more sense.
	(fm_list_view_set_zoom_level): Call _update_font.
	(fm_list_view_font_family_changed): Extracted guts to
	_update_font.

2001-02-01  John Sullivan  <sullivan@eazel.com>

	reviewed by: Darin Adler <darin@eazel.com>

	Fixed bug 6181 (funny mouse clicking freezes Nautilus)

	* libnautilus-extensions/nautilus-icon-container.c:
	(button_press_event): Ignore middle & right button
	presses when we're dragging a selection rectangle.

2001-02-01  John Sullivan  <sullivan@eazel.com>

	reviewed by: Darin Adler <darin@eazel.com>

	* libnautilus-extensions/nautilus-global-preferences.c:
	(global_preferences_install_descriptions):
	Parenthesize parenthetical part of "slow but complete
	search" checkbox label.
	(global_preferences_create_dialog): Use SHORT_ENUM
	instead of ENUM type for executable text file
	activation options so they all go on one line, taking
	less precious vertical screen real estate.

2001-02-01  Darin Adler  <darin@eazel.com>

	* components/services/install/lib/eazel-package-system-types.h:
	Add missing packagedata_destroy prototype to make it compile
	on systems with RPM 4 (like mine).

2001-02-01  Maciej Stachowiak  <mjs@eazel.com>

	* ChangeLog: rolled over to ChangeLog-20010201.

